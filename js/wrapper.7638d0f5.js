(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["wrapper"],{"05b9":function(t,e,a){"use strict";a("5f75")},"0b4c":function(t,e,a){"use strict";a("e1df")},"0d58":function(t,e,a){"use strict";a("4d40")},"12d7":function(t,e,a){"use strict";a("9a5e")},1380:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"matrix"}},[a("MatrixHeader"),a("LoadingPage"),a("div",{attrs:{id:"container"}})],1)},n=[],s=a("2909"),i=a("1da1"),o=(a("96cf"),a("99af"),a("d81d"),a("b0c0"),a("a434"),a("a4d3"),a("e01a"),a("e9c4"),a("fb6a"),a("d3b7"),a("ac1f"),a("5319"),a("466d"),a("4de4"),a("4e82"),a("159b"),a("1276"),a("b64b"),a("3ca3"),a("ddb0"),a("bc3a")),l=a.n(o),c=a("9cc6"),u=a("2fdb"),d=a("4360"),h={name:"Matrix",components:{MatrixHeader:c["a"],LoadingPage:u["a"]},data:function(){return{hostname:d["default"].state.url,publicPath:"/",structures:null,totalStructures:0,d3:a("5698"),green:"#7A9D5B",backgroundColour:"#ffffff",x:0,y:15,organismId:"2697049"}},mounted:function(){var t,e=this,a="".concat(window.BACKEND,"/").concat(this.organismId);l()({method:"get",url:a}).then((function(a){t=JSON.parse(a.data.primary_accessions),e.getStructures(e.organismId,t).then((function(t){console.log(t),e.getMatchingStructures(t).then((function(t){e.getProteinSynonyms(t).then((function(t){e.loadShapes(t).then((function(){document.querySelector(".matrixLoading")&&(document.querySelector(".matrixLoading").style.visibility="hidden",document.querySelector(".matrixLoading").style.display="none")}))}))}))})),e.structures=t})),window.addEventListener("resize",this.initialDisplay)},methods:{getResidueSize:function(t,e){return e*t},loadShapes:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r,n,i,o,l,c,u,d,h,p,f,m,g,v,y,w,b,A,_;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:for(t=e.partitionToThree(t),r=0,n=960/Math.max.apply(Math,Object(s["a"])(t.map((function(t){return e.getListSum(t)})))),i=0;i<t.length;i++){for(o=e.d3.select("#container").append("svg").attr("class","row").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","0 0 960 360"),e.x=0,e.y=15,l=0,0!==i&&(c=t[i-1],u=c[c.length-1],d=t[i][0],h=Math.floor(d.length/500+1),p=!1,h>3&&(p=!0),f={id:"placeholder",dark:!0,placeholderLarge:p,primary_accession:u.primary_accession,name:u.name,synonym:u.synonym,placeholder:!0},e.drawArrow(o,f,150,20,20/1.5,l,n),e.drawRuler(o,f,r,150,20/1.5,l),l=l+150+20/1.5),m=0;m<t[i].length;m++)g=!1,v=20,y=v/1.5,w=e.getResidueSize(n,t[i][m].length)-y,w<0&&(y=e.getResidueSize(n,t[i][m].length),w=0),e.drawArrow(o,t[i][m],w,v,y,l,n),e.drawRuler(o,t[i][m],r,w,y,l),r=t[i][m].continuous?t[i][m].length:0,e.addNonDarkToFragments(t[i][m]),0!==t[i][m].fragments.length&&(e.y=e.y+33,g=!0),e.drawFragments(o,t[i][m].fragments,n,l),e.drawMatchingStructures(o,t[i][m],w,v,y,l,n),l=l+w+y,g&&(e.y=e.y-33);0!==i&&i!==t.length-1&&(b=t[i+1],A=b[0],_=t[i-1],h=Math.floor(_[_.length-1].length/500+1),p=!1,h>3&&(p=!0),f={id:"placeholder",dark:!0,placeholderLarge:p,primary_accession:A.primary_accession,name:A.name,synonym:A.synonym,placeholder:!0},e.drawArrow(o,f,e.getResidueSize(n,b[0].length)-20/1.5,20,20/1.5,l,n),e.drawRuler(o,f,r,e.getResidueSize(n,b[0].length)-20/1.5,20/1.5,l)),e.drawExpandButton(o)}e.initialDisplay(!1);case 5:case"end":return a.stop()}}),a)})))()},fillData:function(t){var e=[{offset:"0%",color:"black"}];if(t.nonDark){console.log(t.nonDark);for(var a=0;a<t.nonDark.length;a++){var r=t.nonDark[a];e.push({offset:r.Start/t.length*100+"%",color:"black"}),e.push({offset:r.Start/t.length*100+"%",color:this.green}),e.push({offset:r.Stop/t.length*100+"%",color:this.green}),e.push({offset:r.Stop/t.length*100+"%",color:"black"})}}return t.placeholder&&(e=[{offset:"0%",color:"#CCCCCC"}]),e},getNonDarkBetween:function(t,e,a){var r=[];if(t.nonDark)for(var n=0;n<t.nonDark.length;n++)t.nonDark[n].Start<=e&&t.nonDark[n].Stop>=e?r.push({Start:0,Stop:t.nonDark[n].Stop-e}):t.nonDark[n].Start>=e&&t.nonDark[n].Stop<=a?r.push({Start:t.nonDark[n].Start-e,Stop:t.nonDark[n].Stop-e}):t.nonDark[n].Start<=a&&t.nonDark[n].Stop>=a&&r.push({Start:t.nonDark[n].Start-e,Stop:a-e});return r},splitToChunks:function(t,e){for(var a=[],r=e;r>0;r--)a.push(t.splice(0,Math.ceil(t.length/r)));return a},addNonDarkToFragments:function(t){if(t.fragments)for(var e=0;e<t.fragments.length;e++){var a=t.fragments[e];t.fragments[e].nonDark=this.getNonDarkBetween(t,a.Start,a.Stop)}},drawArrow:function(t,e,r,n,s,i,o){var l=this.fillData(e),c=e.id?e.id:e.primary_accession;console.log(c);var u,d=e.description?e.description:e.name;if(l.length>14&&r>300)for(var h=0,p=JSON.parse(JSON.stringify(e.nonDark)),f=Math.floor(l.length/10)>4?Math.floor(l.length/10):4,m=this.splitToChunks(p,f),g=0,v=0;v<m.length;v++){var y=m[v].slice(-1)[0].Stop-g;v===m.length-1&&(y=e.length-g);for(var w=this.getResidueSize(o,y),b=0;b<m[v].length;b++)m[v][b].Start=m[v][b].Start-g,m[v][b].Stop=m[v][b].Stop-g;var A=this.fillData({length:y,nonDark:m[v]});if(t.append("linearGradient").attr("id","grad_partial_"+c+"_"+v).attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%").selectAll("stop").data(A).enter().append("stop").attr("offset",(function(t){return t.offset})).attr("stop-color",(function(t){return t.color})).attr("stop-opacity",1),v===m.length-1){var _=w-s,S=void 0;S=_>0?[this.x,this.y,this.x,this.y+n,this.x+_,this.y+n,this.x+_,this.y+.5*n+s,this.x+_+s,this.y+.5*n,this.x+_,this.y+.5*n-s,this.x+_,this.y]:[this.x,this.y+.5*n-s,this.x,this.y+.5*n+s,this.x+s,this.y+.5*n],t.append("svg:polygon").attr("points",S).attr("fill","url(#grad_partial_"+c+"_"+v+")").attr("id",c).attr("title",c).attr("transform","translate("+(i+h)+",0)").attr("class","arrow").on("mouseover",(function(t,e){var r=a("5698");r.select(this).attr("opacity",".85"),r.selectAll("rect#"+this.id).attr("opacity",".85"),this.style.cursor="pointer"})).on("mouseout",(function(t,e){var r=a("5698");r.select(this).attr("opacity","1"),r.selectAll("rect#"+this.id).attr("opacity","1")})).on("click",(function(){var t=a("5698"),e=window.location.origin;window.open(e+"/"+t.select(this).attr("title"))})).append("svg:title").text(d)}else t.append("svg:rect").attr("fill","url(#grad_partial_"+c+"_"+v+")").attr("x",this.x).attr("y",this.y).attr("width",w).attr("height",n).attr("id",c).attr("class","arrow").attr("title",c).attr("transform","translate("+(i+h)+",0)").on("mouseover",(function(t,e){var r=a("5698");r.select(this).attr("opacity",".85"),r.selectAll("rect#"+this.id).attr("opacity",".85"),r.selectAll("polygon#"+this.id).attr("opacity",".85"),this.style.cursor="pointer"})).on("mouseout",(function(t,e){var r=a("5698");r.select(this).attr("opacity","1"),r.selectAll("rect#"+this.id).attr("opacity","1"),r.selectAll("polygon#"+this.id).attr("opacity","1")})).on("click",(function(){var t=a("5698"),e=window.location.origin;window.open(e+"/"+t.select(this).attr("title"))})).append("svg:title").text(d);g+=y,h+=w}else t.append("linearGradient").attr("id","grad_"+c).attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%").selectAll("stop").data(l).enter().append("stop").attr("offset",(function(t){return t.offset})).attr("stop-color",(function(t){return t.color})).attr("stop-opacity",1),u=r>0?[this.x,this.y,this.x,this.y+n,this.x+r,this.y+n,this.x+r,this.y+.5*n+s,this.x+r+s,this.y+.5*n,this.x+r,this.y+.5*n-s,this.x+r,this.y]:[this.x,this.y+.5*n-s,this.x,this.y+.5*n+s,this.x+s,this.y+.5*n],t.append("svg:polygon").attr("points",u).attr("fill","url(#grad_"+c+")").attr("id",c).attr("title",c).attr("class","arrow").attr("transform","translate("+i+",0)").on("mouseover",(function(t,e){var r=a("5698");this.style.cursor="pointer",r.select(this).attr("opacity",".85")})).on("mouseout",(function(t,e){var r=a("5698");r.select(this).attr("opacity","1")})).on("click",(function(){var t=a("5698"),e=window.location.origin;window.open(e+"/"+t.select(this).attr("title"))})).append("svg:title").text(d);var x=t.append("text").attr("x",this.x+.5*(r+.5*s)).attr("y",this.y+.5*n).attr("transform","translate("+i+",0)").attr("dy",".35em").style("text-anchor","middle").attr("class","arrow").style("fill","white").text(e.name);if(x.node().getComputedTextLength()>r&&(x.text(e.synonym[0]),x.node().getComputedTextLength()>r)){var C=e.synonym.reduce((function(t,e){return t.length<=e.length?t:e}));C=C.replace("orf","").replace("ORF",""),x.text(C),x.node().getComputedTextLength()>r+.5*s&&(x.attr("y",this.y+1.5*n),x.style("fill",this.green),x.attr("class","rowContent"))}},drawRuler:function(t,e,a,r,n,s){var i=[1,r+n-1];a&&(i=[0,r+n]);var o=this.d3.scale.linear().domain([a,a+e.length]).range(i),l=Math.floor(e.length/500+1);if(l>3||e.placeholderLarge){e.placeholderLarge&&(l=0);var c=t.append("g").attr("transform","translate("+s+","+(this.y-15)+")").attr("style","").style("fill","gray").style("font-size","10px").attr("class","rowContent").call(this.d3.svg.axis().scale(o).tickSize(0,1).tickFormat((function(t,e){return 0===t||t%1e3!==0?" ":t})).orient("bottom").ticks(l));e.placeholder&&c.style("fill","#CCCCCC"),c.selectAll(".tick").attr("stroke","gray").attr("x1",this.x).attr("x2",this.x).attr("y2",0).attr("y1",3).attr("stroke-width","1")}else if(e.length>200||e.placeholder){l=2,e.placeholder&&(l=0);var u=t.append("g").attr("transform","translate("+s+","+(this.y-10)+")").style("fill","gray").attr("class","rowContent").call(this.d3.svg.axis().scale(this.d3.scale.linear().domain([0,1]).range([1,r+n-1])).tickSize(2,1).orient("top").ticks(l).tickFormat(""));u.selectAll(".tick").attr("stroke","gray").attr("x1",this.x).attr("y1",4).attr("y2",-1).attr("stroke-width","1"),e.placeholder&&u.style("fill","#CCCCCC");var d=t.append("text").attr("x",this.x+.5*(r+n)).attr("y",this.y-10).attr("dy",".35em").style("text-anchor","middle").attr("transform","translate("+s+",0)").style("fill","gray").style("font-size","10px").attr("class","rowContent").text(e.length);t.append("rect","text").datum((function(){return d.node().getBBox()})).attr("x",(function(t){return t.x-2})).attr("y",(function(t){return t.y})).style("fill",this.backgroundColour).attr("transform","translate("+s+",0)").attr("class","rowContent").attr("width",(function(t){return t.width+4})).attr("height",(function(t){return t.height})),d.node().parentNode.appendChild(d.node())}},drawFragments:function(t,e,a,r){for(var n=0;n<e.length;n++){console.log(e);var s={name:e[n].Name,primary_accession:e[n].Primary_Accession,synonym:[e[n].Short_Name].concat(e[n].Short_Name.match(/[0-9]+/g)),Start:e[n].Start,Stop:e[n].Stop,pdb:null,length:e[n].Stop-e[n].Start,id:e[n].Primary_Accession+"_"+e[n].Short_Name,nonDark:e[n].nonDark,description:e[n].Description},i=e[n].Stop-e[n].Start,o=20,l=o/1.5,c=this.getResidueSize(a,i)-l;c<0&&(l=this.getResidueSize(a,i),c=0),(0===n||e[n].Start>=e[n-1].Stop)&&(this.drawArrow(t,s,c,o,l,r,a),r=r+c+l)}},renderImage:function(t,e,r,n,s,i,o){var l=(r<120?r:120)+10,c=e.Start?e.Start:0;if(o){t.append("rect","text").attr("x",.5*r+c).attr("y",this.y+n).style("fill",this.backgroundColour).attr("transform","translate("+(s-l/2)+","+(20+i)+")").attr("width",l).attr("height",200).attr("title",o).on("mouseover",(function(t,e){var r=a("5698");r.select(this).transition().duration(500).style("fill","orange"),this.style.cursor="pointer"})).on("mouseout",(function(t,e){var r=a("5698");r.select(this).transition().duration(500).style("fill","white")})).on("click",(function(){var t=a("5698"),e=t.select(this).attr("title");if(e){var r=window.location.origin;window.open(r+"/"+t.select(this).attr("title"))}}));var u=t.append("svg:image").attr("x",.5*r+c).attr("y",this.y+n).attr("transform","translate("+(s-l/2)+","+(20+i)+")").attr("width",l).attr("height",l).style("pointer-events","none");!e.dark&&e.pdb?u.attr("xlink:href","../images/pdb/"+e.pdb+".png"):(u.attr("xlink:href","../images/covid19/unknown-structure_1000.png"),u.style("visibility","hidden"))}},splitLargeGaps:function(t){for(var e=0;e<t.length;e++){var a=t[e];if(a.seq_start.length>1)for(var r=0;r<a.seq_start.length-1;r++)if(a.seq_start[r+1]-a.seq_end[r]>100){var n=JSON.parse(JSON.stringify(a));n.seq_start=a.seq_start.slice(0,r+1),n.seq_end=a.seq_end.slice(0,r+1),t[e].seq_start=a.seq_start.slice(r+1),t[e].seq_end=a.seq_end.slice(r+1),t.push(n);break}}return t},drawMatchingStructures:function(t,e,r,n,i,o,l){var c=this,u=30;if(e.clusters){e.clusters=this.splitLargeGaps(e.clusters),e.clusters=e.clusters.filter((function(t){return t.seq_start[0]>=0})),e.clusters.sort((function(t,e){return t.cluster_size>e.cluster_size?-1:e.cluster_size>t.cluster_size?1:0}));var d=1;while(d<e.clusters.length){var h=0,p=!1;while(h<d&&!p){var f=Math.min.apply(Math,Object(s["a"])(e.clusters[h].seq_start)),m=Math.min.apply(Math,Object(s["a"])(e.clusters[d].seq_start)),g=Math.max.apply(Math,Object(s["a"])(e.clusters[h].seq_end)),v=Math.max.apply(Math,Object(s["a"])(e.clusters[d].seq_end));f<=m&&g>=v?(e.clusters[h].cluster_size+=e.clusters[d].cluster_size,e.clusters.splice(d,1),p=!0):(f>m&&f-m<.9*(v-m)||g<v&&v-g<.9*(v-m))&&(e.clusters[h].cluster_size+=e.clusters[d].cluster_size,e.clusters[h].seq_start=[Math.min(f,m)],e.clusters[h].seq_end=[Math.max(g,v)],e.clusters.splice(d,1),p=!0),h++}p||d++}e.clusters=e.clusters.filter((function(t){return Math.max.apply(Math,Object(s["a"])(t.seq_end))-Math.min.apply(Math,Object(s["a"])(t.seq_start))>20})),e.clusters.forEach((function(r){var s=c.getResidueSize(l,r.seq_start[0]);if(!(r.seq_start<0)){var i=c.getResidueSize(l,r.seq_end[r.seq_end.length-1]);if(!(r.seq_end>e.length)){var d=c.d3.scale.linear().domain([0,2]).range([s+1,i-1]).nice(),h=t.append("g").attr("transform","translate("+o+","+(c.y+n+10)+")").attr("style","").style("fill",c.green).style("font-size","10px").call(c.d3.svg.axis().scale(d).tickSize(0,1).tickFormat("").orient("bottom").ticks(2));c.d3.select(h.selectAll(".tick")[0][1]).attr("stroke",c.green).attr("x1",c.x).attr("x2",c.x).attr("y2",0).attr("y1",u).attr("stroke-width","1");var p=t.append("text").datum((function(){return h.node().getBBox()})).attr("x",(function(t){return t.x+.5*t.width})).attr("y",c.y+n+u+5).attr("dy",".35em").style("text-anchor","middle").attr("transform","translate("+o+",0)").style("fill","white").style("font-size","12px").text(r.cluster_size).attr("title",e.primary_accession+"/"+r.pdb_id).style("pointer-events","none");t.append("rect","text").datum((function(){return p.node().getBBox()})).attr("x",(function(t){return t.x-4})).attr("y",(function(t){return t.y})).attr("rx",6).attr("ry",10).style("fill",c.green).attr("transform","translate("+o+",0)").attr("width",(function(t){return t.width+8})).attr("height",(function(t){return t.height})).attr("title",e.primary_accession+"/"+r.pdb_id).on("click",(function(){var t=a("5698");console.log(t.select(this).attr("title"));var e=window.location.origin;window.open(e+"/"+t.select(this).attr("title"))})).on("mouseover",(function(){this.style.cursor="pointer"})),p.node().parentNode.appendChild(p.node());var f={name:r.pdb_id,primary_accession:e.primary_accession,Start:s,Stop:i,pdb:r.pdb_id,length:i-s,id:e.primary_accession+"_"+r.pdb_id,nonDark:!0};c.renderImage(t,f,i-s,n,o,u,e.primary_accession+"/"+r.pdb_id)}}}))}else this.renderImage(t,e,r,n,o,u,"")},drawExpandButton:function(t){var e=t.append("svg:rect").attr("x",0).attr("y",0).attr("stroke","#CCCCCC").attr("fill","#CCCCCC").attr("opacity",.8).attr("width",window.innerWidth).attr("height",30).attr("id","expand");window.innerHeight>window.innerWidth&&e.attr("display","none"),e.on("mouseover",(function(t,e){var r=a("5698");r.select(this.parentNode).select("path#expand:last-child").attr("stroke","orange"),this.style.cursor="pointer"})).on("mouseout",(function(t,e){var r=a("5698");r.select(this.parentNode).select("path#expand:last-child").attr("stroke","#CCCCCC")})),e.on("click",(function(t,e){var r=a("5698");if(this.parentNode.className.baseVal.split(" ").indexOf("open")>-1)r.select(this.parentNode).classed("open",!1),r.selectAll(".row").transition().duration(1e3).attr("viewBox","0 0 960 35"),r.selectAll(".rowContent").transition().duration(1e3).attr("opacity",0);else{r.selectAll(".open").selectAll("rect#expand").attr("opacity",0),r.selectAll(".open").selectAll("rect#expand").attr("display","block"),r.selectAll(".open").selectAll("rect#expand").transition().duration(1e3).attr("opacity",.8),r.selectAll(".open").selectAll("path#expand").attr("opacity",0),r.selectAll(".open").selectAll("path#expand").attr("display","block"),r.selectAll(".open").selectAll("path#expand").transition().duration(1e3).attr("opacity",1),r.selectAll(".arrow").transition().duration(1e3).attr("transform",(function(){var t=r.transform(r.select(this).attr("transform"));return"translate("+t.translate[0]+", -10)"})),r.selectAll(".row").classed("open",!1),r.selectAll(".row").transition().duration(1e3).attr("viewBox","0 0 960 35"),r.selectAll(".rowContent").transition().duration(1e3).attr("opacity",0),r.select(this.parentNode).classed("open",!0),r.select(this).attr("display","none"),r.select(this.parentNode).selectAll("path#expand").attr("display","none"),r.selectAll(".open").transition().duration(1e3).attr("viewBox","0 0 960 360"),r.selectAll(".open .rowContent").transition().duration(1e3).attr("opacity",1),r.select(this.parentNode).selectAll(".arrow").transition().duration(1e3).attr("transform",(function(){var t=r.transform(r.select(this).attr("transform"));return"translate("+t.translate[0]+", 0)"}));for(var n=r.selectAll(".row"),s=!1,i=!0,o=0;o<n[0].length;o++)r.select(n[0][o]).classed("open")&&(s=!0),s?(r.select(n[0][o]).select("path#expand").attr("transform","scale(1, -1) translate(480, -0)"),r.select(n[0][o]).select("path#expand:last-child").attr("transform","translate(480,0)")):(i=!1,r.select("#container").transition().duration(1e3).style("padding","8px 0px 0px 0px"),r.select(n[0][o]).select("path#expand").attr("transform","translate(480,30)"),r.select(n[0][o]).select("path#expand:last-child").attr("transform","scale(1, -1) translate(480, -30)"));i&&r.select("#container").transition().duration(1e3).style("padding","0px 0px 0px 0px")}})),this.renderHalfMoon(t,480,0)},renderHalfMoon:function(t,e,r){var n=this.d3.svg.arc().outerRadius(20).innerRadius(0).startAngle(-Math.PI/2).endAngle(Math.PI/2),s=t.append("path").attr("transform","scale(1, -1) translate("+e+", -"+r+")").attr("d",n()).attr("fill","gray").attr("id","expand").on("mouseover",(function(t,e){var r=a("5698");r.select(this.parentNode).select("path#expand:last-child").attr("stroke","orange"),this.style.cursor="pointer"})).on("mouseout",(function(t,e){var r=a("5698");r.select(this.parentNode).select("path#expand:last-child").attr("stroke","#CCCCCC")})),i=t.append("path").attr("transform","translate("+e+","+r+")").attr("d","M-8 12 0 5 8 12").attr("stroke","#CCCCCC").attr("stroke-width",3).attr("fill","transparent").attr("id","expand").on("mouseover",(function(t,e){var r=a("5698");r.select(this).attr("stroke","orange"),this.style.cursor="pointer"})).on("mouseout",(function(t,e){var r=a("5698");r.select(this).attr("stroke","#CCCCCC")}));i.on("click",(function(t,e){var r=a("5698");r.selectAll(".open").selectAll("rect#expand").attr("opacity",0),r.selectAll(".open").selectAll("rect#expand").attr("display","block"),r.selectAll(".open").selectAll("rect#expand").transition().duration(1e3).attr("opacity",.8),r.selectAll(".open").selectAll("path#expand").attr("opacity",0),r.selectAll(".open").selectAll("path#expand").attr("display","block"),r.selectAll(".open").selectAll("path#expand").transition().duration(1e3).attr("opacity",1),r.selectAll(".row").classed("open",!1),r.selectAll(".row").transition().duration(1e3).attr("viewBox","0 0 960 35"),r.selectAll(".rowContent").transition().duration(1e3).attr("opacity",0),r.selectAll(".arrow").transition().duration(1e3).attr("transform",(function(){var t=r.transform(r.select(this).attr("transform"));return"translate("+t.translate[0]+", -10)"})),r.selectAll(".row").classed("open",!1),r.selectAll(".row").transition().duration(1e3).attr("viewBox","0 0 960 35"),r.selectAll(".rowContent").transition().duration(1e3).attr("opacity",0),r.select(this.parentNode).classed("open",!0),r.select(this.parentNode).selectAll("rect#expand").attr("display","none"),r.select(this.parentNode).selectAll("path#expand").attr("display","none"),r.selectAll(".open").transition().duration(1e3).attr("viewBox","0 0 960 360"),r.selectAll(".open .rowContent").transition().duration(1e3).attr("opacity",1),r.select(this.parentNode).selectAll(".arrow").transition().duration(1e3).attr("transform",(function(){var t=r.transform(r.select(this).attr("transform"));return"translate("+t.translate[0]+", 0)"}));for(var n=r.selectAll(".row"),s=!1,i=!0,o=0;o<n[0].length;o++)r.select(n[0][o]).classed("open")&&(s=!0),s?(r.select("#container").transition().duration(1e3).style("padding","0px 0px 0px 0px"),r.select(n[0][o]).select("path#expand").attr("transform","scale(1, -1) translate(480, -0)"),r.select(n[0][o]).select("path#expand:last-child").attr("transform","translate(480,0)")):(i=!1,r.select("#container").transition().duration(1e3).style("padding","8px 0px 0px 0px"),r.select(n[0][o]).select("path#expand").attr("transform","translate(480,30)"),r.select(n[0][o]).select("path#expand:last-child").attr("transform","scale(1, -1) translate(480, -30)"));i&&r.select("#container").transition().duration(1e3).style("padding","0px 0px 0px 0px")})),s.on("click",(function(t,e){var r=a("5698");r.selectAll(".open").selectAll("rect#expand").attr("opacity",0),r.selectAll(".open").selectAll("rect#expand").attr("display","block"),r.selectAll(".open").selectAll("rect#expand").transition().duration(1e3).attr("opacity",.8),r.selectAll(".open").selectAll("path#expand").attr("opacity",0),r.selectAll(".open").selectAll("path#expand").attr("display","block"),r.selectAll(".open").selectAll("path#expand").transition().duration(1e3).attr("opacity",1),r.selectAll(".arrow").transition().duration(1e3).attr("transform",(function(){var t=r.transform(r.select(this).attr("transform"));return"translate("+t.translate[0]+", -10)"})),r.selectAll(".row").classed("open",!1),r.selectAll(".row").transition().duration(1e3).attr("viewBox","0 0 960 35"),r.selectAll(".rowContent").transition().duration(1e3).attr("opacity",0),r.select(this.parentNode).classed("open",!0),r.select(this.parentNode).selectAll("rect#expand").attr("display","none"),r.select(this.parentNode).selectAll("path#expand").attr("display","none"),r.selectAll(".open").transition().duration(1e3).attr("viewBox","0 0 960 360"),r.selectAll(".open .rowContent").transition().duration(1e3).attr("opacity",1),r.select(this.parentNode).selectAll(".arrow").transition().duration(1e3).attr("transform",(function(){var t=r.transform(r.select(this).attr("transform"));return"translate("+t.translate[0]+", 0)"}));for(var n=r.selectAll(".row"),s=!1,i=!0,o=0;o<n[0].length;o++)r.select(n[0][o]).classed("open")&&(s=!0),s?(r.select(n[0][o]).select("path#expand").attr("transform","scale(1, -1) translate(480, -0)"),r.select(n[0][o]).select("path#expand:last-child").attr("transform","translate(480,0)")):(i=!1,r.select("#container").transition().duration(1e3).style("padding","8px 0px 0px 0px"),r.select(n[0][o]).select("path#expand").attr("transform","translate(480,30)"),r.select(n[0][o]).select("path#expand:last-child").attr("transform","scale(1, -1) translate(480, -30)"));i&&r.select("#container").transition().duration(1e3).style("padding","0px 0px 0px 0px")}))},initialDisplay:function(t){if(window.innerHeight>window.innerWidth)this.d3.selectAll("rect#expand").attr("display","none"),this.d3.selectAll("path#expand").attr("display","none"),this.d3.selectAll(".row").classed("open",!0),this.d3.selectAll(".open").transition().duration(1e3).attr("viewBox","0 0 960 360"),this.d3.selectAll(".open .rowContent").transition().duration(1e3).attr("opacity",1),this.d3.selectAll(".arrow").transition().duration(1e3).attr("transform",(function(){var t=a("5698"),e=t.transform(t.select(this).attr("transform"));return"translate("+e.translate[0]+", 0)"}));else if(window.innerHeight<.25*window.innerWidth)this.d3.selectAll("rect#expand").attr("display","block"),this.d3.selectAll("path#expand").attr("display","block"),this.d3.selectAll(".row").classed("open",!1),this.d3.selectAll(".row").transition().duration(500).attr("viewBox","0 0 960 35"),this.d3.selectAll(".rowContent").transition().duration(500).attr("opacity",0),this.d3.selectAll(".arrow").transition().duration(1e3).attr("transform",(function(){var t=a("5698"),e=t.transform(t.select(this).attr("transform"));return"translate("+e.translate[0]+", -10)"}));else{var e=this.d3.select(".open");if(this.d3.selectAll("rect#expand").attr("display","block"),this.d3.selectAll("path#expand").attr("display","block"),this.d3.selectAll(".row").classed("open",!1),this.d3.selectAll(".row").transition().duration(500).attr("viewBox","0 0 960 35"),this.d3.selectAll(".rowContent").transition().duration(500).attr("opacity",0),t){e.classed("open",!0),e.select("rect#expand").attr("display","none"),e.selectAll("path#expand").attr("display","none"),e.transition().duration(1e3).attr("viewBox","0 0 960 360"),this.d3.selectAll(".open .rowContent").transition().duration(500).attr("opacity",1),this.d3.selectAll(".arrow").transition().duration(1e3).attr("transform",(function(){var t=a("5698"),e=t.transform(t.select(this).attr("transform"));return"translate("+e.translate[0]+", -10)"})),e.selectAll(".arrow").transition().duration(1e3).attr("transform",(function(){var t=a("5698"),e=t.transform(t.select(this).attr("transform"));return"translate("+e.translate[0]+", 0)"}));for(var r=this.d3.selectAll(".row"),n=!1,s=!0,i=0;i<r[0].length;i++)this.d3.select(r[0][i]).classed("open")&&(n=!0),n?(this.d3.select(r[0][i]).select("path#expand").attr("transform","scale(1, -1) translate(480, -0)"),this.d3.select(r[0][i]).select("path#expand:last-child").attr("transform","translate(480,0)")):(s=!1,this.d3.select("#container").transition().duration(1e3).style("padding","8px 0px 0px 0px"),this.d3.select(r[0][i]).select("path#expand").attr("transform","translate(480,30)"),this.d3.select(r[0][i]).select("path#expand:last-child").attr("transform","scale(1, -1) translate(480, -30)"));s&&this.d3.select("#container").transition().duration(1e3).style("padding","0px 0px 0px 0px")}else e=this.d3.select(".row").classed("open",!0),this.d3.select("rect#expand").attr("display","none"),e.selectAll("path#expand").attr("display","none"),this.d3.selectAll(".open").transition().duration(500).attr("viewBox","0 0 960 360"),this.d3.selectAll(".open .rowContent").transition().duration(500).attr("opacity",1),this.d3.selectAll(".arrow").transition().duration(1e3).attr("transform",(function(){var t=a("5698"),e=t.transform(t.select(this).attr("transform"));return"translate("+e.translate[0]+", -10)"})),e.selectAll(".arrow").transition().duration(1e3).attr("transform",(function(){var t=a("5698"),e=t.transform(t.select(this).attr("transform"));return"translate("+e.translate[0]+", 0)"}))}},partitionToThree:function(t){var e=this.getListSum(t),a=e/3;t.push({name:"newPlaceholderNum",length:a});var r=this.partitionToTwo(t);r[1].pop();var n=this.partitionToTwo(r[0]);return[n[0],n[1],r[1]]},partitionToTwo:function(t){var e=this.getListSum(t),a=t.length-1;while(this.getListSum(t.slice(a))<e/2){if(this.getListSum(t.slice(a-1))>=e/2)break;a--}return[t.slice(0,a),t.slice(a)]},getListSum:function(t){return t.reduce((function(t,e){return t+e.length}),0)},sortStructures:function(t,e){var a=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var n,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,a.getPositions(t);case 2:for(n=r.sent,s=0;s<e.length;s++)e[s].position=n[e[s].primary_accession];return e.sort((function(t,e){return t.position-e.position})),r.abrupt("return",e);case 6:case"end":return r.stop()}}),r)})))()},cleanProteins:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r,n,s,i,o,l,c,u,d,h,p,f,m;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:for(r={},t.forEach((function(t){var e=r[t.position];e||(e=r[t.position]=[]),e.push(t)})),n=[],s=1;s<=Object.keys(r).length;s++)1!==r[s].length?function(){var t=void 0;r[s].forEach((function(e){t?e.length>t.length&&(t=e):t=e})),i=t;for(var a=0;a<r[s].length;a++)if(r[s][a].sequence!==t.sequence){for(o=e.findSubstring(r[s][a].sequence,t.sequence),i.sequence=i.sequence.replace(o,""),i.length=i.sequence.length,i.name=i.name+" (split)",r[s][a].continuous=!0,n.push(r[s][a]),i.fragments.length>0&&r[s][a].fragments.forEach((function(t){i.fragments=i.fragments.filter((function(e){return e.Name!==t.Name}))})),l=0;l<i.fragments.length;l++)i.fragments[l].Start=i.fragments[l].Start-r[s][a].length,i.fragments[l].Stop=i.fragments[l].Stop-r[s][a].length,i.fragments[l].Start<0&&(i.fragments[l].Start=0);for(i.fragments=i.fragments.filter((function(t){return t.Start>=0})),c=[],u=0;u<i.nonDark.length;u++)i.nonDark[u].Stop>r[s][a].length&&(d=i.nonDark[u].Start-r[s][a].length,d<0&&(d=0),h=i.nonDark[u].Stop-r[s][a].length,c.push({Primary_Accession:i.primary_accession,Start:d,Stop:h}));if(i.clusters)for(p=0;p<i.clusters.length;p++){for(f=0;f<i.clusters[p].seq_start.length;f++)i.clusters[p].seq_start[f]=i.clusters[p].seq_start[f]-r[s][a].length;for(m=0;m<i.clusters[p].seq_end.length;m++)i.clusters[p].seq_end[m]=i.clusters[p].seq_end[m]-r[s][a].length}i.nonDark=c}i.continuous=!1,n.push(i)}():(r[s][0].continuous=!1,n.push(r[s][0]));return a.abrupt("return",n);case 5:case"end":return a.stop()}}),a)})))()},findSubstring:function(t,e){var a=t.length,r=0;while(r<a&&t.charAt(r)===e.charAt(r))r++;return t.substring(0,r)},getPositions:function(t){return Object(i["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a="".concat(window.BACKEND,"/getGenomicPosition/").concat(t),r={},e.next=4,l()({method:"get",url:a}).then((function(t){for(var e=0;e<t.data.length;e++)r[t.data[e].primary_accession]=t.data[e].position_index}));case 4:return 0===Object.keys(r).length&&console.log("cannot get genomic positions of "+t+" in getPositions() Coverage.vue"),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})))()},getProteinSynonyms:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:r=0;case 1:if(!(r<t.length)){a.next=9;break}return a.next=4,e.getSynonym(t[r].primary_accession);case 4:n=a.sent,t[r].synonym=n;case 6:r++,a.next=1;break;case 9:return a.abrupt("return",t);case 10:case"end":return a.stop()}}),a)})))()},getSynonym:function(t){return Object(i["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a="".concat(window.BACKEND,"/getProteinSynonyms/").concat(t),r=[],e.next=4,l()({method:"get",url:a}).then((function(t){t.data.Synonym&&r.push(t.data.Synonym),r=r.concat(t.data.synonyms)}));case 4:return e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))()},getMatchingStructures:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r,n,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:r=0;case 1:if(!(r<t.length)){a.next=10;break}return n={selector:[t[r].primary_accession]},console.log(n),s="".concat(window.BACKEND,"/get_matching_structures"),a.next=7,l()({method:"get",url:s,params:n}).then((function(e){console.log(e),"'Dark' protein"===e.data?(t[r].clusters=0,t[r].pdb=null):(t[r].clusters=e.data.clusters,t[r].pdb=e.data.Best_PDB.pdb_id)}));case 7:r++,a.next=1;break;case 10:return a.abrupt("return",e.cleanProteins(t));case 11:case"end":return a.stop()}}),a)})))()},countMatchingStructures:function(t){return 0===t?0:t.reduce((function(t,e){return t+e.members.length}),0)},getNonDarkRegions:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:r=0;case 1:if(!(r<t.length)){a.next=10;break}return console.log(t[r].primary_accession),a.next=5,e.getNonDarkCoverage(t[r].primary_accession);case 5:n=a.sent,t[r].nonDark=n;case 7:r++,a.next=1;break;case 10:return a.abrupt("return",t);case 11:case"end":return a.stop()}}),a)})))()},getNonDark:function(t){return Object(i["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a="".concat(window.BACKEND,"/getNonDarkRegions/").concat(t),r=[],e.next=4,l()({method:"get",url:a}).then((function(t){t.data&&(r=t.data)}));case 4:return e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))()},getNonDarkCoverage:function(t){return Object(i["a"])(regeneratorRuntime.mark((function e(){var a,r,n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={selector:[t]},r="".concat(window.BACKEND,"/getCoverageMap"),n={},s=[],e.next=6,l()({method:"get",url:r,params:a}).then((function(t){if("'Dark' protein"!==t.data){n=t.data,console.log("nondarK: ",n);for(var e=0;e<n.seq_start.length;e++)s.push({Start:n.seq_start[e],Stop:n.seq_end[e]})}}));case 6:return e.abrupt("return",s);case 7:case"end":return e.stop()}}),e)})))()},getStructures:function(t,e){var a=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var n,s,i,o,c;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=[],r.next=3,a.sortStructures(t,e);case 3:e=r.sent,i=regeneratorRuntime.mark((function t(r){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e[r].count=0,c={selector:[e[r].primary_accession]},s="".concat(window.BACKEND,"/get_3D_alignment"),t.next=5,l()({method:"get",url:s,params:c}).then((function(t){var s="";if(t.data.sequences){s=t.data.sequences[0];var i=s.length;console.log("Loaded ",e[r].synonym,i),n.push({name:e[r].synonym,primary_accession:e[r].primary_accession,sequence:s.sequence,position:e[r].position,length:i})}else s=t.data[e[r].primary_accession],n.push({name:e[r].synonym,primary_accession:e[r].primary_accession,sequence:s.sequence,position:e[r].position,length:s.length});return a.getFragments(e[r].primary_accession)})).then((function(t){n[r].fragments=t}));case 5:case"end":return t.stop()}}),t)})),o=0;case 6:if(!(o<e.length)){r.next=11;break}return r.delegateYield(i(o),"t0",8);case 8:o++,r.next=6;break;case 11:return r.next=13,a.getNonDarkRegions(n);case 13:return n=r.sent,r.abrupt("return",n);case 15:case"end":return r.stop()}}),r)})))()},getFragments:function(t){return Object(i["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a="".concat(window.BACKEND,"/getProteinFragments/").concat(t),r=[],e.next=4,l()({method:"get",url:a}).then((function(t){t.data.length>0&&(r=t.data)}));case 4:return e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))()}}},p=h,f=(a("0d58"),a("2877")),m=Object(f["a"])(p,r,n,!1,null,"69cdfee8",null);e["default"]=m.exports},"20d9":function(t,e,a){t.exports=a.p+"img/search_dark.012aee91.png"},"22b1":function(t,e,a){a("d3b7"),a("159b"),a("e9c4"),a("b0c0");var r=a("1f25"),n=a("4b90"),s=function(t,e){var a=this;this.id=t,n.getUrlParameter("clearCache")&&localStorage.removeItem(this.id);var s=localStorage.getItem(this.id);if(this.cache=new r(e),null===s);else{var i=JSON.parse(s);i.forEach((function(t){a.cache.set(t.key,t.value)}))}};s.prototype.submitFired=function(t,e,a){var r={name:t,primary_accession:e,pdb_id:a};this.cache.set(e+a,r),this.save()},s.prototype.save=function(){var t=[];this.cache.forEach((function(e,a){t.push({key:a,value:e})}));var e=JSON.stringify(t);console.log("TopTen.save",t),localStorage.setItem(this.id,e)},s.prototype.getAll=function(){var t=[];return this.cache.forEach((function(e){t.push(e)})),t},s.prototype.savePDB=function(t,e){var a={};a.primary_acccession=t,a.pdb=e,this.cache.push(a)},s.prototype.previousLookup=function(t){var e=!1;return this.cache.forEach((function(a){a.primary_accession==t&&(e=a.pdb_id)})),e},s.prototype.previousLookupByName=function(t){var e=!1;return this.cache.forEach((function(a){a.name==t&&(e=a.pdb_id)})),e},s.prototype.updatePDB=function(t,e){this.cache.forEach((function(a){a.primary_accession==t&&(a.pdb_id=e)})),this.save()},t.exports=s},"23c5":function(t,e,a){},"2b1d":function(t,e,a){},"2c07":function(t,e,a){t.exports=a.p+"img/aquaria-symbol-01.057e39d9.svg"},"31c8":function(t,e,a){t.exports=a.p+"img/up.64c3e14c.png"},"39b5":function(t,e,a){t.exports=a.p+"img/MS-01.f169151b.svg"},"3b50":function(t,e,a){},"3c16":function(t,e,a){"use strict";a("3b50")},"3cb4":function(t,e,a){"use strict";a("23c5")},"41b6":function(t,e,a){"use strict";a("4f7f")},4459:function(t,e,a){"use strict";a("7742")},4481:function(t,e,a){},"4ace":function(t,e,a){},"4c7a":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB0AAAAQCAYAAADqDXTRAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNq8020KgCAMBmAb0TGDQLyY0Ek6SbcoEHKg0YfWttLBK+iczy8bY8yilOpUvVrBL9rHVQLR0Yhan6EC7IJjIRyUhncQN3BolIJP4BUtAd/AFPonnARzaIT7D7AL8zbVhIfBUQhHcMxdgJcHuPArSEE5MAmkohSYDHLQJ5gFctEUzAYl6BFeJSBWK/yHCE0+s2R4E2AAhOs7b2YKWEMAAAAASUVORK5CYII="},"4d26":function(t,e,a){"use strict";a("9363")},"4d40":function(t,e,a){},"4f7f":function(t,e,a){},"4f95":function(t,e,a){},"5f75":function(t,e,a){},"609a":function(t,e,a){},"62bc":function(t,e,a){t.exports=a.p+"img/down.7ae68b7a.png"},"6eaa":function(t,e,a){},"715b":function(t,e,a){"use strict";a("ea62")},"734d":function(t,e,a){},7742:function(t,e,a){},7829:function(t,e,a){},"7bd5":function(t,e,a){"use strict";a("e26a")},"7f5f":function(t,e,a){"use strict";a("2b1d")},"80d8":function(t,e,a){"use strict";a("4f95")},8673:function(t,e,a){t.exports=a.p+"img/aquaria-loader3.223aec7b.svg"},"88de":function(t,e,a){"use strict";a("a309")},"8a17":function(t,e,a){"use strict";a("e5d1")},"8c8c":function(t,e,a){"use strict";a("6eaa")},"8f69":function(t,e,a){},"8f89":function(t,e,a){"use strict";a("7829")},9210:function(t,e,a){a("d3b7");var r=a("22b1");a("b3c8");var n=10,s=[],i=function(t){s.push(t)};AQUARIA.fireProteinSubmitListeners=function(t,e,a){s.forEach((function(r){r.submitFired(t,e,a)}))},AQUARIA.proteinTopTen=new r("protein_top_ten",n),AQUARIA.pdbTopTen=new r("pdbTopten",n),i(AQUARIA.proteinTopTen)},9363:function(t,e,a){},"9a5e":function(t,e,a){},"9b83":function(t,e,a){"use strict";a("c48f")},"9db5":function(t,e,a){t.exports=a.p+"img/FT-01.e4a6c439.svg"},a01c:function(t,e,a){"use strict";a("734d")},a309:function(t,e,a){},a6f5:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAGoWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDIgNzkuMTY0NDYwLCAyMDIwLzA1LzEyLTE2OjA0OjE3ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8xLjAvIiB4bXA6Q3JlYXRlRGF0ZT0iMjAyMC0xMS0wN1QxODo0Njo0OC0wNTowMCIgeG1wOk1vZGlmeURhdGU9IjIwMjAtMTItMDlUMDg6NDk6MTYtMDU6MDAiIHhtcDpNZXRhZGF0YURhdGU9IjIwMjAtMTItMDlUMDg6NDk6MTYtMDU6MDAiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIiBwaG90b3Nob3A6SUNDUHJvZmlsZT0ic1JHQiBJRUM2MTk2Ni0yLjEiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MjEzNGEyNTEtODFjYy00ZDNjLWJhMmQtY2VhMmM1MGY2YmQxIiB4bXBNTTpEb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6ZTFkNTMwYWUtYzY2MS0wMjRlLTk1ZTItNTU4ODI4OWU1NTkxIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YjhlNjQyOWMtMjlkZS00NTc2LWEzN2MtMjM4NDJiNGUyZjA5IiB0aWZmOk9yaWVudGF0aW9uPSIxIiB0aWZmOlJlc29sdXRpb25Vbml0PSIyIiBleGlmOkNvbG9yU3BhY2U9IjEiIGV4aWY6UGl4ZWxYRGltZW5zaW9uPSI3MDAiIGV4aWY6UGl4ZWxZRGltZW5zaW9uPSI3MDAiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpiOGU2NDI5Yy0yOWRlLTQ1NzYtYTM3Yy0yMzg0MmI0ZTJmMDkiIHN0RXZ0OndoZW49IjIwMjAtMTItMDlUMDg6NDI6NTQtMDU6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCAyMS4yIChNYWNpbnRvc2gpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDoyMTM0YTI1MS04MWNjLTRkM2MtYmEyZC1jZWEyYzUwZjZiZDEiIHN0RXZ0OndoZW49IjIwMjAtMTItMDlUMDg6NDk6MTYtMDU6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCAyMS4yIChNYWNpbnRvc2gpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDwvcmRmOlNlcT4gPC94bXBNTTpIaXN0b3J5PiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PtMh4BEAAAZoSURBVHja7Z17TNVlGMdPK4FlV3FqIDSJbF0sMqrF2rqRf5i1yrTsvsx1W6Os7LbZ1cxpq2hWFq78x8op5FKbRZOwaFZqm80tS6g0BwYiyOXAOfD2fT0v2xlwgvO87znv8x7eZ/uMjXH5Pb/P77383tsJCCECHj5wuIhjwDgwBRSD2eA+MBfMAdNAATgNHOeFJIYMUAjuB6VgHagBf4B/QRtoB02gFmwD68F74GFwGTjZC9FjEngElIMGoR8tYAN4RpUuL2SY3AI2icRHlSpxXkgM7gXbRfLjd1AC0ryQCLPAbmE/9qv2ZsQKOVPV6dxCdhYuGmlC7gJB3TvX29t79Gs4HBahUOgo8nvRaMSCkSJkeSIe62gBhoTI+Bykp6oQ+R7wk3AvZKN/dqoJOQXsEe7GEa5SKL+UqZ4y10OOBpzlupATwZ8idaIZ5LkspCbBN+gv8D34CmxEI14px7Hwtd5Qoz5YHHBVyLIE3IxfwTtgBshXI78D/jdEpIPzwG09PT2rwD7Dcja6JmSGYRFrwTXUi4aMUZAyG1QbFPOYK0JGGxRRDS40dfGQEYCU6aDOkJiJLgj5zJCMpxOVBGSkQcr7BqTs4C6k0ICIfeDiZCQDKTMNSLmTs5CfNZOTXeQxyUwIQqZqSmniKqTAwIxelo2kUFKu1JRyN0chWzQS6gGTbT5pEHKDhpS93IScq1k6buTQhURJeU0jhyJOQpZqJPI1pzdflJJ/iHms4yTkbw0hE5gJKdaouk7iIESnMS/jOKQNITuJ+dzBQcgCDSHZTIVMI+azgoOQco3pUbZTo5BSS8hpNwchtUQhszgLAYuI3fdTbQrJIsqQreY45iWkmJjb5TaFXEq86F+Ylw7J8aCDkNtcm0JuIgpZ7YAQyS5Cbs/ZFPIQUchiR4RQVla+blPI80QhJS4IQTtSRsjtXZtCFhGFuLIN4C1CbittCnmFKGSeI0JKuY8+9P/GU0Qh8x0R8hEht1KbQu4hCnnTESGVhNxetinkWqKQCkeE7CXk9oRNIecThexxQMZY0E3I7VabQuTa3U6ilDzBu8t7MzGvc2wPLm4jXjj3/XwfEhdqHGtbSBlRSA3zEnKIkFMVh+H32zUmqAqZyniAmM9LHISM0RBSzVRIIzGfS7gscvhOQ8pUZjIeJC5yaOS06mTegBmo4Sf1GyMZJ4Au4oP1AichGf0nc+J8ypYwEVKpUdIzOQmRvKpRSoSa7LK5avFFjfVY1hZsDLX1WWhKudqSjEc1F1tfwFFIQFU9A4TEmez0JMt4XFPGJpsle6gfGAVCmqUkaW/xkPGGgQ07kzgLidnjIiT+iUjQ5h1cyxTI+EHoh/XOCHkegSilWQ1njzYkIhcsNbThczOHnuFwf1CeBnrEkBQZB9XTmEMUUQBWgrAwF1UuCZFcZaDX1T/kUs2tYCGYqYa65RaANPUQpKtqrlDNZi7D/9uVoBMdZOwQlo8GjPcXSmJJMXiT5JB3vYgceXFQ0FYb6sT2ZA+56wgJqPnzREuxHd+6JGSkSNnskpBBh1ZSML5xSUhAvfClenzpkpCAGq86kOJSPnVJSN9A5Bqud7O7u7vLwJ/Z4JKQPq4TkU844BKHwfXBYDC7vb29TvePocOy3jUhAfViJZdfHrIoQpaIt0XUnvmurq4JENNgQMrHrgnpQ26WlGdkJfMEU9mWLY41JIOqKwdiGg1IKXdRSDRyTmSVevM2HfKDXypEZBdwxlDXEgqFpJT9BqRUuCwk+rhAeTqC3DizE7QSBcj94x+IyEcjjY/3OiBlImjWlSIP5JTHDLosZLDjyguVpPmq7ZGjACsUsh2Qm4ieFJHPIykyNacSDofPgJTDBqSsTSUhVoGUfEip59T7GtFClJQc0GpAyhovxNxc/GTQaqCD8YWIcRi0F0KQgpLSZEDKj16IOSnZJqovxLNeiDkp+ZDSQmhD5JhZ9KxnrhdirqHPQ++rKV4heOGM/laJF2JWShak6Ix9LfFCzEs5HdUQdexroReSAFBKclEVNfxfVRUjiryQBIFSMr6jo6MujoUdq30vK8EEg8HMzs7O4YwSyw8by/RCklN9jW1ra9sCYlVVcgRb68x7f6PjLymBlpaWK9CuLIeUrerNXI5jzfFjWSmIvwleiMcL8UI8XogX4vFCvBCPF+KF+JvghXi8EC/E44V4IR7j/Ac9YhOzv9yXfwAAAABJRU5ErkJggg=="},ae0b:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main"},[a("GdprConsentModal"),a("Header"),a("Sequence"),a("div",[a("AboutAlignment")],1),a("div",[a("AboutPdb")],1),a("div",[a("AboutAquaria"),a("UserHelp"),a("Errors")],1),a("div",{attrs:{id:"heightinspector"}}),a("StructureViewer"),a("Tabs"),a("CoverageMap"),a("Loader"),a("PopUp"),a("a",{attrs:{href:t.data.hash}},[a("div",{staticClass:"hide",attrs:{id:"scrim"},on:{click:t.dismissPanel}})])],1)},n=[],s=(a("d3b7"),a("159b"),a("4360")),i=(a("9210"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"header"}},[a("div",{staticClass:"item fix level3",attrs:{id:"logo"}},[a("a",{attrs:{href:"#About"},on:{click:t.showScrim}},[a("img",{attrs:{src:t.aquariasymbol}})])]),a("Title"),a("div",{staticClass:"item fix level3",attrs:{id:"menu-btn"}},[a("a",{attrs:{href:"#Menu"}},[a("img",{attrs:{src:t.hamburger}})])]),a("Menu")],1)}),o=[],l=(a("caad"),a("2532"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"item title fix level5",attrs:{id:"title"}},[a("span",{attrs:{id:"org_prot"}},[t.organism_name&&!t.seqRes?a("a",{staticClass:"seqPanel",attrs:{href:"#Sequence"},on:{click:function(e){return t.makeActive("seqPanel")}}},[a("img",{attrs:{src:t.search}}),t._v(" "+t._s(t.organism_name)+" "),a("strong",[t._v(t._s(t.primary_accession))])]):t._e(),t.organism_name||t.seqRes?t._e():a("a",{staticClass:"seqPanel",attrs:{href:""},on:{click:function(e){return t.makeActive("seqPanel")}}},[a("img",{attrs:{src:t.search}}),t._v(" Protein Sequence ")])]),t.seqRes?t._e():a("span",{attrs:{id:"alignment"}},[a("a",{staticClass:"alignPanel",attrs:{href:"#Alignment"},on:{click:function(e){return t.makeActive("alignPanel")}}},[t._v("aligned onto")])]),t.seqRes?t._e():a("span",{attrs:{id:"struct"}},[t.pdb?t._e():a("a",{staticClass:"structPanel",attrs:{href:"#Structure"},on:{click:function(e){return t.makeActive("structPanel")}}},[t._v("PDB ID")]),t.pdb&&!t.seqRes?a("a",{staticClass:"structPanel",attrs:{href:"#Structure"},on:{click:function(e){return t.makeActive("structPanel")}}},[t._v(t._s(t.pdb))]):t._e(),a("span",{style:{visibility:t.helpOption?"visible":"hidden"},attrs:{id:"help"},on:{click:t.showHelp}},[t._v("?")])]),t.seqRes?a("div",{attrs:{id:"titleAlign"}},[a("span",{staticClass:"titlepanel"},[a("a",{staticClass:"selectionPanel",attrs:{href:"#Alignment"},on:{click:function(e){return t.makeActive("selectionPanel")}}},[a("strong",[t._v(t._s(t.primary_accession))]),t._v(" sequence: "+t._s(t.seqRes)+" "),a("br"),a("strong",[t._v(t._s(t.pdb))]),t._v(" structure: "+t._s(t.structRes)+" ")])])]):t._e(),a("a",{staticClass:"close",attrs:{href:t.data.hash},on:{click:t.dismissPanel}})])}),c=[],u=a("5530"),d=(a("498a"),a("ac1f"),a("5319"),a("5b81"),a("1276"),a("1b1f")),h=a("2f62"),p={name:"Title",data:function(){return{organism_name:null,primary_accession:null,text:null,pdb:null,search:a("a6f5"),seqRes:null,structRes:null,helpOption:!0}},computed:Object(u["a"])({data:function(){return{hash:s["default"].state.hash}},scrim:function(){return s["default"].state.showScrim}},Object(h["b"])(["getHash","getOrganism","getGene","getStructure"])),watch:{scrim:function(t){var e=this;t||e.dismissPanel()}},beforeMount:function(){var t=this;window.AQUARIA.update3DTitle=function(e,a,r,n,s){if(r&&n){var i=n;if(-1!==i.indexOf("(")&&(i=n.substring(0,n.indexOf("(")).trim()),window.AQUARIA.short_moleculeName=i,e&&a&&s){t.organism_name=t.getOrganism.replaceAll("_"," "),t.primary_accession=t.getGene,t.text="aligned onto",t.pdb=a+"-"+r;var o=window.AQUARIA.currentMember.E_value;window.AQUARIA.explainTitle(e,t.getGene,i,a,r,s,o)}else t.organism_name=t.getOrganism.replaceAll("_"," "),t.primary_accession=i,t.text="structure from",t.pdb=a+"-"+r;var l=window.location.href.substr(window.location.origin.length+window.location.pathname.length);history.pushState("",document.title,"/"+t.getOrganism+"/"+t.getGene+"/"+t.getStructure.pdb+"/"+t.getStructure.chain+l)}else document.querySelector("#uniProtDesc").text(t.getGene)}},methods:{showHelp:function(){s["default"].commit("setHelpTitle","Aquaria Help"),s["default"].commit("setUserStatus",!1),document.getElementById("UserHelp").classList.remove("hide"),document.getElementById("UserHelp").className+=" show",document.querySelector("div.dimmer")||(d["overlay"](),document.querySelector("div.dimmer").className+=" level7"),document.querySelector("div.dimmer").addEventListener("click",(function(){d["RemoveOverlay"](),document.getElementById("UserHelp").classList.remove("show"),document.getElementById("UserHelp").className+=" hide"}))},storeHash:function(){""===window.location.hash?s["default"].commit("setHash","#(0,0,0)"):(window.location.hash.includes("-")||window.location.hash.includes("("))&&s["default"].commit("setHash",window.location.hash)},makeActive:function(t){this.helpOption=!1,this.storeHash(),document.querySelectorAll("#title span a").forEach((function(t){t.classList.remove("active")})),document.querySelector("."+t).classList+=" active",-1===document.querySelector("#title").className.indexOf("active")&&(document.querySelector("#title").className+=" active"),document.querySelector("#scrim").className="show level2",s["default"].commit("setScrim",!0),null!==document.querySelector("#titleAlign")&&(document.querySelector("#titleAlign").className="active",s["default"].commit("setAlignment",window.AQUARIA.panel3d.joleculeAlignment.copyToClipboard()),s["default"].commit("setHash",window.location.hash))},dismissPanel:function(){this.helpOption=!0;var t=document.getElementById("scrim");t.classList.contains("show")&&(t.classList.remove("show"),t.classList.add("hide")),s["default"].commit("setHash",this.getHash),document.querySelector("#title").className="item title fix level6",null!==document.querySelector("#titleAlign")&&(document.querySelector("#titleAlign").className=""),document.querySelectorAll("#title span a").forEach((function(t){t.classList.remove("active")}))},resetSelection:function(){document.querySelectorAll("#titlebar span").forEach((function(t){t.className="titlepanel"})),document.querySelectorAll(".contents").forEach((function(t){t.style.display="none"}))},release:function(){document.querySelector("#threeDSpan-inner-jolecule-soup-display-canvas-wrapper-selection").style.display="none",this.resetSelection()}},mounted:function(){this.resetSelection()},updated:function(){var t=this;t.primary_accession=t.getGene;var e=new MutationObserver((function(){if("none"===document.querySelector("#threeDSpan-inner-jolecule-soup-display-canvas-wrapper-selection").style.display)t.seqRes=null,t.structRes=null,s["default"].commit("setAlignment","");else{var e=document.querySelector("#threeDSpan-inner-jolecule-soup-display-canvas-wrapper-selection").innerText.split("\n"),a=window.AQUARIA.currentMember.pdb_id+"["+window.AQUARIA.currentMember.model+"]-"+window.AQUARIA.currentMember.pdb_chain+":",r=t.getGene+":";t.seqRes=e[1].split(r)[1],t.structRes=e[0].split(a)[1]}}));e.observe(document.querySelector("#threeDSpan-inner-jolecule-soup-display-canvas-wrapper-selection"),{attributes:!0,childList:!0,characterData:!0})}},f=p,m=(a("4459"),a("2877")),g=Object(m["a"])(f,l,c,!1,null,"e5962c14",null),v=g.exports,y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"panel abs floating level7",attrs:{id:"Menu"}},[a("a",{staticClass:"close",attrs:{href:"#"}}),t._m(0),t._m(1),a("select",{directives:[{name:"model",rawName:"v-model",value:t.selected,expression:"selected"}],on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.selected=e.target.multiple?a:a[0]},function(e){return t.onChange(e)}]}},[a("option",{attrs:{id:"ribbon",selected:""}},[t._v("Ribbon")]),a("option",{attrs:{id:"sphere"}},[t._v("Sphere")]),a("option",{attrs:{id:"backbone"}},[t._v("Backbone")])])])},w=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a",{staticClass:"lnk",attrs:{id:"print",href:"#"}},[t._v("Print")]),a("a",{staticClass:"lnk",attrs:{id:"helpbtn",href:"#"}},[t._v("Help")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a",{staticClass:"lnk",attrs:{id:"Sidechains",href:"#Menu"}},[t._v("Sidechains")]),a("a",{staticClass:"lnk",attrs:{id:"Neighbors",href:"#Menu"}},[t._v("Neighbors")]),a("a",{staticClass:"lnk active",attrs:{id:"Ligands",href:"#Menu"}},[t._v("Ligands")]),a("a",{staticClass:"lnk",attrs:{id:"Water",href:"#Menu"}},[t._v("Water")])])}],b=a("1da1"),A=(a("96cf"),a("aaec")),_=a("2fac"),S={name:"Menu",data:function(){return{selected:"Ribbon"}},methods:{onChange:function(t){var e=t.target.value.toLowerCase();document.querySelector("#threeDSpan-inner-menu-"+e).click()},showHelp:function(){var t=this;s["default"].commit("setHelpTitle","Aquaria Help"),s["default"].commit("setUserStatus",!1),document.getElementById("UserHelp").classList.remove("hide"),document.getElementById("UserHelp").className+=" show",document.querySelector("div.dimmer")||(d["overlay"](),document.querySelector("div.dimmer").className+=" level7"),document.querySelector("div.dimmer").addEventListener("click",(function(){d["RemoveOverlay"](),document.getElementById("UserHelp").classList.remove("show"),document.getElementById("UserHelp").className+=" hide";var e={};e.target=document.querySelector("#helpbtn"),t.toggleActive(e)}))},toggleActive:function(t){"lnk active"===t.target.className?t.target.className="lnk":t.target.className="lnk active"}},mounted:function(){var t=this;document.querySelector("#print").addEventListener("click",function(){var t=Object(b["a"])(regeneratorRuntime.mark((function t(e){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.preventDefault(),t.next=3,Object(A["a"])(7680,4320,0,0);case 3:a=t.sent,r=document.createElement("a"),r.href=a,r.download="aquaria-screenshot.png",r.click();case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),document.querySelector("#helpbtn").addEventListener("click",(function(e){e.preventDefault(),t.toggleActive(e),t.showHelp()})),document.querySelector("#Sidechains").addEventListener("click",(function(e){e.preventDefault(),t.toggleActive(e),e.currentTarget.classList.contains("active")&&_["b"](),document.querySelector("#threeDSpan-inner > div.jolecule-embed-header.jolecule-embed-toolbar > span:nth-child(5)").click()})),document.querySelector("#Neighbors").addEventListener("click",(function(e){e.preventDefault(),t.toggleActive(e),document.querySelector("#threeDSpan-inner > div.jolecule-embed-header.jolecule-embed-toolbar > span:nth-child(6)").click()})),document.querySelector("#Ligands").addEventListener("click",(function(e){e.preventDefault(),t.toggleActive(e),document.querySelector("#threeDSpan-inner-menu-ligand").click()})),document.querySelector("#Water").addEventListener("click",(function(e){e.preventDefault(),t.toggleActive(e),document.querySelector("#threeDSpan-inner-menu-water").click()}))}},x=S,C=(a("8c8c"),Object(m["a"])(x,y,w,!1,null,"3cbdef84",null)),I=C.exports,k={name:"Header",components:{Title:v,Menu:I},data:function(){return{aquariasymbol:a("2c07"),hamburger:a("b335")}},methods:{showScrim:function(){""===window.location.hash&&s["default"].commit("setHash","#(0,0,0)"),window.location.hash.includes("(")&&s["default"].commit("setHash",window.location.hash),document.querySelector("#scrim").className="show level3",document.querySelector("#xr-button").click()}}},R=k,P=(a("3c16"),Object(m["a"])(R,i,o,!1,null,"1e15f6b6",null)),E=P.exports,O=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"panel overlay about level3",attrs:{id:"Sequence"}},[a("SearchPanel"),a("AboutUniprot")],1)},D=[],M=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"searchByName"}},[a("p",[t._v("Organism")]),a("SearchOrganism"),t._m(0),a("p",[t._v("Protein")]),a("SearchProtein"),a("div",{attrs:{id:"psyns"}},[a("p",[t._v("(example: "),a("a",{attrs:{href:"#"},on:{click:function(e){return t.fillin("p53")}}},[t._v("p53")]),t._v(" or "),a("a",{attrs:{href:"#"},on:{click:function(e){return t.fillin("P04637")}}},[t._v("P04637")]),t._v(")")])])],1)},q=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"osyns"}},[a("p",[t._v(" ")])])}],V=a("1157"),T=a.n(V),L=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("autocomplete",{ref:"autocomplete",attrs:{id:"organism_syn_input",search:t.search,"get-result-value":t.getResultValue},on:{submit:t.handleSubmit}})],1)},B=[],N=(a("99af"),a("d81d"),a("bc3a")),U=a.n(N),j=a("356e"),H=a("95bf"),F=(a("8b78"),{name:"SearchOrganism",components:{Autocomplete:H["a"]},data:function(){return{OrganismSynonyms:{}}},computed:{data:function(){return{OrgID:s["default"].state.OrgID,Organism:s["default"].state.Organism}}},methods:{getResultValue:function(t){return t.value},handleSubmit:function(t){var e=this;if(t.value&&0!==t.value.indexOf("No organisms for: ")&&t.id!==e.data.OrgID){var a="".concat(window.BACKEND,"/getOrganismSynonyms");U()({method:"get",url:a,params:{organism_id:t.id}}).then((function(e){var a=e.data;s["default"].commit("setOrgID",t.id),localStorage.preferred_organism_name=t.value,j["a"](a),document.querySelector("#organism_syn_input").setAttribute("size",t.value.length)}))}},clear:function(){this.value="",this.$refs.autocomplete.value=""},search:function(t){var e,a=this,r=this.OrganismSynonyms,n=t;return this.value=t,new Promise((function(t){if(n in r)t(r[n]);else if(""!==n){var s="".concat(window.BACKEND,"/getQueryOrganism/").concat(n);U()({method:"get",url:s}).then((function(a){var s=a.data;s.length>0?(e=s.map((function(t){return{label:t.Synonym,value:t.Synonym,id:t.Organism_ID}})),r[n]=e):e={label:"No organisms for: "+n,value:0},document.querySelector("#autocomplete-result-list-1").style.zIndex=99,document.querySelector(".autocomplete-result-list").style.maxHeight="390px",t(e)}))}else e={label:a.data.Organism,value:a.data.OrgID},t(e)}))}}}),Q=F,G=Object(m["a"])(Q,L,B,!1,null,null,null),z=G.exports,Z=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("autocomplete",{ref:"autocomplete",attrs:{id:"protein_syn_input",search:t.search,"get-result-value":t.getResultValue},on:{submit:t.handleSubmit}})},W=[],Y=(a("b0c0"),a("4de4"),a("2ca0"),a("4e82"),a("2b3b")),J={name:"SearchProtein",components:{Autocomplete:H["a"]},data:function(){return{callbackData:{names:[],ids:[],pdbIDs:[]},cacheProteinSynonyms:{},term:null,proteinSynonymOrgId:null,pdbId:null,collectResponsevalues:null}},methods:{getResultValue:function(t){return t.value+" ("+t.id+")"},clear:function(){this.value="",this.$refs.autocomplete.value=""},handleSubmit:function(t){var e=this;if(t.value&&0!==t.value.indexOf("No structures for: ")){var a=t.id;if(a.indexOf("/")>-1){var r=a.split("/");a=r[0],e.pdbId=r[1]}if("PDB"===t.type){console.log("AQUARIA.proteinAutocomplete.select pdb",t.value),s["default"].commit("showLoader",!0),s["default"].commit("setLoaderMsg","Waiting for data...");var n="".concat(window.BACKEND,"/getAccessionForPDB/").concat(t.value);U()({method:"get",url:n}).then((function(e){var a=e.data;Y["loadAccession"]([a.Accession],t.value,null)}))}else t.id===s["default"].getters.getStructure.accession?t.value===s["default"].getters.getGene?s["default"].commit("showLoader",!1):(console.log("AQUARIA.proteinAutocomplete.select same protein, different name",t.value),s["default"].commit("setGene",t.value),n="".concat(window.BACKEND,"/getProteinSynonyms/").concat(s["default"].getters.getStructure.accession,";"),U()({method:"get",url:n}).then((function(t){j["b"](t.data)}))):(document.querySelector("#protein_syn_input").placeholder=t.value,document.querySelector("#protein_syn_input").value="",s["default"].commit("showLoader",!0),s["default"].commit("setLoaderMsg","Waiting for data..."),s["default"].commit("setGene",t.value),Y["loadAccession"]([a],e.pdbId,null))}else event.preventDefault()},search:function(t){var e=this;return e.term=t,e.callbackData.LRU=e.getLRU(),new Promise((function(t){if(""===e.term)e.collectResponse(),e.collectResponsevalues&&t(e.collectResponsevalues);else{if(e.proteinSynonymOrgId=e.term+"%"+e.$store.state.OrgID,e.proteinSynonymOrgId in e.cacheProteinSynonyms)return void t(e.cacheProteinSynonyms[e.proteinSynonymOrgId]);document.querySelector(".autocomplete-result-list").style.maxHeight="390px";var a="".concat(window.BACKEND,"/queryProtein/").concat(e.term,"/").concat(e.$store.state.OrgID);U()({method:"get",url:a}).then((function(a){var r=a.data;isNaN(parseInt(e.term.charAt(0)))?r.length>0?0===r[0].isID?(e.nameCallback(r),e.collectResponsevalues&&t(e.collectResponsevalues)):e.idCallback(r):0===r.isID?(e.nameCallback(r),e.collectResponsevalues&&t(e.collectResponsevalues)):(e.idCallback(r),e.collectResponsevalues&&t(e.collectResponsevalues)):(e.pdbCallback(r),e.collectResponsevalues&&t(e.collectResponsevalues))}))}}))},getLRU:function(){return window.AQUARIA.proteinTopTen.getAll().map((function(t){return{label:t.name,suffix:t.primary_accession+", "+t.pdb_id,value:t.name,type:"LRU",category:"Recent",id:t.primary_accession+"/"+t.pdb_id}}))},collectResponse:function(){var t=this,e=t.callbackData.LRU;e.length>0&&t.term&&t.term.length>0&&(e=e.filter((function(e){if(e.label)return e.label.toLowerCase().startsWith(t.term.toLowerCase())})));var a=!0,r=e.concat(t.callbackData.names).concat(t.callbackData.ids).concat(t.callbackData.pdbIDs);0===r.length&&(t.term&&t.term.length>0?r=[{label:"No structures for: "+t.term,value:0}]:a=!1),t.cacheProteinSynonyms[t.proteinSynonymOrgId]=r,a&&(t.collectResponsevalues=r)},nameCallback:function(t){var e,a=this;e=t.map((function(t){return{label:t.Synonym,suffix:null,value:t.Synonym,type:"Synonym",category:"Names",id:t.Primary_Accession,organism:t.Organism_ID}})),e.sort((function(t,e){return t.label>e.label?1:-1})),e.reduce((function(t,e){var a=t,r=e;return a&&a.value===r.value&&(a.dup||(a.suffix=a.id,a.dup=!0),r.dup||(r.suffix=r.id,r.dup=!0)),e}),null),a.callbackData.names=e,a.collectResponse()},idCallback:function(t){var e,a=this;e=t.map((function(t){var e=t.Source_Field;return"AC"!==e&&"ID"!==e||(e="UniProt"),{label:t.Synonym,suffix:e,value:t.Synonym,type:e,category:"Identifiers",id:t.Primary_Accession}})),e.sort((function(t,e){return t.label>e.label?1:-1})),a.callbackData.ids=e,a.collectResponse()},pdbCallback:function(t){var e,a=this;e=t.map((function(t){return{label:t.Synonym,suffix:"PDB",type:"PDB",value:t.Synonym,category:t.Category,id:t.Synonym}})),a.callbackData.pdbIDs=e,a.collectResponse()}}},$=J,X=Object(m["a"])($,Z,W,!1,null,null,null),K=X.exports,tt={components:{SearchOrganism:z,SearchProtein:K},name:"SearchPanel",data:function(){return{search:a("20d9")}},methods:{fillin:function(t){document.getElementById("protein_syn_input").value=t,setTimeout((function(){window.location.href="/P04637"}),300)},selectOrganism:function(t){},placeholderText:function(t,e){var a=document.querySelector("#organism_syn_input"),r=document.querySelector("#protein_syn_input");a.placeholder=t,a.setAttribute("size",a.getAttribute("placeholder").length),r.placeholder=e,r.setAttribute("size",r.getAttribute("placeholder").length),T()("#organism_syn_input").focus((function(){T()(this).attr("placeholder","Specify an organism"),a.setAttribute("size",a.getAttribute("placeholder").length)})).blur((function(){T()(this).attr("placeholder",t),a.setAttribute("size",a.getAttribute("placeholder").length)})),T()("#protein_syn_input").focus((function(){T()(this).attr("placeholder","Specify a protein"),r.setAttribute("size",r.getAttribute("placeholder").length)})).blur((function(){T()(this).attr("placeholder",e),r.setAttribute("size",r.getAttribute("placeholder").length)}))}}},et=tt,at=(a("a01c"),Object(m["a"])(et,M,q,!1,null,null,null)),rt=at.exports,nt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"scrollable",attrs:{"data-intro":"UniProt summary of the specified protein's function.","data-position":"right"}},[t._m(0),t.uniprotDesc?a("div",{attrs:{id:"uniProtDesc"}}):t._e(),t._l(t.descriptions,(function(e,r){return a("div",{key:r,staticClass:"expandable"},[a("expandable-text-line",{attrs:{"use-hover":""},domProps:{innerHTML:t._s("<strong>"+e[0]+"</strong>:"+e[1])}})],1)}))],2)},st=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{display:"none"},attrs:{id:"gsyns"}},[a("p",[t._v("Genes:  ")])])}],it=(a("a4d3"),a("e01a"),a("466d"),a("02a1")),ot={name:"AboutUniprot",components:{ExpandableTextLine:it["a"]},data:function(){return{uniprotDesc:null,sections:[],descriptions:[],a:[1,2,3],tightSections:[],desc:null,list:[]}},computed:Object(u["a"])({},Object(h["b"])(["getSequences"])),watch:{getSequences:function(t){var e=this;t.length>0&&(e.uniprotDesc=e.getSequences[0].description,e.updateUniprotInfo(e.uniprotDesc))}},methods:{updateUniprotInfo:function(t){var e=this;e.list=[],e.tightSections=[];var a=/\n[A-Z ]+:.*?$/;function r(){if(t&&t.length>0){var n=t.match(a);null!==n?(e.sections.unshift(n[0].split(": ")),t=t.replace(n[0],""),r()):e.sections.unshift(t.split(": "))}}function n(t){for(var a=null,r=0;r<t.length;r++)if(r<t.length-2){var n=t[r][0],s=t[r+1][0];if(s===n)null===a&&(a="<ul>"),a+="<li>"+t[r][1]+"</li>";else if(null===a)e.tightSections.push(t[r]);else{a+="<li>"+t[r][1]+"</li></ul>";var i=[n,a];e.tightSections.push(i),a=null}}else null===a?e.tightSections.push(t[r]):(a+="<li>"+t[r][1]+"</li></ul>",i=[n,a],e.tightSections.push(i),a=null);return e.tightSections}r(),this.sections.forEach((function(t){if(-1!==t[1].indexOf("URL=")){var e="",a="",r="",n="",s=t[1].split(";");s.forEach((function(t){t=t.split("="),-1!==t[0].indexOf("URL")&&(a=t[1]),-1!==t[0].indexOf("Name")&&(r=t[1]),-1!==t[0].indexOf("Note")&&(n=t[1])})),e="<a href="+a+' title="'+n+'" target="_blank">'+r+"</a>",t[1]=e}}));var s=n(e.sections);s.forEach((function(t){var a="";if(t.length>2){for(var r=1;r<t.length;r++)a=a+" "+t[r];t[1]=a}e.list.push(t)})),e.descriptions=e.list}}},lt=ot,ct=(a("80d8"),Object(m["a"])(lt,nt,st,!1,null,"739206f9",null)),ut=ct.exports,dt={name:"Sequence",components:{SearchPanel:rt,AboutUniprot:ut}},ht=dt,pt=Object(m["a"])(ht,O,D,!1,null,null,null),ft=pt.exports,mt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"panel overlay about level3",attrs:{id:"Alignment"}},[a("div",{staticClass:"scrollable"},[t.data.alignment?a("p",{staticClass:"spacer"},[t._v(" ")]):t._e(),a("p",[t._v("What you see in the 3D viewer is the experimentally-determined structure of "+t._s(t.pdbName)+" from "),a("a",{attrs:{href:"http://www.rcsb.org/pdb/explore.do?structureId={{}}",target:"_blank"}},[t._v(" PDB entry "+t._s(t.pdbId))]),t._v(" chain "+t._s(t.chainId)+". ")]),a("p",[t._v(" The full-length sequence of the protein you specified ("+t._s(t.uniprotName)+") has been aligned onto the sequence used to determine this PDB structure.")]),a("p",[t._v(" Overall, the two sequences align with "+t._s(t.score)+"% identity; any amino acid substitutions are indicated using dark coloring (see legend).")]),a("p",{staticClass:"quality"},[t._v(" This alignment has an HHblits E-value of "+t._s(t.evalueString)+" × "),a("nobr",[t._v("10"),a("sup",[t._v(t._s(t.power))])]),t._v(", which is considered to be "+t._s(t.quality)+". Based on cross-validation, the likelihood that your specified protein ("+t._s(t.uniprotName)+") adopts a structure similar to that shown is estimated to be "+t._s(t.precisiontxt)+"%.")],1),a("p",[t._v("Note that the structure shown is taken directly from the PDB; it has not been derived by ab-initio or comparative modeling.")]),t.data.alignment?a("div",[a("p",[a("b",[t._v("Alignment:")]),a("br"),a("pre",[t._v(t._s(t.data.alignment))])])]):t._e()])])},gt=[],vt=(a("25f0"),a("5698")),yt=a.n(vt),wt={name:"AboutAlignment",computed:{data:function(){return{alignment:s["default"].state.alignment}}},data:function(){return{pdbName:null,pdbId:null,chainId:null,score:null,qualClass:null,evalueString:null,quality:null,uniprotName:null,precisiontxt:null,power:null}},beforeMount:function(){var t=this;window.AQUARIA.explainTitle=function(e,a,r,n,s,i,o){var l;t.pdbName=r,t.pdbId=n,t.chainId=s,t.score=i,t.uniprotName=a,l=-Math.log(o)/Math.LN10;var c=100*t.BioScience_PlantDisease_Weibull_model(l);c=Math.round(c),t.evalueString=o.toString().split("e")[0],t.power=o.toString().split("e")[1],t.precisiontxt=0===o&&1===c?"close to 100":"≥ "+c,o>1e-71?(t.quality="in the twilight zone",t.qualClass="twilight"):(t.quality="high quality",t.qualClass="high")}},methods:{BioScience_PlantDisease_Weibull_model:function(t){var e;e=0;var a=-2.903935098912483,r=7.984666145922813,n=.4478023883120025;return e=1-Math.exp(-1*Math.pow((t-a)/r,n)),e},showBubble:function(t){0===document.getElementsByClassName("dimmer").length&&d["overlay"](),T()("span#help3D.roundButton").css("background-position","0 -21px"),document.querySelector("div.dimmer").addEventListener("click",(function(){T()("div.popup, div.dimmer").fadeOut().remove(),T()("span#help3D.roundButton").css("background-position","0 0")}));var e="<div class='balloon'><h3>3D View Explained<span class='x'>&nbsp;</span></h3>";e=e+t+"</div>",yt.a.select("body").append("div").attr("class","popup top").html(e);var a=T()("#help3D").offset(),r=parseInt(a.left-230),n=parseInt(a.top+30);T()("div.popup").css({left:r+"px",top:n+"px"}).draggable().fadeIn(600),T()("span.x").click((function(){T()("div.popup, div.dimmer").fadeOut().remove(),T()("span#help3D.roundButton").css("background-position","0 0")}))},resetSelection:function(){document.querySelectorAll("#titlebar span").forEach((function(t){t.className="titlepanel"})),document.querySelectorAll(".contents").forEach((function(t){t.style.display="none"}))}},mounted:function(){this.resetSelection()}},bt=wt,At=(a("8a17"),Object(m["a"])(bt,mt,gt,!1,null,"0e3c182a",null)),_t=At.exports,St=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},xt=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"panel overlay about level3",attrs:{id:"Structure"}},[a("div",{staticClass:"scrollable",attrs:{id:"description","data-intro":"PDB summary for the shown structure.","data-position":"bottom"}},[a("span",{staticClass:"content",attrs:{id:"description","data-intro":"PDB summary for the shown structure.","data-position":"bottom"}},[a("span",{staticStyle:{display:"none"},attrs:{id:"biounitDisplay"}},[a("span",{staticStyle:{display:"inline-block"},attrs:{id:"biounitLeft",title:"Navigate to other assemblies"}},[t._v("<")]),t._v("  "),a("span",{staticStyle:{display:"inline-block"},attrs:{id:"biounitType"}},[t._v("biounit")]),t._v("  "),a("span",{staticStyle:{display:"inline-block"},attrs:{id:"biounitCount"}},[t._v("x/x")]),t._v("   "),a("span",{staticStyle:{display:"inline-block"},attrs:{id:"biounitRight",title:"Navigate to other assemblies"}},[t._v(">")]),a("a",{attrs:{id:"helpBiounit",href:"https://pdb101.rcsb.org/learn/guide-to-understanding-pdb-data/biological-assemblies#Anchor-BioUnit",target:"_blank",title:"Go to PDB to view explanation of assembly"}},[a("span",{staticClass:"help roundButton"})])]),a("span",{staticStyle:{display:"none"},attrs:{id:"aboutPDBHider","data-intro":"PubMed Information about PDB structure","data-position":"left"}},[a("p",{attrs:{id:"classification"}},[t._v("Classification unavailable")]),a("h4",{attrs:{id:"reference_title"}},[t._v("Title unavailable")]),a("p",{attrs:{id:"reference_link"}},[a("a",{attrs:{href:"#"}},[t._v("PubMed Link unavailable")])]),a("p",{attrs:{id:"molecule",title:"View this structure in Aquaria","data-intro":"Information about currently focused PDB chain.","data-position":"left"}},[a("strong",[t._v("Molecule: ")]),a("span",{staticClass:"text"},[t._v("unavailable")])])]),a("p",{attrs:{id:"organism"}},[a("strong",[t._v("Organism: ")]),a("span",{staticClass:"text"},[t._v("unavailable")])]),a("p",{attrs:{id:"small_molecules"}},[a("strong",[t._v("Small molecules: ")]),a("span",{staticClass:"text"},[t._v("unavailable")])]),a("p",{attrs:{id:"method"}},[a("strong",[t._v("Method: ")]),a("span",{staticClass:"text"},[t._v("unavailable")])]),a("p",{attrs:{id:"resolution"}},[a("strong",[t._v("Resolution: ")]),a("span",{staticClass:"text"},[t._v("unavailable")])]),a("p",{attrs:{id:"pdb"}},[a("strong",[t._v("Protein Data Bank: ")]),a("span",{staticClass:"text"},[t._v("unavailable")])])])])])}],Ct={name:"AboutPdb"},It=Ct,kt=(a("f760"),Object(m["a"])(It,St,xt,!1,null,"01dba514",null)),Rt=kt.exports,Pt=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},Et=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"structure-viewer"}},[a("span",{attrs:{id:"threeDSpan"}})])}],Ot={name:"StructureViewer",mounted:function(){function t(){var t=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"];if(!navigator.platform)return!1;while(t.length)if(navigator.platform===t.pop()||screen.width>=300&&screen.width<=600)return!0}var e=t();if(e){var a=Math.max(window.innerHeight),r=document.body;document.addEventListener("scroll",(function(t){var e=Math.max(window.innerHeight);e-50>a?r.classList.contains("ios-toolbar")||r.classList.add("ios-toolbar"):r.classList.contains("ios-toolbar")&&r.classList.remove("ios-toolbar")}))}}},Dt=Ot,Mt=(a("88de"),Object(m["a"])(Dt,Pt,Et,!1,null,null,null)),qt=Mt.exports,Vt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"tabs rel level3"},[a("div",{staticClass:"tab",attrs:{id:"Structures"},on:{click:t.renderClusters}},[a("a",{attrs:{href:"#Structures"}},[a("span",{staticClass:"icon"},[a("img",{attrs:{src:t.MS}})]),t._v("  Matching Structures  "),t.getStructCount>0?a("span",{staticClass:"counter"},[t._v(" "+t._s(t.getStructCount.toLocaleString()))]):t._e()])]),a("MatchingStructures"),a("div",{staticClass:"tab",attrs:{id:"Features"},on:{click:t.renderFeatures}},[a("a",{attrs:{href:"#Features"}},[a("span",{staticClass:"icon"},[a("img",{attrs:{src:t.FT}})]),t._v("  Features  "),t.getFeatCount?a("span",{staticClass:"counter",attrs:{id:"featureCounter"}},[t._v(t._s(t.getFeatCount.toLocaleString()))]):t._e()])]),a("Features")],1)])},Tt=[],Lt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"panel"},[a("a",{staticClass:"close intab",attrs:{href:t.data.hash},on:{click:t.closeTab}}),t._m(0),a("TreeView",{directives:[{name:"show",rawName:"v-show",value:t.showTree,expression:"showTree"}],staticClass:"level5",attrs:{id:"treeView",treeReady:t.prop,count:t.count,coordinates:t.treeCoordinates,parentElem:t.parentElem}}),a("NodeLoader",{directives:[{name:"show",rawName:"v-show",value:t.showLoader,expression:"showLoader"}],attrs:{coordinates:t.treeCoordinates,change:t.change}})],1)},Bt=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"vis"}},[a("div",{attrs:{id:"allclusters","data-intro":"Visual summary of all structures in PDB matching the specified protein, grouped by region of match.","data-position":"left"}})])}],Nt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"scrim level6",on:{click:t.hideTree}}),a("div",{staticClass:"level7",attrs:{id:"arc"}})])},Ut=[],jt=a("2909"),Ht=(a("4d63"),a("c607"),a("2c3e"),a("a434"),a("841c"),a("00b4"),a("9f50")),Ft=a("fae8"),Qt=a("7792");a("cb29"),a("b64b"),a("9e89"),a("29c86");function Gt(t,e,a){document.querySelectorAll("#selectedCluster [id*='r_'] rect").forEach((function(t){t.style.fill="#a5a5a5",t.style.stroke="#a5a5a5"})),document.querySelectorAll("#selectedCluster [id*='r_'] polygon").forEach((function(t){t.style.fill="#a5a5a5",t.style.stroke="#a5a5a5"})),this.width=document.getElementById("structure-viewer").offsetWidth/1.2-window.AQUARIA.margin.right-window.AQUARIA.margin.left,this.height=40-window.AQUARIA.margin.top-window.AQUARIA.margin.bottom+35,this.datum=t;var r=yt.a.select("#selectedFeature").append("div").attr("id","outerFeatureMap");this.drawTrack(this.datum,this.createSVGforFeature(r,"100vw",this.height+10,this.width+1),e,a),yt.a.select("#outerFeatureMap > svg").attr("class","loadedFeature")}var zt,Zt,Wt,Yt,Jt,$t=a("d4ec"),Xt=a("bee2"),Kt=a("1b1f"),te=function(){function t(e,a,r,n,s,i,o){Object($t["a"])(this,t),this.width=n,this.height=s,this.xScale=r,this.onTextClick=i,this.clustSize=0,this.onClusterItemClick=o,this.rank=a,this.cluster=e;var l=this.drawClusterContainer(e,a);"undefined"!==typeof l&&this.drawCluster(e,a)}return Object(Xt["a"])(t,[{key:"updateCluster",value:function(t){var e=this;this.cluster=t,this.clustSize=t.cluster_size;var a=this.cluster.pdb_id.toLowerCase()+"_"+this.rank;"undefined"!==typeof this.nusvg&&this.nusvg.select("g#structure_"+a+" text").text((function(){return e.clustSize}))}},{key:"drawClusterContainer",value:function(t,e){var a=this,r=(t.members[0],t.pdb_chain[0]);if(0!==t.secondary_structure.length&&0!==t.secondary_structure[0].length){var n=this.xScale(t.secondary_structure[0][0].start),s=this.xScale(t.secondary_structure[0][t.secondary_structure[0].length-1].end),i=t.pdb_id.toLowerCase()+"_"+e;this.clustSize=t.cluster_size;var o=t.alignment_identity_score,l=0;this.clustSize>99&&(l=8),this.clustSize>999&&(l=18),this.clustSize<10&&(l=-6);var c=yt.a.select("#allclusters").append("div").attr("id","out_"+i).attr("class","outer_container");c.append("svg").attr("width",40).attr("height",40).attr("viewBox","0 0 40 40").attr("preserveAspectRatio","none").append("text").attr("text-anchor","end").attr("class","percentage").attr("x",28).attr("y",26).text(o+"%"),this.nusvg=c.append("div").attr("id","c_"+i).attr("class","container").append("svg").attr("width",this.width+200).attr("height",this.height+30).attr("viewBox","0 0 "+(this.width+200)+" "+(this.height+30)).attr("preserveAspectRatio","none"),this.nusvg.append("g").attr("id","structure_"+i).attr("transform","translate("+(AQUARIA.margin.left+n)+",20)").on("mouseover",(function(){return yt.a.select(this).call(a.mouseover,a)})).on("mouseout",(function(){return yt.a.select(this).call(a.mouseout,a)})).append("rect").attr("transform","translate("+(s-n-5)+",5)").attr("class","handle").attr("width",32+l).attr("height",16).attr("rx",6),this.nusvg.select("g#structure_"+i).append("g").attr("class","cluster").attr("title","Click to load "+i.substr(0,4)+", chain "+r+" into structure view. Compared to the specified protein, this structure has "+o+"% sequence identity. ").attr("width",s-n+2).attr("height",26).on("click",(function(){return yt.a.select(this.parentNode).call((function(t){console.log("ClusterRenderer.nusvg.select clicked! "+t),Kt.hidePanels(),a.onClusterItemClick(t)}))})),this.nusvg.select("g#structure_"+i+" g.cluster").append("rect").attr("class","cluster").attr("width",s-n+3).attr("height",26).attr("rx",6),this.nusvg.select("g#structure_"+i+" g.cluster").append("rect").attr("width",s-n).attr("height",1).attr("transform","translate(0,13)").attr("class","insertion"),this.addThumbnails(i,n,s,l),this.nusvg.select("g#structure_"+i).append("text").attr("text-anchor","end").attr("fill","white").style("font-size","16px").attr("x",s-n+24+l).attr("y",13).attr("dx",-3).attr("dy",".35em");var u="Click to see "+a.clustSize+" structures in this cluster";return this.nusvg.select("g#structure_"+i+" text, g#structure_"+i).attr("class","expandable").attr("title",u),this.nusvg.select("g#structure_"+i+" text").on("click",(function(){a.onTextClick(yt.a.select(this.parentNode),this.getBoundingClientRect())})),c}console.log("ClusterRenderer.drawClusterContainer error: cannot draw cluster as it has no secondary structure: ",t)}},{key:"drawCluster",value:function(t,e){var a=this;t.secondary_structure[0].forEach((function(r,n){r.start=+r.start,r.end=+r.end,a.drawResidues(t,e,r)})),this.setConservation(e,t)}},{key:"drawResidues",value:function(t,e,a){for(var r=t.secondary_structure[0][0].start,n=0,s=a.start;s<=a.end;s++){var i=t.conservationArray[0][s];if(s==a.end||i!==t.conservationArray[0][s+1]){var o=this.nusvg.select("g#structure_"+t.pdb_id.toLowerCase()+"_"+e+" g.cluster").append("g").attr("class","residue "+a.type).attr("id","r_"+e+"_"+s).attr("transform","translate("+(s-r-n)*AQUARIA.srw+",8)").append("rect").attr("class",i).attr("width",AQUARIA.srw*(n+1)).attr("height",10);"SHEET"==a.type&&(o.attr("height",14).attr("transform","translate(0,-2)"),s==a.end&&(o.attr("width",AQUARIA.srw*n),this.nusvg.select("g.residue#r_"+e+"_"+s).append("svg:polygon").attr("class",i).attr("transform","translate("+AQUARIA.srw*n+",0)").attr("points",AQUARIA.srw+",0 0,-6 0,16 "+AQUARIA.srw+",10"))),"HELIX"==a.type&&this.nusvg.select("g.residue#r_"+e+"_"+s+" rect").attr("height",16).attr("class",i).attr("transform","translate(0,-3)"),n=0}else n++}}},{key:"setConservation",value:function(t,e){for(var a=[],r=this,n=0;n<e.seq_end.length-1;n++){var s=[];s[0]=e.seq_end[n]+1,s[1]=e.seq_start[n+1]-1,a.push(s)}this.nusvg.selectAll("g.residue").data(a).each((function(e){for(var a=e[0];a<=e[1];a++)r.nusvg.select("g.residue#r_"+t+"_"+a+" rect").attr("height",1).attr("transform","translate(0,5)").attr("class","insertion")}))}},{key:"addThumbnails",value:function(t,e,a,r){var n=t.substring(0,4).toUpperCase();yt.a.select("g#structure_"+t+" g.cluster").append("line").attr("x1",a-e+6+r).attr("y1",13).attr("x2",this.width-e+60).attr("y2",13).attr("class","connector").attr("stroke-width",1),yt.a.select("g#structure_"+t).append("g").attr("class","thumbnail").attr("transform","translate("+(this.width-e+28)+",-18)").append("circle").attr("cx",30).attr("cy",30).attr("r",16).attr("fill","#FFF").attr("stroke","#797979").attr("stroke-width",2),yt.a.select("g#structure_"+t+" g.thumbnail").append("clipPath").attr("id","path_"+t).append("circle").attr("cx",30).attr("cy",30).attr("r",15).attr("clip-rule","evenodd");yt.a.select("g#structure_"+t+" g.thumbnail").append("image").attr("width","30px").attr("height","30px").attr("x",15).attr("y",15).attr("xlink:href","https://www.ebi.ac.uk/pdbe/static/entry/"+n.toLowerCase()+"_assembly_1_chain_front_image-200x200.png").attr("clip-path","url(#path_"+t+")")}},{key:"mouseover",value:function(t,e){e.origin=yt.a.select("#"+t.attr("id")+" g.thumbnail").attr("transform");var a=parseFloat(e.origin.substring(e.origin.indexOf("(")+1,e.origin.indexOf(","))),r=t.attr("id").substr(9);yt.a.select("#"+t.attr("id")+" g.cluster, #"+t.attr("id")).classed("active",!0),yt.a.select("#"+t.attr("id")+" g.thumbnail").attr("transform","translate("+(a+32)+", -18)"),yt.a.select("#"+t.attr("id")+" g.thumbnail circle").attr("r",30),yt.a.select("#"+t.attr("id")+" g.thumbnail #path"+r+" circle").attr("r",29),yt.a.select("#"+t.attr("id")+" g.thumbnail image").attr("width","60px").attr("height","60px").attr("x",0).attr("y",0)}},{key:"mouseout",value:function(t,e){var a=t.attr("id").substr(9);yt.a.select("#"+t.attr("id")+" g.cluster, #"+t.attr("id")).classed("active",!1),yt.a.select("#"+t.attr("id")+" g.thumbnail").attr("transform",e.origin),yt.a.select("#"+t.attr("id")+" g.thumbnail circle").attr("r",16),yt.a.select("#"+t.attr("id")+" g.thumbnail #path"+a+" circle").attr("r",15),yt.a.select("#"+t.attr("id")+" g.thumbnail image").attr("width","30px").attr("height","30px").attr("x",15).attr("y",15)}}]),t}(),ee=[];function ae(t,e){var a=parseInt(t.attr("id").substr(15));s["default"].commit("setTreeData",a),s["default"].commit("setTreeCoordinates",e)}function re(t,e){document.querySelector("g.loaded")&&document.querySelector("g.loaded").classList.remove("loaded"),yt.a.select("div.container.loaded").classed("loaded",!1),yt.a.select("g#structure_"+t.pdb_id+"_"+e).classed("loaded",!0),yt.a.select("div#c_"+t.pdb_id+"_"+e).classed("loaded",!0)}function ne(t){Yt=0;var e=t.length;zt=document.getElementById("structure-viewer").offsetWidth-AQUARIA.margin.right-AQUARIA.margin.left-50,Zt=40-AQUARIA.margin.top-AQUARIA.margin.bottom+35,Wt=yt.a.scale.linear().domain([1,e]).range([1,zt]),AQUARIA.srw=Wt(100)/100,document.querySelector("#vis > .ruler")&&document.querySelector("#vis > .ruler").remove(),ue("vis")}function se(t){Jt=t;for(var e=0;e<t.length;e++)ee[e].updateCluster(t[e])}function ie(){ee=[],Jt=[],ne(s["default"].state.sequences[0]);var t=s["default"].state.Matches.clusters;t.forEach((function(t){oe(t)})),se(t),re()}function oe(t){var e=new te(t,Yt,Wt,zt,Zt,(function(t,e){console.log("ShowMatchingStructures.addCluster.onclick",e),ae(t,e)}),ce,"#allclusters");ee.push(e),Yt++}function le(t){return parseInt(t.attr("id").substr(15))}function ce(t){history.pushState("",document.title,window.location.pathname+window.location.search);var e=t.attr("id").substr(10,4),a=le(t);re(e,a),console.log("ShowMatchingStructures.clusterItemClick","shortId: "+e,"cluster-number: "+a,Jt[a]);var r=Jt[a].members[0];Y["displayMember"](r)}function ue(t){zt=document.getElementById("structure-viewer").offsetWidth-AQUARIA.margin.right-AQUARIA.margin.left-50;var e=yt.a.select("#"+t).insert("div",":first-child").attr("class","ruler").attr("data-intro","Graphical representation of the specified protein's sequence").attr("data-position","left").append("svg").attr("width",parseInt(zt+AQUARIA.margin.left)).attr("viewBox","0 0 "+parseInt(zt+AQUARIA.margin.left)+" 15").attr("preserveAspectRatio","none").attr("height",15).append("g").attr("transform","translate("+AQUARIA.margin.left+",0)");e.append("g").attr("class","x axis").call(yt.a.svg.axis().scale(Wt).orient("bottom").tickSize(4,2,6).tickPadding(2));for(var a=[],r=yt.a.selectAll("#vis div.ruler g.x text")[0],n=0;n<r.length;n++)a.push(+r[n].textContent);a=a.filter(de),a.push(s["default"].state.sequences[0].length),a.unshift(1),yt.a.select("#"+t+" div.ruler g.x").call(yt.a.svg.axis().scale(Wt).orient("bottom").tickSize(4,2,6).tickPadding(2).tickValues(a)),yt.a.selectAll("g.x text").attr("text-anchor","end")}function de(t){var e=s["default"].state.sequences[0].length;return 1!==t&&t!==e&&t*AQUARIA.srw<e*AQUARIA.srw-30}var he=10,pe=450,fe=450,me=14,ge=new RegExp(/(p\.)?[A-Za-z]+[0-9]+[A-Za-z\*\_\?\[\]\(\)\%\=\.]+/),ve={name:"TreeView",props:["treeReady","count","coordinates","parentElem"],data:function(){return{pdbs:[],up:a("31c8"),down:a("62bc")}},computed:Object(u["a"])({},Object(h["b"])(["getGene","getOrganism","getMatches"])),watch:{treeReady:function(t,e){var a=this;a.coordinates.clientX+pe+5>=window.innerWidth&&window.innerWidth>500?document.querySelector(a.parentElem+" #arc").style.left=window.innerWidth-pe-5+"px":a.coordinates.clientX+pe+5>=window.innerWidth?document.querySelector(a.parentElem+" #arc").style.left="50px":document.querySelector(a.parentElem+" #arc").style.left=a.coordinates.clientX+"px",document.querySelector(a.parentElem+" #arc").style.top=a.coordinates.clientY-400+"px",!0===this.$parent.showLoader?this.$parent.showLoader=!1:this.$parent.showTree=!1,console.log(a.count),console.log("Prop changed: ",t," | was: ",e);var r=t,n=r[0];if(vt["selectAll"](a.parentElem+" #arc > *").remove(),r.length>he){var s=a.chunk(r,he);a.generateArc(s,n,0)}else a.generateArc(r,n)}},methods:{hideTree:function(){s["default"].commit("setTreeData",null),this.$parent.showTree=!1},nodeClick:function(t){var e=this,a=t[2].children[0],r=0;if(a.name=t[2].label,a.length=t[2].children.length,t[2].children.length>he){var n=e.chunk(t[2].children,he);e.generateArc(n,a,r)}else r+=1,this.generateArc(t[2].children,a)},chunk:function(t,e){var a,r=[];t=(a=[]).concat.apply(a,Object(jt["a"])(t));while(t.length)r.push(t.splice(0,e));return r},reversePdbArray:function(t){var e=[];return t.forEach((function(t){e.unshift(t)})),e},generateArc:function(t,e,a){var r,n,s,i,o,l=this,c=60;if(void 0!==a?(o=t,n=o[a]):(o=l.reversePdbArray(t),n=o),Object.prototype.hasOwnProperty.call(n[0],"children")){void 0!==a&&null!==document.querySelector("svg#tree")&&document.querySelector("svg#tree").remove();var u=vt["select"](l.parentElem+" #arc").append("svg").attr("id","tree").attr("width",pe).attr("height",fe);i=l.createLinks(u,"parent",o,e,a)}else document.querySelectorAll("outerElem").forEach((function(t){return t.remove()})),document.querySelectorAll("[id^=children_]").forEach((function(t){return t.parentNode.removeChild(t)})),u=vt["select"](l.parentElem+" #arc").append("svg").attr("id","children_"+n[0].pdb_id+"_"+a).attr("width",pe).attr("height",fe),i=l.createLinks(u,"child",o,e,a);if(s=i.nodes,u=i.svg,Object.prototype.hasOwnProperty.call(n[0],"children")?(s.shift(),r=vt["select"]("svg#tree").selectAll("g#gParent").data(s).enter()):(e.dx=s[1][0]-c,e.dy=s[1][1]-me/2,s.push([s[1][0]-c,s[1][1],e,"parent"]),document.querySelector("#tree").classList.add("hide"),s.shift(),r=vt["select"]("svg#children_"+n[0].pdb_id+"_"+a).selectAll("g").data(s).enter()),r=r.append("g").attr("class",(function(t,e){if(t.length>1)return Object.prototype.hasOwnProperty.call(t[2],"children")?"outerElem":"innerElem"})).attr("id",(function(t,e){if(t.length>1)return Object.prototype.hasOwnProperty.call(t[2],"children")?"out_"+t[2].children[0].pdb_id:void 0!==t[3]&&t[3].includes("parent")?"parentNode":"in_"+t[2].pdb_id})).attr("width",me).attr("height",me).on("click",(function(t,e){if(e>=0)if(Object.prototype.hasOwnProperty.call(t[2],"children"))l.nodeClick(t);else if(void 0===t[3]){var a=window.location.search;history.pushState("",document.title,"/"+l.getOrganism+"/"+l.getGene+"/"+t[2].pdb_id+"/"+t[2].pdb_chain+a),l.getMatches.clusters.forEach((function(e,a){if(e.members.length>1)e.members.forEach((function(r){if(r.pdb_id===t[2].pdb_id&&r.pdb_chain[0]===t[2].pdb_chain)return Y["displayMember"](r),re(e,a),null}));else if(e.members[0].pdb_id===t[2].pdb_id&&e.members[0].pdb_chain[0]===t[2].pdb_chain)return e.E_value=e.members[0].E_value,Y["displayMember"](e),re(e,a),null})),ge.test(a)&&l.waitForElement()}else document.querySelector("#tree").classList.remove("hide"),document.querySelectorAll("[id^=children_]").forEach((function(t){return t.parentNode.removeChild(t)}))})),Object.prototype.hasOwnProperty.call(n[0],"children"))r.append("rect").attr("transform",(function(t){return"translate("+t[0]+","+(t[1]-me/2)+")"})).attr("class","label").attr("width",(function(t,e){return t[2].children?t[2].children.length>9?32:26:0})).attr("height",(function(t,e){return t[2].children?16:0})).attr("rx",6).attr("fill","#a3a3a3").attr("stroke","none");else{var d=vt["select"]("g#parentNode").selectAll("g").data([e]).enter();d.append("text").attr("x",(function(t){return t.dx-40-20})).attr("dy",(function(t){return t.dy+40})).attr("class","nbr_label").text((function(t){return t.name.length>15?t.name.substr(0,15)+"...":t.name})).attr("text-anchor","start").style("fill-opacity",1).style("fill","white").style("font-weight",500),d.append("rect").attr("transform",(function(t){return"translate("+t.dx+","+t.dy+")"})).attr("class","label").attr("width",(function(t,e){return t.length?t.length>9?32:26:0})).attr("height",16).attr("rx",6).attr("fill","#a3a3a3").attr("stroke","none"),d.append("text").attr("x",(function(t){return t.dx+me+2})).attr("dy",(function(t){return t.dy+me-1})).attr("class","nbr_label").text((function(t){return t.length})).attr("text-anchor","start").style("fill-opacity",1).style("fill","white").style("font-weight",500)}r.append("circle").attr("cx",(function(t){return t[0]})).attr("cy",(function(t){return t[1]})).attr("r",me).style("fill","white").style("stroke","#999999").style("stroke-width","1"),r.append("clipPath").attr("id","clip_"+function(t,e){return e}).append("circle").attr("cx",(function(t){return t[0]})).attr("cy",(function(t){return t[1]})).attr("r",me).attr("clip-rule","evenodd"),r.append("image").attr("width",2*(me-1)+"px").attr("height",2*(me-1)+"px").attr("x",(function(t){return t[0]-13})).attr("y",(function(t){return t[1]-13})).attr("clip-path",(function(t,e){var a=" ";return t[2].pdb_id&&(a="url(#clip_"+t[2].pdb_id+")"),t[2].children&&t[2].children[0].pdb_id&&(a="url(#clip_"+t[2].children[0].pdb_id+")"),a})).attr("xlink:href",(function(t,e){var a=" ";return t[2].pdb_id&&"undefined"===typeof t[2].children&&(a=t[2].pdb_id.toUpperCase()),t[2].children&&t[2].children[0].pdb_id&&(a=t[2].children[0].pdb_id.toUpperCase())," "===a?" ":"https://www.ebi.ac.uk/pdbe/static/entry/"+a.toLowerCase()+"_assembly_1_chain_front_image-200x200.png"})),r.append("text").attr("x",(function(t){return t[0]+me+2})).attr("dy",(function(t){return t[1]+me/2-1})).attr("class","nbr_label").text((function(t,e){if(t[2].label&&"undefined"!==t[2].label){var a=t[2].label;return t[2].label.length>30&&(a=t[2].label.substr(0,15)+" ... "+t[2].label.substr(t[2].label.length-15)),t[2].children?t[2].children.length+"      "+a:" "}if(void 0===t[3])return t[2].pdb_id+"-"+t[2].pdb_chain})).attr("title",(function(t,e){return t[2].label_long?t[2].label_long:t[2].label})).attr("text-anchor","start").style("fill-opacity",1).style("fill","white").style("font-weight",500)},createLinks:function(t,e,a,r,n){var s,i=[],o=0,l=[],c={},u=this,d=40;void 0!==n?(s=a[n],s=u.reversePdbArray(s)):s=a,"child"===e&&(o=60);var h=fe-d;l.push([10,h]);for(var p=0;p<s.length;p++)l.push([80+o,h-p*d]),l[p+1].push(s[p]);if(i.push(Ht["a"]()({source:l[0],target:l[1]})),s.length>1){var f=[{xpoint:30+o,ypoint:h},{xpoint:45+o,ypoint:h-10},{xpoint:47+o,ypoint:h-20}],m=Ft["a"]().x((function(t){return t.xpoint})).y((function(t){return t.ypoint})).curve(Qt["a"]);t.append("path").attr("d",m(f)).attr("fill","none").attr("class",(function(){return"outerElem"})).attr("stroke","#76c276").style("stroke-width",2);for(var g=2;g<l.length;g++){var v=[{xpoint:47+o,ypoint:l[g][1]+10},{xpoint:55+o,ypoint:l[g][1]},{xpoint:80+o,ypoint:l[g][1]}];t.append("path").attr("d",m(v)).attr("fill","none").attr("stroke","#76c276").style("stroke-width",2).attr("class",(function(t){return"outerElem"}))}t.append("line").style("stroke","#76c276").style("stroke-width",2).attr("x1",47+o).attr("y1",h+10-(l.length-2)*d).attr("x2",47+o).attr("y2",h-20).attr("class",(function(){return 1===e?"outerElem":"innerElem"}))}return t.append("path").attr("d",i).attr("stroke","#76c276").attr("fill","none").style("stroke-width",2),a.length>1&&(n+1<a.length&&(t.append("circle").attr("cx",80+o).attr("cy",h+30).attr("r",10).style("fill","#00b2ff"),t.append("image").attr("width","18px").attr("height","18px").attr("x",80+o-9).attr("y",h+21).attr("xlink:href",u.down).on("click",(function(){n<a.length-1&&u.generateArc(a,r,n+1)})),t.append("text").attr("x",95+o).attr("dy",h+35).attr("class","nbr_label").text("Next "+a[n+1].length).attr("text-anchor","start").style("fill-opacity",1).style("fill","white").style("font-weight",500)),n+1>1&&(t.append("circle").attr("cx",80+o).attr("cy",fe-l.length*d+10).attr("r",10).style("fill","#00b2ff"),t.append("image").attr("width","18px").attr("height","18px").attr("x",80+o-9).attr("y",fe-l.length*d+1).attr("xlink:href",u.up).on("click",(function(){n-1>=0&&u.generateArc(a,r,n-1)})),t.append("text").attr("x",95+o).attr("dy",fe-l.length*d+me).attr("class","nbr_label").text("Previous").attr("text-anchor","start").style("fill-opacity",1).style("fill","white").style("font-weight",500))),t.append("rect").attr("x",0).attr("y",400).attr("rx",6).attr("ry",6).attr("width",u.coordinates.width+2).attr("height",u.coordinates.height).style("fill","orange").attr("class","handle").on("click",(function(){u.hideTree()})),t.append("text").attr("x",3).attr("dy",415).attr("class","nbr_label").text(u.count).attr("text-anchor","start").style("fill-opacity",1).style("fill","white").style("font-weight",500),c.nodes=l,c.links=i,c.svg=t,c},waitForElement:function(){var t=this;window.AQUARIA.addedFeature=!0,"none"!==document.getElementById("waitingFrame").style.display?setTimeout(t.waitForElement,5):(window.AQUARIA.passFeature(window.AQUARIA.customfeatureSet,window.AQUARIA.customfeatureSetioid),Gt(window.AQUARIA.customfeatureSet),vt["selectAll"]("svg.loaded rect.feature").attr("fill","#a4abdf"),vt["select"]("svg.loaded").classed("loaded",!1))}}},ye=ve,we=(a("41b6"),Object(m["a"])(ye,Nt,Ut,!1,null,null,null)),be=we.exports,Ae=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"scrim level6",attrs:{id:"nodeLoader"},on:{click:t.hideLoader}},[a("img",{attrs:{src:t.loader}})])},_e=[],Se={name:"NodeLoader",data:function(){return{loader:a("ae7d")}},props:["coordinates","change"],watch:{change:function(t,e){var a=this;document.querySelectorAll("#nodeLoader > img").forEach((function(t){t.style.marginLeft=a.coordinates.clientX+"px",t.style.marginTop=a.coordinates.clientY-10+"px"}))}},methods:{hideLoader:function(){this.$parent.showLoader=!1,this.$parent.showTree=!1}}},xe=Se,Ce=(a("d2f8"),Object(m["a"])(xe,Ae,_e,!1,null,"d0db7e78",null)),Ie=Ce.exports,ke={name:"MatchingStructures",components:{TreeView:be,NodeLoader:Ie},data:function(){return{showTree:!1,prop:null,count:0,treeCoordinates:{},change:0,showLoader:!1,parentElem:".panel"}},watch:{sequence:function(t,e){e.accession!==t.accession&&null!==e.accession&&window.scrollBy(0,100)},treeData:function(t){var e=this;if(null!==t){e.change=e.change+1;var a=e.getTreeCoordinates;e.treeCoordinates.clientX=a.left,e.treeCoordinates.clientY=a.top,e.treeCoordinates.width=a.width,e.treeCoordinates.height=a.height,e.showLoader=!0;var r="".concat(window.BACKEND,"/get_secondary_clusters/");r=r+e.getStructure.accession+"/"+e.getStructure.pdb+"/"+e.getStructure.chain+"/"+t,U()({method:"get",url:r}).then((function(t){e.showTree=!0,e.prop=t.data,e.count=0,t.data.forEach((function(t){e.count+=t.children.length}))}))}else e.showTree=!1}},computed:Object(u["a"])({data:function(){return{hash:s["default"].state.hash,prop:null}},sequence:function(){return s["default"].state.structure},treeData:function(){return s["default"].state.treeData}},Object(h["b"])(["getMatches","getTreeCoordinates","getStructure"])),methods:{closeTab:function(){window.scrollBy(0,100),d["hidePanels"]()}},mounted:function(){var t=this;if(t.getMatches&&Object.hasOwnProperty.call(t.getMatches,"clusters"))for(var e=document.querySelectorAll("[id ^= structure_] > text"),a=0;a<e.length;a++)e[a].addEventListener("click",(function(){var t=this.parentElement.id;console.log(t)}))}},Re=ke,Pe=(a("3cb4"),Object(m["a"])(Re,Lt,Bt,!1,null,null,null)),Ee=Pe.exports,Oe=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"panel"},[a("a",{staticClass:"close",attrs:{href:"#"},on:{click:t.closeTab}}),a("div",{attrs:{id:"featurePanel"}},[t.getfeatureSets?a("div",{staticClass:"ui-sortable",attrs:{id:"groupedFeatures"}},t._l(t.getfeatureSets,(function(e){return a("div",{key:e[0],staticClass:"featureCollection ui-sortable-handle",attrs:{id:e[0]},on:{click:function(a){return t.toggleTrack(e[0])}}},[a("div",{staticClass:"featureHeader",on:{mouseover:function(a){return t.hightlight(e[0])},mouseout:function(a){return t.removeHightlight(e[0])}}},[a("p",{attrs:{id:"arrow"}},[t._v("►")]),a("p",{staticClass:"featureName"},[t._v(t._s(e[0]))]),a("div",{staticClass:"info",on:{mouseover:function(a){return t.showInfo(e,a)}}},[t._v("?")])]),a("div",{staticClass:"featureTrack ui-sortable",staticStyle:{cursor:"move"}})])})),0):t._e(),a("br")])])},De=[],Me=a("ade3"),qe=a("53ca"),Ve=a("2ef0"),Te=a.n(Ve);function Le(t,e){He(t,parseInt(e))}function Be(){var t=AQUARIA.currentAnnotationsIn3DViewer;if(void 0!==t){for(var e in t)AQUARIA.panel3d.removeAnnotation(t[e].id,t[e].annotationName);t.length=0}}function Ne(t){var e=window.AQUARIA.panel3d.embededJolecule.controller;t.forEach((function(t){Ue(t)})),e.soupView.isUpdateSidechain=!0,e.soupView.isChanged=!0}function Ue(t){var e=t.split(".")[0],a="object"===Object(qe["a"])(s["default"].state.structure.chain)?s["default"].state.structure.chain[0]:s["default"].state.structure.chain;if(e.includes("-")){var r=parseInt(e.split("-")[0].replace(/\D/g,"")),n=parseInt(e.split("-")[1].replace(/\D/g,""))+1;Te.a.range(r,n).forEach((function(t){je(t,a)}))}else e.includes(",")?e.split(",").forEach((function(t){t=parseInt(t.replace(/\D/g,"")),je(t,a)})):(e=parseInt(e.replace(/\D/g,"")),je(e,a))}function je(t,e){var a=window.AQUARIA.panel3d.joleculeAlignment,r=window.AQUARIA.panel3d.embededJolecule.controller;t=a.mapSeqResToPdbResOfChain(0,t,e);var n=r.soup.findResidueIndices(0,e,t[2])[0];r.soup.getResidueProxy().load(n).sidechain=!0}function He(t,e){if(e="undefined"!==typeof e?e:-1,e>=0)Fe(t,e);else for(e in t.Tracks)Fe(t,e)}function Fe(t,e){var a=new Array,r=new Array,n=new Array,s=new Array,i=new Array,o=new Array,l="#ffffff";if(void 0!=t){var c;for(var u in t.featureColours&&t.featureColours.length>0&&(l=t.featureColours[0]),t.Tracks[e])if(t.Tracks[e][u].show){if("multi_color"!==t.Class.color)t.Tracks[e][u].color.substring(1);t.Tracks[e][u].color?a.push(t.Tracks[e][u].color):a.push(l),r.push(t.Tracks[e][u].label),n.push(t.Tracks[e][u].desc),s.push(t.Tracks[e][u].start+":"+t.Tracks[e][u].end);var d=new Array,h=new Array;for(var p in t.Tracks[e][u].urls)d.push(t.Tracks[e][u].urls[p].href),h.push(t.Tracks[e][u].urls[p].text);i.push(d),o.push(h)}var f=t.ProteinID;if(t.hasOwnProperty("SeqHash")&&""!=t.SeqHash)for(var m=0;m<AQUARIA.panel3d.attributes.sequences.length;m++)t.SeqHash==AQUARIA.panel3d.attributes.sequences[m].uniprot_hash&&(f=AQUARIA.panel3d.attributes.sequences[m].primary_accession,t.ProteinID=f);var g=(c={id:t.ProteinID,annotationName:t.Category,featureColours:a,featureNames:r,featureDescriptions:n,featurePositions:s,featureURLs:i},Object(Me["a"])(c,"featureURLs",i),Object(Me["a"])(c,"featureURLtexts",o),Object(Me["a"])(c,"featureURLtexts",o),c);AQUARIA.currentAnnotationsIn3DViewer.push(g),Array.isArray(g.id)?AQUARIA.panel3d.addAnnotation(g.id[0],g.annotationName,a,r,n,s,i,o):AQUARIA.panel3d.addAnnotation(g.id,g.annotationName,a,r,n,s,i,o)}}AQUARIA.currentAnnotationsIn3DViewer=new Array;var Qe=a("ae8a"),Ge={name:"Features",data:function(){return{jAlignment:null,jController:null}},methods:{closeTab:function(){window.scrollBy(0,100),d["hidePanels"]()},clearResidues:function(){window.AQUARIA.panel3d.embededJolecule.controller.clearSelectedResidues()},toggleTrack:function(t){var e=document.getElementById(t).lastChild;t=t.replace(/\s/g,"\\ "),"block"!==e.style.display?(e.style.display="block",document.querySelector("#"+t+" #arrow").innerText="▼"):(e.style.display="none",document.querySelector("#"+t+" #arrow").innerText="►")},hightlight:function(t){document.querySelector("#"+t.replace(/\s/g,"\\ ")+" > .featureHeader").style.background="#bebebe"},removeHightlight:function(t){document.querySelector("#"+t.replace(/\s/g,"\\ ")+" > .featureHeader").style.background="#ccc"},showInfo:function(t,e){s["default"].commit("setPopupTitle",t[0]),s["default"].commit("setPopupText",t[1][0].About),s["default"].commit("setIsDefaultFeature",!0),s["default"].commit("setVariantIdx",-1),s["default"].commit("setPopupCoordinates",e.srcElement.getBoundingClientRect())},fetch_features:function(t){var e=[],a=[];t.forEach((function(t){e.push(t.primary_accession),a.push(t.uniprot_hash)})),Qe["a"](e)},groupFeatureSets:function(t,e){if(t.length>0){var a=t||a,r=Te.a.groupBy(a,(function(t){return t.Server}));r=Object.keys(r).map((function(t){return[String(t),r[t]]})),(null===s["default"].getters.getfeatureSets||s["default"].getters.getfeatureSets.length<r.length)&&s["default"].commit("setfeatureSets",r)}},checkAddedFeature:function(){var t=this,e=this.$store.state.featureSets?this.$store.state.featureSets:[];e.length>0&&e.forEach((function(e){e[0].includes("Added")&&null===t.getLoadedFeature.set&&s["default"].commit("setLoadedFeature",{set:e[1][0],track:0})}))}},watch:{getcompleteServerNum:function(t,e){var a=this,r=this.$store.state.aggregatedAnnotations,n=this.$store.state.completeExtServers;t!==e&&(a.groupFeatureSets(r,n),a.getCoverageMap&&a.$route.query&&a.checkAddedFeature())},Loader:function(t){var e=this;t||e.fetch_features(this.$store.state.Matches.sequences)},getLoadedFeature:function(t){Le(t.set,t.track),null!==this.sideChain&&Ne(this.sideChain)},getCoverageMap:function(t){var e=this;t&&e.$route.query&&(e.getLoadedFeature.set||e.checkAddedFeature())}},computed:Object(u["a"])({Loader:function(){return s["default"].state.Loader},sideChain:function(){return s["default"].state.sidechain}},Object(h["b"])(["getfeatureSets","getcompleteServerNum","getLoadedFeature","getCoverageMap"]))},ze=Ge,Ze=(a("fc7c"),Object(m["a"])(ze,Oe,De,!1,null,null,null)),We=Ze.exports,Ye=a("29c86"),Je=["A","C","D","E","F","G","H","I","K","L","M","N","P","Q","R","S","T","V","W","Y"];function $e(){s["default"].commit("setPopupCoordinates",0)}function Xe(t,e){var a="";if(t.urls.length>0){a="<p>";for(var r=0;r<t.urls.length;r++)a+="<a href='"+t.urls[r].href+"' target='_blank'>"+t.urls[r].text+"</a><br>";a+="</p>"}var n="";t.name.includes("&#8201;&#8594;&#8201;")&&(n=t.name.replace(/^.*\(/,""),n=n.replace(/\&.*$/,""));var i="<div id='buttons_eachAa'> <b>See also:</b><p class='pAaColor'> "+n+" &rarr;</p>";Je.forEach((function(e,a){if(e!=n){var r=ta(e,t.desc,t.start);i=i+"<button id='btnVI_"+e+"'",i=1==r?i+"class='btnAaBold_b'> <b>"+e+"</b> ":i+" class='btnAaBold'> "+e,i+="</button>"}})),i+="</div>";var o=t.desc+"<br>"+a,l="<b>"+t.label+"</b>";t.name.includes("span_missenseHeading")?(s["default"].commit("setIsDefaultFeature",!1),t.start!=t.end?(s["default"].commit("setVariant",t.start+"-"+t.end),s["default"].commit("setPopupTitle",t.label),Ke(t.start+"-"+t.end,t.label)):(s["default"].commit("setVariant",t.start),s["default"].commit("setPopupTitle",t.label),Ke(t.start,t.label))):(s["default"].commit("setVariant",-1),s["default"].commit("setIsDefaultFeature",!0),l=t.start===t.end?l+"( Residue "+t.start+") ":l+"( Residues "+t.start+"-"+t.end+") ",s["default"].commit("setPopupTitle",l),s["default"].commit("setPopupText",o),s["default"].commit("setVariantIdx",-1),s["default"].commit("setPopupCoordinates",document.querySelector("#"+e.id).getBoundingClientRect())),t.hasOwnProperty("hc_go")&&t.hasOwnProperty("hc_ec")&&t.hasOwnProperty("hc_species")?(console.log("CATH plot data"),console.log(t),ea(t).then((function(){aa()}))):(console.log("CATH plot no data"),console.log(t))}function Ke(t,e){var a=s["default"].getters.getVariantResidues;if(a.hasOwnProperty(t)&&a[t].hasOwnProperty("theOrigFeatStr"))for(var r=0;r<a[t].theOrigFeatStr.length;r++)if(e.includes(a[t].theOrigFeatStr[r])){s["default"].commit("setVariantIdx",r);break}}function ta(t,e,a){var r="<toReplace_varInfo_"+t+">",n="</toReplace_varInfo_"+t+">",s=e.indexOf(r),i=e.lastIndexOf(n),o=e.substring(s,i);return!!(o.match("UniProt")||o.match("FunVar")||o.match("COSMIC")||window.AQUARIA.hasOwnProperty("variantStructs")&&window.AQUARIA.variantStructs.hasOwnProperty(a)&&window.AQUARIA.variantStructs[a].hasOwnProperty(t)&&window.AQUARIA.variantStructs[a][t].hasOwnProperty("pdbs")&&window.AQUARIA.variantStructs[a][t]["pdbs"].length>0)}function ea(t){return new Promise((function(e,a){"undefined"!==typeof t.hc_go&&t.hc_go.hasOwnProperty("data")&&t.hc_go.data.hasOwnProperty("series")&&t.hc_go.data.series.length>=2?ra("hc_go_div",t.hc_go.data.series[0].data,t.hc_go.data.series[1].data,"",t.hc_go.data.series[0].size,t.hc_go.data.series[0].dataLabels.color,t.hc_go.data.series[0].dataLabels.distance,t.hc_go.data.series[1].innerSize,t.hc_go.data.series[0].name,t.hc_go.data.series[1].name,t.hc_go.data.series[1].dataLabels.color).then((function(){document.getElementById("hc_go").prepend(document.getElementById("hc_go_div"))})).catch((function(t){console.log("CATH plot: 2"),na("hc_go_noData").then((function(){document.getElementById("hc_go").prepend(document.getElementById("hc_go_noData")),document.getElementById("hc_go_noData").innerHTML=document.getElementById("hc_go_noData").innerHTML+"<br> <br> <center> No data</center>",console.log("featureslist.showAnnotation ERROR "+t)}))})):(na("hc_go_noData").then((function(){document.getElementById("hc_go").prepend(document.getElementById("hc_go_noData")),document.getElementById("hc_go_noData").innerHTML=document.getElementById("hc_go_noData").innerHTML+"<br> <br> <center> No data</center>"})),console.log("CATH plot: 3")),"undefined"!==typeof t.hc_ec&&t.hc_ec.hasOwnProperty("data")&&t.hc_ec.data.hasOwnProperty("series")&&t.hc_ec.data.series.length>=2?ra("hc_ec_div",t.hc_ec.data.series[0].data,t.hc_ec.data.series[1].data,"",t.hc_ec.data.series[0].size,t.hc_ec.data.series[0].dataLabels.color,t.hc_ec.data.series[0].dataLabels.distance,t.hc_ec.data.series[1].innerSize,t.hc_ec.data.series[0].name,t.hc_ec.data.series[1].name,t.hc_ec.data.series[1].dataLabels.color).then((function(){document.getElementById("hc_ec").prepend(document.getElementById("hc_ec_div"))})).catch((function(t){na("hc_ec_noData").then((function(){document.getElementById("hc_ec").prepend(document.getElementById("hc_ec_noData")),document.getElementById("hc_ec_noData").innerHTML=document.getElementById("hc_ec_noData").innerHTML+"<br> <br> <center> No data</center>",console.log("featureslist.showAnnotation ERROR "+t)}))})):na("hc_ec_noData").then((function(){document.getElementById("hc_ec").prepend(document.getElementById("hc_ec_noData")),document.getElementById("hc_ec_noData").innerHTML=document.getElementById("hc_ec_noData").innerHTML+"<br> <br> <center> No data</center>"})).catch((function(){})),"undefined"!==typeof t.hc_species&&t.hc_species.hasOwnProperty("data")&&t.hc_species.data.hasOwnProperty("series")&&t.hc_species.data.series.length>=2?ra("hc_species_div",t.hc_species.data.series[0].data,t.hc_species.data.series[1].data,"",t.hc_species.data.series[0].size,t.hc_species.data.series[0].dataLabels.color,t.hc_species.data.series[0].dataLabels.distance,t.hc_species.data.series[1].innerSize,t.hc_species.data.series[0].name,t.hc_species.data.series[1].name,t.hc_species.data.series[1].dataLabels.color).then((function(){document.getElementById("hc_species").prepend(document.getElementById("hc_species_div"))})).catch((function(t){na("hc_species_noData").then((function(){document.getElementById("hc_species").prepend(document.getElementById("hc_species_noData")),document.getElementById("hc_species_noData").innerHTML=document.getElementById("hc_species_noData").innerHTML+"<br> <br> <center> No data</center>",console.log("featureslist.showAnnotation ERROR "+t)}))})):na("hc_species_noData").then((function(){document.getElementById("hc_species").prepend(document.getElementById("hc_species_noData")),document.getElementById("hc_species_noData").innerHTML=document.getElementById("hc_species_noData").innerHTML+"<br> <br> <center> No data</center>"})),e()}))}function aa(){var t=document.getElementsByClassName("highcharts-pie-series");for(var e in t)if(t.hasOwnProperty(e)){var a=t[e].getElementsByTagName("path");for(var r in a)if(a.hasOwnProperty(r)){var n=a[r].getAttribute("fill");a[r].removeAttribute("fill"),a[r].setAttribute("style","fill:"+n)}}}function ra(t,e,a,r,n,s,i,o,l,c,u){return new Promise((function(d,h){na(t).then((function(){try{Ye.chart(t,{chart:{type:"pie",margin:0},title:{text:r},plotOptions:{pie:{shadow:!1,center:["50%","50%"]}},tooltip:{valueSuffix:"%"},series:[{name:l,data:e,size:n,dataLabels:{enabled:!1,formatter:function(){return this.y>3?this.point.name:null},color:s,distance:i}},{name:c,data:a,innerSize:o,dataLabels:{enabled:!1,formatter:function(){return this.y>1?"<b>"+this.point.name+":</b> "+this.y+"%":null},color:u},id:"versions"}],responsive:{rules:[{condition:{maxWidth:100},chartOptions:{series:[{},{id:"versions",dataLabels:{enabled:!1}}]}}]}}),d()}catch(h){console.log("Highcharts error"),console.log(h),d(),console.log("In the highcharts plotting function")}}))}))}function na(t){return new Promise((function(e,a){document.getElementById(t)&&document.getElementById(t).remove();var r=document.createElement("div");document.getElementById("superFamCharts").append(r),r.id=t,r.style="width: 100px; height: 100px; margin: 0 auto; background-color: white;",e()}))}var sa=0,ia=0;function oa(t){document.querySelector("#featurePanel > .ruler")&&document.querySelector("#featurePanel > .ruler").remove(),ue("featurePanel"),t.forEach((function(t){var e=yt.a.select("#"+t[0].replace(/\s/g,"\\ ")),a=e.select(".featureTrack").selectAll("div");for(var r in t[1])"Added Features"==t[0]&&t[1][r].hasOwnProperty("SeqHash")&&""!=t[1][r].SeqHash&&t[1][r].SeqHash!=s["default"].state.sequences[0].uniprot_hash||a.data([t[1][r]]).enter().append("div").attr("class","track").attr("id",(function(t){return"track_"+t.Category})).html((function(t){if(""!=t.Type){if("UniProt"==t.Server||"PredictProtein"==t.Server||"CATH"==t.Server||"SNAP2"==t.Server||"COSMIC"==t.Server||"FunVar"==t.Server)var e="Curated Features";else e=t.Server;return"<p><span class='featureSetName'>"+t.Category+'</span> <i class="featureSetName_">('+t.Type.replace(/_/g," ")+")</i> &nbsp;&nbsp; <span class='info'>?</span>  <span class='source'>"+e.replace(/[sS]$/,"")+"</span> </p> <span class='tooltiptext'>"+t.Description+"</span>"}return e="UniProt"==t.Server||"PredictProtein"==t.Server||"CATH"==t.Server||"SNAP2"==t.Server||"COSMIC"==t.Server||"FunVar"==t.Server?"Curated Features":t.Server,'<p><span class="featureSetName">'+t.Category+"</span> &nbsp;&nbsp; <span class='info'>?</span> <span class='source'>"+e.replace(/[sS]$/,"")+"</span></p> <span class='tooltiptext'>"+t.Description+"</span>"})).each(la)}))}function la(t,e){var a=t.Tracks;for(var r in a){var n=yt.a.select(this),i=ua(n);i.attr("id","ftrack_"+sa+"_"+r).on("click",(function(){if("loaded"==yt.a.select(this).attr("class"))s["default"].commit("setLoadedFeature",{set:null,track:null}),yt.a.select("svg.loaded").classed("loaded",!1),document.querySelector(".featureHeader").click(),Be(),$e(),d["hidePanels"]();else{document.querySelector("#outerFeatureMap")&&document.querySelector("#outerFeatureMap").remove(),"Added Features"!=t.Server&&(AQUARIA.addedFeature=!1);var e=yt.a.select(this).attr("id").split("_")[2];s["default"].commit("setLoadedFeature",{set:t,track:e}),yt.a.selectAll("svg.loaded rect.feature").attr("fill","#a4abdf"),yt.a.select("svg.loaded").classed("loaded",!1),yt.a.select(this).attr("class","loaded"),d["hidePanels"]()}})).on("mouseover",(function(){yt.a.select(this).selectAll("rect.feature").attr("fill",(function(){return yt.a.select(this).attr("color")}))})).on("mouseout",(function(){"loaded"!==yt.a.select(this).attr("class")&&yt.a.select(this).selectAll("rect.feature").attr("fill","#a4abdf")})).append("rect").attr("width",ia+AQUARIA.margin.left).attr("height",25).attr("class","bg").attr("fill","none"),yt.a.select("svg#ftrack_"+sa+"_"+r).append("g").attr("transform","translate("+AQUARIA.margin.left+",0)").append("rect").attr("width",ia).attr("height",1).attr("transform","translate(0,13)").attr("class","insertion"),ca(t,a,r)}sa++}function ca(t,e,a){for(var r in e[a]){var n=s["default"].state.featCount+1;s["default"].commit("setFeatCount",n),yt.a.select("#ftrack_"+sa+"_"+a+" g").append("rect").attr("width",(function(){return(e[a][r].size+1)*AQUARIA.srw>2?(e[a][r].size+1)*AQUARIA.srw:2})).attr("height",14).attr("id","feature_"+sa+"_"+a+"_"+r).attr("transform","translate("+e[a][r].start*(AQUARIA.srw-.0085)+",6)").attr("color",e[a][r].color).attr("fill","#a4abdf").attr("fill-opacity",(function(){return"single_track"==t.Class?.3:1})).attr("class","feature").on("mouseover",(function(){yt.a.select(this).attr("stroke-width","2px").attr("stroke","white"),Xe(e[this.id.split("_")[2]][this.id.split("_")[3]],this)})).on("mouseout",(function(){yt.a.select(this).attr("stroke-width","0px"),$e()}))}}function ua(t){var e=document.getElementById("structure-viewer").offsetWidth-window.AQUARIA.margin.right-window.AQUARIA.margin.left;ia=document.getElementById("structure-viewer").offsetWidth-AQUARIA.margin.right;var a=40-AQUARIA.margin.top-AQUARIA.margin.bottom+35,r=t.append("svg").attr("width",ia).attr("height",a).attr("viewBox","0 0 "+e+" "+a).attr("preserveAspectRatio","none");return r}var da,ha,pa,fa={name:"Tabs",components:{MatchingStructures:Ee,Features:We},data:function(){return{MS:a("39b5"),FT:a("9db5")}},computed:Object(u["a"])({},Object(h["b"])(["getFeatCount","getStructCount","getMatches"])),methods:{storeHash:function(){""===window.location.hash&&s["default"].commit("setHash","#(0,0,0)"),window.location.hash.includes("(")&&s["default"].commit("setHash",window.location.hash)},renderClusters:function(){if(this.storeHash(),ne(this.$store.state.Matches.sequences[0]),!document.querySelector(".outer_container")){for(var t=this.getMatches.clusters,e=0;e<t.length;e++)oe(t[e]);se(this.getMatches.clusters)}var a=this.getMatches.Selected_PDB.cluster_number,r=this.getMatches.clusters[a];re(r,a)},renderFeatures:function(){this.storeHash(),ne(this.$store.state.Matches.sequences[0]),oa(s["default"].state.featureSets)},showPanel:function(t,e){document.querySelector("#"+t).style.display="block",document.querySelectorAll(".tab").className="tab inactive",document.querySelector("#"+e).className="tab active"},showMatches:function(){var t=this;if(window.AQUARIA.panel3d){var e=window.AQUARIA.panel3d.embededJolecule.controller;e.clearSelectedResidues()}t.showPanel("vis","Structures"),d["hidePanel"]("featurePanel","Features"),0===document.getElementsByClassName("dimmer").length&&d["overlay"](),document.querySelector("div.dimmer").className+=" level0",document.querySelector("div.dimmer").addEventListener("click",(function(){d["hidePanels"]()}))},showFeatures:function(){var t=this;if(window.AQUARIA.panel3d){var e=window.AQUARIA.panel3d.embededJolecule.controller;e.clearSelectedResidues()}d["hidePanel"]("vis","Structures"),t.showPanel("featurePanel","Features"),0===document.getElementsByClassName("dimmer").length&&d["overlay"](),document.querySelector("div.dimmer").className+=" level0",document.querySelector("div.dimmer").addEventListener("click",(function(){document.querySelector("a.close").click(),d["hidePanels"]()}))}},mounted:function(){var t=this;window.addEventListener("hashchange",(function(){window.location.hash.includes("Structures")&&t.showMatches(),window.location.hash.includes("Features")&&t.showFeatures()}))}},ma=fa,ga=(a("12d7"),Object(m["a"])(ma,Vt,Tt,!1,null,"6a6a937f",null)),va=ga.exports,ya=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"rel",attrs:{id:"map"}},[a("FeatureMap",{attrs:{drawFeature:t.drawFeature}}),t.showLoader?a("mapLoader"):t._e()],1)},wa=[],ba=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"featureMap"}})},Aa=[],_a={name:"FeatureMap",props:["drawFeature"],data:function(){return{seqLength:0,scale:null,coverageMapsrw:0,residueColor:null}},computed:Object(u["a"])({getLoadedFeature:function(){return s["default"].state.loadedFeature}},Object(h["b"])(["getVariantResidues","getLoadedFeature","getVariantIdx","getVariant","getMatches"])),watch:{getLoadedFeature:function(){var t=this;null===t.getLoadedFeature.set?document.querySelectorAll('[id^="feature_residue_').forEach((function(t){t.remove()})):document.querySelector('[id^="feature_residue_')?(document.querySelectorAll('[id^="feature_residue_').forEach((function(t){t.remove()})),t.drawMap(t.getLoadedFeature)):t.drawMap(t.getLoadedFeature)}},methods:{drawMap:function(t){var e=this,a=null;this.setScales(),t.set.Tracks[0].forEach((function(t,r){t.start=+t.start,t.end=+t.end,e.drawResidues(t,a)})),!this.$store.getters.getIsDefaultFeature&&this.getVariantResidues&&(e.loadPopup(t),console.log("The data here is "+e.getVariantIdx+" "+e.getVariant),console.log(t))},loadPopup:function(t){var e=this,a=Object.keys(e.getVariantResidues).sort((function(t,a){return e.getVariantResidues[t].order-e.getVariantResidues[a].order})),r=a[0];console.log('"The data here 2 is "'+r+" "+e.getVariantResidues[r].order+" "+a);var n='[id^="feature_residue_'+r+'"]',i=document.querySelector(n);t.set.Tracks[0].forEach((function(t){if(e.getVariantResidues[t.start]){var a=e.getVariantResidues[t.start];s["default"].commit("setPopupTitle",t.label),s["default"].commit("setPopupText",a),s["default"].commit("setVariantIdx",0),s["default"].commit("setIsDefaultFeature",!1),s["default"].commit("setVariant",t.start),null!=i&&s["default"].commit("setPopupCoordinates",i.getBoundingClientRect())}}))},setScales:function(){this.seqLength=this.getMatches.sequences[0].length,this.scale=vt["scale"].linear().domain([1,this.seqLength]).range([1,window.innerWidth]),this.coverageMapsrw=this.scale(this.seqLength)/this.seqLength},drawResidues:function(t){for(var e=this,a="",r="",n="",i=t.start;i<=t.end;i++){var o='[id^="residue_'+i+'"]',l=document.querySelector(o),c=document.querySelector(o+"> rect");if(l.id.includes("Dark")?(r=15,n=20):(r=25,n=document.querySelector(o+"> rect").getBoundingClientRect().height),"undefined"!==l&&"undefined"!==c&&null!=l&&null!=c){var u=vt["select"]("#map > #coverageMap > g");u.append("g").attr("id","feature_residue_"+i+"_"+document.querySelector(o).id.split("_")[3]).append("rect").attr("width",e.coverageMapsrw).attr("height",n).attr("transform",(function(){var t=document.querySelector(o+"> rect").getBoundingClientRect().height;return 18===t?"translate("+(i*e.coverageMapsrw-e.coverageMapsrw)+",17)":14===t?"translate("+(i*e.coverageMapsrw-e.coverageMapsrw)+",19)":19===t?"translate("+(i*e.coverageMapsrw-e.coverageMapsrw)+",16)":"translate("+(i*e.coverageMapsrw-e.coverageMapsrw)+","+r+")"})).attr("fill",t.color).on("mouseover",(function(r){e.residueColor=vt["select"](this).style("fill"),vt["select"](this).attr("stroke","white").attr("stroke-width",1),l.id.includes("Dark")?s["default"].commit("setPopupTitle",t.label+": Dark region"):s["default"].commit("setPopupTitle",t.label),t.desc!==t.label?e.getVariantResidues[t.start]?(a=e.getVariantResidues[t.start],s["default"].commit("setPopupText",a),s["default"].commit("setVariantIdx",0),s["default"].commit("setVariant",t.start)):t.desc.length>0?(a=t.desc+" </br> ",a+="Structures with residue "+this.parentElement.id.split("_")[1]+": ",s["default"].commit("setPopupText",a),s["default"].commit("setVariant",-1),s["default"].commit("setIsDefaultFeature",!1)):s["default"].commit("setPopupText","Structures with residue "+this.parentElement.id.split("_")[2]+": "):(s["default"].commit("setPopupText","Structures with residue "+this.parentElement.id.split("_")[2]+": "),s["default"].commit("setVariant",-1)),s["default"].commit("setIsDefaultFeature",!1),s["default"].commit("setTotalPDBres",this.parentElement.id.split("_")[3]),s["default"].commit("setPopupCoordinates",this.getBoundingClientRect())})).on("mouseout",(function(){vt["select"](this).attr("stroke",e.residueColor).attr("stroke-width",0)}))}}}}},Sa=_a,xa=(a("9b83"),Object(m["a"])(Sa,ba,Aa,!1,null,null,null)),Ca=xa.exports,Ia=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},ka=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"animated"},[a("div",{staticClass:"innerGradient"})])}],Ra={name:"mapLoader"},Pa=Ra,Ea=(a("be77"),Object(m["a"])(Pa,Ia,ka,!1,null,"6934c327",null)),Oa=Ea.exports,Da=50,Ma=200,qa=[61,28],Va={name:"CoverageMap",components:{FeatureMap:Ca,mapLoader:Oa},data:function(){return{seqLength:0,scale:null,coverageMapsrw:0,residueColor:null,densityScale:null,darkRegions:[],myArray:[1],coverageMapData:null,drawFeature:!1,showLoader:!0,structure:{accession:null},docFrag:null}},computed:Object(u["a"])({getLoadedFeature:function(){return s["default"].state.loadedFeature},secondaryStructure:function(){return s["default"].state.secondaryStructure},sequence:function(){return s["default"].state.structure},loader:function(){return s["default"].state.Loader}},Object(h["b"])(["getGene","getStructure","getOneAaCodes","getThreeAaCodes","getLoadedFeature","getSequences"])),watch:{getLoadedFeature:function(t){var e=this;null===t.set?(e.drawFeature=!1,e.selectStructmap(window.AQUARIA.currentMember)):document.querySelector("#map > #coverageMap")?(e.setStructFeatmap(window.AQUARIA.currentMember),e.drawFeature=!0):e.updateUI()},secondaryStructure:function(){var t=this;document.querySelector("#map > #coverageMap")&&t.selectStructmap(window.AQUARIA.currentMember)()},sequence:function(t,e){var a=this;if(e.accession!==t.accession&&null!==e.accession){document.querySelector("#map > #coverageMap").remove(),a.init(t.accession);var r={selector:[t.accession],selectPDB:t.pdb,selectChain:t.chain},n="".concat(window.BACKEND,"/get_3D_alignment");U()({method:"get",url:n,params:r}).then((function(t){var e=t.data;s["default"].commit("setSecondaryStructure",e.secondary_structure)}))}},loader:function(t){var e=this;if(!t){var a=new _["a"](window.AQUARIA.panel3d.embededJolecule);a.addEventListener("viewcommit",(function(){e.updateUI()}))}}},mounted:function(){this.init(this.$route.params.uniprotAccession)},methods:{updateUI:function(){var t=this;document.querySelector("#map > #coverageMap")||(t.drawMap(t.coverageMapData),document.querySelector("#map").appendChild(t.docFrag),null!==t.getLoadedFeature.set?(t.setStructFeatmap(window.AQUARIA.currentMember),t.drawFeature=!0):t.selectStructmap(window.AQUARIA.currentMember),t.showLoader=!1,s["default"].commit("setCoverageMap",!0))},init:function(t){var e=this,a="".concat(window.BACKEND,"/getCoverageMap"),r={selector:[t]};U()({method:"get",url:a,params:r}).then((function(t){console.log(t.data),e.coverageMapData=t.data}))},drawMap:function(t){var e=this;da=e.renderSVG(),da.append("rect").attr("id","selection"),this.drawLine(da),this.setScales(t),this.drawDarkRegions(t),t.secondaryStructures.forEach((function(a){a.start=+a.start,a.end=+a.end,e.drawResidues(a,t)}))},setScales:function(t){this.seqLength=t.seqLength,this.scale=vt["scale"].linear().domain([1,this.seqLength]).range([1,window.innerWidth]),this.coverageMapsrw=this.scale(t.seqLength)/t.seqLength;var e=Math.max.apply(Math,Object(jt["a"])(t.densityMap));this.densityScale=e<=Ma?vt["scale"].linear().domain([Math.log(1),Math.log(Ma)]).range(qa):vt["scale"].linear().domain([Math.log(1),Math.log(Math.max.apply(Math,Object(jt["a"])(t.densityMap)))]).range(qa)},drawLine:function(t){t.append("line").style("stroke","#434343").attr("x1",1).attr("y1",26).attr("x2",window.innerWidth).attr("y2",26)},renderSVG:function(){this.docFrag=document.createDocumentFragment();var t=vt["select"](this.docFrag).append("svg").attr("id","coverageMap").attr("height",Da).attr("width","100%").attr("viewBox","0, 0, "+window.innerWidth+","+Da).attr("preserveAspectRatio","none"),e=t.append("g");return e},drawResidues:function(t,e){var a=da,r="",n="",i=this;if("SHEET"===t.Type)var o=18,l=17,c="sheet";else"COIL"===t.Type?(o=14,l=19,c="coil"):(o=19,l=16,c="helix");for(var u=t.start;u<=t.end;u++){var d="hsl(0, 0%,"+i.densityScale(Math.log(e.densityMap[u-1]))+"%)";a.append("g").attr("id","residue_"+u+"_"+t.Type+"_"+e.densityMap[u-1]).append("rect").attr("transform","translate("+(u*i.coverageMapsrw-i.coverageMapsrw)+","+l+")").attr("width",(function(){return i.coverageMapsrw<.5?i.coverageMapsrw+.25:i.coverageMapsrw})).attr("height",o).attr("fill",d).attr("class",c).attr("stroke-width",1).on("mouseover",(function(t){i.residueColor=vt["select"](this).style("fill"),vt["select"](this).attr("stroke","white").attr("stroke-width",1);var e=this.parentElement.id.split("_")[1];s["default"].commit("setRes",e);var a=i.getSequences[0].sequence[e-1],o=i.getOneAaCodes.indexOf(a),l=i.getThreeAaCodes[o];if(n='<span style="font-weight: 700;">'+i.getGene+"</span> sequence: "+l+"–"+e,this.parentElement.id.includes("active")){var c=window.AQUARIA.panel3d.joleculeAlignment,u=window.AQUARIA.panel3d.embededJolecule.controller,d=c.mapSeqResToPdbResOfChain(0,e,i.getStructure.chain),h=u.soup.findResidueIndices(0,d[1],d[2]),p=u.soup.getResidueProxy().load(h).resType;p=p.substr(0,1)+p.substr(1).toLowerCase(),r=i.getStructure.pdb+"-"+i.getStructure.chain+" structure: "+p+"-"+d[2]+"</br> Structures with residue "+this.parentElement.id.split("_")[1]+": "}else r="Structures with residue "+this.parentElement.id.split("_")[1]+": ";s["default"].commit("setPopupTitle",n),s["default"].commit("setPopupText",r),s["default"].commit("setTotalPDBres",this.parentElement.id.split("_")[3]),s["default"].commit("setPopupCoordinates",this.getBoundingClientRect())})).on("mouseout",(function(){vt["select"](this).attr("stroke",i.residueColor).attr("stroke-width",0)}))}},selectStructmap:function(t){var e=this;vt["selectAll"]('[id^="residue_"')[0].map((function(t,a){var r=t.id.split("_")[3];t.id.includes("active")&&(t.id=t.id.split("_active")[0]),vt["select"](t).select("rect").attr("fill","hsl(0, 0%,"+e.densityScale(Math.log(r))+"%)")}));var a=s["default"].getters.getSecondaryStructure[0],r=t.seq_start[0],n=t.seq_end[t.seq_start.length-1],i=(n-r)*e.coverageMapsrw+e.coverageMapsrw;document.querySelector("#map > #coverageMap > rect")&&document.querySelector("#map > #coverageMap > rect").remove(),vt["select"]("#map > #coverageMap > g > #selection").attr("width",i).attr("height",30).attr("transform","translate("+(r*e.coverageMapsrw-e.coverageMapsrw)+",11)").attr("fill","white").attr("stroke","#434343").attr("stroke-width",1).attr("rx",6).attr("ry",6),a.map((function(t){if(t.end)var a=t.start,r=t.end,n=t.type;else a=t.split("\n")[0].split(":")[1].split("-")[0],r=t.split("\n")[0].split(":")[1].split("-")[1],n=t.split("\n")[0].split(":")[0];for(var s=a;s<=r;s++){var i='[id^="residue_'+s+'_"]';if(vt["select"](i+"> rect").attr({fill:e.getStructureColor(n)}),document.querySelector(i))document.querySelector(i).id=document.querySelector(i).id+"_active";else{var o={Type:"COIL"};o.start=s,o.end=s,e.drawResidues(o,e.coverageMapData),document.querySelector(i).id=document.querySelector(i).id+"_active"}}}))},setStructFeatmap:function(t){var e=this;vt["selectAll"]('[id^="residue_"')[0].map((function(t,a){var r=t.id.split("_")[3];vt["select"](t).select("rect").attr("fill","hsl(0, 0%,"+e.densityScale(Math.log(r))+"%)")}));var a=s["default"].getters.getSecondaryStructure[0],r=t.seq_start[0],n=t.seq_end[t.seq_start.length-1],i=(n-r)*e.coverageMapsrw+e.coverageMapsrw;document.querySelector("#map > #coverageMap > rect")&&document.querySelector("#map > #coverageMap > rect").remove(),vt["select"]("#map > #coverageMap > g > #selection").attr("width",i).attr("height",30).attr("transform","translate("+(r*e.coverageMapsrw-e.coverageMapsrw)+",11)").attr("fill","white").attr("stroke","#434343").attr("stroke-width",1).attr("rx",6).attr("ry",6),a.map((function(t){if(t.end)var e=t.start,a=t.end;else e=t.split("\n")[0].split(":")[1].split("-")[0],a=t.split("\n")[0].split(":")[1].split("-")[1];for(var r=e;r<=a;r++){var n='[id^="residue_'+r+'_"]';vt["select"](n+"> rect").attr({fill:"#cccccc"})}}))},getStructureColor:function(t){return"SHEET"===t?"#f6c719":"COIL"===t?"#6f9e52":"#6491b6"},drawDarkRegions:function(t){var e=[],a=this,r=da;return t.densityMap.forEach((function(e,n){if(0===e){var i=n+1;r.append("g").attr("id","residue_"+i+"_Dark_0").append("rect").attr("transform","translate("+(i*a.coverageMapsrw-a.coverageMapsrw)+",14)").attr("width",(function(){return a.coverageMapsrw<.5?a.coverageMapsrw+.25:a.coverageMapsrw})).attr("height",30).attr("fill","#434343").attr("opacity",0).attr("stroke-width",1).on("mouseover",(function(e){a.residueColor=vt["select"](this).style("fill"),vt["select"](this).attr("stroke","white").attr("stroke-width",1),s["default"].commit("setPopupTitle","Residue "+this.parentElement.id.split("_")[1]+" : Dark region"),s["default"].commit("setDensityScore",t.densityMap),s["default"].commit("setPopupText","Structures with residue "+this.parentElement.id.split("_")[1]+": "),s["default"].commit("setTotalPDBres",this.parentElement.id.split("_")[3]),s["default"].commit("setPopupCoordinates",this.getBoundingClientRect())})).on("mouseout",(function(){s["default"].commit("setPopupCoordinates",0),vt["select"](this).attr("stroke",a.residueColor).attr("stroke-width",0)}))}})),e}}},Ta=Va,La=(a("af60"),Object(m["a"])(Ta,ya,wa,!1,null,"1816f2c5",null)),Ba=La.exports,Na=a("8ac5"),Ua=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.data.error?a("div",{staticClass:"ErrorPanel overlay level3",attrs:{id:"AboutError"}},[a("a",{staticClass:"close",attrs:{href:"#"},on:{click:t.loadLastSuccess}}),a("div",[a("p",{staticClass:"thetitle"},[t._v(t._s(t.data.error))]),a("p",{staticClass:"intro1"},[t._v(t._s(t.data.errorMsg)+" "),t.data.errorMsg?a("br"):t._e(),t._v(" "),t.data.errorMsg?a("br"):t._e(),t._v(" Press 'Report Issue' to tell the Aquaria team, or press 'OK' to return to previous structure.")]),a("div",[a("md-button",{staticClass:"md-raised md-primary",attrs:{href:t.lastURL}},[t._v("OK")]),a("md-button",{staticClass:"md-raised md-primary",attrs:{href:t.issuesURL,target:"_blank"}},[t._v("Report Issue")])],1)])]):t._e()},ja=[],Ha={name:"Errors",data:function(){return{issues:"",title:"",changes:"https://github.com/aqclient/dev.aqclient.github.io/issues/new?labels=enhancement",logo:a("3198")}},computed:{data:function(){return{message:s["default"].state.message,error:s["default"].state.error,errorMsg:s["default"].state.errorMsg}},issuesURL:function(){return'https://github.com/aqclient/dev.aqclient.github.io/issues/new?title=Problem with this page&labels=bug&body=<a href="'+encodeURIComponent(window.location.href)+'">'+this.data.error+"</a>"},pageUrl:function(){return window.location.href},lastURL:function(){return window.location.origin}},methods:{loadLastSuccess:function(){window.location.pathname=localStorage.getItem("LastSuccess")?localStorage.getItem("LastSuccess"):"/P04637"}}},Fa=Ha,Qa=(a("715b"),Object(m["a"])(Fa,Ua,ja,!1,null,"72919d45",null)),Ga=Qa.exports,za=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"HelpPanel hide dialouge-window overlay level7",attrs:{id:"UserHelp"}},[a("a",{staticClass:"close",attrs:{href:"#"},on:{click:t.closeHelp}}),a("div",{staticClass:"fill",attrs:{id:"fullwindow-video"}},t._l(t.videos,(function(e){return a("youtube",{key:e.id,ref:"youtube",refInFor:!0,staticClass:"hide",attrs:{id:e.id,"video-id":e.id},on:{paused:function(e){return t.paused(e)},ended:function(e){return t.finished(e)}}})})),1),a("div",{attrs:{id:"contents"}},[a("p",{staticClass:"thetitle"},[t._v(t._s(t.data.title))]),a("p",{staticClass:"intro"},[t._v("Watch tutorial videos to get started.")]),a("p",{staticClass:"intro"},[t._v("Skip watching tutorial videos and start using Aquaria.")]),t.data.newUser?t._e():a("Playlist",{attrs:{playlist:t.videos}}),t.data.newUser?a("div",[a("youtube",{ref:"youtube",attrs:{id:"intro-video","video-id":"FAQ3yVGYSzY"},on:{playing:function(e){return t.playing(e)},paused:function(e){return t.paused(e)},ended:function(e){return t.finished(e)}}})],1):t._e(),a("a",{attrs:{href:"#",id:"skip"},on:{click:t.closeHelp}},[t._v("Skip > ")])],1)])},Za=[],Wa=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"playlists"}},t._l(t.playlist,(function(e){return a("span",{key:e.id,attrs:{id:e.id},on:{click:function(a){return t.play(e.id)}}},[a("div",{staticClass:"thumbnail-container"},[a("img",{attrs:{src:"https://img.youtube.com/vi/"+e.id+"/0.jpg"}}),a("button",{staticClass:"btn"},[t._v("▶")])]),a("p",[t._v(t._s(e.title))])])})),0)},Ya=[],Ja={name:"Playlist",props:["playlist"],methods:{play:function(t){document.querySelector("#contents").className=" hide",document.getElementById(t).className+=" show",document.getElementById("UserHelp").classList.remove("overlay"),document.getElementById("UserHelp").classList.remove("level7"),document.getElementById("UserHelp").classList.remove("dialouge-window"),document.getElementById("UserHelp").className+=" fullwindow";for(var e=0;e<this.$parent.$children.length;e++)if(this.$parent.$children[e].$attrs.id===t)var a=e;this.$parent.$children[a].player.playVideo()}}},$a=Ja,Xa=(a("4d26"),Object(m["a"])($a,Wa,Ya,!1,null,null,null)),Ka=Xa.exports,tr={name:"UserHelp",components:{Playlist:Ka},data:function(){return{videos:[{id:"FAQ3yVGYSzY",title:"Introduction to Aquaria"},{id:"UZNEmPOaVrA",title:"How to Calculate Distances"}]}},computed:{data:function(){return{title:s["default"].state.helpTitle,newUser:s["default"].state.newUser}}},methods:{closeHelp:function(){var t=this;if(document.querySelector("iframe.show")){var e=document.querySelector("iframe.show").id;document.getElementById("contents").classList.remove("hide"),document.getElementById(e).classList.remove("show"),document.getElementById("UserHelp").className+=" dialouge-window",document.getElementById("UserHelp").className+=" overlay",document.getElementById("UserHelp").className+=" level7",document.getElementById("UserHelp").classList.remove("fullwindow");var a={h:{}};a.h.id=e,t.paused(a)}else document.getElementById("UserHelp").classList.remove("show"),document.getElementById("UserHelp").className+=" hide",d["RemoveOverlay"](),document.querySelector("#helpbtn").classList.contains("active")&&t.toggleActive(document.querySelector("#helpbtn"))},toggleActive:function(t){"lnk active"===t.className?t.className="lnk":t.className="lnk active"},getIndex:function(t){for(var e=0;e<this.$refs.youtube.length;e++)if(this.$refs.youtube[e].$attrs.id===t)return e},playing:function(t){if(ha=t.h.id,this.$refs.youtube.length)pa=this.getIndex(ha),this.$refs.youtube[pa].player.playVideo();else{this.$refs.youtube.player.playVideo();var e=document.querySelector("#intro-video"),a=e.requestFullScreen||e.mozRequestFullScreen||e.webkitRequestFullScreen;a&&a.bind(e)()}},paused:function(t){ha=t.h.id,document.querySelector("iframe.active")?this.closeHelp():(this.$refs.youtube.length?(pa=this.getIndex(ha),this.$refs.youtube[pa].player.pauseVideo()):this.$refs.youtube.player.pauseVideo(),(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement)&&document.exitFullscreen())},finished:function(t){ha=t.h.id,this.$refs.youtube.length?(pa=this.getIndex(ha),this.$refs.youtube[pa].player.stopVideo()):this.$refs.youtube.player.stopVideo(),document.querySelector("iframe.active")&&document.querySelector("#UserHelp a.close").click(),document.exitFullscreen(),this.closeHelp()}}},er=tr,ar=(a("7f5f"),Object(m["a"])(er,za,Za,!1,null,null,null)),rr=ar.exports,nr=a("7d7f"),sr=a.n(nr),ir=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.loader?a("div",{attrs:{id:"waitingFrame"}},[a("div",{attrs:{id:"waitinghtml"}},[a("img",{attrs:{src:t.overlay}}),a("p",{attrs:{id:"appletMessage"}},[t._v(" "+t._s(t.loaderMsg)+" ")])])]):t._e()},or=[],lr={name:"Loader",data:function(){return{overlay:a("8673")}},computed:{loader:function(){return s["default"].state.Loader},loaderMsg:function(){return s["default"].state.LoaderMsg}}},cr=lr,ur=(a("7bd5"),Object(m["a"])(cr,ir,or,!1,null,"cb681734",null)),dr=ur.exports,hr=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"level4",attrs:{id:"popupshell"}},[a("div",{staticClass:"level4",style:{visibility:t.data.popupTitle?"visible":"hidden"},attrs:{id:"popupbody"}},[a("div",{attrs:{id:"popupheader"},on:{mousedown:function(e){return t.dragMouseDown(e)}}},[a("span",{staticClass:"loadedPin",attrs:{id:"loadedPin"},on:{click:function(e){return t.togglePinBehaviour()}}}),a("span",{domProps:{innerHTML:t._s(t.getPopupTitle)}}),a("span",{staticClass:"x",attrs:{id:"x_close"},on:{click:t.hidePopup}})]),t.getPopupText?a("div",{attrs:{id:"content"}},[t.isVariant?a("div",{staticClass:"aaLightBg"},[t.defaultDesc?a("p",{attrs:{id:"spanDefaultDesc"}},[t._v(" "+t._s(t.defaultDesc)+" ")]):t._e(),t._l(t.oneAaCodes,(function(e){return a("div",{key:e,style:{display:e===t.variant?"block":"none"},attrs:{id:"divVarInfo_"+e}},[t._l(t.getAaDataAsArr(e),(function(e){return a("expandable-text-line",{key:e,attrs:{"use-click":""},domProps:{innerHTML:t._s(e+".")}})})),a("i",[t._v("Structures with "+t._s(t.getOldAa())+t._s(t.getVarDisplay())+t._s(e)+":")]),t._v(" "),a("span",{class:t.getIsShownVar(t.variant),on:{click:function(a){return t.showTreeView(a,e)}}},[t._v(" "+t._s(t.getPdbCount(e))+" ")])],2)})),a("hr",{staticClass:"anAaHr",attrs:{id:"anAaHr",hidden:t.isHrHidden()}}),a("div",{attrs:{id:"divPosInfo"}},[a("span",{staticClass:"weight600",domProps:{innerHTML:t._s(t.getResInfo())}}),a("br"),t._l(t.getPosInfoDataAsArr(),(function(e,r){return a("span",{key:r},[a("expandable-text-line",{attrs:{"use-click":""}},[a("i",[a("span",{domProps:{innerHTML:t._s(r)}}),t._v(": ")]),t._l(e,(function(e){return a("span",{key:e,domProps:{innerHTML:t._s(e+". ")}})}))],2)],1)})),a("i",[t._v("Structures with residue "+t._s(t.getVariant)+":")]),a("span",{class:t.getIsShownRes(),on:{click:function(e){return t.showTreeView(e)}}},[t._v(" "+t._s(t.getTotalPdbCount)+" ")])],2)],2):t._e(),t.isVariant||t.getInfoPopup?t._e():a("div",{staticClass:"aaLightBg"},[a("i",{domProps:{innerHTML:t._s(t.getPopupText)}}),t.getIsDefaultFeature?t._e():a("span",{class:t.getTotalPdbCount>0?"hasStruct":"noStruct",on:{click:function(e){t.getTotalPdbCount>0&&t.showTreeView(e,null,t.getPopupText.replace(/\D/g,""))}}},[t._v(" "+t._s(t.getTotalPdbCount)+" ")])])]):t._e(),a("div",{staticClass:"btnsDiv",style:{display:t.isVariant?"block":"none"}},[a("span",[t._v("See also:")]),t._v(" "),a("span",{staticClass:"pAaColor"},[t._v(" "+t._s(t.getOldAa())+" → ")]),t._l(t.oneAaCodes,(function(e){return a("button",{key:e,class:t.getIfBoldInfoPres(e),attrs:{id:"btnVarInfo_"+e},on:{click:function(a){return t.highlightAa(e)}}},[t._v(t._s(e))])}))],2)]),a("TreeView",{directives:[{name:"show",rawName:"v-show",value:t.showTree,expression:"showTree"}],staticClass:"level5",attrs:{id:"treeView",treeReady:t.prop,count:t.count,coordinates:t.treeCoordinates,parentElem:t.parentElem}}),a("NodeLoader",{directives:[{name:"show",rawName:"v-show",value:t.showLoader,expression:"showLoader"}],attrs:{coordinates:t.treeCoordinates,change:t.change}}),a("img",{staticClass:"show",style:{visibility:t.data.popupTitle?"visible":"hidden"},attrs:{src:t.popupTail,id:"popupTail"}})],1)},pr=[],fr={name:"PopUp",components:{TreeView:be,ExpandableTextLine:it["a"],NodeLoader:Ie},watch:{popupCoordinates:function(t){var e=this;this.setDefault(),null!==t||0!==t?("object"===Object(qe["a"])(s["default"].state.popupText)?(e.handleVariantPopup(),e.togglePinBehaviour()):e.isVariant=!1,this.PopupPos=t):e.hidePopup()}},data:function(){return{popupTail:a("4c7a"),oneAaCodes:["A","C","D","E","F","G","H","I","K","L","M","N","P","Q","R","S","T","V","W","Y"],threeAaCodes:["Ala","Cys","Asp","Glu","Phe","Gly","His","Ile","Lys","Leu","Met","Asn","Pro","Gln","Arg","Ser","Thr","Val","Trp","Tyr"],isVariant:!1,variant:null,defaultDesc:null,treeCoordinates:{},change:0,showTree:!1,isShowTreeViewClicked:!1,prop:null,showLoader:!1,count:0,PopupPos:null,pos:[0,0,0,0],hasVariant:!1,hasResidue:!1,parentElem:"#popupshell"}},computed:Object(u["a"])(Object(u["a"])({popupCoordinates:function(){return s["default"].state.popupCoordinates},data:function(){return{variantStructs:s["default"].state.variantStructs,variantResidues:s["default"].state.variantResidues,popupTitle:s["default"].state.popupTitle,popupText:s["default"].state.popupText,residue:s["default"].state.residue,popupCoordinates:s["default"].state.popupCoordinates}}},Object(h["b"])(["getGene","getTotalPDBres","getVariant","getVariantStructs","getVariantResidues","getPopupTitle","getPopupText","getServersDone","getVariantIdx","getMatches","getStructure","getInfoPopup","getIsDefaultFeature"])),{},{getTotalPdbCount:function(){var t=this;if(t.isVariant){for(var e=0,a=0;a<t.oneAaCodes.length;a++)t.getVariantStructs&&t.getVariant&&Object.hasOwnProperty.call(t.getVariantStructs,t.getVariant)&&Object.hasOwnProperty.call(t.getVariantStructs[t.getVariant],t.oneAaCodes[a])&&Object.hasOwnProperty.call(t.getVariantStructs[t.getVariant][t.oneAaCodes[a]],"pdbs")&&(e+=t.getVariantStructs[t.getVariant][t.oneAaCodes[a]].pdbs.length);return e}return t.getTotalPDBres}}),created:function(){var t=this;window.addEventListener("click",(function(e){if(!t.$el.contains(e.target)&&e.target.parentElement&&t.getPopupTitle&&!e.target.parentElement.id.includes("tree")){var a=document.getElementById("loadedPin");if(a.classList.contains("loadedPin")){var r=document.getElementById("x_close");r.click()}}}))},methods:{setPopupPos:function(t){this.getPopupTitle.includes("Dark")&&(t.y=t.y+20);var e=t.x-document.querySelector("#popupTail").getBoundingClientRect().width/2+t.width/2;document.querySelector("#popupTail").style.left=e+"px",t.height<=2?document.querySelector("#popupshell").style.top=t.y-t.height-document.querySelector("#popupTail").getBoundingClientRect().height+"px":t.height>=18?document.querySelector("#popupshell").style.top=t.y-t.height+5+"px":document.querySelector("#popupshell").style.top=t.y-t.height+"px",document.querySelector("#popupshell").style.left=e-10+"px";var a=document.querySelector("#popupshell").getBoundingClientRect().x+document.querySelector("#popupbody").getBoundingClientRect().width;a>window.innerWidth&&(document.querySelector("#popupshell").style.left=window.innerWidth-document.querySelector("#popupbody").getBoundingClientRect().width+7+"px"),document.querySelector("#popupbody").getBoundingClientRect().x<0&&(document.querySelector("#popupshell").style.left="-10px")},hidePopup:function(){var t=this;this.isShowTreeViewClicked?this.isShowTreeViewClicked=!1:s["default"].commit("setPopupTitle",""),this.getVariantStructs&&t.resetToInitVar()},setDefault:function(){var t=document.getElementById("loadedPin");t.classList.contains("loadedPin_active")&&(t.classList.remove("loadedPin_active"),t.classList.add("loadedPin"));var e=document.getElementById("popupTail");e.classList.contains("hide")&&(e.classList.remove("hide"),e.classList.add("show")),document.getElementById("popupshell").classList.remove("fade")},handleVariantPopup:function(){this.isVariant=!0,this.variant=this.getVariantResidues[this.getVariant].newAas[this.getVariantIdx][0].toUpperCase(),this.defaultDesc=this.getDefaultDesc(),this.handleInitAa()},showTreeView:function(t,e,a){this.isShowTreeViewClicked=!0;var r=this,n=t.srcElement.getBoundingClientRect();if(r.treeCoordinates.clientX=n.left,r.treeCoordinates.clientY=n.top,r.treeCoordinates.width=n.width,r.treeCoordinates.height=n.height,r.change=r.change+1,r.showLoader=!0,r.getVariantStructs&&Object.hasOwnProperty.call(r.getVariantStructs,r.getVariant)){r.count=e?r.getPdbCount(e):r.getTotalPdbCount;var s="".concat(window.BACKEND,"/secondaryClusteringByResidue"),i={};i.selector=[r.getStructure.accession],i.sortedKeys=a?[parseInt(a)]:[r.getVariant],e&&(i.aaCode=e),U()({method:"get",url:s,params:i}).then((function(t){console.log(t.data),r.showTree=!0,r.prop=t.data}))}else{s="".concat(window.BACKEND,"/secondaryClusteringByResidue"),r.count=r.getTotalPdbCount,i={},i.selector=[r.getStructure.accession];var o=t.srcElement.parentElement.innerText.split(":");o.length>2?i.sortedKeys=[parseInt(o[1].split("residue ")[1])]:i.sortedKeys=[parseInt(o[0].split("residue ")[1])],U()({method:"get",url:s,params:i}).then((function(t){console.log(t.data),r.showTree=!0,r.prop=t.data}))}return 0},getOldAa:function(){return Object.hasOwnProperty.call(this.getVariantResidues,this.getVariant)&&Object.hasOwnProperty.call(this.getVariantResidues[this.getVariant],"oldAa")?this.getVariantResidues[this.getVariant].oldAa:""},highlightAa:function(t){this.variant=t.toUpperCase();for(var e=0;e<this.oneAaCodes.length;e++)document.getElementById("btnVarInfo_"+this.oneAaCodes[e]).classList.remove("selCol");if(document.getElementById("btnVarInfo_"+t.toUpperCase()).classList+=" selCol",document.querySelector("#varSpe_toRep")&&(document.querySelector("#varSpe_toRep").innerText=t),document.querySelector("#newAa")){var a=this.oneAaCodes.indexOf(t);document.querySelector("#newAa").innerText=this.threeAaCodes[a]}},getIfBoldInfoPres:function(t){var e=!1;if(Object.hasOwnProperty.call(this.getVariantResidues,this.getVariant)&&Object.hasOwnProperty.call(this.getVariantResidues[this.getVariant],t))for(var a=0;a<this.getVariantResidues[this.getVariant][t].length;a++)this.getVariantStructs&&Object.hasOwnProperty.call(this.getVariantStructs,this.getVariant)&&Object.hasOwnProperty.call(this.getVariantStructs[this.getVariant],t)&&Object.hasOwnProperty.call(this.getVariantStructs[this.getVariant][t],"pdbs")&&this.getVariantStructs[this.getVariant][t].pdbs.length>0&&(e=!0);if(this.getVariantResidues&&this.getVariant>0)return!0===e?t.toUpperCase().includes(this.getVariantResidues[this.getVariant].newAas[this.getVariantIdx][0].toUpperCase())?"btnAaBold_b selCol":"btnAaBold_b":t.toUpperCase().includes(this.getVariantResidues[this.getVariant].newAas[this.getVariantIdx][0].toUpperCase())?"btnAaBold selCol":"btnAaBold"},getAaDataAsArr:function(t){var e=[];if(Object.hasOwnProperty.call(this.getVariantResidues,this.getVariant)&&Object.hasOwnProperty.call(this.getVariantResidues[this.getVariant],t)){for(var a=0;a<this.getVariantResidues[this.getVariant][t].length;a++);return this.getVariantResidues[this.getVariant][t]}return e},resetToInitVar:function(){Object.hasOwnProperty.call(this.getVariantResidues,this.getVariant)&&Object.hasOwnProperty.call(this.getVariantResidues[this.getVariant],"theOrigFeatStr")&&this.getVariantIdx>-1&&(document.getElementById("urlVariant").innerHTML=this.getVariantResidues[this.getVariant].theOrigFeatStr[this.getVariantIdx]),Object.hasOwnProperty.call(this.getVariantResidues,this.getVariant)&&Object.hasOwnProperty.call(this.getVariantResidues[this.getVariant],"consequent")&&this.getVariantIdx>-1&&(document.getElementById("consInfo").innerHTML=this.getVariantResidues[this.getVariant].consequent[this.getVariantIdx]),this.handleInitAa(),document.getElementById("spanDefaultDesc")&&(document.getElementById("spanDefaultDesc").hidden=!1),!0===this.isHrHidden()&&(document.getElementById("anAaHr").hidden=!0)},getVarDisplay:function(){return"string"===typeof this.getVariant&&this.getVariant.match("-")?this.getVariant.split("-")[0]:this.getVariant},getIsShownVar:function(t){if(this.getMatches&&Object.hasOwnProperty.call(this.getMatches,"Selected_PDB")&&Object.hasOwnProperty.call(this.getMatches.Selected_PDB,"pdb_id")&&Object.hasOwnProperty.call(this.getMatches.Selected_PDB,"pdb_chain")){var e=this.getMatches.Selected_PDB.pdb_id+":"+this.getMatches.Selected_PDB.pdb_chain;return this.getVariant&&this.getVariantStructs&&Object.hasOwnProperty.call(this.getVariantStructs,this.getVariant)&&Object.hasOwnProperty.call(this.getVariantStructs[this.getVariant],t)&&Object.hasOwnProperty.call(this.getVariantStructs[this.getVariant][t],"pdbs")&&this.getVariantStructs[this.getVariant][t].pdbs.includes(e)?"selCol_padded":this.getVariant&&this.getVariantStructs&&Object.hasOwnProperty.call(this.getVariantStructs,this.getVariant)&&Object.hasOwnProperty.call(this.getVariantStructs[this.getVariant],t)&&Object.hasOwnProperty.call(this.getVariantStructs[this.getVariant][t],"pdbs")&&!this.getVariantStructs[this.getVariant][t].pdbs.includes(e)?"noSelCol_padded":""}},getIsShownRes:function(){return console.log("The variant structs is "),console.log(this.getVariantStructs),console.log(this.getMatches),this.getVariantStructs&&Object.hasOwnProperty.call(this.getVariantStructs,this.getVariant)&&Object.hasOwnProperty.call(this.getVariantStructs[this.getVariant],"isShown")&&!0===this.getVariantStructs[this.getVariant].isShown?"selCol_padded":this.getVariantStructs&&this.getVariant>-1&&Object.hasOwnProperty.call(this.getVariantStructs,this.getVariant)&&Object.hasOwnProperty.call(this.getVariantStructs[this.getVariant],"isShown")&&!1===this.getVariantStructs[this.getVariant].isShown||0!==this.getTotalPdbCount?"noSelCol_padded":""},getPdbCount:function(t){return this.getVariantStructs&&Object.hasOwnProperty.call(this.getVariantStructs,this.getVariant)&&Object.hasOwnProperty.call(this.getVariantStructs[this.getVariant],t)&&Object.hasOwnProperty.call(this.getVariantStructs[this.getVariant][t],"pdbs")?this.getVariantStructs[this.getVariant][t].pdbs.length:0},isHrHidden:function(){var t=this.getDefaultDesc(),e=!1;return Object.hasOwnProperty.call(this.getVariantResidues,this.getVariant)&&Object.hasOwnProperty.call(this.getVariantResidues[this.getVariant],"newAas")&&this.getVariantIdx>-1&&this.oneAaCodes.includes(this.getVariantResidues[this.getVariant].newAas[this.getVariantIdx][0].toUpperCase())&&(e=!0),""===t&&!1===e},getDefaultDesc:function(){return this.getVariant&&this.getVariantResidues&&Object.hasOwnProperty.call(this.getVariantResidues,this.getVariant)&&Object.hasOwnProperty.call(this.getVariantResidues[this.getVariant],"defaultDesc")&&this.getVariantIdx>-1?this.getVariantResidues[this.getVariant].defaultDesc[this.getVariantIdx]:""},getPosInfoDataAsArr:function(){return Object.hasOwnProperty.call(this.getVariantResidues,this.getVariant)&&Object.hasOwnProperty.call(this.getVariantResidues[this.getVariant],"positionInfo")?this.getVariantResidues[this.getVariant].positionInfo:[]},handleInitAa:function(){var t=this;if(console.log("handleInitAa runs "),console.log(this.getVariantIdx),Object.hasOwnProperty.call(this.getVariantResidues,this.getVariant)&&Object.hasOwnProperty.call(this.getVariantResidues[this.getVariant],"newAas")&&this.getVariantIdx>-1&&this.oneAaCodes.includes(this.getVariantResidues[this.getVariant].newAas[this.getVariantIdx][0].toUpperCase()))t.highlightAa(this.getVariantResidues[this.getVariant].newAas[this.getVariantIdx][0].toUpperCase());else{this.getOldAa();for(var e=0;e<this.oneAaCodes.length;e++){var a=document.getElementById("divVarInfo_"+this.oneAaCodes[e]);"undefined"!==typeof a&&null!==a&&(document.getElementById("divVarInfo_"+this.oneAaCodes[e]).hidden=!0,document.getElementById("btnVarInfo_"+this.oneAaCodes[e]).classList.remove("selCol")),this.oneAaCodes[e]}t.updateSpanAa("")}},updateSpanAa:function(t){if(console.log("Value to display is "+t+this.getVariantIdx),document.getElementById("span_missenseHeading"))if(this.getVariantResidues&&Object.hasOwnProperty.call(this.getVariantResidues,this.getVariant)&&Object.hasOwnProperty.call(this.getVariantResidues[this.getVariant],"isOne")&&this.getVariantIdx>-1&&!0===this.getVariantResidues[this.getVariant].isOne[this.getVariantIdx]){var e=this.oneAaCodes.indexOf(t);document.getElementById("newAa").innerHTML=-1!==e?this.threeAaCodes[e]:""}else document.getElementById("newAa").innerHTML=t},togglePinBehaviour:function(){var t=document.getElementById("loadedPin");t.classList.contains("loadedPin_active")?(t.classList.remove("loadedPin_active"),t.classList.add("loadedPin")):t.classList.contains("loadedPin")&&(t.classList.remove("loadedPin"),t.classList.add("loadedPin_active"))},dragMouseDown:function(t){t=t||window.event,t.preventDefault(),this.pos[2]=t.clientX,this.pos[3]=t.clientY,document.onmouseup=this.closeDragElement,document.onmousemove=this.elementDrag},elementDrag:function(t){t=t||window.event,t.preventDefault();var e=document.getElementById("popupshell");this.pos[0]=this.pos[2]-t.clientX,this.pos[1]=this.pos[3]-t.clientY,this.pos[2]=t.clientX,this.pos[3]=t.clientY,e.style.top=e.offsetTop-this.pos[1]+"px",e.style.left=e.offsetLeft-this.pos[0]+"px";var a=document.getElementById("popupTail");a.classList.contains("show")&&(a.classList.remove("show"),a.classList.add("hide"))},closeDragElement:function(){document.onmouseup=null,document.onmousemove=null},getResInfo:function(){var t=window.AQUARIA.panel3d.joleculeAlignment,e=window.AQUARIA.panel3d.embededJolecule.controller,a=t.mapSeqResToPdbResOfChain(0,this.getVariant,this.getStructure.chain);if(a){var r=e.soup.findResidueIndices(0,a[1],a[2]),n=e.soup.getResidueProxy().load(r).resType;return n=n.substr(0,1)+n.substr(1).toLowerCase(),this.getGene+" residue "+this.getVariant+'<span style="font-weight: 400; color: #a6a5a6;"> ('+this.getStructure.pdb+"-"+this.getStructure.chain+" residue "+n+"-"+a[2]+")"}return this.getGene+" residue "+this.getVariant+'<span style="font-weight: 400; color: #a6a5a6;"> ( Dark region )'}},updated:function(){null!==this.PopupPos&&this.setPopupPos(this.PopupPos)}},mr=fr,gr=(a("0b4c"),a("05b9"),Object(m["a"])(mr,hr,pr,!1,null,"f595311c",null)),vr=gr.exports,yr=a("5e83"),wr={name:"Wrapper",components:{GdprConsentModal:yr["a"],Header:E,Sequence:ft,AboutAlignment:_t,AboutPdb:Rt,StructureViewer:qt,Tabs:va,CoverageMap:Ba,PopUp:vr,AboutAquaria:Na["a"],Errors:Ga,UserHelp:rr,Loader:dr},props:["urlRequest"],computed:{data:function(){return{hash:s["default"].state.hash,arrayOfVideos:["https://youtu.be/FAQ3yVGYSzY?list=PLsGaleFn8YydVFkxDhOvHHE5NoTsl6D1e","https://www.youtube.com/watch?v=UZNEmPOaVrA&list=PLsGaleFn8YydVFkxDhOvHHE5NoTsl6D1e&index=2"]}}},methods:{closeHelp:function(){var t=this;document.getElementById("UserHelp").classList.remove("show"),document.getElementById("UserHelp").className+=" hide",document.querySelector(".dimmer").style.display="none",document.querySelector("#helpbtn").classList.contains("active")&&(d["RemoveOverlay"](),t.toggleActive(document.querySelector("#helpbtn")))},checkPhone:function(){var t=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"];if(!navigator.platform)return!1;while(t.length)if(navigator.platform===t.pop()||screen.width>=300&&screen.width<=600)return!0},inspectHeight:function(){document.querySelector("#heightinspector").innerHTML="reset";var t=window.outerHeight-window.innerHeight;document.querySelector("#heightinspector").innerHTML="HO:"+window.outerHeight+", hDiff:"+t+", scroll: "+window.scrollY+" bodyHeight: "+document.body.scrollHeight},dismissPanel:function(){document.querySelector("#scrim").className="hide",this.$store.commit("setScrim",!1)},toggleActive:function(t){"lnk active"===t.className&&(t.className="lnk")}},mounted:function(){window.AQUARIA.panel3d=new sr.a("#threeDSpan",Y["chainSelected"]),window.scrollBy(0,100),Y["loadAccession"]([this.$props.urlRequest.uniprotAccession],this.$props.urlRequest.pdbID,this.$props.urlRequest.chain),window.addEventListener("resize",(function(){window.scrollBy(0,100),document.querySelectorAll("#vis > .ruler").forEach((function(t){return t.remove()})),document.querySelectorAll("#vis > #allclusters .outer_container").forEach((function(t){return t.remove()})),ie();var t=window.outerHeight-window.innerHeight;document.querySelector("#heightinspector").innerHTML="HO:"+window.outerHeight+", hDiff:"+t+", scroll: "+window.scrollY+" bodyHeight: "+document.body.scrollHeight})),setTimeout((function(){document.querySelector(".matrixLoading")&&(document.querySelector(".matrixLoading").style.visibility="hidden",document.querySelector(".matrixLoading").style.display="none")}),1500)},updated:function(){}},br=wr,Ar=(a("8f89"),Object(m["a"])(br,r,n,!1,null,null,null));e["default"]=Ar.exports},ae7d:function(t,e,a){t.exports=a.p+"img/node.cac6f4f6.gif"},af60:function(t,e,a){"use strict";a("609a")},b335:function(t,e,a){t.exports=a.p+"img/aquaria-menu.1a89fbab.svg"},b3c8:function(t,e,a){(function(t){a("ac1f"),a("5319"),t.fn.digits=function(){return this.each((function(){t(this).text(t(this).text().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,"))}))},t(document).ready((function(){t("#protein_syn_input, #organism_syn_input").focus((function(){t(".infocus").removeClass("infocus"),t("#searchByName").addClass("infocus")})),t("#help3D").hide()})),t((function(){t(document).tooltip({position:{my:"right top+15",at:"right center",collision:"none"}},{show:{delay:1200}})}))}).call(this,a("1157"))},be77:function(t,e,a){"use strict";a("4481")},c48f:function(t,e,a){},d2f8:function(t,e,a){"use strict";a("4ace")},e1df:function(t,e,a){},e26a:function(t,e,a){},e352:function(t,e,a){},e5d1:function(t,e,a){},ea62:function(t,e,a){},f760:function(t,e,a){"use strict";a("8f69")},fc7c:function(t,e,a){"use strict";a("e352")}}]);
//# sourceMappingURL=wrapper.7638d0f5.js.map