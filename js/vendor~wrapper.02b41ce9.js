(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["vendor~wrapper"],{"0073":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DiscrError=void 0,function(e){e["Tag"]="tag",e["Mapping"]="mapping"}(t.DiscrError||(t.DiscrError={}))},"02a1":function(e,t,n){"use strict";(function(e){var n={name:"ExpandableTextLine",props:{useClick:Boolean,forceExpand:Boolean,duration:{type:Number,default:.2},collapseTextOnLeaveRatio:{type:Number,default:1}},data:function(){return{expandedClass:"__extl-expanded",timeoutOnCollapse:null,timeoutOnExpand:null,touch:!1,initialH:null,initialW:null}},computed:{shouldHover:function(){return!this.useClick&&!this.touch},style:function(){return{transitionDuration:this.duration+"s"}}},mounted:function(){this.manageWidth(),this.addClickOrTouchListener()},methods:{click:function(){var e=this.$refs["text-line"];e.classList.contains(this.expandedClass)?this.collapse():this.expand()},expand:function(){var e=this.$refs["text-line"];if(!this.forceExpand||!e.classList.contains(this.expandedClass)){var t=this.dimensionsForExpand(e);clearTimeout(this.timeoutOnCollapse),e.style.height=t.expandHeight,e.style.whiteSpace="unset",e.classList.add(this.expandedClass),this.$emit("start-expand"),this.timeoutOnExpand=setTimeout((function(){e.style.height="auto"}),1e3*this.duration)}},collapse:function(){var e=this;if(!this.forceExpand){var t=this.$refs["text-line"],n=this.dimensionsForCollapse(t);clearTimeout(this.timeoutOnExpand),setTimeout((function(){t.style.height=n.collapseHeight,t.scroll({top:0,behavior:"smooth"}),e.$emit("start-collaps"),e.timeoutOnCollapse=setTimeout((function(){t.style.whiteSpace=null,t.classList.remove(e.expandedClass),t.scrollTop=0,t.style.height=null}),1e3*e.duration*e.collapseTextOnLeaveRatio)}))}},dimensionsForExpand:function(e,t){var n=getComputedStyle(e),i=n.height,r=n.width,o=i,s=r,a=e.style.height;e.style.height="auto",e.style.whiteSpace="initial",e.classList.add(this.expandedClass);var l=getComputedStyle(e),u=l.height,c=l.width;return e.style.whiteSpace=null,e.style.height=t?a:o,e.classList.remove(this.expandedClass),getComputedStyle(e).height,{collapseWidth:s,expandWidth:c,collapseHeight:o,expandHeight:u}},dimensionsForCollapse:function(e){var t=getComputedStyle(e),n=t.height,i=t.width,r=t.whiteSpace,o=n,s=i;e.style.height=null,e.style.whiteSpace="nowrap",e.classList.remove(this.expandedClass);var a=getComputedStyle(e),l=a.height,u=a.width;return e.style.whiteSpace=r,e.style.height=o,e.classList.add(this.expandedClass),getComputedStyle(e).height,{collapseWidth:u,expandWidth:s,collapseHeight:l,expandHeight:o}},manageWidth:function(){var e=this,t=this.$refs["text-line"];if(t){var n=this.dimensionsForExpand(t,!0);n.collapseWidth!==n.expandWidth&&(console.warn("ExpandableTextLine: The parent width does not seem to be set explicitly. Therefore, the maximum width of the collapsed line must be set on the fly to match the natural dimensions in the expanded state. This can potentially affect performance. Please consider explicitly setting the width of the parent element or the width of the line itself."),t.style.width=n.expandWidth,window.addEventListener("resize",(function(){setTimeout((function(){requestAnimationFrame((function(){e.setMaxWidth(t)}))}),10)})))}},setMaxWidth:function(e){var t=e.style.width;if(e.style.width=null,e.classList.contains(this.expandedClass))e.style.width=getComputedStyle(e).width;else{var n=this.dimensionsForExpand(e);n.collapseWidth!==n.expandWidth?e.style.width=n.expandWidth:e.style.width=t}},addClickOrTouchListener:function(){document.addEventListener("touchstart",this.onFirstTouch),document.addEventListener("click",this.onFirstClick)},onFirstTouch:function(e){var t=this;this.touch=!0,document.removeEventListener("click",this.leaveOnClickOutside),document.removeEventListener("touchstart",this.onFirstTouch),document.addEventListener("touchstart",(function(e){t.leaveOnClickOutside(e)})),this.leaveOnClickOutside(e)},onFirstClick:function(e){var t=this;document.removeEventListener("click",this.onFirstClick),this.touch||(document.removeEventListener("touchstart",this.onFirstTouch),document.addEventListener("click",(function(e){t.leaveOnClickOutside(e)})),this.leaveOnClickOutside(e))},leaveOnClickOutside:function(e){if(!this.forceExpand){var t=this.$refs["text-line"];t&&!t.contains(e.target)&&t.classList.contains(this.expandedClass)&&this.collapse()}}}};function i(e,t,n,i,r,o,s,a,l,u){"boolean"!==typeof s&&(l=a,a=s,s=!1);var c,h="function"===typeof n?n.options:n;if(e&&e.render&&(h.render=e.render,h.staticRenderFns=e.staticRenderFns,h._compiled=!0,r&&(h.functional=!0)),i&&(h._scopeId=i),o?(c=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,l(e)),e&&e._registeredComponents&&e._registeredComponents.add(o)},h._ssrRegister=c):t&&(c=s?function(e){t.call(this,u(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,a(e))}),c)if(h.functional){var d=h.render;h.render=function(e,t){return c.call(t),d(e,t)}}else{var p=h.beforeCreate;h.beforeCreate=p?[].concat(p,c):[c]}return n}var r,o="undefined"!==typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());function s(e){return function(e,t){return l(e,t)}}var a={};function l(e,t){var n=o?t.media||"default":e,i=a[n]||(a[n]={ids:new Set,styles:[]});if(!i.ids.has(e)){i.ids.add(e);var s=t.source;if(t.map&&(s+="\n/*# sourceURL="+t.map.sources[0]+" */",s+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t.map))))+" */"),i.element||(i.element=document.createElement("style"),i.element.type="text/css",t.media&&i.element.setAttribute("media",t.media),void 0===r&&(r=document.head||document.getElementsByTagName("head")[0]),r.appendChild(i.element)),"styleSheet"in i.element)i.styles.push(s),i.element.styleSheet.cssText=i.styles.filter(Boolean).join("\n");else{var l=i.ids.size-1,u=document.createTextNode(s),c=i.element.childNodes;c[l]&&i.element.removeChild(c[l]),c.length?i.element.insertBefore(u,c[l]):i.element.appendChild(u)}}}var u=n,c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",e._g({ref:"text-line",staticClass:"expandable-text-line",style:e.style},e.shouldHover?{mouseenter:e.expand,mouseleave:e.collapse}:{click:e.click}),[e._t("default")],2)},h=[];c._withStripped=!0;var d=function(e){e&&(e("data-v-bee853a2_0",{source:"\n*[data-v-bee853a2] {\n  will-change: height;\n  transform: translateZ(0);\n  backface-visibility: hidden;\n  perspective: 1000px;\n}\n",map:{version:3,sources:["/Users/maxim/PROJECTs/job/vue-expandable-text-line/src/ExpandableTextLine.vue"],names:[],mappings:";AAyNA;EACA,mBAAA;EACA,wBAAA;EACA,2BAAA;EACA,mBAAA;AACA",file:"ExpandableTextLine.vue",sourcesContent:["<template>\n  <div ref=\"text-line\"\n       class=\"expandable-text-line\"\n       :style=\"style\"\n       v-on=\"shouldHover ? { mouseenter: expand, mouseleave: collapse } : { click }\">\n    <slot />\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'ExpandableTextLine',\n\n  props: {\n    useClick: Boolean,\n    forceExpand: Boolean,\n    duration: { type: Number, default: 0.2 },\n    collapseTextOnLeaveRatio: { type: Number, default: 1 }\n  },\n\n  data () {\n    return {\n      expandedClass: '__extl-expanded',\n      timeoutOnCollapse: null,\n      timeoutOnExpand: null,\n      touch: false,\n      initialH: null,\n      initialW: null\n    }\n  },\n\n  computed: {\n    shouldHover () {\n      return !this.useClick && !this.touch\n    },\n    style () {\n      return {\n        transitionDuration: `${this.duration}s`\n      }\n    }\n  },\n\n  mounted () {\n    this.manageWidth()\n    this.addClickOrTouchListener()\n  },\n\n  methods: {\n    click () {\n      const el = this.$refs['text-line']\n      if (!el.classList.contains(this.expandedClass)) {\n        this.expand()\n      } else {\n        this.collapse()\n      }\n    },\n\n    expand () {\n      /** @type HTMLElement */\n      const el = this.$refs['text-line']\n      if (this.forceExpand && el.classList.contains(this.expandedClass)) return\n      const dimensions = this.dimensionsForExpand(el)\n      clearTimeout(this.timeoutOnCollapse)\n      el.style.height = dimensions.expandHeight\n      el.style.whiteSpace = 'unset'\n      el.classList.add(this.expandedClass)\n      this.$emit('start-expand')\n      this.timeoutOnExpand = setTimeout(() => {\n        el.style.height = 'auto'\n      }, this.duration * 1000)\n    },\n\n    collapse () {\n      if (this.forceExpand) return\n      const el = this.$refs['text-line']\n      const dimensions = this.dimensionsForCollapse(el)\n      clearTimeout(this.timeoutOnExpand)\n      setTimeout(() => {\n        el.style.height = dimensions.collapseHeight\n        el.scroll({ top: 0, behavior: 'smooth' })\n        this.$emit('start-collaps')\n        this.timeoutOnCollapse = setTimeout(() => {\n          el.style.whiteSpace = null\n          el.classList.remove(this.expandedClass)\n          el.scrollTop = 0\n          el.style.height = null\n        }, this.duration * 1000 * this.collapseTextOnLeaveRatio)\n      })\n    },\n\n    /**\n     * @param {HTMLElement} lineEl\n     * @param {boolean} resetH\n     * @return {{collapseWidth:string, expandWidth:string, collapseHeight:string, expandHeight:string}}\n     */\n    dimensionsForExpand (lineEl, resetH) {\n      let { height, width } = getComputedStyle(lineEl)\n      const collapseHeight = height\n      const collapseWidth = width\n      const preH = lineEl.style.height\n\n      lineEl.style.height = 'auto'\n      lineEl.style.whiteSpace = 'initial'\n      lineEl.classList.add(this.expandedClass)\n\n      const expandRect = getComputedStyle(lineEl)\n      const expandHeight = expandRect.height\n      const expandWidth = expandRect.width\n\n      lineEl.style.whiteSpace = null\n      lineEl.style.height = resetH ? preH : collapseHeight\n      lineEl.classList.remove(this.expandedClass)\n      // Force repaint to make sure the animation is triggered correctly.\n      // eslint-disable-next-line no-unused-expressions\n      getComputedStyle(lineEl).height\n\n      return { collapseWidth, expandWidth, collapseHeight, expandHeight }\n    },\n\n    /**\n     * @param {HTMLElement} lineEl\n     * @return {{collapseWidth:string, expandWidth:string, collapseHeight:string, expandHeight:string}}\n     */\n    dimensionsForCollapse (lineEl) {\n      let { height, width, whiteSpace } = getComputedStyle(lineEl)\n      const expandHeight = height\n      const expandWidth = width\n\n      lineEl.style.height = null\n      lineEl.style.whiteSpace = 'nowrap'\n      lineEl.classList.remove(this.expandedClass)\n\n      const collapseRect = getComputedStyle(lineEl)\n      const collapseHeight = collapseRect.height\n      const collapseWidth = collapseRect.width\n\n      lineEl.style.whiteSpace = whiteSpace\n      lineEl.style.height = expandHeight\n      lineEl.classList.add(this.expandedClass)\n\n      // eslint-disable-next-line no-unused-expressions\n      getComputedStyle(lineEl).height\n\n      return { collapseWidth, expandWidth, collapseHeight, expandHeight }\n    },\n\n    manageWidth () {\n      const el = this.$refs['text-line']\n      if (!el) return\n      const dimensions = this.dimensionsForExpand(el, true)\n      if (dimensions.collapseWidth !== dimensions.expandWidth) {\n      // this could be a case when the line's paren doesn't have an explicit width\n      // make sure that the line will be the same width in both states (expanded & collapsed)\n        console.warn(`ExpandableTextLine: The parent width does not seem to be set explicitly. Therefore, the maximum width of the collapsed line must be set on the fly to match the natural dimensions in the expanded state. This can potentially affect performance. Please consider explicitly setting the width of the parent element or the width of the line itself.`)\n        el.style.width = dimensions.expandWidth\n        window.addEventListener('resize', () => {\n          setTimeout(() => {\n            requestAnimationFrame(() => { this.setMaxWidth(el) })\n          }, 10)\n        })\n      }\n    },\n\n    setMaxWidth (el) {\n      const preW = el.style.width\n      el.style.width = null\n      if (el.classList.contains(this.expandedClass)) {\n        el.style.width = getComputedStyle(el).width\n      } else {\n        const dim = this.dimensionsForExpand(el)\n        if (dim.collapseWidth !== dim.expandWidth) {\n          el.style.width = dim.expandWidth\n        } else {\n          el.style.width = preW\n        }\n      }\n    },\n\n    addClickOrTouchListener () {\n      document.addEventListener('touchstart', this.onFirstTouch)\n      document.addEventListener('click', this.onFirstClick)\n    },\n\n    onFirstTouch (e) {\n      this.touch = true\n      document.removeEventListener('click', this.leaveOnClickOutside)\n      document.removeEventListener('touchstart', this.onFirstTouch)\n      document.addEventListener('touchstart', e => {\n        this.leaveOnClickOutside(e)\n      })\n      this.leaveOnClickOutside(e)\n    },\n\n    onFirstClick (e) {\n      document.removeEventListener('click', this.onFirstClick)\n      if (!this.touch) {\n        document.removeEventListener('touchstart', this.onFirstTouch)\n        document.addEventListener('click', e => {\n          this.leaveOnClickOutside(e)\n        })\n        this.leaveOnClickOutside(e)\n      }\n    },\n\n    leaveOnClickOutside (event) {\n      if (this.forceExpand) return\n      const el = this.$refs['text-line']\n      if (!el) return\n      if (!el.contains(event.target) &&\n           el.classList.contains(this.expandedClass)) {\n        this.collapse()\n      }\n    }\n  }\n}\n<\/script>\n<style scoped>\n* {\n  will-change: height;\n  transform: translateZ(0);\n  backface-visibility: hidden;\n  perspective: 1000px;\n}\n</style>\n<style lang=\"scss\">\n  $blocks: p, h1, h2, h3, h4, h5, h6, ol, ul, pre, address, blockquote, dl, div, fieldset, form, hr, noscript, table;\n  @mixin all-blocks {\n    @each $el in $blocks {\n      #{$el} { @content }\n    }\n  }\n\n  .expandable-text-line {\n    box-sizing: border-box;\n    white-space: nowrap;\n    text-overflow: ellipsis;\n    overflow: hidden;\n    cursor: pointer;\n    width: 100%;\n    max-width: 100vw;\n    transition: height 0.1s;\n\n    @include all-blocks {\n      display: inline;\n\n      &:not(:first-child)::before {\n        content: \"\\00a0 \"\n      }\n      &:not(:last-child)::after {\n        content: \"\\00a0 \"\n      }\n    }\n\n    br {\n      display: none;\n    }\n\n    &.__extl-expanded {\n      max-height: 100%;\n      overflow: auto;\n      cursor: auto;\n\n      @include all-blocks {\n        display: block;\n\n        &:before {\n          content: none\n        }\n\n        &:first-child {\n          margin-top: 0;\n        }\n      }\n\n      br {\n        display: inline;\n      }\n    }\n  }\n</style>\n"]},media:void 0}),e("data-v-bee853a2_1",{source:'@charset "UTF-8";\n.expandable-text-line {\n  box-sizing: border-box;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  cursor: pointer;\n  width: 100%;\n  max-width: 100vw;\n  transition: height 0.1s;\n}\n.expandable-text-line p {\n  display: inline;\n}\n.expandable-text-line p:not(:first-child)::before {\n  content: " ";\n}\n.expandable-text-line p:not(:last-child)::after {\n  content: " ";\n}\n.expandable-text-line h1 {\n  display: inline;\n}\n.expandable-text-line h1:not(:first-child)::before {\n  content: " ";\n}\n.expandable-text-line h1:not(:last-child)::after {\n  content: " ";\n}\n.expandable-text-line h2 {\n  display: inline;\n}\n.expandable-text-line h2:not(:first-child)::before {\n  content: " ";\n}\n.expandable-text-line h2:not(:last-child)::after {\n  content: " ";\n}\n.expandable-text-line h3 {\n  display: inline;\n}\n.expandable-text-line h3:not(:first-child)::before {\n  content: " ";\n}\n.expandable-text-line h3:not(:last-child)::after {\n  content: " ";\n}\n.expandable-text-line h4 {\n  display: inline;\n}\n.expandable-text-line h4:not(:first-child)::before {\n  content: " ";\n}\n.expandable-text-line h4:not(:last-child)::after {\n  content: " ";\n}\n.expandable-text-line h5 {\n  display: inline;\n}\n.expandable-text-line h5:not(:first-child)::before {\n  content: " ";\n}\n.expandable-text-line h5:not(:last-child)::after {\n  content: " ";\n}\n.expandable-text-line h6 {\n  display: inline;\n}\n.expandable-text-line h6:not(:first-child)::before {\n  content: " ";\n}\n.expandable-text-line h6:not(:last-child)::after {\n  content: " ";\n}\n.expandable-text-line ol {\n  display: inline;\n}\n.expandable-text-line ol:not(:first-child)::before {\n  content: " ";\n}\n.expandable-text-line ol:not(:last-child)::after {\n  content: " ";\n}\n.expandable-text-line ul {\n  display: inline;\n}\n.expandable-text-line ul:not(:first-child)::before {\n  content: " ";\n}\n.expandable-text-line ul:not(:last-child)::after {\n  content: " ";\n}\n.expandable-text-line pre {\n  display: inline;\n}\n.expandable-text-line pre:not(:first-child)::before {\n  content: " ";\n}\n.expandable-text-line pre:not(:last-child)::after {\n  content: " ";\n}\n.expandable-text-line address {\n  display: inline;\n}\n.expandable-text-line address:not(:first-child)::before {\n  content: " ";\n}\n.expandable-text-line address:not(:last-child)::after {\n  content: " ";\n}\n.expandable-text-line blockquote {\n  display: inline;\n}\n.expandable-text-line blockquote:not(:first-child)::before {\n  content: " ";\n}\n.expandable-text-line blockquote:not(:last-child)::after {\n  content: " ";\n}\n.expandable-text-line dl {\n  display: inline;\n}\n.expandable-text-line dl:not(:first-child)::before {\n  content: " ";\n}\n.expandable-text-line dl:not(:last-child)::after {\n  content: " ";\n}\n.expandable-text-line div {\n  display: inline;\n}\n.expandable-text-line div:not(:first-child)::before {\n  content: " ";\n}\n.expandable-text-line div:not(:last-child)::after {\n  content: " ";\n}\n.expandable-text-line fieldset {\n  display: inline;\n}\n.expandable-text-line fieldset:not(:first-child)::before {\n  content: " ";\n}\n.expandable-text-line fieldset:not(:last-child)::after {\n  content: " ";\n}\n.expandable-text-line form {\n  display: inline;\n}\n.expandable-text-line form:not(:first-child)::before {\n  content: " ";\n}\n.expandable-text-line form:not(:last-child)::after {\n  content: " ";\n}\n.expandable-text-line hr {\n  display: inline;\n}\n.expandable-text-line hr:not(:first-child)::before {\n  content: " ";\n}\n.expandable-text-line hr:not(:last-child)::after {\n  content: " ";\n}\n.expandable-text-line noscript {\n  display: inline;\n}\n.expandable-text-line noscript:not(:first-child)::before {\n  content: " ";\n}\n.expandable-text-line noscript:not(:last-child)::after {\n  content: " ";\n}\n.expandable-text-line table {\n  display: inline;\n}\n.expandable-text-line table:not(:first-child)::before {\n  content: " ";\n}\n.expandable-text-line table:not(:last-child)::after {\n  content: " ";\n}\n.expandable-text-line br {\n  display: none;\n}\n.expandable-text-line.__extl-expanded {\n  max-height: 100%;\n  overflow: auto;\n  cursor: auto;\n}\n.expandable-text-line.__extl-expanded p {\n  display: block;\n}\n.expandable-text-line.__extl-expanded p:before {\n  content: none;\n}\n.expandable-text-line.__extl-expanded p:first-child {\n  margin-top: 0;\n}\n.expandable-text-line.__extl-expanded h1 {\n  display: block;\n}\n.expandable-text-line.__extl-expanded h1:before {\n  content: none;\n}\n.expandable-text-line.__extl-expanded h1:first-child {\n  margin-top: 0;\n}\n.expandable-text-line.__extl-expanded h2 {\n  display: block;\n}\n.expandable-text-line.__extl-expanded h2:before {\n  content: none;\n}\n.expandable-text-line.__extl-expanded h2:first-child {\n  margin-top: 0;\n}\n.expandable-text-line.__extl-expanded h3 {\n  display: block;\n}\n.expandable-text-line.__extl-expanded h3:before {\n  content: none;\n}\n.expandable-text-line.__extl-expanded h3:first-child {\n  margin-top: 0;\n}\n.expandable-text-line.__extl-expanded h4 {\n  display: block;\n}\n.expandable-text-line.__extl-expanded h4:before {\n  content: none;\n}\n.expandable-text-line.__extl-expanded h4:first-child {\n  margin-top: 0;\n}\n.expandable-text-line.__extl-expanded h5 {\n  display: block;\n}\n.expandable-text-line.__extl-expanded h5:before {\n  content: none;\n}\n.expandable-text-line.__extl-expanded h5:first-child {\n  margin-top: 0;\n}\n.expandable-text-line.__extl-expanded h6 {\n  display: block;\n}\n.expandable-text-line.__extl-expanded h6:before {\n  content: none;\n}\n.expandable-text-line.__extl-expanded h6:first-child {\n  margin-top: 0;\n}\n.expandable-text-line.__extl-expanded ol {\n  display: block;\n}\n.expandable-text-line.__extl-expanded ol:before {\n  content: none;\n}\n.expandable-text-line.__extl-expanded ol:first-child {\n  margin-top: 0;\n}\n.expandable-text-line.__extl-expanded ul {\n  display: block;\n}\n.expandable-text-line.__extl-expanded ul:before {\n  content: none;\n}\n.expandable-text-line.__extl-expanded ul:first-child {\n  margin-top: 0;\n}\n.expandable-text-line.__extl-expanded pre {\n  display: block;\n}\n.expandable-text-line.__extl-expanded pre:before {\n  content: none;\n}\n.expandable-text-line.__extl-expanded pre:first-child {\n  margin-top: 0;\n}\n.expandable-text-line.__extl-expanded address {\n  display: block;\n}\n.expandable-text-line.__extl-expanded address:before {\n  content: none;\n}\n.expandable-text-line.__extl-expanded address:first-child {\n  margin-top: 0;\n}\n.expandable-text-line.__extl-expanded blockquote {\n  display: block;\n}\n.expandable-text-line.__extl-expanded blockquote:before {\n  content: none;\n}\n.expandable-text-line.__extl-expanded blockquote:first-child {\n  margin-top: 0;\n}\n.expandable-text-line.__extl-expanded dl {\n  display: block;\n}\n.expandable-text-line.__extl-expanded dl:before {\n  content: none;\n}\n.expandable-text-line.__extl-expanded dl:first-child {\n  margin-top: 0;\n}\n.expandable-text-line.__extl-expanded div {\n  display: block;\n}\n.expandable-text-line.__extl-expanded div:before {\n  content: none;\n}\n.expandable-text-line.__extl-expanded div:first-child {\n  margin-top: 0;\n}\n.expandable-text-line.__extl-expanded fieldset {\n  display: block;\n}\n.expandable-text-line.__extl-expanded fieldset:before {\n  content: none;\n}\n.expandable-text-line.__extl-expanded fieldset:first-child {\n  margin-top: 0;\n}\n.expandable-text-line.__extl-expanded form {\n  display: block;\n}\n.expandable-text-line.__extl-expanded form:before {\n  content: none;\n}\n.expandable-text-line.__extl-expanded form:first-child {\n  margin-top: 0;\n}\n.expandable-text-line.__extl-expanded hr {\n  display: block;\n}\n.expandable-text-line.__extl-expanded hr:before {\n  content: none;\n}\n.expandable-text-line.__extl-expanded hr:first-child {\n  margin-top: 0;\n}\n.expandable-text-line.__extl-expanded noscript {\n  display: block;\n}\n.expandable-text-line.__extl-expanded noscript:before {\n  content: none;\n}\n.expandable-text-line.__extl-expanded noscript:first-child {\n  margin-top: 0;\n}\n.expandable-text-line.__extl-expanded table {\n  display: block;\n}\n.expandable-text-line.__extl-expanded table:before {\n  content: none;\n}\n.expandable-text-line.__extl-expanded table:first-child {\n  margin-top: 0;\n}\n.expandable-text-line.__extl-expanded br {\n  display: inline;\n}\n\n/*# sourceMappingURL=ExpandableTextLine.vue.map */',map:{version:3,sources:["ExpandableTextLine.vue","/Users/maxim/PROJECTs/job/vue-expandable-text-line/src/ExpandableTextLine.vue"],names:[],mappings:"AAAA,gBAAgB;ACwOhB;EACA,sBAAA;EACA,mBAAA;EACA,uBAAA;EACA,gBAAA;EACA,eAAA;EACA,WAAA;EACA,gBAAA;EACA,uBAAA;ADtOA;AC0NA;EAeA,eAAA;ADtOA;ACwOA;EACA,YAAA;ADtOA;ACwOA;EACA,YAAA;ADtOA;ACiNA;EAeA,eAAA;AD7NA;AC+NA;EACA,YAAA;AD7NA;AC+NA;EACA,YAAA;AD7NA;ACwMA;EAeA,eAAA;ADpNA;ACsNA;EACA,YAAA;ADpNA;ACsNA;EACA,YAAA;ADpNA;AC+LA;EAeA,eAAA;AD3MA;AC6MA;EACA,YAAA;AD3MA;AC6MA;EACA,YAAA;AD3MA;ACsLA;EAeA,eAAA;ADlMA;ACoMA;EACA,YAAA;ADlMA;ACoMA;EACA,YAAA;ADlMA;AC6KA;EAeA,eAAA;ADzLA;AC2LA;EACA,YAAA;ADzLA;AC2LA;EACA,YAAA;ADzLA;ACoKA;EAeA,eAAA;ADhLA;ACkLA;EACA,YAAA;ADhLA;ACkLA;EACA,YAAA;ADhLA;AC2JA;EAeA,eAAA;ADvKA;ACyKA;EACA,YAAA;ADvKA;ACyKA;EACA,YAAA;ADvKA;ACkJA;EAeA,eAAA;AD9JA;ACgKA;EACA,YAAA;AD9JA;ACgKA;EACA,YAAA;AD9JA;ACyIA;EAeA,eAAA;ADrJA;ACuJA;EACA,YAAA;ADrJA;ACuJA;EACA,YAAA;ADrJA;ACgIA;EAeA,eAAA;AD5IA;AC8IA;EACA,YAAA;AD5IA;AC8IA;EACA,YAAA;AD5IA;ACuHA;EAeA,eAAA;ADnIA;ACqIA;EACA,YAAA;ADnIA;ACqIA;EACA,YAAA;ADnIA;AC8GA;EAeA,eAAA;AD1HA;AC4HA;EACA,YAAA;AD1HA;AC4HA;EACA,YAAA;AD1HA;ACqGA;EAeA,eAAA;ADjHA;ACmHA;EACA,YAAA;ADjHA;ACmHA;EACA,YAAA;ADjHA;AC4FA;EAeA,eAAA;ADxGA;AC0GA;EACA,YAAA;ADxGA;AC0GA;EACA,YAAA;ADxGA;ACmFA;EAeA,eAAA;AD/FA;ACiGA;EACA,YAAA;AD/FA;ACiGA;EACA,YAAA;AD/FA;AC0EA;EAeA,eAAA;ADtFA;ACwFA;EACA,YAAA;ADtFA;ACwFA;EACA,YAAA;ADtFA;ACiEA;EAeA,eAAA;AD7EA;AC+EA;EACA,YAAA;AD7EA;AC+EA;EACA,YAAA;AD7EA;ACwDA;EAeA,eAAA;ADpEA;ACsEA;EACA,YAAA;ADpEA;ACsEA;EACA,YAAA;ADpEA;ACwEA;EACA,aAAA;ADtEA;ACyEA;EACA,gBAAA;EACA,cAAA;EACA,YAAA;ADvEA;ACuCA;EAmCA,cAAA;ADvEA;ACyEA;EACA,aAAA;ADvEA;AC0EA;EACA,aAAA;ADxEA;AC8BA;EAmCA,cAAA;AD9DA;ACgEA;EACA,aAAA;AD9DA;ACiEA;EACA,aAAA;AD/DA;ACqBA;EAmCA,cAAA;ADrDA;ACuDA;EACA,aAAA;ADrDA;ACwDA;EACA,aAAA;ADtDA;ACYA;EAmCA,cAAA;AD5CA;AC8CA;EACA,aAAA;AD5CA;AC+CA;EACA,aAAA;AD7CA;ACGA;EAmCA,cAAA;ADnCA;ACqCA;EACA,aAAA;ADnCA;ACsCA;EACA,aAAA;ADpCA;ACNA;EAmCA,cAAA;AD1BA;AC4BA;EACA,aAAA;AD1BA;AC6BA;EACA,aAAA;AD3BA;ACfA;EAmCA,cAAA;ADjBA;ACmBA;EACA,aAAA;ADjBA;ACoBA;EACA,aAAA;ADlBA;ACxBA;EAmCA,cAAA;ADRA;ACUA;EACA,aAAA;ADRA;ACWA;EACA,aAAA;ADTA;ACjCA;EAmCA,cAAA;ADCA;ACCA;EACA,aAAA;ADCA;ACEA;EACA,aAAA;ADAA;AC1CA;EAmCA,cAAA;ADUA;ACRA;EACA,aAAA;ADUA;ACPA;EACA,aAAA;ADSA;ACnDA;EAmCA,cAAA;ADmBA;ACjBA;EACA,aAAA;ADmBA;AChBA;EACA,aAAA;ADkBA;AC5DA;EAmCA,cAAA;AD4BA;AC1BA;EACA,aAAA;AD4BA;ACzBA;EACA,aAAA;AD2BA;ACrEA;EAmCA,cAAA;ADqCA;ACnCA;EACA,aAAA;ADqCA;AClCA;EACA,aAAA;ADoCA;AC9EA;EAmCA,cAAA;AD8CA;AC5CA;EACA,aAAA;AD8CA;AC3CA;EACA,aAAA;AD6CA;ACvFA;EAmCA,cAAA;ADuDA;ACrDA;EACA,aAAA;ADuDA;ACpDA;EACA,aAAA;ADsDA;AChGA;EAmCA,cAAA;ADgEA;AC9DA;EACA,aAAA;ADgEA;AC7DA;EACA,aAAA;AD+DA;ACzGA;EAmCA,cAAA;ADyEA;ACvEA;EACA,aAAA;ADyEA;ACtEA;EACA,aAAA;ADwEA;AClHA;EAmCA,cAAA;ADkFA;AChFA;EACA,aAAA;ADkFA;AC/EA;EACA,aAAA;ADiFA;AC3HA;EAmCA,cAAA;AD2FA;ACzFA;EACA,aAAA;AD2FA;ACxFA;EACA,aAAA;AD0FA;ACtFA;EACA,eAAA;ADwFA;;AAEA,iDAAiD",file:"ExpandableTextLine.vue",sourcesContent:['@charset "UTF-8";\n.expandable-text-line {\n  box-sizing: border-box;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  cursor: pointer;\n  width: 100%;\n  max-width: 100vw;\n  transition: height 0.1s;\n}\n.expandable-text-line p {\n  display: inline;\n}\n.expandable-text-line p:not(:first-child)::before {\n  content: " ";\n}\n.expandable-text-line p:not(:last-child)::after {\n  content: " ";\n}\n.expandable-text-line h1 {\n  display: inline;\n}\n.expandable-text-line h1:not(:first-child)::before {\n  content: " ";\n}\n.expandable-text-line h1:not(:last-child)::after {\n  content: " ";\n}\n.expandable-text-line h2 {\n  display: inline;\n}\n.expandable-text-line h2:not(:first-child)::before {\n  content: " ";\n}\n.expandable-text-line h2:not(:last-child)::after {\n  content: " ";\n}\n.expandable-text-line h3 {\n  display: inline;\n}\n.expandable-text-line h3:not(:first-child)::before {\n  content: " ";\n}\n.expandable-text-line h3:not(:last-child)::after {\n  content: " ";\n}\n.expandable-text-line h4 {\n  display: inline;\n}\n.expandable-text-line h4:not(:first-child)::before {\n  content: " ";\n}\n.expandable-text-line h4:not(:last-child)::after {\n  content: " ";\n}\n.expandable-text-line h5 {\n  display: inline;\n}\n.expandable-text-line h5:not(:first-child)::before {\n  content: " ";\n}\n.expandable-text-line h5:not(:last-child)::after {\n  content: " ";\n}\n.expandable-text-line h6 {\n  display: inline;\n}\n.expandable-text-line h6:not(:first-child)::before {\n  content: " ";\n}\n.expandable-text-line h6:not(:last-child)::after {\n  content: " ";\n}\n.expandable-text-line ol {\n  display: inline;\n}\n.expandable-text-line ol:not(:first-child)::before {\n  content: " ";\n}\n.expandable-text-line ol:not(:last-child)::after {\n  content: " ";\n}\n.expandable-text-line ul {\n  display: inline;\n}\n.expandable-text-line ul:not(:first-child)::before {\n  content: " ";\n}\n.expandable-text-line ul:not(:last-child)::after {\n  content: " ";\n}\n.expandable-text-line pre {\n  display: inline;\n}\n.expandable-text-line pre:not(:first-child)::before {\n  content: " ";\n}\n.expandable-text-line pre:not(:last-child)::after {\n  content: " ";\n}\n.expandable-text-line address {\n  display: inline;\n}\n.expandable-text-line address:not(:first-child)::before {\n  content: " ";\n}\n.expandable-text-line address:not(:last-child)::after {\n  content: " ";\n}\n.expandable-text-line blockquote {\n  display: inline;\n}\n.expandable-text-line blockquote:not(:first-child)::before {\n  content: " ";\n}\n.expandable-text-line blockquote:not(:last-child)::after {\n  content: " ";\n}\n.expandable-text-line dl {\n  display: inline;\n}\n.expandable-text-line dl:not(:first-child)::before {\n  content: " ";\n}\n.expandable-text-line dl:not(:last-child)::after {\n  content: " ";\n}\n.expandable-text-line div {\n  display: inline;\n}\n.expandable-text-line div:not(:first-child)::before {\n  content: " ";\n}\n.expandable-text-line div:not(:last-child)::after {\n  content: " ";\n}\n.expandable-text-line fieldset {\n  display: inline;\n}\n.expandable-text-line fieldset:not(:first-child)::before {\n  content: " ";\n}\n.expandable-text-line fieldset:not(:last-child)::after {\n  content: " ";\n}\n.expandable-text-line form {\n  display: inline;\n}\n.expandable-text-line form:not(:first-child)::before {\n  content: " ";\n}\n.expandable-text-line form:not(:last-child)::after {\n  content: " ";\n}\n.expandable-text-line hr {\n  display: inline;\n}\n.expandable-text-line hr:not(:first-child)::before {\n  content: " ";\n}\n.expandable-text-line hr:not(:last-child)::after {\n  content: " ";\n}\n.expandable-text-line noscript {\n  display: inline;\n}\n.expandable-text-line noscript:not(:first-child)::before {\n  content: " ";\n}\n.expandable-text-line noscript:not(:last-child)::after {\n  content: " ";\n}\n.expandable-text-line table {\n  display: inline;\n}\n.expandable-text-line table:not(:first-child)::before {\n  content: " ";\n}\n.expandable-text-line table:not(:last-child)::after {\n  content: " ";\n}\n.expandable-text-line br {\n  display: none;\n}\n.expandable-text-line.__extl-expanded {\n  max-height: 100%;\n  overflow: auto;\n  cursor: auto;\n}\n.expandable-text-line.__extl-expanded p {\n  display: block;\n}\n.expandable-text-line.__extl-expanded p:before {\n  content: none;\n}\n.expandable-text-line.__extl-expanded p:first-child {\n  margin-top: 0;\n}\n.expandable-text-line.__extl-expanded h1 {\n  display: block;\n}\n.expandable-text-line.__extl-expanded h1:before {\n  content: none;\n}\n.expandable-text-line.__extl-expanded h1:first-child {\n  margin-top: 0;\n}\n.expandable-text-line.__extl-expanded h2 {\n  display: block;\n}\n.expandable-text-line.__extl-expanded h2:before {\n  content: none;\n}\n.expandable-text-line.__extl-expanded h2:first-child {\n  margin-top: 0;\n}\n.expandable-text-line.__extl-expanded h3 {\n  display: block;\n}\n.expandable-text-line.__extl-expanded h3:before {\n  content: none;\n}\n.expandable-text-line.__extl-expanded h3:first-child {\n  margin-top: 0;\n}\n.expandable-text-line.__extl-expanded h4 {\n  display: block;\n}\n.expandable-text-line.__extl-expanded h4:before {\n  content: none;\n}\n.expandable-text-line.__extl-expanded h4:first-child {\n  margin-top: 0;\n}\n.expandable-text-line.__extl-expanded h5 {\n  display: block;\n}\n.expandable-text-line.__extl-expanded h5:before {\n  content: none;\n}\n.expandable-text-line.__extl-expanded h5:first-child {\n  margin-top: 0;\n}\n.expandable-text-line.__extl-expanded h6 {\n  display: block;\n}\n.expandable-text-line.__extl-expanded h6:before {\n  content: none;\n}\n.expandable-text-line.__extl-expanded h6:first-child {\n  margin-top: 0;\n}\n.expandable-text-line.__extl-expanded ol {\n  display: block;\n}\n.expandable-text-line.__extl-expanded ol:before {\n  content: none;\n}\n.expandable-text-line.__extl-expanded ol:first-child {\n  margin-top: 0;\n}\n.expandable-text-line.__extl-expanded ul {\n  display: block;\n}\n.expandable-text-line.__extl-expanded ul:before {\n  content: none;\n}\n.expandable-text-line.__extl-expanded ul:first-child {\n  margin-top: 0;\n}\n.expandable-text-line.__extl-expanded pre {\n  display: block;\n}\n.expandable-text-line.__extl-expanded pre:before {\n  content: none;\n}\n.expandable-text-line.__extl-expanded pre:first-child {\n  margin-top: 0;\n}\n.expandable-text-line.__extl-expanded address {\n  display: block;\n}\n.expandable-text-line.__extl-expanded address:before {\n  content: none;\n}\n.expandable-text-line.__extl-expanded address:first-child {\n  margin-top: 0;\n}\n.expandable-text-line.__extl-expanded blockquote {\n  display: block;\n}\n.expandable-text-line.__extl-expanded blockquote:before {\n  content: none;\n}\n.expandable-text-line.__extl-expanded blockquote:first-child {\n  margin-top: 0;\n}\n.expandable-text-line.__extl-expanded dl {\n  display: block;\n}\n.expandable-text-line.__extl-expanded dl:before {\n  content: none;\n}\n.expandable-text-line.__extl-expanded dl:first-child {\n  margin-top: 0;\n}\n.expandable-text-line.__extl-expanded div {\n  display: block;\n}\n.expandable-text-line.__extl-expanded div:before {\n  content: none;\n}\n.expandable-text-line.__extl-expanded div:first-child {\n  margin-top: 0;\n}\n.expandable-text-line.__extl-expanded fieldset {\n  display: block;\n}\n.expandable-text-line.__extl-expanded fieldset:before {\n  content: none;\n}\n.expandable-text-line.__extl-expanded fieldset:first-child {\n  margin-top: 0;\n}\n.expandable-text-line.__extl-expanded form {\n  display: block;\n}\n.expandable-text-line.__extl-expanded form:before {\n  content: none;\n}\n.expandable-text-line.__extl-expanded form:first-child {\n  margin-top: 0;\n}\n.expandable-text-line.__extl-expanded hr {\n  display: block;\n}\n.expandable-text-line.__extl-expanded hr:before {\n  content: none;\n}\n.expandable-text-line.__extl-expanded hr:first-child {\n  margin-top: 0;\n}\n.expandable-text-line.__extl-expanded noscript {\n  display: block;\n}\n.expandable-text-line.__extl-expanded noscript:before {\n  content: none;\n}\n.expandable-text-line.__extl-expanded noscript:first-child {\n  margin-top: 0;\n}\n.expandable-text-line.__extl-expanded table {\n  display: block;\n}\n.expandable-text-line.__extl-expanded table:before {\n  content: none;\n}\n.expandable-text-line.__extl-expanded table:first-child {\n  margin-top: 0;\n}\n.expandable-text-line.__extl-expanded br {\n  display: inline;\n}\n\n/*# sourceMappingURL=ExpandableTextLine.vue.map */',"<template>\n  <div ref=\"text-line\"\n       class=\"expandable-text-line\"\n       :style=\"style\"\n       v-on=\"shouldHover ? { mouseenter: expand, mouseleave: collapse } : { click }\">\n    <slot />\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'ExpandableTextLine',\n\n  props: {\n    useClick: Boolean,\n    forceExpand: Boolean,\n    duration: { type: Number, default: 0.2 },\n    collapseTextOnLeaveRatio: { type: Number, default: 1 }\n  },\n\n  data () {\n    return {\n      expandedClass: '__extl-expanded',\n      timeoutOnCollapse: null,\n      timeoutOnExpand: null,\n      touch: false,\n      initialH: null,\n      initialW: null\n    }\n  },\n\n  computed: {\n    shouldHover () {\n      return !this.useClick && !this.touch\n    },\n    style () {\n      return {\n        transitionDuration: `${this.duration}s`\n      }\n    }\n  },\n\n  mounted () {\n    this.manageWidth()\n    this.addClickOrTouchListener()\n  },\n\n  methods: {\n    click () {\n      const el = this.$refs['text-line']\n      if (!el.classList.contains(this.expandedClass)) {\n        this.expand()\n      } else {\n        this.collapse()\n      }\n    },\n\n    expand () {\n      /** @type HTMLElement */\n      const el = this.$refs['text-line']\n      if (this.forceExpand && el.classList.contains(this.expandedClass)) return\n      const dimensions = this.dimensionsForExpand(el)\n      clearTimeout(this.timeoutOnCollapse)\n      el.style.height = dimensions.expandHeight\n      el.style.whiteSpace = 'unset'\n      el.classList.add(this.expandedClass)\n      this.$emit('start-expand')\n      this.timeoutOnExpand = setTimeout(() => {\n        el.style.height = 'auto'\n      }, this.duration * 1000)\n    },\n\n    collapse () {\n      if (this.forceExpand) return\n      const el = this.$refs['text-line']\n      const dimensions = this.dimensionsForCollapse(el)\n      clearTimeout(this.timeoutOnExpand)\n      setTimeout(() => {\n        el.style.height = dimensions.collapseHeight\n        el.scroll({ top: 0, behavior: 'smooth' })\n        this.$emit('start-collaps')\n        this.timeoutOnCollapse = setTimeout(() => {\n          el.style.whiteSpace = null\n          el.classList.remove(this.expandedClass)\n          el.scrollTop = 0\n          el.style.height = null\n        }, this.duration * 1000 * this.collapseTextOnLeaveRatio)\n      })\n    },\n\n    /**\n     * @param {HTMLElement} lineEl\n     * @param {boolean} resetH\n     * @return {{collapseWidth:string, expandWidth:string, collapseHeight:string, expandHeight:string}}\n     */\n    dimensionsForExpand (lineEl, resetH) {\n      let { height, width } = getComputedStyle(lineEl)\n      const collapseHeight = height\n      const collapseWidth = width\n      const preH = lineEl.style.height\n\n      lineEl.style.height = 'auto'\n      lineEl.style.whiteSpace = 'initial'\n      lineEl.classList.add(this.expandedClass)\n\n      const expandRect = getComputedStyle(lineEl)\n      const expandHeight = expandRect.height\n      const expandWidth = expandRect.width\n\n      lineEl.style.whiteSpace = null\n      lineEl.style.height = resetH ? preH : collapseHeight\n      lineEl.classList.remove(this.expandedClass)\n      // Force repaint to make sure the animation is triggered correctly.\n      // eslint-disable-next-line no-unused-expressions\n      getComputedStyle(lineEl).height\n\n      return { collapseWidth, expandWidth, collapseHeight, expandHeight }\n    },\n\n    /**\n     * @param {HTMLElement} lineEl\n     * @return {{collapseWidth:string, expandWidth:string, collapseHeight:string, expandHeight:string}}\n     */\n    dimensionsForCollapse (lineEl) {\n      let { height, width, whiteSpace } = getComputedStyle(lineEl)\n      const expandHeight = height\n      const expandWidth = width\n\n      lineEl.style.height = null\n      lineEl.style.whiteSpace = 'nowrap'\n      lineEl.classList.remove(this.expandedClass)\n\n      const collapseRect = getComputedStyle(lineEl)\n      const collapseHeight = collapseRect.height\n      const collapseWidth = collapseRect.width\n\n      lineEl.style.whiteSpace = whiteSpace\n      lineEl.style.height = expandHeight\n      lineEl.classList.add(this.expandedClass)\n\n      // eslint-disable-next-line no-unused-expressions\n      getComputedStyle(lineEl).height\n\n      return { collapseWidth, expandWidth, collapseHeight, expandHeight }\n    },\n\n    manageWidth () {\n      const el = this.$refs['text-line']\n      if (!el) return\n      const dimensions = this.dimensionsForExpand(el, true)\n      if (dimensions.collapseWidth !== dimensions.expandWidth) {\n      // this could be a case when the line's paren doesn't have an explicit width\n      // make sure that the line will be the same width in both states (expanded & collapsed)\n        console.warn(`ExpandableTextLine: The parent width does not seem to be set explicitly. Therefore, the maximum width of the collapsed line must be set on the fly to match the natural dimensions in the expanded state. This can potentially affect performance. Please consider explicitly setting the width of the parent element or the width of the line itself.`)\n        el.style.width = dimensions.expandWidth\n        window.addEventListener('resize', () => {\n          setTimeout(() => {\n            requestAnimationFrame(() => { this.setMaxWidth(el) })\n          }, 10)\n        })\n      }\n    },\n\n    setMaxWidth (el) {\n      const preW = el.style.width\n      el.style.width = null\n      if (el.classList.contains(this.expandedClass)) {\n        el.style.width = getComputedStyle(el).width\n      } else {\n        const dim = this.dimensionsForExpand(el)\n        if (dim.collapseWidth !== dim.expandWidth) {\n          el.style.width = dim.expandWidth\n        } else {\n          el.style.width = preW\n        }\n      }\n    },\n\n    addClickOrTouchListener () {\n      document.addEventListener('touchstart', this.onFirstTouch)\n      document.addEventListener('click', this.onFirstClick)\n    },\n\n    onFirstTouch (e) {\n      this.touch = true\n      document.removeEventListener('click', this.leaveOnClickOutside)\n      document.removeEventListener('touchstart', this.onFirstTouch)\n      document.addEventListener('touchstart', e => {\n        this.leaveOnClickOutside(e)\n      })\n      this.leaveOnClickOutside(e)\n    },\n\n    onFirstClick (e) {\n      document.removeEventListener('click', this.onFirstClick)\n      if (!this.touch) {\n        document.removeEventListener('touchstart', this.onFirstTouch)\n        document.addEventListener('click', e => {\n          this.leaveOnClickOutside(e)\n        })\n        this.leaveOnClickOutside(e)\n      }\n    },\n\n    leaveOnClickOutside (event) {\n      if (this.forceExpand) return\n      const el = this.$refs['text-line']\n      if (!el) return\n      if (!el.contains(event.target) &&\n           el.classList.contains(this.expandedClass)) {\n        this.collapse()\n      }\n    }\n  }\n}\n<\/script>\n<style scoped>\n* {\n  will-change: height;\n  transform: translateZ(0);\n  backface-visibility: hidden;\n  perspective: 1000px;\n}\n</style>\n<style lang=\"scss\">\n  $blocks: p, h1, h2, h3, h4, h5, h6, ol, ul, pre, address, blockquote, dl, div, fieldset, form, hr, noscript, table;\n  @mixin all-blocks {\n    @each $el in $blocks {\n      #{$el} { @content }\n    }\n  }\n\n  .expandable-text-line {\n    box-sizing: border-box;\n    white-space: nowrap;\n    text-overflow: ellipsis;\n    overflow: hidden;\n    cursor: pointer;\n    width: 100%;\n    max-width: 100vw;\n    transition: height 0.1s;\n\n    @include all-blocks {\n      display: inline;\n\n      &:not(:first-child)::before {\n        content: \"\\00a0 \"\n      }\n      &:not(:last-child)::after {\n        content: \"\\00a0 \"\n      }\n    }\n\n    br {\n      display: none;\n    }\n\n    &.__extl-expanded {\n      max-height: 100%;\n      overflow: auto;\n      cursor: auto;\n\n      @include all-blocks {\n        display: block;\n\n        &:before {\n          content: none\n        }\n\n        &:first-child {\n          margin-top: 0;\n        }\n      }\n\n      br {\n        display: inline;\n      }\n    }\n  }\n</style>\n"]},media:void 0}))},p="data-v-bee853a2",f=void 0,m=!1,g=i({render:c,staticRenderFns:h},d,u,p,m,f,!1,s,void 0,void 0);function v(e){v.installed||(v.installed=!0,e.component("ExpandableTextLine",g))}var y={install:v},x=null;"undefined"!==typeof window?x=window.Vue:"undefined"!==typeof e&&(x=e.Vue),x&&x.use(y),t["a"]=g}).call(this,n("c8ba"))},"04d0":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateAdditionalItems=void 0;const i=n("96ab"),r=n("417a"),o={message:({params:{len:e}})=>i.str`must NOT have more than ${e} items`,params:({params:{len:e}})=>i._`{limit: ${e}}`},s={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:o,code(e){const{parentSchema:t,it:n}=e,{items:i}=t;Array.isArray(i)?a(e,i):r.checkStrictMode(n,'"additionalItems" is ignored when "items" is not an array of schemas')}};function a(e,t){const{gen:n,schema:o,data:s,keyword:a,it:l}=e;l.items=!0;const u=n.const("len",i._`${s}.length`);if(!1===o)e.setParams({len:t.length}),e.pass(i._`${u} <= ${t.length}`);else if("object"==typeof o&&!r.alwaysValidSchema(l,o)){const r=n.var("valid",i._`${u} <= ${t.length}`);n.if(i.not(r),()=>c(r)),e.ok(r)}function c(o){n.forRange("i",t.length,u,t=>{e.subschema({keyword:a,dataProp:t,dataPropType:r.Type.Num},o),l.allErrors||n.if(i.not(o),()=>n.break())})}}t.validateAdditionalItems=a,t.default=s},"05c4":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ValueScope=t.ValueScopeName=t.Scope=t.varKinds=t.UsedValueState=void 0;const i=n("ab2c");class r extends Error{constructor(e){super(`CodeGen: "code" for ${e} not defined`),this.value=e.value}}var o;(function(e){e[e["Started"]=0]="Started",e[e["Completed"]=1]="Completed"})(o=t.UsedValueState||(t.UsedValueState={})),t.varKinds={const:new i.Name("const"),let:new i.Name("let"),var:new i.Name("var")};class s{constructor({prefixes:e,parent:t}={}){this._names={},this._prefixes=e,this._parent=t}toName(e){return e instanceof i.Name?e:this.name(e)}name(e){return new i.Name(this._newName(e))}_newName(e){const t=this._names[e]||this._nameGroup(e);return`${e}${t.index++}`}_nameGroup(e){var t,n;if((null===(n=null===(t=this._parent)||void 0===t?void 0:t._prefixes)||void 0===n?void 0:n.has(e))||this._prefixes&&!this._prefixes.has(e))throw new Error(`CodeGen: prefix "${e}" is not allowed in this scope`);return this._names[e]={prefix:e,index:0}}}t.Scope=s;class a extends i.Name{constructor(e,t){super(t),this.prefix=e}setValue(e,{property:t,itemIndex:n}){this.value=e,this.scopePath=i._`.${new i.Name(t)}[${n}]`}}t.ValueScopeName=a;const l=i._`\n`;class u extends s{constructor(e){super(e),this._values={},this._scope=e.scope,this.opts={...e,_n:e.lines?l:i.nil}}get(){return this._scope}name(e){return new a(e,this._newName(e))}value(e,t){var n;if(void 0===t.ref)throw new Error("CodeGen: ref must be passed in value");const i=this.toName(e),{prefix:r}=i,o=null!==(n=t.key)&&void 0!==n?n:t.ref;let s=this._values[r];if(s){const e=s.get(o);if(e)return e}else s=this._values[r]=new Map;s.set(o,i);const a=this._scope[r]||(this._scope[r]=[]),l=a.length;return a[l]=t.ref,i.setValue(t,{property:r,itemIndex:l}),i}getValue(e,t){const n=this._values[e];if(n)return n.get(t)}scopeRefs(e,t=this._values){return this._reduceValues(t,t=>{if(void 0===t.scopePath)throw new Error(`CodeGen: name "${t}" has no value`);return i._`${e}${t.scopePath}`})}scopeCode(e=this._values,t,n){return this._reduceValues(e,e=>{if(void 0===e.value)throw new Error(`CodeGen: name "${e}" has no value`);return e.value.code},t,n)}_reduceValues(e,n,s={},a){let l=i.nil;for(const u in e){const c=e[u];if(!c)continue;const h=s[u]=s[u]||new Map;c.forEach(e=>{if(h.has(e))return;h.set(e,o.Started);let s=n(e);if(s){const n=this.opts.es5?t.varKinds.var:t.varKinds.const;l=i._`${l}${n} ${e} = ${s};${this.opts._n}`}else{if(!(s=null===a||void 0===a?void 0:a(e)))throw new r(e);l=i._`${l}${s}${this.opts._n}`}h.set(e,o.Completed)})}return l}}t.ValueScope=u},"079c":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("3712"),r={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:e=>i.validateTuple(e,"items")};t.default=r},"07ac":function(e,t,n){var i=n("23e7"),r=n("6f53").values;i({target:"Object",stat:!0},{values:function(e){return r(e)}})},"07d6":function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},"0b16":function(e,t,n){"use strict";var i=n("1985"),r=n("35e8");function o(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}t.parse=w,t.resolve=A,t.resolveObject=S,t.format=_,t.Url=o;var s=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,l=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,u=["<",">",'"',"`"," ","\r","\n","\t"],c=["{","}","|","\\","^","`"].concat(u),h=["'"].concat(c),d=["%","/","?",";","#"].concat(h),p=["/","?","#"],f=255,m=/^[+a-z0-9A-Z_-]{0,63}$/,g=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,v={javascript:!0,"javascript:":!0},y={javascript:!0,"javascript:":!0},x={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},b=n("b383");function w(e,t,n){if(e&&r.isObject(e)&&e instanceof o)return e;var i=new o;return i.parse(e,t,n),i}function _(e){return r.isString(e)&&(e=w(e)),e instanceof o?e.format():o.prototype.format.call(e)}function A(e,t){return w(e,!1,!0).resolve(t)}function S(e,t){return e?w(e,!1,!0).resolveObject(t):t}o.prototype.parse=function(e,t,n){if(!r.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var o=e.indexOf("?"),a=-1!==o&&o<e.indexOf("#")?"?":"#",u=e.split(a),c=/\\/g;u[0]=u[0].replace(c,"/"),e=u.join(a);var w=e;if(w=w.trim(),!n&&1===e.split("#").length){var _=l.exec(w);if(_)return this.path=w,this.href=w,this.pathname=_[1],_[2]?(this.search=_[2],this.query=t?b.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var A=s.exec(w);if(A){A=A[0];var S=A.toLowerCase();this.protocol=S,w=w.substr(A.length)}if(n||A||w.match(/^\/\/[^@\/]+@[^@\/]+/)){var E="//"===w.substr(0,2);!E||A&&y[A]||(w=w.substr(2),this.slashes=!0)}if(!y[A]&&(E||A&&!x[A])){for(var M,T,C=-1,P=0;P<p.length;P++){var R=w.indexOf(p[P]);-1!==R&&(-1===C||R<C)&&(C=R)}T=-1===C?w.lastIndexOf("@"):w.lastIndexOf("@",C),-1!==T&&(M=w.slice(0,T),w=w.slice(T+1),this.auth=decodeURIComponent(M)),C=-1;for(P=0;P<d.length;P++){R=w.indexOf(d[P]);-1!==R&&(-1===C||R<C)&&(C=R)}-1===C&&(C=w.length),this.host=w.slice(0,C),w=w.slice(C),this.parseHost(),this.hostname=this.hostname||"";var L="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!L)for(var O=this.hostname.split(/\./),D=(P=0,O.length);P<D;P++){var I=O[P];if(I&&!I.match(m)){for(var N="",k=0,V=I.length;k<V;k++)I.charCodeAt(k)>127?N+="x":N+=I[k];if(!N.match(m)){var U=O.slice(0,P),F=O.slice(P+1),z=I.match(g);z&&(U.push(z[1]),F.unshift(z[2])),F.length&&(w="/"+F.join(".")+w),this.hostname=U.join(".");break}}}this.hostname.length>f?this.hostname="":this.hostname=this.hostname.toLowerCase(),L||(this.hostname=i.toASCII(this.hostname));var j=this.port?":"+this.port:"",B=this.hostname||"";this.host=B+j,this.href+=this.host,L&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==w[0]&&(w="/"+w))}if(!v[S])for(P=0,D=h.length;P<D;P++){var $=h[P];if(-1!==w.indexOf($)){var H=encodeURIComponent($);H===$&&(H=escape($)),w=w.split($).join(H)}}var G=w.indexOf("#");-1!==G&&(this.hash=w.substr(G),w=w.slice(0,G));var W=w.indexOf("?");if(-1!==W?(this.search=w.substr(W),this.query=w.substr(W+1),t&&(this.query=b.parse(this.query)),w=w.slice(0,W)):t&&(this.search="",this.query={}),w&&(this.pathname=w),x[S]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){j=this.pathname||"";var q=this.search||"";this.path=j+q}return this.href=this.format(),this},o.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",i=this.hash||"",o=!1,s="";this.host?o=e+this.host:this.hostname&&(o=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&r.isObject(this.query)&&Object.keys(this.query).length&&(s=b.stringify(this.query));var a=this.search||s&&"?"+s||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||x[t])&&!1!==o?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):o||(o=""),i&&"#"!==i.charAt(0)&&(i="#"+i),a&&"?"!==a.charAt(0)&&(a="?"+a),n=n.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})),a=a.replace("#","%23"),t+o+n+a+i},o.prototype.resolve=function(e){return this.resolveObject(w(e,!1,!0)).format()},o.prototype.resolveObject=function(e){if(r.isString(e)){var t=new o;t.parse(e,!1,!0),e=t}for(var n=new o,i=Object.keys(this),s=0;s<i.length;s++){var a=i[s];n[a]=this[a]}if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var l=Object.keys(e),u=0;u<l.length;u++){var c=l[u];"protocol"!==c&&(n[c]=e[c])}return x[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!x[e.protocol]){for(var h=Object.keys(e),d=0;d<h.length;d++){var p=h[d];n[p]=e[p]}return n.href=n.format(),n}if(n.protocol=e.protocol,e.host||y[e.protocol])n.pathname=e.pathname;else{var f=(e.pathname||"").split("/");while(f.length&&!(e.host=f.shift()));e.host||(e.host=""),e.hostname||(e.hostname=""),""!==f[0]&&f.unshift(""),f.length<2&&f.unshift(""),n.pathname=f.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var m=n.pathname||"",g=n.search||"";n.path=m+g}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var v=n.pathname&&"/"===n.pathname.charAt(0),b=e.host||e.pathname&&"/"===e.pathname.charAt(0),w=b||v||n.host&&e.pathname,_=w,A=n.pathname&&n.pathname.split("/")||[],S=(f=e.pathname&&e.pathname.split("/")||[],n.protocol&&!x[n.protocol]);if(S&&(n.hostname="",n.port=null,n.host&&(""===A[0]?A[0]=n.host:A.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===f[0]?f[0]=e.host:f.unshift(e.host)),e.host=null),w=w&&(""===f[0]||""===A[0])),b)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,A=f;else if(f.length)A||(A=[]),A.pop(),A=A.concat(f),n.search=e.search,n.query=e.query;else if(!r.isNullOrUndefined(e.search)){if(S){n.hostname=n.host=A.shift();var E=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@");E&&(n.auth=E.shift(),n.host=n.hostname=E.shift())}return n.search=e.search,n.query=e.query,r.isNull(n.pathname)&&r.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!A.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var M=A.slice(-1)[0],T=(n.host||e.host||A.length>1)&&("."===M||".."===M)||""===M,C=0,P=A.length;P>=0;P--)M=A[P],"."===M?A.splice(P,1):".."===M?(A.splice(P,1),C++):C&&(A.splice(P,1),C--);if(!w&&!_)for(;C--;C)A.unshift("..");!w||""===A[0]||A[0]&&"/"===A[0].charAt(0)||A.unshift(""),T&&"/"!==A.join("/").substr(-1)&&A.push("");var R=""===A[0]||A[0]&&"/"===A[0].charAt(0);if(S){n.hostname=n.host=R?"":A.length?A.shift():"";E=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@");E&&(n.auth=E.shift(),n.host=n.hostname=E.shift())}return w=w||n.host&&A.length,w&&!R&&A.unshift(""),A.length?n.pathname=A.join("/"):(n.pathname=null,n.path=null),r.isNull(n.pathname)&&r.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},o.prototype.parseHost=function(){var e=this.host,t=a.exec(e);t&&(t=t[0],":"!==t&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},"0b25":function(e,t,n){var i=n("a691"),r=n("50c4");e.exports=function(e){if(void 0===e)return 0;var t=i(e),n=r(t);if(t!==n)throw RangeError("Wrong length or index");return n}},"0c1a":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateSchemaDeps=t.validatePropertyDeps=t.error=void 0;const i=n("96ab"),r=n("417a"),o=n("4c26");t.error={message:({params:{property:e,depsCount:t,deps:n}})=>{const r=1===t?"property":"properties";return i.str`must have ${r} ${n} when property ${e} is present`},params:({params:{property:e,depsCount:t,deps:n,missingProperty:r}})=>i._`{property: ${e},
    missingProperty: ${r},
    depsCount: ${t},
    deps: ${n}}`};const s={keyword:"dependencies",type:"object",schemaType:"object",error:t.error,code(e){const[t,n]=a(e);l(e,t),u(e,n)}};function a({schema:e}){const t={},n={};for(const i in e){if("__proto__"===i)continue;const r=Array.isArray(e[i])?t:n;r[i]=e[i]}return[t,n]}function l(e,t=e.schema){const{gen:n,data:r,it:s}=e;if(0===Object.keys(t).length)return;const a=n.let("missing");for(const l in t){const u=t[l];if(0===u.length)continue;const c=o.propertyInData(n,r,l,s.opts.ownProperties);e.setParams({property:l,depsCount:u.length,deps:u.join(", ")}),s.allErrors?n.if(c,()=>{for(const t of u)o.checkReportMissingProp(e,t)}):(n.if(i._`${c} && (${o.checkMissingProp(e,u,a)})`),o.reportMissingProp(e,a),n.else())}}function u(e,t=e.schema){const{gen:n,data:i,keyword:s,it:a}=e,l=n.name("valid");for(const u in t)r.alwaysValidSchema(a,t[u])||(n.if(o.propertyInData(n,i,u,a.opts.ownProperties),()=>{const t=e.subschema({keyword:s,schemaProp:u},l);e.mergeValidEvaluated(t,l)},()=>n.var(l,!0)),e.ok(l))}t.validatePropertyDeps=l,t.validateSchemaDeps=u,t.default=s},"0e33":function(e,t,n){(function(i){var r,o,s;(function(i){o=[n("1157")],r=i,s="function"===typeof r?r.apply(t,o):r,void 0===s||(e.exports=s)})((function(e){var t=function(){if(e&&e.fn&&e.fn.select2&&e.fn.select2.amd)var t=e.fn.select2.amd;return function(){
/**
 * @license almond 0.3.3 Copyright jQuery Foundation and other contributors.
 * Released under MIT license, http://github.com/requirejs/almond/LICENSE
 */
var e,n,i;t&&t.requirejs||(t?n=t:t={},function(t){var r,o,s,a,l={},u={},c={},h={},d=Object.prototype.hasOwnProperty,p=[].slice,f=/\.js$/;function m(e,t){return d.call(e,t)}function g(e,t){var n,i,r,o,s,a,l,u,h,d,p,m,g=t&&t.split("/"),v=c.map,y=v&&v["*"]||{};if(e){for(e=e.split("/"),s=e.length-1,c.nodeIdCompat&&f.test(e[s])&&(e[s]=e[s].replace(f,"")),"."===e[0].charAt(0)&&g&&(m=g.slice(0,g.length-1),e=m.concat(e)),h=0;h<e.length;h++)if(p=e[h],"."===p)e.splice(h,1),h-=1;else if(".."===p){if(0===h||1===h&&".."===e[2]||".."===e[h-1])continue;h>0&&(e.splice(h-1,2),h-=2)}e=e.join("/")}if((g||y)&&v){for(n=e.split("/"),h=n.length;h>0;h-=1){if(i=n.slice(0,h).join("/"),g)for(d=g.length;d>0;d-=1)if(r=v[g.slice(0,d).join("/")],r&&(r=r[i],r)){o=r,a=h;break}if(o)break;!l&&y&&y[i]&&(l=y[i],u=h)}!o&&l&&(o=l,a=u),o&&(n.splice(0,a,o),e=n.join("/"))}return e}function v(e,n){return function(){var i=p.call(arguments,0);return"string"!==typeof i[0]&&1===i.length&&i.push(null),o.apply(t,i.concat([e,n]))}}function y(e){return function(t){return g(t,e)}}function x(e){return function(t){l[e]=t}}function b(e){if(m(u,e)){var n=u[e];delete u[e],h[e]=!0,r.apply(t,n)}if(!m(l,e)&&!m(h,e))throw new Error("No "+e);return l[e]}function w(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function _(e){return e?w(e):[]}function A(e){return function(){return c&&c.config&&c.config[e]||{}}}s=function(e,t){var n,i=w(e),r=i[0],o=t[1];return e=i[1],r&&(r=g(r,o),n=b(r)),r?e=n&&n.normalize?n.normalize(e,y(o)):g(e,o):(e=g(e,o),i=w(e),r=i[0],e=i[1],r&&(n=b(r))),{f:r?r+"!"+e:e,n:e,pr:r,p:n}},a={require:function(e){return v(e)},exports:function(e){var t=l[e];return"undefined"!==typeof t?t:l[e]={}},module:function(e){return{id:e,uri:"",exports:l[e],config:A(e)}}},r=function(e,n,i,r){var o,c,d,p,f,g,y,w=[],A=typeof i;if(r=r||e,g=_(r),"undefined"===A||"function"===A){for(n=!n.length&&i.length?["require","exports","module"]:n,f=0;f<n.length;f+=1)if(p=s(n[f],g),c=p.f,"require"===c)w[f]=a.require(e);else if("exports"===c)w[f]=a.exports(e),y=!0;else if("module"===c)o=w[f]=a.module(e);else if(m(l,c)||m(u,c)||m(h,c))w[f]=b(c);else{if(!p.p)throw new Error(e+" missing "+c);p.p.load(p.n,v(r,!0),x(c),{}),w[f]=l[c]}d=i?i.apply(l[e],w):void 0,e&&(o&&o.exports!==t&&o.exports!==l[e]?l[e]=o.exports:d===t&&y||(l[e]=d))}else e&&(l[e]=i)},e=n=o=function(e,n,i,l,u){if("string"===typeof e)return a[e]?a[e](n):b(s(e,_(n)).f);if(!e.splice){if(c=e,c.deps&&o(c.deps,c.callback),!n)return;n.splice?(e=n,n=i,i=null):e=t}return n=n||function(){},"function"===typeof i&&(i=l,l=u),l?r(t,e,n,i):setTimeout((function(){r(t,e,n,i)}),4),o},o.config=function(e){return o(e)},e._defined=l,i=function(e,t,n){if("string"!==typeof e)throw new Error("See almond README: incorrect module build, no module name");t.splice||(n=t,t=[]),m(l,e)||m(u,e)||(u[e]=[e,t,n])},i.amd={jQuery:!0}}(),t.requirejs=e,t.require=n,t.define=i)}(),t.define("almond",(function(){})),t.define("jquery",[],(function(){var t=e||i;return null==t&&console&&console.error&&console.error("Select2: An instance of jQuery or a jQuery-compatible library was not found. Make sure that you are including jQuery before Select2 on your web page."),t})),t.define("select2/utils",["jquery"],(function(e){var t={};function n(e){var t=e.prototype,n=[];for(var i in t){var r=t[i];"function"===typeof r&&("constructor"!==i&&n.push(i))}return n}t.Extend=function(e,t){var n={}.hasOwnProperty;function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},t.Decorate=function(e,t){var i=n(t),r=n(e);function o(){var n=Array.prototype.unshift,i=t.prototype.constructor.length,r=e.prototype.constructor;i>0&&(n.call(arguments,e.prototype.constructor),r=t.prototype.constructor),r.apply(this,arguments)}function s(){this.constructor=o}t.displayName=e.displayName,o.prototype=new s;for(var a=0;a<r.length;a++){var l=r[a];o.prototype[l]=e.prototype[l]}for(var u=function(e){var n=function(){};e in o.prototype&&(n=o.prototype[e]);var i=t.prototype[e];return function(){var e=Array.prototype.unshift;return e.call(arguments,n),i.apply(this,arguments)}},c=0;c<i.length;c++){var h=i[c];o.prototype[h]=u(h)}return o};var i=function(){this.listeners={}};i.prototype.on=function(e,t){this.listeners=this.listeners||{},e in this.listeners?this.listeners[e].push(t):this.listeners[e]=[t]},i.prototype.trigger=function(e){var t=Array.prototype.slice,n=t.call(arguments,1);this.listeners=this.listeners||{},null==n&&(n=[]),0===n.length&&n.push({}),n[0]._type=e,e in this.listeners&&this.invoke(this.listeners[e],t.call(arguments,1)),"*"in this.listeners&&this.invoke(this.listeners["*"],arguments)},i.prototype.invoke=function(e,t){for(var n=0,i=e.length;n<i;n++)e[n].apply(this,t)},t.Observable=i,t.generateChars=function(e){for(var t="",n=0;n<e;n++){var i=Math.floor(36*Math.random());t+=i.toString(36)}return t},t.bind=function(e,t){return function(){e.apply(t,arguments)}},t._convertData=function(e){for(var t in e){var n=t.split("-"),i=e;if(1!==n.length){for(var r=0;r<n.length;r++){var o=n[r];o=o.substring(0,1).toLowerCase()+o.substring(1),o in i||(i[o]={}),r==n.length-1&&(i[o]=e[t]),i=i[o]}delete e[t]}}return e},t.hasScroll=function(t,n){var i=e(n),r=n.style.overflowX,o=n.style.overflowY;return(r!==o||"hidden"!==o&&"visible"!==o)&&("scroll"===r||"scroll"===o||(i.innerHeight()<n.scrollHeight||i.innerWidth()<n.scrollWidth))},t.escapeMarkup=function(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return"string"!==typeof e?e:String(e).replace(/[&<>"'\/\\]/g,(function(e){return t[e]}))},t.appendMany=function(t,n){if("1.7"===e.fn.jquery.substr(0,3)){var i=e();e.map(n,(function(e){i=i.add(e)})),n=i}t.append(n)},t.__cache={};var r=0;return t.GetUniqueElementId=function(e){var t=e.getAttribute("data-select2-id");return null==t&&(e.id?(t=e.id,e.setAttribute("data-select2-id",t)):(e.setAttribute("data-select2-id",++r),t=r.toString())),t},t.StoreData=function(e,n,i){var r=t.GetUniqueElementId(e);t.__cache[r]||(t.__cache[r]={}),t.__cache[r][n]=i},t.GetData=function(n,i){var r=t.GetUniqueElementId(n);return i?t.__cache[r]&&null!=t.__cache[r][i]?t.__cache[r][i]:e(n).data(i):t.__cache[r]},t.RemoveData=function(e){var n=t.GetUniqueElementId(e);null!=t.__cache[n]&&delete t.__cache[n],e.removeAttribute("data-select2-id")},t})),t.define("select2/results",["jquery","./utils"],(function(e,t){function n(e,t,i){this.$element=e,this.data=i,this.options=t,n.__super__.constructor.call(this)}return t.Extend(n,t.Observable),n.prototype.render=function(){var t=e('<ul class="select2-results__options" role="listbox"></ul>');return this.options.get("multiple")&&t.attr("aria-multiselectable","true"),this.$results=t,t},n.prototype.clear=function(){this.$results.empty()},n.prototype.displayMessage=function(t){var n=this.options.get("escapeMarkup");this.clear(),this.hideLoading();var i=e('<li role="alert" aria-live="assertive" class="select2-results__option"></li>'),r=this.options.get("translations").get(t.message);i.append(n(r(t.args))),i[0].className+=" select2-results__message",this.$results.append(i)},n.prototype.hideMessages=function(){this.$results.find(".select2-results__message").remove()},n.prototype.append=function(e){this.hideLoading();var t=[];if(null!=e.results&&0!==e.results.length){e.results=this.sort(e.results);for(var n=0;n<e.results.length;n++){var i=e.results[n],r=this.option(i);t.push(r)}this.$results.append(t)}else 0===this.$results.children().length&&this.trigger("results:message",{message:"noResults"})},n.prototype.position=function(e,t){var n=t.find(".select2-results");n.append(e)},n.prototype.sort=function(e){var t=this.options.get("sorter");return t(e)},n.prototype.highlightFirstItem=function(){var e=this.$results.find(".select2-results__option[aria-selected]"),t=e.filter("[aria-selected=true]");t.length>0?t.first().trigger("mouseenter"):e.first().trigger("mouseenter"),this.ensureHighlightVisible()},n.prototype.setClasses=function(){var n=this;this.data.current((function(i){var r=e.map(i,(function(e){return e.id.toString()})),o=n.$results.find(".select2-results__option[aria-selected]");o.each((function(){var n=e(this),i=t.GetData(this,"data"),o=""+i.id;null!=i.element&&i.element.selected||null==i.element&&e.inArray(o,r)>-1?n.attr("aria-selected","true"):n.attr("aria-selected","false")}))}))},n.prototype.showLoading=function(e){this.hideLoading();var t=this.options.get("translations").get("searching"),n={disabled:!0,loading:!0,text:t(e)},i=this.option(n);i.className+=" loading-results",this.$results.prepend(i)},n.prototype.hideLoading=function(){this.$results.find(".loading-results").remove()},n.prototype.option=function(n){var i=document.createElement("li");i.className="select2-results__option";var r={role:"option","aria-selected":"false"},o=window.Element.prototype.matches||window.Element.prototype.msMatchesSelector||window.Element.prototype.webkitMatchesSelector;for(var s in(null!=n.element&&o.call(n.element,":disabled")||null==n.element&&n.disabled)&&(delete r["aria-selected"],r["aria-disabled"]="true"),null==n.id&&delete r["aria-selected"],null!=n._resultId&&(i.id=n._resultId),n.title&&(i.title=n.title),n.children&&(r.role="group",r["aria-label"]=n.text,delete r["aria-selected"]),r){var a=r[s];i.setAttribute(s,a)}if(n.children){var l=e(i),u=document.createElement("strong");u.className="select2-results__group";e(u);this.template(n,u);for(var c=[],h=0;h<n.children.length;h++){var d=n.children[h],p=this.option(d);c.push(p)}var f=e("<ul></ul>",{class:"select2-results__options select2-results__options--nested"});f.append(c),l.append(u),l.append(f)}else this.template(n,i);return t.StoreData(i,"data",n),i},n.prototype.bind=function(n,i){var r=this,o=n.id+"-results";this.$results.attr("id",o),n.on("results:all",(function(e){r.clear(),r.append(e.data),n.isOpen()&&(r.setClasses(),r.highlightFirstItem())})),n.on("results:append",(function(e){r.append(e.data),n.isOpen()&&r.setClasses()})),n.on("query",(function(e){r.hideMessages(),r.showLoading(e)})),n.on("select",(function(){n.isOpen()&&(r.setClasses(),r.options.get("scrollAfterSelect")&&r.highlightFirstItem())})),n.on("unselect",(function(){n.isOpen()&&(r.setClasses(),r.options.get("scrollAfterSelect")&&r.highlightFirstItem())})),n.on("open",(function(){r.$results.attr("aria-expanded","true"),r.$results.attr("aria-hidden","false"),r.setClasses(),r.ensureHighlightVisible()})),n.on("close",(function(){r.$results.attr("aria-expanded","false"),r.$results.attr("aria-hidden","true"),r.$results.removeAttr("aria-activedescendant")})),n.on("results:toggle",(function(){var e=r.getHighlightedResults();0!==e.length&&e.trigger("mouseup")})),n.on("results:select",(function(){var e=r.getHighlightedResults();if(0!==e.length){var n=t.GetData(e[0],"data");"true"==e.attr("aria-selected")?r.trigger("close",{}):r.trigger("select",{data:n})}})),n.on("results:previous",(function(){var e=r.getHighlightedResults(),t=r.$results.find("[aria-selected]"),n=t.index(e);if(!(n<=0)){var i=n-1;0===e.length&&(i=0);var o=t.eq(i);o.trigger("mouseenter");var s=r.$results.offset().top,a=o.offset().top,l=r.$results.scrollTop()+(a-s);0===i?r.$results.scrollTop(0):a-s<0&&r.$results.scrollTop(l)}})),n.on("results:next",(function(){var e=r.getHighlightedResults(),t=r.$results.find("[aria-selected]"),n=t.index(e),i=n+1;if(!(i>=t.length)){var o=t.eq(i);o.trigger("mouseenter");var s=r.$results.offset().top+r.$results.outerHeight(!1),a=o.offset().top+o.outerHeight(!1),l=r.$results.scrollTop()+a-s;0===i?r.$results.scrollTop(0):a>s&&r.$results.scrollTop(l)}})),n.on("results:focus",(function(e){e.element.addClass("select2-results__option--highlighted")})),n.on("results:message",(function(e){r.displayMessage(e)})),e.fn.mousewheel&&this.$results.on("mousewheel",(function(e){var t=r.$results.scrollTop(),n=r.$results.get(0).scrollHeight-t+e.deltaY,i=e.deltaY>0&&t-e.deltaY<=0,o=e.deltaY<0&&n<=r.$results.height();i?(r.$results.scrollTop(0),e.preventDefault(),e.stopPropagation()):o&&(r.$results.scrollTop(r.$results.get(0).scrollHeight-r.$results.height()),e.preventDefault(),e.stopPropagation())})),this.$results.on("mouseup",".select2-results__option[aria-selected]",(function(n){var i=e(this),o=t.GetData(this,"data");"true"!==i.attr("aria-selected")?r.trigger("select",{originalEvent:n,data:o}):r.options.get("multiple")?r.trigger("unselect",{originalEvent:n,data:o}):r.trigger("close",{})})),this.$results.on("mouseenter",".select2-results__option[aria-selected]",(function(n){var i=t.GetData(this,"data");r.getHighlightedResults().removeClass("select2-results__option--highlighted"),r.trigger("results:focus",{data:i,element:e(this)})}))},n.prototype.getHighlightedResults=function(){var e=this.$results.find(".select2-results__option--highlighted");return e},n.prototype.destroy=function(){this.$results.remove()},n.prototype.ensureHighlightVisible=function(){var e=this.getHighlightedResults();if(0!==e.length){var t=this.$results.find("[aria-selected]"),n=t.index(e),i=this.$results.offset().top,r=e.offset().top,o=this.$results.scrollTop()+(r-i),s=r-i;o-=2*e.outerHeight(!1),n<=2?this.$results.scrollTop(0):(s>this.$results.outerHeight()||s<0)&&this.$results.scrollTop(o)}},n.prototype.template=function(t,n){var i=this.options.get("templateResult"),r=this.options.get("escapeMarkup"),o=i(t,n);null==o?n.style.display="none":"string"===typeof o?n.innerHTML=r(o):e(n).append(o)},n})),t.define("select2/keys",[],(function(){var e={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46};return e})),t.define("select2/selection/base",["jquery","../utils","../keys"],(function(e,t,n){function i(e,t){this.$element=e,this.options=t,i.__super__.constructor.call(this)}return t.Extend(i,t.Observable),i.prototype.render=function(){var n=e('<span class="select2-selection" role="combobox"  aria-haspopup="true" aria-expanded="false"></span>');return this._tabindex=0,null!=t.GetData(this.$element[0],"old-tabindex")?this._tabindex=t.GetData(this.$element[0],"old-tabindex"):null!=this.$element.attr("tabindex")&&(this._tabindex=this.$element.attr("tabindex")),n.attr("title",this.$element.attr("title")),n.attr("tabindex",this._tabindex),n.attr("aria-disabled","false"),this.$selection=n,n},i.prototype.bind=function(e,t){var i=this,r=e.id+"-results";this.container=e,this.$selection.on("focus",(function(e){i.trigger("focus",e)})),this.$selection.on("blur",(function(e){i._handleBlur(e)})),this.$selection.on("keydown",(function(e){i.trigger("keypress",e),e.which===n.SPACE&&e.preventDefault()})),e.on("results:focus",(function(e){i.$selection.attr("aria-activedescendant",e.data._resultId)})),e.on("selection:update",(function(e){i.update(e.data)})),e.on("open",(function(){i.$selection.attr("aria-expanded","true"),i.$selection.attr("aria-owns",r),i._attachCloseHandler(e)})),e.on("close",(function(){i.$selection.attr("aria-expanded","false"),i.$selection.removeAttr("aria-activedescendant"),i.$selection.removeAttr("aria-owns"),i.$selection.trigger("focus"),i._detachCloseHandler(e)})),e.on("enable",(function(){i.$selection.attr("tabindex",i._tabindex),i.$selection.attr("aria-disabled","false")})),e.on("disable",(function(){i.$selection.attr("tabindex","-1"),i.$selection.attr("aria-disabled","true")}))},i.prototype._handleBlur=function(t){var n=this;window.setTimeout((function(){document.activeElement==n.$selection[0]||e.contains(n.$selection[0],document.activeElement)||n.trigger("blur",t)}),1)},i.prototype._attachCloseHandler=function(n){e(document.body).on("mousedown.select2."+n.id,(function(n){var i=e(n.target),r=i.closest(".select2"),o=e(".select2.select2-container--open");o.each((function(){if(this!=r[0]){var e=t.GetData(this,"element");e.select2("close")}}))}))},i.prototype._detachCloseHandler=function(t){e(document.body).off("mousedown.select2."+t.id)},i.prototype.position=function(e,t){var n=t.find(".selection");n.append(e)},i.prototype.destroy=function(){this._detachCloseHandler(this.container)},i.prototype.update=function(e){throw new Error("The `update` method must be defined in child classes.")},i.prototype.isEnabled=function(){return!this.isDisabled()},i.prototype.isDisabled=function(){return this.options.get("disabled")},i})),t.define("select2/selection/single",["jquery","./base","../utils","../keys"],(function(e,t,n,i){function r(){r.__super__.constructor.apply(this,arguments)}return n.Extend(r,t),r.prototype.render=function(){var e=r.__super__.render.call(this);return e.addClass("select2-selection--single"),e.html('<span class="select2-selection__rendered"></span><span class="select2-selection__arrow" role="presentation"><b role="presentation"></b></span>'),e},r.prototype.bind=function(e,t){var n=this;r.__super__.bind.apply(this,arguments);var i=e.id+"-container";this.$selection.find(".select2-selection__rendered").attr("id",i).attr("role","textbox").attr("aria-readonly","true"),this.$selection.attr("aria-labelledby",i),this.$selection.on("mousedown",(function(e){1===e.which&&n.trigger("toggle",{originalEvent:e})})),this.$selection.on("focus",(function(e){})),this.$selection.on("blur",(function(e){})),e.on("focus",(function(t){e.isOpen()||n.$selection.trigger("focus")}))},r.prototype.clear=function(){var e=this.$selection.find(".select2-selection__rendered");e.empty(),e.removeAttr("title")},r.prototype.display=function(e,t){var n=this.options.get("templateSelection"),i=this.options.get("escapeMarkup");return i(n(e,t))},r.prototype.selectionContainer=function(){return e("<span></span>")},r.prototype.update=function(e){if(0!==e.length){var t=e[0],n=this.$selection.find(".select2-selection__rendered"),i=this.display(t,n);n.empty().append(i);var r=t.title||t.text;r?n.attr("title",r):n.removeAttr("title")}else this.clear()},r})),t.define("select2/selection/multiple",["jquery","./base","../utils"],(function(e,t,n){function i(e,t){i.__super__.constructor.apply(this,arguments)}return n.Extend(i,t),i.prototype.render=function(){var e=i.__super__.render.call(this);return e.addClass("select2-selection--multiple"),e.html('<ul class="select2-selection__rendered"></ul>'),e},i.prototype.bind=function(t,r){var o=this;i.__super__.bind.apply(this,arguments),this.$selection.on("click",(function(e){o.trigger("toggle",{originalEvent:e})})),this.$selection.on("click",".select2-selection__choice__remove",(function(t){if(!o.isDisabled()){var i=e(this),r=i.parent(),s=n.GetData(r[0],"data");o.trigger("unselect",{originalEvent:t,data:s})}}))},i.prototype.clear=function(){var e=this.$selection.find(".select2-selection__rendered");e.empty(),e.removeAttr("title")},i.prototype.display=function(e,t){var n=this.options.get("templateSelection"),i=this.options.get("escapeMarkup");return i(n(e,t))},i.prototype.selectionContainer=function(){var t=e('<li class="select2-selection__choice"><span class="select2-selection__choice__remove" role="presentation">&times;</span></li>');return t},i.prototype.update=function(e){if(this.clear(),0!==e.length){for(var t=[],i=0;i<e.length;i++){var r=e[i],o=this.selectionContainer(),s=this.display(r,o);o.append(s);var a=r.title||r.text;a&&o.attr("title",a),n.StoreData(o[0],"data",r),t.push(o)}var l=this.$selection.find(".select2-selection__rendered");n.appendMany(l,t)}},i})),t.define("select2/selection/placeholder",["../utils"],(function(e){function t(e,t,n){this.placeholder=this.normalizePlaceholder(n.get("placeholder")),e.call(this,t,n)}return t.prototype.normalizePlaceholder=function(e,t){return"string"===typeof t&&(t={id:"",text:t}),t},t.prototype.createPlaceholder=function(e,t){var n=this.selectionContainer();return n.html(this.display(t)),n.addClass("select2-selection__placeholder").removeClass("select2-selection__choice"),n},t.prototype.update=function(e,t){var n=1==t.length&&t[0].id!=this.placeholder.id,i=t.length>1;if(i||n)return e.call(this,t);this.clear();var r=this.createPlaceholder(this.placeholder);this.$selection.find(".select2-selection__rendered").append(r)},t})),t.define("select2/selection/allowClear",["jquery","../keys","../utils"],(function(e,t,n){function i(){}return i.prototype.bind=function(e,t,n){var i=this;e.call(this,t,n),null==this.placeholder&&this.options.get("debug")&&window.console&&console.error&&console.error("Select2: The `allowClear` option should be used in combination with the `placeholder` option."),this.$selection.on("mousedown",".select2-selection__clear",(function(e){i._handleClear(e)})),t.on("keypress",(function(e){i._handleKeyboardClear(e,t)}))},i.prototype._handleClear=function(e,t){if(!this.isDisabled()){var i=this.$selection.find(".select2-selection__clear");if(0!==i.length){t.stopPropagation();var r=n.GetData(i[0],"data"),o=this.$element.val();this.$element.val(this.placeholder.id);var s={data:r};if(this.trigger("clear",s),s.prevented)this.$element.val(o);else{for(var a=0;a<r.length;a++)if(s={data:r[a]},this.trigger("unselect",s),s.prevented)return void this.$element.val(o);this.$element.trigger("input").trigger("change"),this.trigger("toggle",{})}}}},i.prototype._handleKeyboardClear=function(e,n,i){i.isOpen()||n.which!=t.DELETE&&n.which!=t.BACKSPACE||this._handleClear(n)},i.prototype.update=function(t,i){if(t.call(this,i),!(this.$selection.find(".select2-selection__placeholder").length>0||0===i.length)){var r=this.options.get("translations").get("removeAllItems"),o=e('<span class="select2-selection__clear" title="'+r()+'">&times;</span>');n.StoreData(o[0],"data",i),this.$selection.find(".select2-selection__rendered").prepend(o)}},i})),t.define("select2/selection/search",["jquery","../utils","../keys"],(function(e,t,n){function i(e,t,n){e.call(this,t,n)}return i.prototype.render=function(t){var n=e('<li class="select2-search select2-search--inline"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" role="searchbox" aria-autocomplete="list" /></li>');this.$searchContainer=n,this.$search=n.find("input");var i=t.call(this);return this._transferTabIndex(),i},i.prototype.bind=function(e,i,r){var o=this,s=i.id+"-results";e.call(this,i,r),i.on("open",(function(){o.$search.attr("aria-controls",s),o.$search.trigger("focus")})),i.on("close",(function(){o.$search.val(""),o.$search.removeAttr("aria-controls"),o.$search.removeAttr("aria-activedescendant"),o.$search.trigger("focus")})),i.on("enable",(function(){o.$search.prop("disabled",!1),o._transferTabIndex()})),i.on("disable",(function(){o.$search.prop("disabled",!0)})),i.on("focus",(function(e){o.$search.trigger("focus")})),i.on("results:focus",(function(e){e.data._resultId?o.$search.attr("aria-activedescendant",e.data._resultId):o.$search.removeAttr("aria-activedescendant")})),this.$selection.on("focusin",".select2-search--inline",(function(e){o.trigger("focus",e)})),this.$selection.on("focusout",".select2-search--inline",(function(e){o._handleBlur(e)})),this.$selection.on("keydown",".select2-search--inline",(function(e){e.stopPropagation(),o.trigger("keypress",e),o._keyUpPrevented=e.isDefaultPrevented();var i=e.which;if(i===n.BACKSPACE&&""===o.$search.val()){var r=o.$searchContainer.prev(".select2-selection__choice");if(r.length>0){var s=t.GetData(r[0],"data");o.searchRemoveChoice(s),e.preventDefault()}}})),this.$selection.on("click",".select2-search--inline",(function(e){o.$search.val()&&e.stopPropagation()}));var a=document.documentMode,l=a&&a<=11;this.$selection.on("input.searchcheck",".select2-search--inline",(function(e){l?o.$selection.off("input.search input.searchcheck"):o.$selection.off("keyup.search")})),this.$selection.on("keyup.search input.search",".select2-search--inline",(function(e){if(l&&"input"===e.type)o.$selection.off("input.search input.searchcheck");else{var t=e.which;t!=n.SHIFT&&t!=n.CTRL&&t!=n.ALT&&t!=n.TAB&&o.handleSearch(e)}}))},i.prototype._transferTabIndex=function(e){this.$search.attr("tabindex",this.$selection.attr("tabindex")),this.$selection.attr("tabindex","-1")},i.prototype.createPlaceholder=function(e,t){this.$search.attr("placeholder",t.text)},i.prototype.update=function(e,t){var n=this.$search[0]==document.activeElement;this.$search.attr("placeholder",""),e.call(this,t),this.$selection.find(".select2-selection__rendered").append(this.$searchContainer),this.resizeSearch(),n&&this.$search.trigger("focus")},i.prototype.handleSearch=function(){if(this.resizeSearch(),!this._keyUpPrevented){var e=this.$search.val();this.trigger("query",{term:e})}this._keyUpPrevented=!1},i.prototype.searchRemoveChoice=function(e,t){this.trigger("unselect",{data:t}),this.$search.val(t.text),this.handleSearch()},i.prototype.resizeSearch=function(){this.$search.css("width","25px");var e="";if(""!==this.$search.attr("placeholder"))e=this.$selection.find(".select2-selection__rendered").width();else{var t=this.$search.val().length+1;e=.75*t+"em"}this.$search.css("width",e)},i})),t.define("select2/selection/eventRelay",["jquery"],(function(e){function t(){}return t.prototype.bind=function(t,n,i){var r=this,o=["open","opening","close","closing","select","selecting","unselect","unselecting","clear","clearing"],s=["opening","closing","selecting","unselecting","clearing"];t.call(this,n,i),n.on("*",(function(t,n){if(-1!==e.inArray(t,o)){n=n||{};var i=e.Event("select2:"+t,{params:n});r.$element.trigger(i),-1!==e.inArray(t,s)&&(n.prevented=i.isDefaultPrevented())}}))},t})),t.define("select2/translation",["jquery","require"],(function(e,t){function n(e){this.dict=e||{}}return n.prototype.all=function(){return this.dict},n.prototype.get=function(e){return this.dict[e]},n.prototype.extend=function(t){this.dict=e.extend({},t.all(),this.dict)},n._cache={},n.loadPath=function(e){if(!(e in n._cache)){var i=t(e);n._cache[e]=i}return new n(n._cache[e])},n})),t.define("select2/diacritics",[],(function(){var e={"Ⓐ":"A","Ａ":"A","À":"A","Á":"A","Â":"A","Ầ":"A","Ấ":"A","Ẫ":"A","Ẩ":"A","Ã":"A","Ā":"A","Ă":"A","Ằ":"A","Ắ":"A","Ẵ":"A","Ẳ":"A","Ȧ":"A","Ǡ":"A","Ä":"A","Ǟ":"A","Ả":"A","Å":"A","Ǻ":"A","Ǎ":"A","Ȁ":"A","Ȃ":"A","Ạ":"A","Ậ":"A","Ặ":"A","Ḁ":"A","Ą":"A","Ⱥ":"A","Ɐ":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ⓑ":"B","Ｂ":"B","Ḃ":"B","Ḅ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ɓ":"B","Ⓒ":"C","Ｃ":"C","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","Ç":"C","Ḉ":"C","Ƈ":"C","Ȼ":"C","Ꜿ":"C","Ⓓ":"D","Ｄ":"D","Ḋ":"D","Ď":"D","Ḍ":"D","Ḑ":"D","Ḓ":"D","Ḏ":"D","Đ":"D","Ƌ":"D","Ɗ":"D","Ɖ":"D","Ꝺ":"D","Ǳ":"DZ","Ǆ":"DZ","ǲ":"Dz","ǅ":"Dz","Ⓔ":"E","Ｅ":"E","È":"E","É":"E","Ê":"E","Ề":"E","Ế":"E","Ễ":"E","Ể":"E","Ẽ":"E","Ē":"E","Ḕ":"E","Ḗ":"E","Ĕ":"E","Ė":"E","Ë":"E","Ẻ":"E","Ě":"E","Ȅ":"E","Ȇ":"E","Ẹ":"E","Ệ":"E","Ȩ":"E","Ḝ":"E","Ę":"E","Ḙ":"E","Ḛ":"E","Ɛ":"E","Ǝ":"E","Ⓕ":"F","Ｆ":"F","Ḟ":"F","Ƒ":"F","Ꝼ":"F","Ⓖ":"G","Ｇ":"G","Ǵ":"G","Ĝ":"G","Ḡ":"G","Ğ":"G","Ġ":"G","Ǧ":"G","Ģ":"G","Ǥ":"G","Ɠ":"G","Ꞡ":"G","Ᵹ":"G","Ꝿ":"G","Ⓗ":"H","Ｈ":"H","Ĥ":"H","Ḣ":"H","Ḧ":"H","Ȟ":"H","Ḥ":"H","Ḩ":"H","Ḫ":"H","Ħ":"H","Ⱨ":"H","Ⱶ":"H","Ɥ":"H","Ⓘ":"I","Ｉ":"I","Ì":"I","Í":"I","Î":"I","Ĩ":"I","Ī":"I","Ĭ":"I","İ":"I","Ï":"I","Ḯ":"I","Ỉ":"I","Ǐ":"I","Ȉ":"I","Ȋ":"I","Ị":"I","Į":"I","Ḭ":"I","Ɨ":"I","Ⓙ":"J","Ｊ":"J","Ĵ":"J","Ɉ":"J","Ⓚ":"K","Ｋ":"K","Ḱ":"K","Ǩ":"K","Ḳ":"K","Ķ":"K","Ḵ":"K","Ƙ":"K","Ⱪ":"K","Ꝁ":"K","Ꝃ":"K","Ꝅ":"K","Ꞣ":"K","Ⓛ":"L","Ｌ":"L","Ŀ":"L","Ĺ":"L","Ľ":"L","Ḷ":"L","Ḹ":"L","Ļ":"L","Ḽ":"L","Ḻ":"L","Ł":"L","Ƚ":"L","Ɫ":"L","Ⱡ":"L","Ꝉ":"L","Ꝇ":"L","Ꞁ":"L","Ǉ":"LJ","ǈ":"Lj","Ⓜ":"M","Ｍ":"M","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ɯ":"M","Ⓝ":"N","Ｎ":"N","Ǹ":"N","Ń":"N","Ñ":"N","Ṅ":"N","Ň":"N","Ṇ":"N","Ņ":"N","Ṋ":"N","Ṉ":"N","Ƞ":"N","Ɲ":"N","Ꞑ":"N","Ꞥ":"N","Ǌ":"NJ","ǋ":"Nj","Ⓞ":"O","Ｏ":"O","Ò":"O","Ó":"O","Ô":"O","Ồ":"O","Ố":"O","Ỗ":"O","Ổ":"O","Õ":"O","Ṍ":"O","Ȭ":"O","Ṏ":"O","Ō":"O","Ṑ":"O","Ṓ":"O","Ŏ":"O","Ȯ":"O","Ȱ":"O","Ö":"O","Ȫ":"O","Ỏ":"O","Ő":"O","Ǒ":"O","Ȍ":"O","Ȏ":"O","Ơ":"O","Ờ":"O","Ớ":"O","Ỡ":"O","Ở":"O","Ợ":"O","Ọ":"O","Ộ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Ɔ":"O","Ɵ":"O","Ꝋ":"O","Ꝍ":"O","Œ":"OE","Ƣ":"OI","Ꝏ":"OO","Ȣ":"OU","Ⓟ":"P","Ｐ":"P","Ṕ":"P","Ṗ":"P","Ƥ":"P","Ᵽ":"P","Ꝑ":"P","Ꝓ":"P","Ꝕ":"P","Ⓠ":"Q","Ｑ":"Q","Ꝗ":"Q","Ꝙ":"Q","Ɋ":"Q","Ⓡ":"R","Ｒ":"R","Ŕ":"R","Ṙ":"R","Ř":"R","Ȑ":"R","Ȓ":"R","Ṛ":"R","Ṝ":"R","Ŗ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꝛ":"R","Ꞧ":"R","Ꞃ":"R","Ⓢ":"S","Ｓ":"S","ẞ":"S","Ś":"S","Ṥ":"S","Ŝ":"S","Ṡ":"S","Š":"S","Ṧ":"S","Ṣ":"S","Ṩ":"S","Ș":"S","Ş":"S","Ȿ":"S","Ꞩ":"S","Ꞅ":"S","Ⓣ":"T","Ｔ":"T","Ṫ":"T","Ť":"T","Ṭ":"T","Ț":"T","Ţ":"T","Ṱ":"T","Ṯ":"T","Ŧ":"T","Ƭ":"T","Ʈ":"T","Ⱦ":"T","Ꞇ":"T","Ꜩ":"TZ","Ⓤ":"U","Ｕ":"U","Ù":"U","Ú":"U","Û":"U","Ũ":"U","Ṹ":"U","Ū":"U","Ṻ":"U","Ŭ":"U","Ü":"U","Ǜ":"U","Ǘ":"U","Ǖ":"U","Ǚ":"U","Ủ":"U","Ů":"U","Ű":"U","Ǔ":"U","Ȕ":"U","Ȗ":"U","Ư":"U","Ừ":"U","Ứ":"U","Ữ":"U","Ử":"U","Ự":"U","Ụ":"U","Ṳ":"U","Ų":"U","Ṷ":"U","Ṵ":"U","Ʉ":"U","Ⓥ":"V","Ｖ":"V","Ṽ":"V","Ṿ":"V","Ʋ":"V","Ꝟ":"V","Ʌ":"V","Ꝡ":"VY","Ⓦ":"W","Ｗ":"W","Ẁ":"W","Ẃ":"W","Ŵ":"W","Ẇ":"W","Ẅ":"W","Ẉ":"W","Ⱳ":"W","Ⓧ":"X","Ｘ":"X","Ẋ":"X","Ẍ":"X","Ⓨ":"Y","Ｙ":"Y","Ỳ":"Y","Ý":"Y","Ŷ":"Y","Ỹ":"Y","Ȳ":"Y","Ẏ":"Y","Ÿ":"Y","Ỷ":"Y","Ỵ":"Y","Ƴ":"Y","Ɏ":"Y","Ỿ":"Y","Ⓩ":"Z","Ｚ":"Z","Ź":"Z","Ẑ":"Z","Ż":"Z","Ž":"Z","Ẓ":"Z","Ẕ":"Z","Ƶ":"Z","Ȥ":"Z","Ɀ":"Z","Ⱬ":"Z","Ꝣ":"Z","ⓐ":"a","ａ":"a","ẚ":"a","à":"a","á":"a","â":"a","ầ":"a","ấ":"a","ẫ":"a","ẩ":"a","ã":"a","ā":"a","ă":"a","ằ":"a","ắ":"a","ẵ":"a","ẳ":"a","ȧ":"a","ǡ":"a","ä":"a","ǟ":"a","ả":"a","å":"a","ǻ":"a","ǎ":"a","ȁ":"a","ȃ":"a","ạ":"a","ậ":"a","ặ":"a","ḁ":"a","ą":"a","ⱥ":"a","ɐ":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ⓑ":"b","ｂ":"b","ḃ":"b","ḅ":"b","ḇ":"b","ƀ":"b","ƃ":"b","ɓ":"b","ⓒ":"c","ｃ":"c","ć":"c","ĉ":"c","ċ":"c","č":"c","ç":"c","ḉ":"c","ƈ":"c","ȼ":"c","ꜿ":"c","ↄ":"c","ⓓ":"d","ｄ":"d","ḋ":"d","ď":"d","ḍ":"d","ḑ":"d","ḓ":"d","ḏ":"d","đ":"d","ƌ":"d","ɖ":"d","ɗ":"d","ꝺ":"d","ǳ":"dz","ǆ":"dz","ⓔ":"e","ｅ":"e","è":"e","é":"e","ê":"e","ề":"e","ế":"e","ễ":"e","ể":"e","ẽ":"e","ē":"e","ḕ":"e","ḗ":"e","ĕ":"e","ė":"e","ë":"e","ẻ":"e","ě":"e","ȅ":"e","ȇ":"e","ẹ":"e","ệ":"e","ȩ":"e","ḝ":"e","ę":"e","ḙ":"e","ḛ":"e","ɇ":"e","ɛ":"e","ǝ":"e","ⓕ":"f","ｆ":"f","ḟ":"f","ƒ":"f","ꝼ":"f","ⓖ":"g","ｇ":"g","ǵ":"g","ĝ":"g","ḡ":"g","ğ":"g","ġ":"g","ǧ":"g","ģ":"g","ǥ":"g","ɠ":"g","ꞡ":"g","ᵹ":"g","ꝿ":"g","ⓗ":"h","ｈ":"h","ĥ":"h","ḣ":"h","ḧ":"h","ȟ":"h","ḥ":"h","ḩ":"h","ḫ":"h","ẖ":"h","ħ":"h","ⱨ":"h","ⱶ":"h","ɥ":"h","ƕ":"hv","ⓘ":"i","ｉ":"i","ì":"i","í":"i","î":"i","ĩ":"i","ī":"i","ĭ":"i","ï":"i","ḯ":"i","ỉ":"i","ǐ":"i","ȉ":"i","ȋ":"i","ị":"i","į":"i","ḭ":"i","ɨ":"i","ı":"i","ⓙ":"j","ｊ":"j","ĵ":"j","ǰ":"j","ɉ":"j","ⓚ":"k","ｋ":"k","ḱ":"k","ǩ":"k","ḳ":"k","ķ":"k","ḵ":"k","ƙ":"k","ⱪ":"k","ꝁ":"k","ꝃ":"k","ꝅ":"k","ꞣ":"k","ⓛ":"l","ｌ":"l","ŀ":"l","ĺ":"l","ľ":"l","ḷ":"l","ḹ":"l","ļ":"l","ḽ":"l","ḻ":"l","ſ":"l","ł":"l","ƚ":"l","ɫ":"l","ⱡ":"l","ꝉ":"l","ꞁ":"l","ꝇ":"l","ǉ":"lj","ⓜ":"m","ｍ":"m","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ɯ":"m","ⓝ":"n","ｎ":"n","ǹ":"n","ń":"n","ñ":"n","ṅ":"n","ň":"n","ṇ":"n","ņ":"n","ṋ":"n","ṉ":"n","ƞ":"n","ɲ":"n","ŉ":"n","ꞑ":"n","ꞥ":"n","ǌ":"nj","ⓞ":"o","ｏ":"o","ò":"o","ó":"o","ô":"o","ồ":"o","ố":"o","ỗ":"o","ổ":"o","õ":"o","ṍ":"o","ȭ":"o","ṏ":"o","ō":"o","ṑ":"o","ṓ":"o","ŏ":"o","ȯ":"o","ȱ":"o","ö":"o","ȫ":"o","ỏ":"o","ő":"o","ǒ":"o","ȍ":"o","ȏ":"o","ơ":"o","ờ":"o","ớ":"o","ỡ":"o","ở":"o","ợ":"o","ọ":"o","ộ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","ɔ":"o","ꝋ":"o","ꝍ":"o","ɵ":"o","œ":"oe","ƣ":"oi","ȣ":"ou","ꝏ":"oo","ⓟ":"p","ｐ":"p","ṕ":"p","ṗ":"p","ƥ":"p","ᵽ":"p","ꝑ":"p","ꝓ":"p","ꝕ":"p","ⓠ":"q","ｑ":"q","ɋ":"q","ꝗ":"q","ꝙ":"q","ⓡ":"r","ｒ":"r","ŕ":"r","ṙ":"r","ř":"r","ȑ":"r","ȓ":"r","ṛ":"r","ṝ":"r","ŗ":"r","ṟ":"r","ɍ":"r","ɽ":"r","ꝛ":"r","ꞧ":"r","ꞃ":"r","ⓢ":"s","ｓ":"s","ß":"s","ś":"s","ṥ":"s","ŝ":"s","ṡ":"s","š":"s","ṧ":"s","ṣ":"s","ṩ":"s","ș":"s","ş":"s","ȿ":"s","ꞩ":"s","ꞅ":"s","ẛ":"s","ⓣ":"t","ｔ":"t","ṫ":"t","ẗ":"t","ť":"t","ṭ":"t","ț":"t","ţ":"t","ṱ":"t","ṯ":"t","ŧ":"t","ƭ":"t","ʈ":"t","ⱦ":"t","ꞇ":"t","ꜩ":"tz","ⓤ":"u","ｕ":"u","ù":"u","ú":"u","û":"u","ũ":"u","ṹ":"u","ū":"u","ṻ":"u","ŭ":"u","ü":"u","ǜ":"u","ǘ":"u","ǖ":"u","ǚ":"u","ủ":"u","ů":"u","ű":"u","ǔ":"u","ȕ":"u","ȗ":"u","ư":"u","ừ":"u","ứ":"u","ữ":"u","ử":"u","ự":"u","ụ":"u","ṳ":"u","ų":"u","ṷ":"u","ṵ":"u","ʉ":"u","ⓥ":"v","ｖ":"v","ṽ":"v","ṿ":"v","ʋ":"v","ꝟ":"v","ʌ":"v","ꝡ":"vy","ⓦ":"w","ｗ":"w","ẁ":"w","ẃ":"w","ŵ":"w","ẇ":"w","ẅ":"w","ẘ":"w","ẉ":"w","ⱳ":"w","ⓧ":"x","ｘ":"x","ẋ":"x","ẍ":"x","ⓨ":"y","ｙ":"y","ỳ":"y","ý":"y","ŷ":"y","ỹ":"y","ȳ":"y","ẏ":"y","ÿ":"y","ỷ":"y","ẙ":"y","ỵ":"y","ƴ":"y","ɏ":"y","ỿ":"y","ⓩ":"z","ｚ":"z","ź":"z","ẑ":"z","ż":"z","ž":"z","ẓ":"z","ẕ":"z","ƶ":"z","ȥ":"z","ɀ":"z","ⱬ":"z","ꝣ":"z","Ά":"Α","Έ":"Ε","Ή":"Η","Ί":"Ι","Ϊ":"Ι","Ό":"Ο","Ύ":"Υ","Ϋ":"Υ","Ώ":"Ω","ά":"α","έ":"ε","ή":"η","ί":"ι","ϊ":"ι","ΐ":"ι","ό":"ο","ύ":"υ","ϋ":"υ","ΰ":"υ","ώ":"ω","ς":"σ","’":"'"};return e})),t.define("select2/data/base",["../utils"],(function(e){function t(e,n){t.__super__.constructor.call(this)}return e.Extend(t,e.Observable),t.prototype.current=function(e){throw new Error("The `current` method must be defined in child classes.")},t.prototype.query=function(e,t){throw new Error("The `query` method must be defined in child classes.")},t.prototype.bind=function(e,t){},t.prototype.destroy=function(){},t.prototype.generateResultId=function(t,n){var i=t.id+"-result-";return i+=e.generateChars(4),null!=n.id?i+="-"+n.id.toString():i+="-"+e.generateChars(4),i},t})),t.define("select2/data/select",["./base","../utils","jquery"],(function(e,t,n){function i(e,t){this.$element=e,this.options=t,i.__super__.constructor.call(this)}return t.Extend(i,e),i.prototype.current=function(e){var t=[],i=this;this.$element.find(":selected").each((function(){var e=n(this),r=i.item(e);t.push(r)})),e(t)},i.prototype.select=function(e){var t=this;if(e.selected=!0,n(e.element).is("option"))return e.element.selected=!0,void this.$element.trigger("input").trigger("change");if(this.$element.prop("multiple"))this.current((function(i){var r=[];e=[e],e.push.apply(e,i);for(var o=0;o<e.length;o++){var s=e[o].id;-1===n.inArray(s,r)&&r.push(s)}t.$element.val(r),t.$element.trigger("input").trigger("change")}));else{var i=e.id;this.$element.val(i),this.$element.trigger("input").trigger("change")}},i.prototype.unselect=function(e){var t=this;if(this.$element.prop("multiple")){if(e.selected=!1,n(e.element).is("option"))return e.element.selected=!1,void this.$element.trigger("input").trigger("change");this.current((function(i){for(var r=[],o=0;o<i.length;o++){var s=i[o].id;s!==e.id&&-1===n.inArray(s,r)&&r.push(s)}t.$element.val(r),t.$element.trigger("input").trigger("change")}))}},i.prototype.bind=function(e,t){var n=this;this.container=e,e.on("select",(function(e){n.select(e.data)})),e.on("unselect",(function(e){n.unselect(e.data)}))},i.prototype.destroy=function(){this.$element.find("*").each((function(){t.RemoveData(this)}))},i.prototype.query=function(e,t){var i=[],r=this,o=this.$element.children();o.each((function(){var t=n(this);if(t.is("option")||t.is("optgroup")){var o=r.item(t),s=r.matches(e,o);null!==s&&i.push(s)}})),t({results:i})},i.prototype.addOptions=function(e){t.appendMany(this.$element,e)},i.prototype.option=function(e){var i;e.children?(i=document.createElement("optgroup"),i.label=e.text):(i=document.createElement("option"),void 0!==i.textContent?i.textContent=e.text:i.innerText=e.text),void 0!==e.id&&(i.value=e.id),e.disabled&&(i.disabled=!0),e.selected&&(i.selected=!0),e.title&&(i.title=e.title);var r=n(i),o=this._normalizeItem(e);return o.element=i,t.StoreData(i,"data",o),r},i.prototype.item=function(e){var i={};if(i=t.GetData(e[0],"data"),null!=i)return i;if(e.is("option"))i={id:e.val(),text:e.text(),disabled:e.prop("disabled"),selected:e.prop("selected"),title:e.prop("title")};else if(e.is("optgroup")){i={text:e.prop("label"),children:[],title:e.prop("title")};for(var r=e.children("option"),o=[],s=0;s<r.length;s++){var a=n(r[s]),l=this.item(a);o.push(l)}i.children=o}return i=this._normalizeItem(i),i.element=e[0],t.StoreData(e[0],"data",i),i},i.prototype._normalizeItem=function(e){e!==Object(e)&&(e={id:e,text:e}),e=n.extend({},{text:""},e);var t={selected:!1,disabled:!1};return null!=e.id&&(e.id=e.id.toString()),null!=e.text&&(e.text=e.text.toString()),null==e._resultId&&e.id&&null!=this.container&&(e._resultId=this.generateResultId(this.container,e)),n.extend({},t,e)},i.prototype.matches=function(e,t){var n=this.options.get("matcher");return n(e,t)},i})),t.define("select2/data/array",["./select","../utils","jquery"],(function(e,t,n){function i(e,t){this._dataToConvert=t.get("data")||[],i.__super__.constructor.call(this,e,t)}return t.Extend(i,e),i.prototype.bind=function(e,t){i.__super__.bind.call(this,e,t),this.addOptions(this.convertToOptions(this._dataToConvert))},i.prototype.select=function(e){var t=this.$element.find("option").filter((function(t,n){return n.value==e.id.toString()}));0===t.length&&(t=this.option(e),this.addOptions(t)),i.__super__.select.call(this,e)},i.prototype.convertToOptions=function(e){var i=this,r=this.$element.find("option"),o=r.map((function(){return i.item(n(this)).id})).get(),s=[];function a(e){return function(){return n(this).val()==e.id}}for(var l=0;l<e.length;l++){var u=this._normalizeItem(e[l]);if(n.inArray(u.id,o)>=0){var c=r.filter(a(u)),h=this.item(c),d=n.extend(!0,{},u,h),p=this.option(d);c.replaceWith(p)}else{var f=this.option(u);if(u.children){var m=this.convertToOptions(u.children);t.appendMany(f,m)}s.push(f)}}return s},i})),t.define("select2/data/ajax",["./array","../utils","jquery"],(function(e,t,n){function i(e,t){this.ajaxOptions=this._applyDefaults(t.get("ajax")),null!=this.ajaxOptions.processResults&&(this.processResults=this.ajaxOptions.processResults),i.__super__.constructor.call(this,e,t)}return t.Extend(i,e),i.prototype._applyDefaults=function(e){var t={data:function(e){return n.extend({},e,{q:e.term})},transport:function(e,t,i){var r=n.ajax(e);return r.then(t),r.fail(i),r}};return n.extend({},t,e,!0)},i.prototype.processResults=function(e){return e},i.prototype.query=function(e,t){var i=this;null!=this._request&&(n.isFunction(this._request.abort)&&this._request.abort(),this._request=null);var r=n.extend({type:"GET"},this.ajaxOptions);function o(){var o=r.transport(r,(function(r){var o=i.processResults(r,e);i.options.get("debug")&&window.console&&console.error&&(o&&o.results&&n.isArray(o.results)||console.error("Select2: The AJAX results did not return an array in the `results` key of the response.")),t(o)}),(function(){(!("status"in o)||0!==o.status&&"0"!==o.status)&&i.trigger("results:message",{message:"errorLoading"})}));i._request=o}"function"===typeof r.url&&(r.url=r.url.call(this.$element,e)),"function"===typeof r.data&&(r.data=r.data.call(this.$element,e)),this.ajaxOptions.delay&&null!=e.term?(this._queryTimeout&&window.clearTimeout(this._queryTimeout),this._queryTimeout=window.setTimeout(o,this.ajaxOptions.delay)):o()},i})),t.define("select2/data/tags",["jquery"],(function(e){function t(t,n,i){var r=i.get("tags"),o=i.get("createTag");void 0!==o&&(this.createTag=o);var s=i.get("insertTag");if(void 0!==s&&(this.insertTag=s),t.call(this,n,i),e.isArray(r))for(var a=0;a<r.length;a++){var l=r[a],u=this._normalizeItem(l),c=this.option(u);this.$element.append(c)}}return t.prototype.query=function(e,t,n){var i=this;function r(e,o){for(var s=e.results,a=0;a<s.length;a++){var l=s[a],u=null!=l.children&&!r({results:l.children},!0),c=(l.text||"").toUpperCase(),h=(t.term||"").toUpperCase(),d=c===h;if(d||u)return!o&&(e.data=s,void n(e))}if(o)return!0;var p=i.createTag(t);if(null!=p){var f=i.option(p);f.attr("data-select2-tag",!0),i.addOptions([f]),i.insertTag(s,p)}e.results=s,n(e)}this._removeOldTags(),null!=t.term&&null==t.page?e.call(this,t,r):e.call(this,t,n)},t.prototype.createTag=function(t,n){var i=e.trim(n.term);return""===i?null:{id:i,text:i}},t.prototype.insertTag=function(e,t,n){t.unshift(n)},t.prototype._removeOldTags=function(t){var n=this.$element.find("option[data-select2-tag]");n.each((function(){this.selected||e(this).remove()}))},t})),t.define("select2/data/tokenizer",["jquery"],(function(e){function t(e,t,n){var i=n.get("tokenizer");void 0!==i&&(this.tokenizer=i),e.call(this,t,n)}return t.prototype.bind=function(e,t,n){e.call(this,t,n),this.$search=t.dropdown.$search||t.selection.$search||n.find(".select2-search__field")},t.prototype.query=function(t,n,i){var r=this;function o(t){var n=r._normalizeItem(t),i=r.$element.find("option").filter((function(){return e(this).val()===n.id}));if(!i.length){var o=r.option(n);o.attr("data-select2-tag",!0),r._removeOldTags(),r.addOptions([o])}s(n)}function s(e){r.trigger("select",{data:e})}n.term=n.term||"";var a=this.tokenizer(n,this.options,o);a.term!==n.term&&(this.$search.length&&(this.$search.val(a.term),this.$search.trigger("focus")),n.term=a.term),t.call(this,n,i)},t.prototype.tokenizer=function(t,n,i,r){var o=i.get("tokenSeparators")||[],s=n.term,a=0,l=this.createTag||function(e){return{id:e.term,text:e.term}};while(a<s.length){var u=s[a];if(-1!==e.inArray(u,o)){var c=s.substr(0,a),h=e.extend({},n,{term:c}),d=l(h);null!=d?(r(d),s=s.substr(a+1)||"",a=0):a++}else a++}return{term:s}},t})),t.define("select2/data/minimumInputLength",[],(function(){function e(e,t,n){this.minimumInputLength=n.get("minimumInputLength"),e.call(this,t,n)}return e.prototype.query=function(e,t,n){t.term=t.term||"",t.term.length<this.minimumInputLength?this.trigger("results:message",{message:"inputTooShort",args:{minimum:this.minimumInputLength,input:t.term,params:t}}):e.call(this,t,n)},e})),t.define("select2/data/maximumInputLength",[],(function(){function e(e,t,n){this.maximumInputLength=n.get("maximumInputLength"),e.call(this,t,n)}return e.prototype.query=function(e,t,n){t.term=t.term||"",this.maximumInputLength>0&&t.term.length>this.maximumInputLength?this.trigger("results:message",{message:"inputTooLong",args:{maximum:this.maximumInputLength,input:t.term,params:t}}):e.call(this,t,n)},e})),t.define("select2/data/maximumSelectionLength",[],(function(){function e(e,t,n){this.maximumSelectionLength=n.get("maximumSelectionLength"),e.call(this,t,n)}return e.prototype.bind=function(e,t,n){var i=this;e.call(this,t,n),t.on("select",(function(){i._checkIfMaximumSelected()}))},e.prototype.query=function(e,t,n){var i=this;this._checkIfMaximumSelected((function(){e.call(i,t,n)}))},e.prototype._checkIfMaximumSelected=function(e,t){var n=this;this.current((function(e){var i=null!=e?e.length:0;n.maximumSelectionLength>0&&i>=n.maximumSelectionLength?n.trigger("results:message",{message:"maximumSelected",args:{maximum:n.maximumSelectionLength}}):t&&t()}))},e})),t.define("select2/dropdown",["jquery","./utils"],(function(e,t){function n(e,t){this.$element=e,this.options=t,n.__super__.constructor.call(this)}return t.Extend(n,t.Observable),n.prototype.render=function(){var t=e('<span class="select2-dropdown"><span class="select2-results"></span></span>');return t.attr("dir",this.options.get("dir")),this.$dropdown=t,t},n.prototype.bind=function(){},n.prototype.position=function(e,t){},n.prototype.destroy=function(){this.$dropdown.remove()},n})),t.define("select2/dropdown/search",["jquery","../utils"],(function(e,t){function n(){}return n.prototype.render=function(t){var n=t.call(this),i=e('<span class="select2-search select2-search--dropdown"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" role="searchbox" aria-autocomplete="list" /></span>');return this.$searchContainer=i,this.$search=i.find("input"),n.prepend(i),n},n.prototype.bind=function(t,n,i){var r=this,o=n.id+"-results";t.call(this,n,i),this.$search.on("keydown",(function(e){r.trigger("keypress",e),r._keyUpPrevented=e.isDefaultPrevented()})),this.$search.on("input",(function(t){e(this).off("keyup")})),this.$search.on("keyup input",(function(e){r.handleSearch(e)})),n.on("open",(function(){r.$search.attr("tabindex",0),r.$search.attr("aria-controls",o),r.$search.trigger("focus"),window.setTimeout((function(){r.$search.trigger("focus")}),0)})),n.on("close",(function(){r.$search.attr("tabindex",-1),r.$search.removeAttr("aria-controls"),r.$search.removeAttr("aria-activedescendant"),r.$search.val(""),r.$search.trigger("blur")})),n.on("focus",(function(){n.isOpen()||r.$search.trigger("focus")})),n.on("results:all",(function(e){if(null==e.query.term||""===e.query.term){var t=r.showSearch(e);t?r.$searchContainer.removeClass("select2-search--hide"):r.$searchContainer.addClass("select2-search--hide")}})),n.on("results:focus",(function(e){e.data._resultId?r.$search.attr("aria-activedescendant",e.data._resultId):r.$search.removeAttr("aria-activedescendant")}))},n.prototype.handleSearch=function(e){if(!this._keyUpPrevented){var t=this.$search.val();this.trigger("query",{term:t})}this._keyUpPrevented=!1},n.prototype.showSearch=function(e,t){return!0},n})),t.define("select2/dropdown/hidePlaceholder",[],(function(){function e(e,t,n,i){this.placeholder=this.normalizePlaceholder(n.get("placeholder")),e.call(this,t,n,i)}return e.prototype.append=function(e,t){t.results=this.removePlaceholder(t.results),e.call(this,t)},e.prototype.normalizePlaceholder=function(e,t){return"string"===typeof t&&(t={id:"",text:t}),t},e.prototype.removePlaceholder=function(e,t){for(var n=t.slice(0),i=t.length-1;i>=0;i--){var r=t[i];this.placeholder.id===r.id&&n.splice(i,1)}return n},e})),t.define("select2/dropdown/infiniteScroll",["jquery"],(function(e){function t(e,t,n,i){this.lastParams={},e.call(this,t,n,i),this.$loadingMore=this.createLoadingMore(),this.loading=!1}return t.prototype.append=function(e,t){this.$loadingMore.remove(),this.loading=!1,e.call(this,t),this.showLoadingMore(t)&&(this.$results.append(this.$loadingMore),this.loadMoreIfNeeded())},t.prototype.bind=function(e,t,n){var i=this;e.call(this,t,n),t.on("query",(function(e){i.lastParams=e,i.loading=!0})),t.on("query:append",(function(e){i.lastParams=e,i.loading=!0})),this.$results.on("scroll",this.loadMoreIfNeeded.bind(this))},t.prototype.loadMoreIfNeeded=function(){var t=e.contains(document.documentElement,this.$loadingMore[0]);if(!this.loading&&t){var n=this.$results.offset().top+this.$results.outerHeight(!1),i=this.$loadingMore.offset().top+this.$loadingMore.outerHeight(!1);n+50>=i&&this.loadMore()}},t.prototype.loadMore=function(){this.loading=!0;var t=e.extend({},{page:1},this.lastParams);t.page++,this.trigger("query:append",t)},t.prototype.showLoadingMore=function(e,t){return t.pagination&&t.pagination.more},t.prototype.createLoadingMore=function(){var t=e('<li class="select2-results__option select2-results__option--load-more"role="option" aria-disabled="true"></li>'),n=this.options.get("translations").get("loadingMore");return t.html(n(this.lastParams)),t},t})),t.define("select2/dropdown/attachBody",["jquery","../utils"],(function(e,t){function n(t,n,i){this.$dropdownParent=e(i.get("dropdownParent")||document.body),t.call(this,n,i)}return n.prototype.bind=function(e,t,n){var i=this;e.call(this,t,n),t.on("open",(function(){i._showDropdown(),i._attachPositioningHandler(t),i._bindContainerResultHandlers(t)})),t.on("close",(function(){i._hideDropdown(),i._detachPositioningHandler(t)})),this.$dropdownContainer.on("mousedown",(function(e){e.stopPropagation()}))},n.prototype.destroy=function(e){e.call(this),this.$dropdownContainer.remove()},n.prototype.position=function(e,t,n){t.attr("class",n.attr("class")),t.removeClass("select2"),t.addClass("select2-container--open"),t.css({position:"absolute",top:-999999}),this.$container=n},n.prototype.render=function(t){var n=e("<span></span>"),i=t.call(this);return n.append(i),this.$dropdownContainer=n,n},n.prototype._hideDropdown=function(e){this.$dropdownContainer.detach()},n.prototype._bindContainerResultHandlers=function(e,t){if(!this._containerResultsHandlersBound){var n=this;t.on("results:all",(function(){n._positionDropdown(),n._resizeDropdown()})),t.on("results:append",(function(){n._positionDropdown(),n._resizeDropdown()})),t.on("results:message",(function(){n._positionDropdown(),n._resizeDropdown()})),t.on("select",(function(){n._positionDropdown(),n._resizeDropdown()})),t.on("unselect",(function(){n._positionDropdown(),n._resizeDropdown()})),this._containerResultsHandlersBound=!0}},n.prototype._attachPositioningHandler=function(n,i){var r=this,o="scroll.select2."+i.id,s="resize.select2."+i.id,a="orientationchange.select2."+i.id,l=this.$container.parents().filter(t.hasScroll);l.each((function(){t.StoreData(this,"select2-scroll-position",{x:e(this).scrollLeft(),y:e(this).scrollTop()})})),l.on(o,(function(n){var i=t.GetData(this,"select2-scroll-position");e(this).scrollTop(i.y)})),e(window).on(o+" "+s+" "+a,(function(e){r._positionDropdown(),r._resizeDropdown()}))},n.prototype._detachPositioningHandler=function(n,i){var r="scroll.select2."+i.id,o="resize.select2."+i.id,s="orientationchange.select2."+i.id,a=this.$container.parents().filter(t.hasScroll);a.off(r),e(window).off(r+" "+o+" "+s)},n.prototype._positionDropdown=function(){var t=e(window),n=this.$dropdown.hasClass("select2-dropdown--above"),i=this.$dropdown.hasClass("select2-dropdown--below"),r=null,o=this.$container.offset();o.bottom=o.top+this.$container.outerHeight(!1);var s={height:this.$container.outerHeight(!1)};s.top=o.top,s.bottom=o.top+s.height;var a={height:this.$dropdown.outerHeight(!1)},l={top:t.scrollTop(),bottom:t.scrollTop()+t.height()},u=l.top<o.top-a.height,c=l.bottom>o.bottom+a.height,h={left:o.left,top:s.bottom},d=this.$dropdownParent;"static"===d.css("position")&&(d=d.offsetParent());var p={top:0,left:0};(e.contains(document.body,d[0])||d[0].isConnected)&&(p=d.offset()),h.top-=p.top,h.left-=p.left,n||i||(r="below"),c||!u||n?!u&&c&&n&&(r="below"):r="above",("above"==r||n&&"below"!==r)&&(h.top=s.top-p.top-a.height),null!=r&&(this.$dropdown.removeClass("select2-dropdown--below select2-dropdown--above").addClass("select2-dropdown--"+r),this.$container.removeClass("select2-container--below select2-container--above").addClass("select2-container--"+r)),this.$dropdownContainer.css(h)},n.prototype._resizeDropdown=function(){var e={width:this.$container.outerWidth(!1)+"px"};this.options.get("dropdownAutoWidth")&&(e.minWidth=e.width,e.position="relative",e.width="auto"),this.$dropdown.css(e)},n.prototype._showDropdown=function(e){this.$dropdownContainer.appendTo(this.$dropdownParent),this._positionDropdown(),this._resizeDropdown()},n})),t.define("select2/dropdown/minimumResultsForSearch",[],(function(){function e(t){for(var n=0,i=0;i<t.length;i++){var r=t[i];r.children?n+=e(r.children):n++}return n}function t(e,t,n,i){this.minimumResultsForSearch=n.get("minimumResultsForSearch"),this.minimumResultsForSearch<0&&(this.minimumResultsForSearch=1/0),e.call(this,t,n,i)}return t.prototype.showSearch=function(t,n){return!(e(n.data.results)<this.minimumResultsForSearch)&&t.call(this,n)},t})),t.define("select2/dropdown/selectOnClose",["../utils"],(function(e){function t(){}return t.prototype.bind=function(e,t,n){var i=this;e.call(this,t,n),t.on("close",(function(e){i._handleSelectOnClose(e)}))},t.prototype._handleSelectOnClose=function(t,n){if(n&&null!=n.originalSelect2Event){var i=n.originalSelect2Event;if("select"===i._type||"unselect"===i._type)return}var r=this.getHighlightedResults();if(!(r.length<1)){var o=e.GetData(r[0],"data");null!=o.element&&o.element.selected||null==o.element&&o.selected||this.trigger("select",{data:o})}},t})),t.define("select2/dropdown/closeOnSelect",[],(function(){function e(){}return e.prototype.bind=function(e,t,n){var i=this;e.call(this,t,n),t.on("select",(function(e){i._selectTriggered(e)})),t.on("unselect",(function(e){i._selectTriggered(e)}))},e.prototype._selectTriggered=function(e,t){var n=t.originalEvent;n&&(n.ctrlKey||n.metaKey)||this.trigger("close",{originalEvent:n,originalSelect2Event:t})},e})),t.define("select2/i18n/en",[],(function(){return{errorLoading:function(){return"The results could not be loaded."},inputTooLong:function(e){var t=e.input.length-e.maximum,n="Please delete "+t+" character";return 1!=t&&(n+="s"),n},inputTooShort:function(e){var t=e.minimum-e.input.length,n="Please enter "+t+" or more characters";return n},loadingMore:function(){return"Loading more results…"},maximumSelected:function(e){var t="You can only select "+e.maximum+" item";return 1!=e.maximum&&(t+="s"),t},noResults:function(){return"No results found"},searching:function(){return"Searching…"},removeAllItems:function(){return"Remove all items"}}})),t.define("select2/defaults",["jquery","require","./results","./selection/single","./selection/multiple","./selection/placeholder","./selection/allowClear","./selection/search","./selection/eventRelay","./utils","./translation","./diacritics","./data/select","./data/array","./data/ajax","./data/tags","./data/tokenizer","./data/minimumInputLength","./data/maximumInputLength","./data/maximumSelectionLength","./dropdown","./dropdown/search","./dropdown/hidePlaceholder","./dropdown/infiniteScroll","./dropdown/attachBody","./dropdown/minimumResultsForSearch","./dropdown/selectOnClose","./dropdown/closeOnSelect","./i18n/en"],(function(e,t,n,i,r,o,s,a,l,u,c,h,d,p,f,m,g,v,y,x,b,w,_,A,S,E,M,T,C){function P(){this.reset()}P.prototype.apply=function(c){if(c=e.extend(!0,{},this.defaults,c),null==c.dataAdapter){if(null!=c.ajax?c.dataAdapter=f:null!=c.data?c.dataAdapter=p:c.dataAdapter=d,c.minimumInputLength>0&&(c.dataAdapter=u.Decorate(c.dataAdapter,v)),c.maximumInputLength>0&&(c.dataAdapter=u.Decorate(c.dataAdapter,y)),c.maximumSelectionLength>0&&(c.dataAdapter=u.Decorate(c.dataAdapter,x)),c.tags&&(c.dataAdapter=u.Decorate(c.dataAdapter,m)),null==c.tokenSeparators&&null==c.tokenizer||(c.dataAdapter=u.Decorate(c.dataAdapter,g)),null!=c.query){var h=t(c.amdBase+"compat/query");c.dataAdapter=u.Decorate(c.dataAdapter,h)}if(null!=c.initSelection){var C=t(c.amdBase+"compat/initSelection");c.dataAdapter=u.Decorate(c.dataAdapter,C)}}if(null==c.resultsAdapter&&(c.resultsAdapter=n,null!=c.ajax&&(c.resultsAdapter=u.Decorate(c.resultsAdapter,A)),null!=c.placeholder&&(c.resultsAdapter=u.Decorate(c.resultsAdapter,_)),c.selectOnClose&&(c.resultsAdapter=u.Decorate(c.resultsAdapter,M))),null==c.dropdownAdapter){if(c.multiple)c.dropdownAdapter=b;else{var P=u.Decorate(b,w);c.dropdownAdapter=P}if(0!==c.minimumResultsForSearch&&(c.dropdownAdapter=u.Decorate(c.dropdownAdapter,E)),c.closeOnSelect&&(c.dropdownAdapter=u.Decorate(c.dropdownAdapter,T)),null!=c.dropdownCssClass||null!=c.dropdownCss||null!=c.adaptDropdownCssClass){var R=t(c.amdBase+"compat/dropdownCss");c.dropdownAdapter=u.Decorate(c.dropdownAdapter,R)}c.dropdownAdapter=u.Decorate(c.dropdownAdapter,S)}if(null==c.selectionAdapter){if(c.multiple?c.selectionAdapter=r:c.selectionAdapter=i,null!=c.placeholder&&(c.selectionAdapter=u.Decorate(c.selectionAdapter,o)),c.allowClear&&(c.selectionAdapter=u.Decorate(c.selectionAdapter,s)),c.multiple&&(c.selectionAdapter=u.Decorate(c.selectionAdapter,a)),null!=c.containerCssClass||null!=c.containerCss||null!=c.adaptContainerCssClass){var L=t(c.amdBase+"compat/containerCss");c.selectionAdapter=u.Decorate(c.selectionAdapter,L)}c.selectionAdapter=u.Decorate(c.selectionAdapter,l)}c.language=this._resolveLanguage(c.language),c.language.push("en");for(var O=[],D=0;D<c.language.length;D++){var I=c.language[D];-1===O.indexOf(I)&&O.push(I)}return c.language=O,c.translations=this._processTranslations(c.language,c.debug),c},P.prototype.reset=function(){function t(e){function t(e){return h[e]||e}return e.replace(/[^\u0000-\u007E]/g,t)}function n(i,r){if(""===e.trim(i.term))return r;if(r.children&&r.children.length>0){for(var o=e.extend(!0,{},r),s=r.children.length-1;s>=0;s--){var a=r.children[s],l=n(i,a);null==l&&o.children.splice(s,1)}return o.children.length>0?o:n(i,o)}var u=t(r.text).toUpperCase(),c=t(i.term).toUpperCase();return u.indexOf(c)>-1?r:null}this.defaults={amdBase:"./",amdLanguageBase:"./i18n/",closeOnSelect:!0,debug:!1,dropdownAutoWidth:!1,escapeMarkup:u.escapeMarkup,language:{},matcher:n,minimumInputLength:0,maximumInputLength:0,maximumSelectionLength:0,minimumResultsForSearch:0,selectOnClose:!1,scrollAfterSelect:!1,sorter:function(e){return e},templateResult:function(e){return e.text},templateSelection:function(e){return e.text},theme:"default",width:"resolve"}},P.prototype.applyFromElement=function(e,t){var n=e.language,i=this.defaults.language,r=t.prop("lang"),o=t.closest("[lang]").prop("lang"),s=Array.prototype.concat.call(this._resolveLanguage(r),this._resolveLanguage(n),this._resolveLanguage(i),this._resolveLanguage(o));return e.language=s,e},P.prototype._resolveLanguage=function(t){if(!t)return[];if(e.isEmptyObject(t))return[];if(e.isPlainObject(t))return[t];var n;n=e.isArray(t)?t:[t];for(var i=[],r=0;r<n.length;r++)if(i.push(n[r]),"string"===typeof n[r]&&n[r].indexOf("-")>0){var o=n[r].split("-"),s=o[0];i.push(s)}return i},P.prototype._processTranslations=function(t,n){for(var i=new c,r=0;r<t.length;r++){var o=new c,s=t[r];if("string"===typeof s)try{o=c.loadPath(s)}catch(a){try{s=this.defaults.amdLanguageBase+s,o=c.loadPath(s)}catch(l){n&&window.console&&console.warn&&console.warn('Select2: The language file for "'+s+'" could not be automatically loaded. A fallback will be used instead.')}}else o=e.isPlainObject(s)?new c(s):s;i.extend(o)}return i},P.prototype.set=function(t,n){var i=e.camelCase(t),r={};r[i]=n;var o=u._convertData(r);e.extend(!0,this.defaults,o)};var R=new P;return R})),t.define("select2/options",["require","jquery","./defaults","./utils"],(function(e,t,n,i){function r(t,r){if(this.options=t,null!=r&&this.fromElement(r),null!=r&&(this.options=n.applyFromElement(this.options,r)),this.options=n.apply(this.options),r&&r.is("input")){var o=e(this.get("amdBase")+"compat/inputData");this.options.dataAdapter=i.Decorate(this.options.dataAdapter,o)}}return r.prototype.fromElement=function(e){var n=["select2"];null==this.options.multiple&&(this.options.multiple=e.prop("multiple")),null==this.options.disabled&&(this.options.disabled=e.prop("disabled")),null==this.options.dir&&(e.prop("dir")?this.options.dir=e.prop("dir"):e.closest("[dir]").prop("dir")?this.options.dir=e.closest("[dir]").prop("dir"):this.options.dir="ltr"),e.prop("disabled",this.options.disabled),e.prop("multiple",this.options.multiple),i.GetData(e[0],"select2Tags")&&(this.options.debug&&window.console&&console.warn&&console.warn('Select2: The `data-select2-tags` attribute has been changed to use the `data-data` and `data-tags="true"` attributes and will be removed in future versions of Select2.'),i.StoreData(e[0],"data",i.GetData(e[0],"select2Tags")),i.StoreData(e[0],"tags",!0)),i.GetData(e[0],"ajaxUrl")&&(this.options.debug&&window.console&&console.warn&&console.warn("Select2: The `data-ajax-url` attribute has been changed to `data-ajax--url` and support for the old attribute will be removed in future versions of Select2."),e.attr("ajax--url",i.GetData(e[0],"ajaxUrl")),i.StoreData(e[0],"ajax-Url",i.GetData(e[0],"ajaxUrl")));var r={};function o(e,t){return t.toUpperCase()}for(var s=0;s<e[0].attributes.length;s++){var a=e[0].attributes[s].name,l="data-";if(a.substr(0,l.length)==l){var u=a.substring(l.length),c=i.GetData(e[0],u),h=u.replace(/-([a-z])/g,o);r[h]=c}}t.fn.jquery&&"1."==t.fn.jquery.substr(0,2)&&e[0].dataset&&(r=t.extend(!0,{},e[0].dataset,r));var d=t.extend(!0,{},i.GetData(e[0]),r);for(var p in d=i._convertData(d),d)t.inArray(p,n)>-1||(t.isPlainObject(this.options[p])?t.extend(this.options[p],d[p]):this.options[p]=d[p]);return this},r.prototype.get=function(e){return this.options[e]},r.prototype.set=function(e,t){this.options[e]=t},r})),t.define("select2/core",["jquery","./options","./utils","./keys"],(function(e,t,n,i){var r=function(e,i){null!=n.GetData(e[0],"select2")&&n.GetData(e[0],"select2").destroy(),this.$element=e,this.id=this._generateId(e),i=i||{},this.options=new t(i,e),r.__super__.constructor.call(this);var o=e.attr("tabindex")||0;n.StoreData(e[0],"old-tabindex",o),e.attr("tabindex","-1");var s=this.options.get("dataAdapter");this.dataAdapter=new s(e,this.options);var a=this.render();this._placeContainer(a);var l=this.options.get("selectionAdapter");this.selection=new l(e,this.options),this.$selection=this.selection.render(),this.selection.position(this.$selection,a);var u=this.options.get("dropdownAdapter");this.dropdown=new u(e,this.options),this.$dropdown=this.dropdown.render(),this.dropdown.position(this.$dropdown,a);var c=this.options.get("resultsAdapter");this.results=new c(e,this.options,this.dataAdapter),this.$results=this.results.render(),this.results.position(this.$results,this.$dropdown);var h=this;this._bindAdapters(),this._registerDomEvents(),this._registerDataEvents(),this._registerSelectionEvents(),this._registerDropdownEvents(),this._registerResultsEvents(),this._registerEvents(),this.dataAdapter.current((function(e){h.trigger("selection:update",{data:e})})),e.addClass("select2-hidden-accessible"),e.attr("aria-hidden","true"),this._syncAttributes(),n.StoreData(e[0],"select2",this),e.data("select2",this)};return n.Extend(r,n.Observable),r.prototype._generateId=function(e){var t="";return t=null!=e.attr("id")?e.attr("id"):null!=e.attr("name")?e.attr("name")+"-"+n.generateChars(2):n.generateChars(4),t=t.replace(/(:|\.|\[|\]|,)/g,""),t="select2-"+t,t},r.prototype._placeContainer=function(e){e.insertAfter(this.$element);var t=this._resolveWidth(this.$element,this.options.get("width"));null!=t&&e.css("width",t)},r.prototype._resolveWidth=function(e,t){var n=/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i;if("resolve"==t){var i=this._resolveWidth(e,"style");return null!=i?i:this._resolveWidth(e,"element")}if("element"==t){var r=e.outerWidth(!1);return r<=0?"auto":r+"px"}if("style"==t){var o=e.attr("style");if("string"!==typeof o)return null;for(var s=o.split(";"),a=0,l=s.length;a<l;a+=1){var u=s[a].replace(/\s/g,""),c=u.match(n);if(null!==c&&c.length>=1)return c[1]}return null}if("computedstyle"==t){var h=window.getComputedStyle(e[0]);return h.width}return t},r.prototype._bindAdapters=function(){this.dataAdapter.bind(this,this.$container),this.selection.bind(this,this.$container),this.dropdown.bind(this,this.$container),this.results.bind(this,this.$container)},r.prototype._registerDomEvents=function(){var e=this;this.$element.on("change.select2",(function(){e.dataAdapter.current((function(t){e.trigger("selection:update",{data:t})}))})),this.$element.on("focus.select2",(function(t){e.trigger("focus",t)})),this._syncA=n.bind(this._syncAttributes,this),this._syncS=n.bind(this._syncSubtree,this),this.$element[0].attachEvent&&this.$element[0].attachEvent("onpropertychange",this._syncA);var t=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;null!=t?(this._observer=new t((function(t){e._syncA(),e._syncS(null,t)})),this._observer.observe(this.$element[0],{attributes:!0,childList:!0,subtree:!1})):this.$element[0].addEventListener&&(this.$element[0].addEventListener("DOMAttrModified",e._syncA,!1),this.$element[0].addEventListener("DOMNodeInserted",e._syncS,!1),this.$element[0].addEventListener("DOMNodeRemoved",e._syncS,!1))},r.prototype._registerDataEvents=function(){var e=this;this.dataAdapter.on("*",(function(t,n){e.trigger(t,n)}))},r.prototype._registerSelectionEvents=function(){var t=this,n=["toggle","focus"];this.selection.on("toggle",(function(){t.toggleDropdown()})),this.selection.on("focus",(function(e){t.focus(e)})),this.selection.on("*",(function(i,r){-1===e.inArray(i,n)&&t.trigger(i,r)}))},r.prototype._registerDropdownEvents=function(){var e=this;this.dropdown.on("*",(function(t,n){e.trigger(t,n)}))},r.prototype._registerResultsEvents=function(){var e=this;this.results.on("*",(function(t,n){e.trigger(t,n)}))},r.prototype._registerEvents=function(){var e=this;this.on("open",(function(){e.$container.addClass("select2-container--open")})),this.on("close",(function(){e.$container.removeClass("select2-container--open")})),this.on("enable",(function(){e.$container.removeClass("select2-container--disabled")})),this.on("disable",(function(){e.$container.addClass("select2-container--disabled")})),this.on("blur",(function(){e.$container.removeClass("select2-container--focus")})),this.on("query",(function(t){e.isOpen()||e.trigger("open",{}),this.dataAdapter.query(t,(function(n){e.trigger("results:all",{data:n,query:t})}))})),this.on("query:append",(function(t){this.dataAdapter.query(t,(function(n){e.trigger("results:append",{data:n,query:t})}))})),this.on("keypress",(function(t){var n=t.which;e.isOpen()?n===i.ESC||n===i.TAB||n===i.UP&&t.altKey?(e.close(t),t.preventDefault()):n===i.ENTER?(e.trigger("results:select",{}),t.preventDefault()):n===i.SPACE&&t.ctrlKey?(e.trigger("results:toggle",{}),t.preventDefault()):n===i.UP?(e.trigger("results:previous",{}),t.preventDefault()):n===i.DOWN&&(e.trigger("results:next",{}),t.preventDefault()):(n===i.ENTER||n===i.SPACE||n===i.DOWN&&t.altKey)&&(e.open(),t.preventDefault())}))},r.prototype._syncAttributes=function(){this.options.set("disabled",this.$element.prop("disabled")),this.isDisabled()?(this.isOpen()&&this.close(),this.trigger("disable",{})):this.trigger("enable",{})},r.prototype._isChangeMutation=function(t,n){var i=!1,r=this;if(!t||!t.target||"OPTION"===t.target.nodeName||"OPTGROUP"===t.target.nodeName){if(n)if(n.addedNodes&&n.addedNodes.length>0)for(var o=0;o<n.addedNodes.length;o++){var s=n.addedNodes[o];s.selected&&(i=!0)}else n.removedNodes&&n.removedNodes.length>0?i=!0:e.isArray(n)&&e.each(n,(function(e,t){if(r._isChangeMutation(e,t))return i=!0,!1}));else i=!0;return i}},r.prototype._syncSubtree=function(e,t){var n=this._isChangeMutation(e,t),i=this;n&&this.dataAdapter.current((function(e){i.trigger("selection:update",{data:e})}))},r.prototype.trigger=function(e,t){var n=r.__super__.trigger,i={open:"opening",close:"closing",select:"selecting",unselect:"unselecting",clear:"clearing"};if(void 0===t&&(t={}),e in i){var o=i[e],s={prevented:!1,name:e,args:t};if(n.call(this,o,s),s.prevented)return void(t.prevented=!0)}n.call(this,e,t)},r.prototype.toggleDropdown=function(){this.isDisabled()||(this.isOpen()?this.close():this.open())},r.prototype.open=function(){this.isOpen()||this.isDisabled()||this.trigger("query",{})},r.prototype.close=function(e){this.isOpen()&&this.trigger("close",{originalEvent:e})},r.prototype.isEnabled=function(){return!this.isDisabled()},r.prototype.isDisabled=function(){return this.options.get("disabled")},r.prototype.isOpen=function(){return this.$container.hasClass("select2-container--open")},r.prototype.hasFocus=function(){return this.$container.hasClass("select2-container--focus")},r.prototype.focus=function(e){this.hasFocus()||(this.$container.addClass("select2-container--focus"),this.trigger("focus",{}))},r.prototype.enable=function(e){this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("enable")` method has been deprecated and will be removed in later Select2 versions. Use $element.prop("disabled") instead.'),null!=e&&0!==e.length||(e=[!0]);var t=!e[0];this.$element.prop("disabled",t)},r.prototype.data=function(){this.options.get("debug")&&arguments.length>0&&window.console&&console.warn&&console.warn('Select2: Data can no longer be set using `select2("data")`. You should consider setting the value instead using `$element.val()`.');var e=[];return this.dataAdapter.current((function(t){e=t})),e},r.prototype.val=function(t){if(this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("val")` method has been deprecated and will be removed in later Select2 versions. Use $element.val() instead.'),null==t||0===t.length)return this.$element.val();var n=t[0];e.isArray(n)&&(n=e.map(n,(function(e){return e.toString()}))),this.$element.val(n).trigger("input").trigger("change")},r.prototype.destroy=function(){this.$container.remove(),this.$element[0].detachEvent&&this.$element[0].detachEvent("onpropertychange",this._syncA),null!=this._observer?(this._observer.disconnect(),this._observer=null):this.$element[0].removeEventListener&&(this.$element[0].removeEventListener("DOMAttrModified",this._syncA,!1),this.$element[0].removeEventListener("DOMNodeInserted",this._syncS,!1),this.$element[0].removeEventListener("DOMNodeRemoved",this._syncS,!1)),this._syncA=null,this._syncS=null,this.$element.off(".select2"),this.$element.attr("tabindex",n.GetData(this.$element[0],"old-tabindex")),this.$element.removeClass("select2-hidden-accessible"),this.$element.attr("aria-hidden","false"),n.RemoveData(this.$element[0]),this.$element.removeData("select2"),this.dataAdapter.destroy(),this.selection.destroy(),this.dropdown.destroy(),this.results.destroy(),this.dataAdapter=null,this.selection=null,this.dropdown=null,this.results=null},r.prototype.render=function(){var t=e('<span class="select2 select2-container"><span class="selection"></span><span class="dropdown-wrapper" aria-hidden="true"></span></span>');return t.attr("dir",this.options.get("dir")),this.$container=t,this.$container.addClass("select2-container--"+this.options.get("theme")),n.StoreData(t[0],"element",this.$element),t},r})),t.define("jquery-mousewheel",["jquery"],(function(e){return e})),t.define("jquery.select2",["jquery","jquery-mousewheel","./select2/core","./select2/defaults","./select2/utils"],(function(e,t,n,i,r){if(null==e.fn.select2){var o=["open","close","destroy"];e.fn.select2=function(t){if(t=t||{},"object"===typeof t)return this.each((function(){var i=e.extend(!0,{},t);new n(e(this),i)})),this;if("string"===typeof t){var i,s=Array.prototype.slice.call(arguments,1);return this.each((function(){var e=r.GetData(this,"select2");null==e&&window.console&&console.error&&console.error("The select2('"+t+"') method was called on an element that is not using Select2."),i=e[t].apply(e,s)})),e.inArray(t,o)>-1?this:i}throw new Error("Invalid arguments for Select2: "+t)}}return null==e.fn.select2.defaults&&(e.fn.select2.defaults=i),n})),{define:t.define,require:t.require}}(),n=t.require("jquery.select2");return e.fn.select2.amd=t,n}))}).call(this,n("1157"))},1212:function(e,t,n){(function(e){var i;(function(e,r,o){function s(e){var t=this,n=u();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(e),t.s0<0&&(t.s0+=1),t.s1-=n(e),t.s1<0&&(t.s1+=1),t.s2-=n(e),t.s2<0&&(t.s2+=1),n=null}function a(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function l(e,t){var n=new s(e),i=t&&t.state,r=n.next;return r.int32=function(){return 4294967296*n.next()|0},r.double=function(){return r()+11102230246251565e-32*(2097152*r()|0)},r.quick=r,i&&("object"==typeof i&&a(i,n),r.state=function(){return a(n,{})}),r}function u(){var e=4022871197,t=function(t){t=String(t);for(var n=0;n<t.length;n++){e+=t.charCodeAt(n);var i=.02519603282416938*e;e=i>>>0,i-=e,i*=e,e=i>>>0,i-=e,e+=4294967296*i}return 2.3283064365386963e-10*(e>>>0)};return t}r&&r.exports?r.exports=l:n("07d6")&&n("3c35")?(i=function(){return l}.call(t,n,t,r),void 0===i||(r.exports=i)):this.alea=l})(0,e,n("07d6"))}).call(this,n("62e4")(e))},"131a":function(e,t,n){var i=n("23e7"),r=n("d2bb");i({target:"Object",stat:!0},{setPrototypeOf:r})},"143c":function(e,t,n){var i=n("74e8");i("Int32",(function(e){return function(t,n,i){return e(this,t,n,i)}}))},1448:function(e,t,n){var i=n("dfb9"),r=n("b6b7");e.exports=function(e,t){return i(r(e),t)}},"145e":function(e,t,n){"use strict";var i=n("7b0b"),r=n("23cb"),o=n("50c4"),s=Math.min;e.exports=[].copyWithin||function(e,t){var n=i(this),a=o(n.length),l=r(e,a),u=r(t,a),c=arguments.length>2?arguments[2]:void 0,h=s((void 0===c?a:r(c,a))-u,a-l),d=1;u<l&&l<u+h&&(d=-1,u+=h-1,l+=h-1);while(h-- >0)u in n?n[l]=n[u]:delete n[l],l+=d,u+=d;return n}},"170b":function(e,t,n){"use strict";var i=n("ebb5"),r=n("50c4"),o=n("23cb"),s=n("b6b7"),a=i.aTypedArray,l=i.exportTypedArrayMethod;l("subarray",(function(e,t){var n=a(this),i=n.length,l=o(e,i),u=s(n);return new u(n.buffer,n.byteOffset+l*n.BYTES_PER_ELEMENT,r((void 0===t?i:o(t,i))-l))}))},"182d":function(e,t,n){var i=n("f8cd");e.exports=function(e,t){var n=i(e);if(n%t)throw RangeError("Wrong offset");return n}},1985:function(e,t,n){(function(e,i){var r;/*! https://mths.be/punycode v1.4.1 by @mathias */(function(o){t&&t.nodeType,e&&e.nodeType;var s="object"==typeof i&&i;s.global!==s&&s.window!==s&&s.self;var a,l=2147483647,u=36,c=1,h=26,d=38,p=700,f=72,m=128,g="-",v=/^xn--/,y=/[^\x20-\x7E]/,x=/[\x2E\u3002\uFF0E\uFF61]/g,b={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},w=u-c,_=Math.floor,A=String.fromCharCode;function S(e){throw new RangeError(b[e])}function E(e,t){var n=e.length,i=[];while(n--)i[n]=t(e[n]);return i}function M(e,t){var n=e.split("@"),i="";n.length>1&&(i=n[0]+"@",e=n[1]),e=e.replace(x,".");var r=e.split("."),o=E(r,t).join(".");return i+o}function T(e){var t,n,i=[],r=0,o=e.length;while(r<o)t=e.charCodeAt(r++),t>=55296&&t<=56319&&r<o?(n=e.charCodeAt(r++),56320==(64512&n)?i.push(((1023&t)<<10)+(1023&n)+65536):(i.push(t),r--)):i.push(t);return i}function C(e){return E(e,(function(e){var t="";return e>65535&&(e-=65536,t+=A(e>>>10&1023|55296),e=56320|1023&e),t+=A(e),t})).join("")}function P(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:u}function R(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function L(e,t,n){var i=0;for(e=n?_(e/p):e>>1,e+=_(e/t);e>w*h>>1;i+=u)e=_(e/w);return _(i+(w+1)*e/(e+d))}function O(e){var t,n,i,r,o,s,a,d,p,v,y=[],x=e.length,b=0,w=m,A=f;for(n=e.lastIndexOf(g),n<0&&(n=0),i=0;i<n;++i)e.charCodeAt(i)>=128&&S("not-basic"),y.push(e.charCodeAt(i));for(r=n>0?n+1:0;r<x;){for(o=b,s=1,a=u;;a+=u){if(r>=x&&S("invalid-input"),d=P(e.charCodeAt(r++)),(d>=u||d>_((l-b)/s))&&S("overflow"),b+=d*s,p=a<=A?c:a>=A+h?h:a-A,d<p)break;v=u-p,s>_(l/v)&&S("overflow"),s*=v}t=y.length+1,A=L(b-o,t,0==o),_(b/t)>l-w&&S("overflow"),w+=_(b/t),b%=t,y.splice(b++,0,w)}return C(y)}function D(e){var t,n,i,r,o,s,a,d,p,v,y,x,b,w,E,M=[];for(e=T(e),x=e.length,t=m,n=0,o=f,s=0;s<x;++s)y=e[s],y<128&&M.push(A(y));i=r=M.length,r&&M.push(g);while(i<x){for(a=l,s=0;s<x;++s)y=e[s],y>=t&&y<a&&(a=y);for(b=i+1,a-t>_((l-n)/b)&&S("overflow"),n+=(a-t)*b,t=a,s=0;s<x;++s)if(y=e[s],y<t&&++n>l&&S("overflow"),y==t){for(d=n,p=u;;p+=u){if(v=p<=o?c:p>=o+h?h:p-o,d<v)break;E=d-v,w=u-v,M.push(A(R(v+E%w,0))),d=_(E/w)}M.push(A(R(d,0))),o=L(n,b,i==r),n=0,++i}++n,++t}return M.join("")}function I(e){return M(e,(function(e){return v.test(e)?O(e.slice(4).toLowerCase()):e}))}function N(e){return M(e,(function(e){return y.test(e)?"xn--"+D(e):e}))}a={version:"1.4.1",ucs2:{decode:T,encode:C},decode:O,encode:D,toASCII:N,toUnicode:I},r=function(){return a}.call(t,n,t,e),void 0===r||(e.exports=r)})()}).call(this,n("62e4")(e),n("c8ba"))},"1a88":function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var i=n("eadc"),r=n("82ac"),o=n("d8ad"),s=n("fda4");function a(e){return e.source}function l(e){return e.target}function u(e){var t=a,n=l,u=s["a"],c=s["b"],h=null;function d(){var o,s=r["b"].call(arguments),a=t.apply(this,s),l=n.apply(this,s);if(h||(h=o=Object(i["a"])()),e(h,+u.apply(this,(s[0]=a,s)),+c.apply(this,s),+u.apply(this,(s[0]=l,s)),+c.apply(this,s)),o)return h=null,o+""||null}return d.source=function(e){return arguments.length?(t=e,d):t},d.target=function(e){return arguments.length?(n=e,d):n},d.x=function(e){return arguments.length?(u="function"===typeof e?e:Object(o["a"])(+e),d):u},d.y=function(e){return arguments.length?(c="function"===typeof e?e:Object(o["a"])(+e),d):c},d.context=function(e){return arguments.length?(h=null==e?null:e,d):h},d}function c(e,t,n,i,r){e.moveTo(t,n),e.bezierCurveTo(t=(t+i)/2,n,t,r,i,r)}function h(){return u(c)}},"1dec":function(e){e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"http://json-schema.org/draft-07/schema#","title":"Core schema meta-schema","definitions":{"schemaArray":{"type":"array","minItems":1,"items":{"$ref":"#"}},"nonNegativeInteger":{"type":"integer","minimum":0},"nonNegativeIntegerDefault0":{"allOf":[{"$ref":"#/definitions/nonNegativeInteger"},{"default":0}]},"simpleTypes":{"enum":["array","boolean","integer","null","number","object","string"]},"stringArray":{"type":"array","items":{"type":"string"},"uniqueItems":true,"default":[]}},"type":["object","boolean"],"properties":{"$id":{"type":"string","format":"uri-reference"},"$schema":{"type":"string","format":"uri"},"$ref":{"type":"string","format":"uri-reference"},"$comment":{"type":"string"},"title":{"type":"string"},"description":{"type":"string"},"default":true,"readOnly":{"type":"boolean","default":false},"examples":{"type":"array","items":true},"multipleOf":{"type":"number","exclusiveMinimum":0},"maximum":{"type":"number"},"exclusiveMaximum":{"type":"number"},"minimum":{"type":"number"},"exclusiveMinimum":{"type":"number"},"maxLength":{"$ref":"#/definitions/nonNegativeInteger"},"minLength":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"pattern":{"type":"string","format":"regex"},"additionalItems":{"$ref":"#"},"items":{"anyOf":[{"$ref":"#"},{"$ref":"#/definitions/schemaArray"}],"default":true},"maxItems":{"$ref":"#/definitions/nonNegativeInteger"},"minItems":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"uniqueItems":{"type":"boolean","default":false},"contains":{"$ref":"#"},"maxProperties":{"$ref":"#/definitions/nonNegativeInteger"},"minProperties":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"required":{"$ref":"#/definitions/stringArray"},"additionalProperties":{"$ref":"#"},"definitions":{"type":"object","additionalProperties":{"$ref":"#"},"default":{}},"properties":{"type":"object","additionalProperties":{"$ref":"#"},"default":{}},"patternProperties":{"type":"object","additionalProperties":{"$ref":"#"},"propertyNames":{"format":"regex"},"default":{}},"dependencies":{"type":"object","additionalProperties":{"anyOf":[{"$ref":"#"},{"$ref":"#/definitions/stringArray"}]}},"propertyNames":{"$ref":"#"},"const":true,"enum":{"type":"array","items":true,"minItems":1,"uniqueItems":true},"type":{"anyOf":[{"$ref":"#/definitions/simpleTypes"},{"type":"array","items":{"$ref":"#/definitions/simpleTypes"},"minItems":1,"uniqueItems":true}]},"format":{"type":"string"},"contentMediaType":{"type":"string"},"contentEncoding":{"type":"string"},"if":{"$ref":"#"},"then":{"$ref":"#"},"else":{"$ref":"#"},"allOf":{"$ref":"#/definitions/schemaArray"},"anyOf":{"$ref":"#/definitions/schemaArray"},"oneOf":{"$ref":"#/definitions/schemaArray"},"not":{"$ref":"#"}},"default":true}')},"1f03":function(e,t,n){"use strict";e.exports=function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}},"1f25":function(e,t,n){"use strict";const i=n("5cf7"),r=Symbol("max"),o=Symbol("length"),s=Symbol("lengthCalculator"),a=Symbol("allowStale"),l=Symbol("maxAge"),u=Symbol("dispose"),c=Symbol("noDisposeOnSet"),h=Symbol("lruList"),d=Symbol("cache"),p=Symbol("updateAgeOnGet"),f=()=>1;class m{constructor(e){if("number"===typeof e&&(e={max:e}),e||(e={}),e.max&&("number"!==typeof e.max||e.max<0))throw new TypeError("max must be a non-negative number");this[r]=e.max||1/0;const t=e.length||f;if(this[s]="function"!==typeof t?f:t,this[a]=e.stale||!1,e.maxAge&&"number"!==typeof e.maxAge)throw new TypeError("maxAge must be a number");this[l]=e.maxAge||0,this[u]=e.dispose,this[c]=e.noDisposeOnSet||!1,this[p]=e.updateAgeOnGet||!1,this.reset()}set max(e){if("number"!==typeof e||e<0)throw new TypeError("max must be a non-negative number");this[r]=e||1/0,y(this)}get max(){return this[r]}set allowStale(e){this[a]=!!e}get allowStale(){return this[a]}set maxAge(e){if("number"!==typeof e)throw new TypeError("maxAge must be a non-negative number");this[l]=e,y(this)}get maxAge(){return this[l]}set lengthCalculator(e){"function"!==typeof e&&(e=f),e!==this[s]&&(this[s]=e,this[o]=0,this[h].forEach(e=>{e.length=this[s](e.value,e.key),this[o]+=e.length})),y(this)}get lengthCalculator(){return this[s]}get length(){return this[o]}get itemCount(){return this[h].length}rforEach(e,t){t=t||this;for(let n=this[h].tail;null!==n;){const i=n.prev;w(this,e,n,t),n=i}}forEach(e,t){t=t||this;for(let n=this[h].head;null!==n;){const i=n.next;w(this,e,n,t),n=i}}keys(){return this[h].toArray().map(e=>e.key)}values(){return this[h].toArray().map(e=>e.value)}reset(){this[u]&&this[h]&&this[h].length&&this[h].forEach(e=>this[u](e.key,e.value)),this[d]=new Map,this[h]=new i,this[o]=0}dump(){return this[h].map(e=>!v(this,e)&&{k:e.key,v:e.value,e:e.now+(e.maxAge||0)}).toArray().filter(e=>e)}dumpLru(){return this[h]}set(e,t,n){if(n=n||this[l],n&&"number"!==typeof n)throw new TypeError("maxAge must be a number");const i=n?Date.now():0,a=this[s](t,e);if(this[d].has(e)){if(a>this[r])return x(this,this[d].get(e)),!1;const s=this[d].get(e),l=s.value;return this[u]&&(this[c]||this[u](e,l.value)),l.now=i,l.maxAge=n,l.value=t,this[o]+=a-l.length,l.length=a,this.get(e),y(this),!0}const p=new b(e,t,a,i,n);return p.length>this[r]?(this[u]&&this[u](e,t),!1):(this[o]+=p.length,this[h].unshift(p),this[d].set(e,this[h].head),y(this),!0)}has(e){if(!this[d].has(e))return!1;const t=this[d].get(e).value;return!v(this,t)}get(e){return g(this,e,!0)}peek(e){return g(this,e,!1)}pop(){const e=this[h].tail;return e?(x(this,e),e.value):null}del(e){x(this,this[d].get(e))}load(e){this.reset();const t=Date.now();for(let n=e.length-1;n>=0;n--){const i=e[n],r=i.e||0;if(0===r)this.set(i.k,i.v);else{const e=r-t;e>0&&this.set(i.k,i.v,e)}}}prune(){this[d].forEach((e,t)=>g(this,t,!1))}}const g=(e,t,n)=>{const i=e[d].get(t);if(i){const t=i.value;if(v(e,t)){if(x(e,i),!e[a])return}else n&&(e[p]&&(i.value.now=Date.now()),e[h].unshiftNode(i));return t.value}},v=(e,t)=>{if(!t||!t.maxAge&&!e[l])return!1;const n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[l]&&n>e[l]},y=e=>{if(e[o]>e[r])for(let t=e[h].tail;e[o]>e[r]&&null!==t;){const n=t.prev;x(e,t),t=n}},x=(e,t)=>{if(t){const n=t.value;e[u]&&e[u](n.key,n.value),e[o]-=n.length,e[d].delete(n.key),e[h].removeNode(t)}};class b{constructor(e,t,n,i,r){this.key=e,this.value=t,this.length=n,this.now=i,this.maxAge=r||0}}const w=(e,t,n,i)=>{let r=n.value;v(e,r)&&(x(e,n),e[a]||(r=void 0)),r&&t.call(i,r.value,r.key,e)};e.exports=m},"219c":function(e,t,n){"use strict";var i=n("ebb5"),r=n("da84"),o=n("d039"),s=n("1c0b"),a=n("50c4"),l=n("addb"),u=n("04d1"),c=n("d998"),h=n("2d00"),d=n("512c"),p=i.aTypedArray,f=i.exportTypedArrayMethod,m=r.Uint16Array,g=m&&m.prototype.sort,v=!!g&&!o((function(){var e=new m(2);e.sort(null),e.sort({})})),y=!!g&&!o((function(){if(h)return h<74;if(u)return u<67;if(c)return!0;if(d)return d<602;var e,t,n=new m(516),i=Array(516);for(e=0;e<516;e++)t=e%4,n[e]=515-e,i[e]=e-2*t+3;for(n.sort((function(e,t){return(e/4|0)-(t/4|0)})),e=0;e<516;e++)if(n[e]!==i[e])return!0})),x=function(e){return function(t,n){return void 0!==e?+e(t,n)||0:n!==n?-1:t!==t?1:0===t&&0===n?1/t>0&&1/n<0?1:-1:t>n}};f("sort",(function(e){var t=this;if(void 0!==e&&s(e),y)return g.call(t,e);p(t);var n,i=a(t.length),r=Array(i);for(n=0;n<i;n++)r[n]=t[n];for(r=l(t,x(e)),n=0;n<i;n++)t[n]=r[n];return t}),!y||v)},"25a1":function(e,t,n){"use strict";var i=n("ebb5"),r=n("d58f").right,o=i.aTypedArray,s=i.exportTypedArrayMethod;s("reduceRight",(function(e){return r(o(this),e,arguments.length,arguments.length>1?arguments[1]:void 0)}))},2954:function(e,t,n){"use strict";var i=n("ebb5"),r=n("b6b7"),o=n("d039"),s=i.aTypedArray,a=i.exportTypedArrayMethod,l=[].slice,u=o((function(){new Int8Array(1).slice()}));a("slice",(function(e,t){var n=l.call(s(this),e,t),i=r(this),o=0,a=n.length,u=new i(a);while(a>o)u[o]=n[o++];return u}),u)},"298a":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.boolOrEmptySchema=t.topBoolOrEmptySchema=void 0;const i=n("38d7"),r=n("96ab"),o=n("a3a3"),s={message:"boolean schema is false"};function a(e){const{gen:t,schema:n,validateName:i}=e;!1===n?u(e,!1):"object"==typeof n&&!0===n.$async?t.return(o.default.data):(t.assign(r._`${i}.errors`,null),t.return(!0))}function l(e,t){const{gen:n,schema:i}=e;!1===i?(n.var(t,!1),u(e)):n.var(t,!0)}function u(e,t){const{gen:n,data:r}=e,o={gen:n,keyword:"false schema",data:r,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:e};i.reportError(o,s,void 0,t)}t.topBoolOrEmptySchema=a,t.boolOrEmptySchema=l},"2b0b":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getData=t.KeywordCxt=t.validateFunctionCode=void 0;const i=n("298a"),r=n("6292"),o=n("ac74"),s=n("6292"),a=n("6b6f"),l=n("ef23"),u=n("950f"),c=n("96ab"),h=n("a3a3"),d=n("a98d"),p=n("417a"),f=n("38d7");function m(e){S(e)&&(M(e),A(e))?x(e):g(e,()=>i.topBoolOrEmptySchema(e))}function g({gen:e,validateName:t,schema:n,schemaEnv:i,opts:r},o){r.code.es5?e.func(t,c._`${h.default.data}, ${h.default.valCxt}`,i.$async,()=>{e.code(c._`"use strict"; ${w(n,r)}`),y(e,r),e.code(o)}):e.func(t,c._`${h.default.data}, ${v(r)}`,i.$async,()=>e.code(w(n,r)).code(o))}function v(e){return c._`{${h.default.instancePath}="", ${h.default.parentData}, ${h.default.parentDataProperty}, ${h.default.rootData}=${h.default.data}${e.dynamicRef?c._`, ${h.default.dynamicAnchors}={}`:c.nil}}={}`}function y(e,t){e.if(h.default.valCxt,()=>{e.var(h.default.instancePath,c._`${h.default.valCxt}.${h.default.instancePath}`),e.var(h.default.parentData,c._`${h.default.valCxt}.${h.default.parentData}`),e.var(h.default.parentDataProperty,c._`${h.default.valCxt}.${h.default.parentDataProperty}`),e.var(h.default.rootData,c._`${h.default.valCxt}.${h.default.rootData}`),t.dynamicRef&&e.var(h.default.dynamicAnchors,c._`${h.default.valCxt}.${h.default.dynamicAnchors}`)},()=>{e.var(h.default.instancePath,c._`""`),e.var(h.default.parentData,c._`undefined`),e.var(h.default.parentDataProperty,c._`undefined`),e.var(h.default.rootData,h.default.data),t.dynamicRef&&e.var(h.default.dynamicAnchors,c._`{}`)})}function x(e){const{schema:t,opts:n,gen:i}=e;g(e,()=>{n.$comment&&t.$comment&&O(e),P(e),i.let(h.default.vErrors,null),i.let(h.default.errors,0),n.unevaluated&&b(e),T(e),D(e)})}function b(e){const{gen:t,validateName:n}=e;e.evaluated=t.const("evaluated",c._`${n}.evaluated`),t.if(c._`${e.evaluated}.dynamicProps`,()=>t.assign(c._`${e.evaluated}.props`,c._`undefined`)),t.if(c._`${e.evaluated}.dynamicItems`,()=>t.assign(c._`${e.evaluated}.items`,c._`undefined`))}function w(e,t){const n="object"==typeof e&&e[t.schemaId];return n&&(t.code.source||t.code.process)?c._`/*# sourceURL=${n} */`:c.nil}function _(e,t){S(e)&&(M(e),A(e))?E(e,t):i.boolOrEmptySchema(e,t)}function A({schema:e,self:t}){if("boolean"==typeof e)return!e;for(const n in e)if(t.RULES.all[n])return!0;return!1}function S(e){return"boolean"!=typeof e.schema}function E(e,t){const{schema:n,gen:i,opts:r}=e;r.$comment&&n.$comment&&O(e),R(e),L(e);const o=i.const("_errs",h.default.errors);T(e,o),i.var(t,c._`${o} === ${h.default.errors}`)}function M(e){p.checkUnknownRules(e),C(e)}function T(e,t){if(e.opts.jtd)return N(e,[],!1,t);const n=r.getSchemaTypes(e.schema),i=r.coerceAndCheckDataType(e,n);N(e,n,!i,t)}function C(e){const{schema:t,errSchemaPath:n,opts:i,self:r}=e;t.$ref&&i.ignoreKeywordsWithRef&&p.schemaHasRulesButRef(t,r.RULES)&&r.logger.warn(`$ref: keywords ignored in schema at path "${n}"`)}function P(e){const{schema:t,opts:n}=e;void 0!==t.default&&n.useDefaults&&n.strictSchema&&p.checkStrictMode(e,"default is ignored in the schema root")}function R(e){const t=e.schema[e.opts.schemaId];t&&(e.baseId=d.resolveUrl(e.baseId,t))}function L(e){if(e.schema.$async&&!e.schemaEnv.$async)throw new Error("async schema in sync schema")}function O({gen:e,schemaEnv:t,schema:n,errSchemaPath:i,opts:r}){const o=n.$comment;if(!0===r.$comment)e.code(c._`${h.default.self}.logger.log(${o})`);else if("function"==typeof r.$comment){const n=c.str`${i}/$comment`,r=e.scopeValue("root",{ref:t.root});e.code(c._`${h.default.self}.opts.$comment(${o}, ${n}, ${r}.schema)`)}}function D(e){const{gen:t,schemaEnv:n,validateName:i,ValidationError:r,opts:o}=e;n.$async?t.if(c._`${h.default.errors} === 0`,()=>t.return(h.default.data),()=>t.throw(c._`new ${r}(${h.default.vErrors})`)):(t.assign(c._`${i}.errors`,h.default.vErrors),o.unevaluated&&I(e),t.return(c._`${h.default.errors} === 0`))}function I({gen:e,evaluated:t,props:n,items:i}){n instanceof c.Name&&e.assign(c._`${t}.props`,n),i instanceof c.Name&&e.assign(c._`${t}.items`,i)}function N(e,t,n,i){const{gen:r,schema:a,data:l,allErrors:u,opts:d,self:f}=e,{RULES:m}=f;function g(p){o.shouldUseGroup(a,p)&&(p.type?(r.if(s.checkDataType(p.type,l,d.strictNumbers)),k(e,p),1===t.length&&t[0]===p.type&&n&&(r.else(),s.reportTypeError(e)),r.endIf()):k(e,p),u||r.if(c._`${h.default.errors} === ${i||0}`))}!a.$ref||!d.ignoreKeywordsWithRef&&p.schemaHasRulesButRef(a,m)?(d.jtd||V(e,t),r.block(()=>{for(const e of m.rules)g(e);g(m.post)})):r.block(()=>G(e,"$ref",m.all.$ref.definition))}function k(e,t){const{gen:n,schema:i,opts:{useDefaults:r}}=e;r&&a.assignDefaults(e,t.type),n.block(()=>{for(const n of t.rules)o.shouldUseRule(i,n)&&G(e,n.keyword,n.definition,t.type)})}function V(e,t){!e.schemaEnv.meta&&e.opts.strictTypes&&(U(e,t),e.opts.allowUnionTypes||F(e,t),z(e,e.dataTypes))}function U(e,t){t.length&&(e.dataTypes.length?(t.forEach(t=>{B(e.dataTypes,t)||$(e,`type "${t}" not allowed by context "${e.dataTypes.join(",")}"`)}),e.dataTypes=e.dataTypes.filter(e=>B(t,e))):e.dataTypes=t)}function F(e,t){t.length>1&&(2!==t.length||!t.includes("null"))&&$(e,"use allowUnionTypes to allow union type keyword")}function z(e,t){const n=e.self.RULES.all;for(const i in n){const r=n[i];if("object"==typeof r&&o.shouldUseRule(e.schema,r)){const{type:n}=r.definition;n.length&&!n.some(e=>j(t,e))&&$(e,`missing type "${n.join(",")}" for keyword "${i}"`)}}}function j(e,t){return e.includes(t)||"number"===t&&e.includes("integer")}function B(e,t){return e.includes(t)||"integer"===t&&e.includes("number")}function $(e,t){const n=e.schemaEnv.baseId+e.errSchemaPath;t+=` at "${n}" (strictTypes)`,p.checkStrictMode(e,t,e.opts.strictTypes)}t.validateFunctionCode=m;class H{constructor(e,t,n){if(l.validateKeywordUsage(e,t,n),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=n,this.data=e.data,this.schema=e.schema[n],this.$data=t.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=p.schemaRefOrVal(e,this.schema,n,this.$data),this.schemaType=t.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=t,this.$data)this.schemaCode=e.gen.const("vSchema",Y(this.$data,e));else if(this.schemaCode=this.schemaValue,!l.validSchemaType(this.schema,t.schemaType,t.allowUndefined))throw new Error(`${n} value must be ${JSON.stringify(t.schemaType)}`);("code"in t?t.trackErrors:!1!==t.errors)&&(this.errsCount=e.gen.const("_errs",h.default.errors))}result(e,t,n){this.failResult(c.not(e),t,n)}failResult(e,t,n){this.gen.if(e),n?n():this.error(),t?(this.gen.else(),t(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(e,t){this.failResult(c.not(e),void 0,t)}fail(e){if(void 0===e)return this.error(),void(this.allErrors||this.gen.if(!1));this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);const{schemaCode:t}=this;this.fail(c._`${t} !== undefined && (${c.or(this.invalid$data(),e)})`)}error(e,t,n){if(t)return this.setParams(t),this._error(e,n),void this.setParams({});this._error(e,n)}_error(e,t){(e?f.reportExtraError:f.reportError)(this,this.def.error,t)}$dataError(){f.reportError(this,this.def.$dataError||f.keyword$DataError)}reset(){if(void 0===this.errsCount)throw new Error('add "trackErrors" to keyword definition');f.resetErrorsCount(this.gen,this.errsCount)}ok(e){this.allErrors||this.gen.if(e)}setParams(e,t){t?Object.assign(this.params,e):this.params=e}block$data(e,t,n=c.nil){this.gen.block(()=>{this.check$data(e,n),t()})}check$data(e=c.nil,t=c.nil){if(!this.$data)return;const{gen:n,schemaCode:i,schemaType:r,def:o}=this;n.if(c.or(c._`${i} === undefined`,t)),e!==c.nil&&n.assign(e,!0),(r.length||o.validateSchema)&&(n.elseIf(this.invalid$data()),this.$dataError(),e!==c.nil&&n.assign(e,!1)),n.else()}invalid$data(){const{gen:e,schemaCode:t,schemaType:n,def:i,it:r}=this;return c.or(o(),a());function o(){if(n.length){if(!(t instanceof c.Name))throw new Error("ajv implementation error");const e=Array.isArray(n)?n:[n];return c._`${s.checkDataTypes(e,t,r.opts.strictNumbers,s.DataType.Wrong)}`}return c.nil}function a(){if(i.validateSchema){const n=e.scopeValue("validate$data",{ref:i.validateSchema});return c._`!${n}(${t})`}return c.nil}}subschema(e,t){const n=u.getSubschema(this.it,e);u.extendSubschemaData(n,this.it,e),u.extendSubschemaMode(n,e);const i={...this.it,...n,items:void 0,props:void 0};return _(i,t),i}mergeEvaluated(e,t){const{it:n,gen:i}=this;n.opts.unevaluated&&(!0!==n.props&&void 0!==e.props&&(n.props=p.mergeEvaluated.props(i,e.props,n.props,t)),!0!==n.items&&void 0!==e.items&&(n.items=p.mergeEvaluated.items(i,e.items,n.items,t)))}mergeValidEvaluated(e,t){const{it:n,gen:i}=this;if(n.opts.unevaluated&&(!0!==n.props||!0!==n.items))return i.if(t,()=>this.mergeEvaluated(e,c.Name)),!0}}function G(e,t,n,i){const r=new H(e,n,t);"code"in n?n.code(r,i):r.$data&&n.validate?l.funcKeywordCode(r,n):"macro"in n?l.macroKeywordCode(r,n):(n.compile||n.validate)&&l.funcKeywordCode(r,n)}t.KeywordCxt=H;const W=/^\/(?:[^~]|~0|~1)*$/,q=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function Y(e,{dataLevel:t,dataNames:n,dataPathArr:i}){let r,o;if(""===e)return h.default.rootData;if("/"===e[0]){if(!W.test(e))throw new Error("Invalid JSON-pointer: "+e);r=e,o=h.default.rootData}else{const s=q.exec(e);if(!s)throw new Error("Invalid JSON-pointer: "+e);const a=+s[1];if(r=s[2],"#"===r){if(a>=t)throw new Error(l("property/index",a));return i[t-a]}if(a>t)throw new Error(l("data",a));if(o=n[t-a],!r)return o}let s=o;const a=r.split("/");for(const u of a)u&&(o=c._`${o}${c.getProperty(p.unescapeJsonPointer(u))}`,s=c._`${s} && ${o}`);return s;function l(e,n){return`Cannot access ${e} ${n} levels up, current level is ${t}`}}t.getData=Y},"2ca0":function(e,t,n){"use strict";var i=n("23e7"),r=n("06cf").f,o=n("50c4"),s=n("577e"),a=n("5a34"),l=n("1d80"),u=n("ab13"),c=n("c430"),h="".startsWith,d=Math.min,p=u("startsWith"),f=!c&&!p&&!!function(){var e=r(String.prototype,"startsWith");return e&&!e.writable}();i({target:"String",proto:!0,forced:!f&&!p},{startsWith:function(e){var t=s(l(this));a(e);var n=o(d(arguments.length>1?arguments[1]:void 0,t.length)),i=s(e);return h?h.call(t,i,n):t.slice(n,n+i.length)===i}})},"2e32":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("4c26"),r=n("96ab"),o=n("a3a3"),s=n("417a"),a={message:"must NOT have additional properties",params:({params:e})=>r._`{additionalProperty: ${e.additionalProperty}}`},l={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:a,code(e){const{gen:t,schema:n,parentSchema:a,data:l,errsCount:u,it:c}=e;if(!u)throw new Error("ajv implementation error");const{allErrors:h,opts:d}=c;if(c.props=!0,"all"!==d.removeAdditional&&s.alwaysValidSchema(c,n))return;const p=i.allSchemaProperties(a.properties),f=i.allSchemaProperties(a.patternProperties);function m(){t.forIn("key",l,e=>{p.length||f.length?t.if(g(e),()=>y(e)):y(e)})}function g(n){let o;if(p.length>8){const e=s.schemaRefOrVal(c,a.properties,"properties");o=i.isOwnProperty(t,e,n)}else o=p.length?r.or(...p.map(e=>r._`${n} === ${e}`)):r.nil;return f.length&&(o=r.or(o,...f.map(t=>r._`${i.usePattern(e,t)}.test(${n})`))),r.not(o)}function v(e){t.code(r._`delete ${l}[${e}]`)}function y(i){if("all"===d.removeAdditional||d.removeAdditional&&!1===n)v(i);else{if(!1===n)return e.setParams({additionalProperty:i}),e.error(),void(h||t.break());if("object"==typeof n&&!s.alwaysValidSchema(c,n)){const n=t.name("valid");"failing"===d.removeAdditional?(x(i,n,!1),t.if(r.not(n),()=>{e.reset(),v(i)})):(x(i,n),h||t.if(r.not(n),()=>t.break()))}}}function x(t,n,i){const r={keyword:"additionalProperties",dataProp:t,dataPropType:s.Type.Str};!1===i&&Object.assign(r,{compositeRule:!0,createErrors:!1,allErrors:!1}),e.subschema(r,n)}m(),e.ok(r._`${u} === ${o.default.errors}`)}};t.default=l},"2ef0":function(e,t,n){(function(e,i){var r;
/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(){var o,s="4.17.21",a=200,l="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",u="Expected a function",c="Invalid `variable` option passed into `_.template`",h="__lodash_hash_undefined__",d=500,p="__lodash_placeholder__",f=1,m=2,g=4,v=1,y=2,x=1,b=2,w=4,_=8,A=16,S=32,E=64,M=128,T=256,C=512,P=30,R="...",L=800,O=16,D=1,I=2,N=3,k=1/0,V=9007199254740991,U=17976931348623157e292,F=NaN,z=4294967295,j=z-1,B=z>>>1,$=[["ary",M],["bind",x],["bindKey",b],["curry",_],["curryRight",A],["flip",C],["partial",S],["partialRight",E],["rearg",T]],H="[object Arguments]",G="[object Array]",W="[object AsyncFunction]",q="[object Boolean]",Y="[object Date]",X="[object DOMException]",Z="[object Error]",J="[object Function]",K="[object GeneratorFunction]",Q="[object Map]",ee="[object Number]",te="[object Null]",ne="[object Object]",ie="[object Promise]",re="[object Proxy]",oe="[object RegExp]",se="[object Set]",ae="[object String]",le="[object Symbol]",ue="[object Undefined]",ce="[object WeakMap]",he="[object WeakSet]",de="[object ArrayBuffer]",pe="[object DataView]",fe="[object Float32Array]",me="[object Float64Array]",ge="[object Int8Array]",ve="[object Int16Array]",ye="[object Int32Array]",xe="[object Uint8Array]",be="[object Uint8ClampedArray]",we="[object Uint16Array]",_e="[object Uint32Array]",Ae=/\b__p \+= '';/g,Se=/\b(__p \+=) '' \+/g,Ee=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Me=/&(?:amp|lt|gt|quot|#39);/g,Te=/[&<>"']/g,Ce=RegExp(Me.source),Pe=RegExp(Te.source),Re=/<%-([\s\S]+?)%>/g,Le=/<%([\s\S]+?)%>/g,Oe=/<%=([\s\S]+?)%>/g,De=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ie=/^\w*$/,Ne=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ke=/[\\^$.*+?()[\]{}|]/g,Ve=RegExp(ke.source),Ue=/^\s+/,Fe=/\s/,ze=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,je=/\{\n\/\* \[wrapped with (.+)\] \*/,Be=/,? & /,$e=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,He=/[()=,{}\[\]\/\s]/,Ge=/\\(\\)?/g,We=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,qe=/\w*$/,Ye=/^[-+]0x[0-9a-f]+$/i,Xe=/^0b[01]+$/i,Ze=/^\[object .+?Constructor\]$/,Je=/^0o[0-7]+$/i,Ke=/^(?:0|[1-9]\d*)$/,Qe=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,et=/($^)/,tt=/['\n\r\u2028\u2029\\]/g,nt="\\ud800-\\udfff",it="\\u0300-\\u036f",rt="\\ufe20-\\ufe2f",ot="\\u20d0-\\u20ff",st=it+rt+ot,at="\\u2700-\\u27bf",lt="a-z\\xdf-\\xf6\\xf8-\\xff",ut="\\xac\\xb1\\xd7\\xf7",ct="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ht="\\u2000-\\u206f",dt=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",pt="A-Z\\xc0-\\xd6\\xd8-\\xde",ft="\\ufe0e\\ufe0f",mt=ut+ct+ht+dt,gt="['’]",vt="["+nt+"]",yt="["+mt+"]",xt="["+st+"]",bt="\\d+",wt="["+at+"]",_t="["+lt+"]",At="[^"+nt+mt+bt+at+lt+pt+"]",St="\\ud83c[\\udffb-\\udfff]",Et="(?:"+xt+"|"+St+")",Mt="[^"+nt+"]",Tt="(?:\\ud83c[\\udde6-\\uddff]){2}",Ct="[\\ud800-\\udbff][\\udc00-\\udfff]",Pt="["+pt+"]",Rt="\\u200d",Lt="(?:"+_t+"|"+At+")",Ot="(?:"+Pt+"|"+At+")",Dt="(?:"+gt+"(?:d|ll|m|re|s|t|ve))?",It="(?:"+gt+"(?:D|LL|M|RE|S|T|VE))?",Nt=Et+"?",kt="["+ft+"]?",Vt="(?:"+Rt+"(?:"+[Mt,Tt,Ct].join("|")+")"+kt+Nt+")*",Ut="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ft="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",zt=kt+Nt+Vt,jt="(?:"+[wt,Tt,Ct].join("|")+")"+zt,Bt="(?:"+[Mt+xt+"?",xt,Tt,Ct,vt].join("|")+")",$t=RegExp(gt,"g"),Ht=RegExp(xt,"g"),Gt=RegExp(St+"(?="+St+")|"+Bt+zt,"g"),Wt=RegExp([Pt+"?"+_t+"+"+Dt+"(?="+[yt,Pt,"$"].join("|")+")",Ot+"+"+It+"(?="+[yt,Pt+Lt,"$"].join("|")+")",Pt+"?"+Lt+"+"+Dt,Pt+"+"+It,Ft,Ut,bt,jt].join("|"),"g"),qt=RegExp("["+Rt+nt+st+ft+"]"),Yt=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Xt=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Zt=-1,Jt={};Jt[fe]=Jt[me]=Jt[ge]=Jt[ve]=Jt[ye]=Jt[xe]=Jt[be]=Jt[we]=Jt[_e]=!0,Jt[H]=Jt[G]=Jt[de]=Jt[q]=Jt[pe]=Jt[Y]=Jt[Z]=Jt[J]=Jt[Q]=Jt[ee]=Jt[ne]=Jt[oe]=Jt[se]=Jt[ae]=Jt[ce]=!1;var Kt={};Kt[H]=Kt[G]=Kt[de]=Kt[pe]=Kt[q]=Kt[Y]=Kt[fe]=Kt[me]=Kt[ge]=Kt[ve]=Kt[ye]=Kt[Q]=Kt[ee]=Kt[ne]=Kt[oe]=Kt[se]=Kt[ae]=Kt[le]=Kt[xe]=Kt[be]=Kt[we]=Kt[_e]=!0,Kt[Z]=Kt[J]=Kt[ce]=!1;var Qt={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"},en={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},tn={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},nn={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},rn=parseFloat,on=parseInt,sn="object"==typeof e&&e&&e.Object===Object&&e,an="object"==typeof self&&self&&self.Object===Object&&self,ln=sn||an||Function("return this")(),un=t&&!t.nodeType&&t,cn=un&&"object"==typeof i&&i&&!i.nodeType&&i,hn=cn&&cn.exports===un,dn=hn&&sn.process,pn=function(){try{var e=cn&&cn.require&&cn.require("util").types;return e||dn&&dn.binding&&dn.binding("util")}catch(t){}}(),fn=pn&&pn.isArrayBuffer,mn=pn&&pn.isDate,gn=pn&&pn.isMap,vn=pn&&pn.isRegExp,yn=pn&&pn.isSet,xn=pn&&pn.isTypedArray;function bn(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function wn(e,t,n,i){var r=-1,o=null==e?0:e.length;while(++r<o){var s=e[r];t(i,s,n(s),e)}return i}function _n(e,t){var n=-1,i=null==e?0:e.length;while(++n<i)if(!1===t(e[n],n,e))break;return e}function An(e,t){var n=null==e?0:e.length;while(n--)if(!1===t(e[n],n,e))break;return e}function Sn(e,t){var n=-1,i=null==e?0:e.length;while(++n<i)if(!t(e[n],n,e))return!1;return!0}function En(e,t){var n=-1,i=null==e?0:e.length,r=0,o=[];while(++n<i){var s=e[n];t(s,n,e)&&(o[r++]=s)}return o}function Mn(e,t){var n=null==e?0:e.length;return!!n&&Un(e,t,0)>-1}function Tn(e,t,n){var i=-1,r=null==e?0:e.length;while(++i<r)if(n(t,e[i]))return!0;return!1}function Cn(e,t){var n=-1,i=null==e?0:e.length,r=Array(i);while(++n<i)r[n]=t(e[n],n,e);return r}function Pn(e,t){var n=-1,i=t.length,r=e.length;while(++n<i)e[r+n]=t[n];return e}function Rn(e,t,n,i){var r=-1,o=null==e?0:e.length;i&&o&&(n=e[++r]);while(++r<o)n=t(n,e[r],r,e);return n}function Ln(e,t,n,i){var r=null==e?0:e.length;i&&r&&(n=e[--r]);while(r--)n=t(n,e[r],r,e);return n}function On(e,t){var n=-1,i=null==e?0:e.length;while(++n<i)if(t(e[n],n,e))return!0;return!1}var Dn=Bn("length");function In(e){return e.split("")}function Nn(e){return e.match($e)||[]}function kn(e,t,n){var i;return n(e,(function(e,n,r){if(t(e,n,r))return i=n,!1})),i}function Vn(e,t,n,i){var r=e.length,o=n+(i?1:-1);while(i?o--:++o<r)if(t(e[o],o,e))return o;return-1}function Un(e,t,n){return t===t?fi(e,t,n):Vn(e,zn,n)}function Fn(e,t,n,i){var r=n-1,o=e.length;while(++r<o)if(i(e[r],t))return r;return-1}function zn(e){return e!==e}function jn(e,t){var n=null==e?0:e.length;return n?Wn(e,t)/n:F}function Bn(e){return function(t){return null==t?o:t[e]}}function $n(e){return function(t){return null==e?o:e[t]}}function Hn(e,t,n,i,r){return r(e,(function(e,r,o){n=i?(i=!1,e):t(n,e,r,o)})),n}function Gn(e,t){var n=e.length;e.sort(t);while(n--)e[n]=e[n].value;return e}function Wn(e,t){var n,i=-1,r=e.length;while(++i<r){var s=t(e[i]);s!==o&&(n=n===o?s:n+s)}return n}function qn(e,t){var n=-1,i=Array(e);while(++n<e)i[n]=t(n);return i}function Yn(e,t){return Cn(t,(function(t){return[t,e[t]]}))}function Xn(e){return e?e.slice(0,yi(e)+1).replace(Ue,""):e}function Zn(e){return function(t){return e(t)}}function Jn(e,t){return Cn(t,(function(t){return e[t]}))}function Kn(e,t){return e.has(t)}function Qn(e,t){var n=-1,i=e.length;while(++n<i&&Un(t,e[n],0)>-1);return n}function ei(e,t){var n=e.length;while(n--&&Un(t,e[n],0)>-1);return n}function ti(e,t){var n=e.length,i=0;while(n--)e[n]===t&&++i;return i}var ni=$n(Qt),ii=$n(en);function ri(e){return"\\"+nn[e]}function oi(e,t){return null==e?o:e[t]}function si(e){return qt.test(e)}function ai(e){return Yt.test(e)}function li(e){var t,n=[];while(!(t=e.next()).done)n.push(t.value);return n}function ui(e){var t=-1,n=Array(e.size);return e.forEach((function(e,i){n[++t]=[i,e]})),n}function ci(e,t){return function(n){return e(t(n))}}function hi(e,t){var n=-1,i=e.length,r=0,o=[];while(++n<i){var s=e[n];s!==t&&s!==p||(e[n]=p,o[r++]=n)}return o}function di(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}function pi(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e]})),n}function fi(e,t,n){var i=n-1,r=e.length;while(++i<r)if(e[i]===t)return i;return-1}function mi(e,t,n){var i=n+1;while(i--)if(e[i]===t)return i;return i}function gi(e){return si(e)?bi(e):Dn(e)}function vi(e){return si(e)?wi(e):In(e)}function yi(e){var t=e.length;while(t--&&Fe.test(e.charAt(t)));return t}var xi=$n(tn);function bi(e){var t=Gt.lastIndex=0;while(Gt.test(e))++t;return t}function wi(e){return e.match(Gt)||[]}function _i(e){return e.match(Wt)||[]}var Ai=function e(t){t=null==t?ln:Si.defaults(ln.Object(),t,Si.pick(ln,Xt));var n=t.Array,i=t.Date,r=t.Error,Fe=t.Function,$e=t.Math,nt=t.Object,it=t.RegExp,rt=t.String,ot=t.TypeError,st=n.prototype,at=Fe.prototype,lt=nt.prototype,ut=t["__core-js_shared__"],ct=at.toString,ht=lt.hasOwnProperty,dt=0,pt=function(){var e=/[^.]+$/.exec(ut&&ut.keys&&ut.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),ft=lt.toString,mt=ct.call(nt),gt=ln._,vt=it("^"+ct.call(ht).replace(ke,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),yt=hn?t.Buffer:o,xt=t.Symbol,bt=t.Uint8Array,wt=yt?yt.allocUnsafe:o,_t=ci(nt.getPrototypeOf,nt),At=nt.create,St=lt.propertyIsEnumerable,Et=st.splice,Mt=xt?xt.isConcatSpreadable:o,Tt=xt?xt.iterator:o,Ct=xt?xt.toStringTag:o,Pt=function(){try{var e=qs(nt,"defineProperty");return e({},"",{}),e}catch(t){}}(),Rt=t.clearTimeout!==ln.clearTimeout&&t.clearTimeout,Lt=i&&i.now!==ln.Date.now&&i.now,Ot=t.setTimeout!==ln.setTimeout&&t.setTimeout,Dt=$e.ceil,It=$e.floor,Nt=nt.getOwnPropertySymbols,kt=yt?yt.isBuffer:o,Vt=t.isFinite,Ut=st.join,Ft=ci(nt.keys,nt),zt=$e.max,jt=$e.min,Bt=i.now,Gt=t.parseInt,Wt=$e.random,qt=st.reverse,Yt=qs(t,"DataView"),Qt=qs(t,"Map"),en=qs(t,"Promise"),tn=qs(t,"Set"),nn=qs(t,"WeakMap"),sn=qs(nt,"create"),an=nn&&new nn,un={},cn=Oa(Yt),dn=Oa(Qt),pn=Oa(en),Dn=Oa(tn),In=Oa(nn),$n=xt?xt.prototype:o,fi=$n?$n.valueOf:o,bi=$n?$n.toString:o;function wi(e){if(Ec(e)&&!lc(e)&&!(e instanceof Ti)){if(e instanceof Mi)return e;if(ht.call(e,"__wrapped__"))return Ia(e)}return new Mi(e)}var Ai=function(){function e(){}return function(t){if(!Sc(t))return{};if(At)return At(t);e.prototype=t;var n=new e;return e.prototype=o,n}}();function Ei(){}function Mi(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=o}function Ti(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=z,this.__views__=[]}function Ci(){var e=new Ti(this.__wrapped__);return e.__actions__=rs(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=rs(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=rs(this.__views__),e}function Pi(){if(this.__filtered__){var e=new Ti(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Ri(){var e=this.__wrapped__.value(),t=this.__dir__,n=lc(e),i=t<0,r=n?e.length:0,o=Ks(0,r,this.__views__),s=o.start,a=o.end,l=a-s,u=i?a:s-1,c=this.__iteratees__,h=c.length,d=0,p=jt(l,this.__takeCount__);if(!n||!i&&r==l&&p==l)return Fo(e,this.__actions__);var f=[];e:while(l--&&d<p){u+=t;var m=-1,g=e[u];while(++m<h){var v=c[m],y=v.iteratee,x=v.type,b=y(g);if(x==I)g=b;else if(!b){if(x==D)continue e;break e}}f[d++]=g}return f}function Li(e){var t=-1,n=null==e?0:e.length;this.clear();while(++t<n){var i=e[t];this.set(i[0],i[1])}}function Oi(){this.__data__=sn?sn(null):{},this.size=0}function Di(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function Ii(e){var t=this.__data__;if(sn){var n=t[e];return n===h?o:n}return ht.call(t,e)?t[e]:o}function Ni(e){var t=this.__data__;return sn?t[e]!==o:ht.call(t,e)}function ki(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=sn&&t===o?h:t,this}function Vi(e){var t=-1,n=null==e?0:e.length;this.clear();while(++t<n){var i=e[t];this.set(i[0],i[1])}}function Ui(){this.__data__=[],this.size=0}function Fi(e){var t=this.__data__,n=cr(t,e);if(n<0)return!1;var i=t.length-1;return n==i?t.pop():Et.call(t,n,1),--this.size,!0}function zi(e){var t=this.__data__,n=cr(t,e);return n<0?o:t[n][1]}function ji(e){return cr(this.__data__,e)>-1}function Bi(e,t){var n=this.__data__,i=cr(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this}function $i(e){var t=-1,n=null==e?0:e.length;this.clear();while(++t<n){var i=e[t];this.set(i[0],i[1])}}function Hi(){this.size=0,this.__data__={hash:new Li,map:new(Qt||Vi),string:new Li}}function Gi(e){var t=Gs(this,e)["delete"](e);return this.size-=t?1:0,t}function Wi(e){return Gs(this,e).get(e)}function qi(e){return Gs(this,e).has(e)}function Yi(e,t){var n=Gs(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this}function Xi(e){var t=-1,n=null==e?0:e.length;this.__data__=new $i;while(++t<n)this.add(e[t])}function Zi(e){return this.__data__.set(e,h),this}function Ji(e){return this.__data__.has(e)}function Ki(e){var t=this.__data__=new Vi(e);this.size=t.size}function Qi(){this.__data__=new Vi,this.size=0}function er(e){var t=this.__data__,n=t["delete"](e);return this.size=t.size,n}function tr(e){return this.__data__.get(e)}function nr(e){return this.__data__.has(e)}function ir(e,t){var n=this.__data__;if(n instanceof Vi){var i=n.__data__;if(!Qt||i.length<a-1)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new $i(i)}return n.set(e,t),this.size=n.size,this}function rr(e,t){var n=lc(e),i=!n&&ac(e),r=!n&&!i&&pc(e),o=!n&&!i&&!r&&zc(e),s=n||i||r||o,a=s?qn(e.length,rt):[],l=a.length;for(var u in e)!t&&!ht.call(e,u)||s&&("length"==u||r&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||sa(u,l))||a.push(u);return a}function or(e){var t=e.length;return t?e[yo(0,t-1)]:o}function sr(e,t){return Pa(rs(e),gr(t,0,e.length))}function ar(e){return Pa(rs(e))}function lr(e,t,n){(n!==o&&!rc(e[t],n)||n===o&&!(t in e))&&fr(e,t,n)}function ur(e,t,n){var i=e[t];ht.call(e,t)&&rc(i,n)&&(n!==o||t in e)||fr(e,t,n)}function cr(e,t){var n=e.length;while(n--)if(rc(e[n][0],t))return n;return-1}function hr(e,t,n,i){return _r(e,(function(e,r,o){t(i,e,n(e),o)})),i}function dr(e,t){return e&&os(t,_h(t),e)}function pr(e,t){return e&&os(t,Ah(t),e)}function fr(e,t,n){"__proto__"==t&&Pt?Pt(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function mr(e,t){var i=-1,r=t.length,s=n(r),a=null==e;while(++i<r)s[i]=a?o:gh(e,t[i]);return s}function gr(e,t,n){return e===e&&(n!==o&&(e=e<=n?e:n),t!==o&&(e=e>=t?e:t)),e}function vr(e,t,n,i,r,s){var a,l=t&f,u=t&m,c=t&g;if(n&&(a=r?n(e,i,r,s):n(e)),a!==o)return a;if(!Sc(e))return e;var h=lc(e);if(h){if(a=ta(e),!l)return rs(e,a)}else{var d=Js(e),p=d==J||d==K;if(pc(e))return Yo(e,l);if(d==ne||d==H||p&&!r){if(a=u||p?{}:na(e),!l)return u?as(e,pr(a,e)):ss(e,dr(a,e))}else{if(!Kt[d])return r?e:{};a=ia(e,d,l)}}s||(s=new Ki);var v=s.get(e);if(v)return v;s.set(e,a),Vc(e)?e.forEach((function(i){a.add(vr(i,t,n,i,e,s))})):Mc(e)&&e.forEach((function(i,r){a.set(r,vr(i,t,n,r,e,s))}));var y=c?u?zs:Fs:u?Ah:_h,x=h?o:y(e);return _n(x||e,(function(i,r){x&&(r=i,i=e[r]),ur(a,r,vr(i,t,n,r,e,s))})),a}function yr(e){var t=_h(e);return function(n){return xr(n,e,t)}}function xr(e,t,n){var i=n.length;if(null==e)return!i;e=nt(e);while(i--){var r=n[i],s=t[r],a=e[r];if(a===o&&!(r in e)||!s(a))return!1}return!0}function br(e,t,n){if("function"!=typeof e)throw new ot(u);return Ea((function(){e.apply(o,n)}),t)}function wr(e,t,n,i){var r=-1,o=Mn,s=!0,l=e.length,u=[],c=t.length;if(!l)return u;n&&(t=Cn(t,Zn(n))),i?(o=Tn,s=!1):t.length>=a&&(o=Kn,s=!1,t=new Xi(t));e:while(++r<l){var h=e[r],d=null==n?h:n(h);if(h=i||0!==h?h:0,s&&d===d){var p=c;while(p--)if(t[p]===d)continue e;u.push(h)}else o(t,d,i)||u.push(h)}return u}wi.templateSettings={escape:Re,evaluate:Le,interpolate:Oe,variable:"",imports:{_:wi}},wi.prototype=Ei.prototype,wi.prototype.constructor=wi,Mi.prototype=Ai(Ei.prototype),Mi.prototype.constructor=Mi,Ti.prototype=Ai(Ei.prototype),Ti.prototype.constructor=Ti,Li.prototype.clear=Oi,Li.prototype["delete"]=Di,Li.prototype.get=Ii,Li.prototype.has=Ni,Li.prototype.set=ki,Vi.prototype.clear=Ui,Vi.prototype["delete"]=Fi,Vi.prototype.get=zi,Vi.prototype.has=ji,Vi.prototype.set=Bi,$i.prototype.clear=Hi,$i.prototype["delete"]=Gi,$i.prototype.get=Wi,$i.prototype.has=qi,$i.prototype.set=Yi,Xi.prototype.add=Xi.prototype.push=Zi,Xi.prototype.has=Ji,Ki.prototype.clear=Qi,Ki.prototype["delete"]=er,Ki.prototype.get=tr,Ki.prototype.has=nr,Ki.prototype.set=ir;var _r=cs(Lr),Ar=cs(Or,!0);function Sr(e,t){var n=!0;return _r(e,(function(e,i,r){return n=!!t(e,i,r),n})),n}function Er(e,t,n){var i=-1,r=e.length;while(++i<r){var s=e[i],a=t(s);if(null!=a&&(l===o?a===a&&!Fc(a):n(a,l)))var l=a,u=s}return u}function Mr(e,t,n,i){var r=e.length;n=Yc(n),n<0&&(n=-n>r?0:r+n),i=i===o||i>r?r:Yc(i),i<0&&(i+=r),i=n>i?0:Xc(i);while(n<i)e[n++]=t;return e}function Tr(e,t){var n=[];return _r(e,(function(e,i,r){t(e,i,r)&&n.push(e)})),n}function Cr(e,t,n,i,r){var o=-1,s=e.length;n||(n=oa),r||(r=[]);while(++o<s){var a=e[o];t>0&&n(a)?t>1?Cr(a,t-1,n,i,r):Pn(r,a):i||(r[r.length]=a)}return r}var Pr=hs(),Rr=hs(!0);function Lr(e,t){return e&&Pr(e,t,_h)}function Or(e,t){return e&&Rr(e,t,_h)}function Dr(e,t){return En(t,(function(t){return wc(e[t])}))}function Ir(e,t){t=Ho(t,e);var n=0,i=t.length;while(null!=e&&n<i)e=e[La(t[n++])];return n&&n==i?e:o}function Nr(e,t,n){var i=t(e);return lc(e)?i:Pn(i,n(e))}function kr(e){return null==e?e===o?ue:te:Ct&&Ct in nt(e)?Ys(e):xa(e)}function Vr(e,t){return e>t}function Ur(e,t){return null!=e&&ht.call(e,t)}function Fr(e,t){return null!=e&&t in nt(e)}function zr(e,t,n){return e>=jt(t,n)&&e<zt(t,n)}function jr(e,t,i){var r=i?Tn:Mn,s=e[0].length,a=e.length,l=a,u=n(a),c=1/0,h=[];while(l--){var d=e[l];l&&t&&(d=Cn(d,Zn(t))),c=jt(d.length,c),u[l]=!i&&(t||s>=120&&d.length>=120)?new Xi(l&&d):o}d=e[0];var p=-1,f=u[0];e:while(++p<s&&h.length<c){var m=d[p],g=t?t(m):m;if(m=i||0!==m?m:0,!(f?Kn(f,g):r(h,g,i))){l=a;while(--l){var v=u[l];if(!(v?Kn(v,g):r(e[l],g,i)))continue e}f&&f.push(g),h.push(m)}}return h}function Br(e,t,n,i){return Lr(e,(function(e,r,o){t(i,n(e),r,o)})),i}function $r(e,t,n){t=Ho(t,e),e=wa(e,t);var i=null==e?e:e[La(ol(t))];return null==i?o:bn(i,e,n)}function Hr(e){return Ec(e)&&kr(e)==H}function Gr(e){return Ec(e)&&kr(e)==de}function Wr(e){return Ec(e)&&kr(e)==Y}function qr(e,t,n,i,r){return e===t||(null==e||null==t||!Ec(e)&&!Ec(t)?e!==e&&t!==t:Yr(e,t,n,i,qr,r))}function Yr(e,t,n,i,r,o){var s=lc(e),a=lc(t),l=s?G:Js(e),u=a?G:Js(t);l=l==H?ne:l,u=u==H?ne:u;var c=l==ne,h=u==ne,d=l==u;if(d&&pc(e)){if(!pc(t))return!1;s=!0,c=!1}if(d&&!c)return o||(o=new Ki),s||zc(e)?Ns(e,t,n,i,r,o):ks(e,t,l,n,i,r,o);if(!(n&v)){var p=c&&ht.call(e,"__wrapped__"),f=h&&ht.call(t,"__wrapped__");if(p||f){var m=p?e.value():e,g=f?t.value():t;return o||(o=new Ki),r(m,g,n,i,o)}}return!!d&&(o||(o=new Ki),Vs(e,t,n,i,r,o))}function Xr(e){return Ec(e)&&Js(e)==Q}function Zr(e,t,n,i){var r=n.length,s=r,a=!i;if(null==e)return!s;e=nt(e);while(r--){var l=n[r];if(a&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}while(++r<s){l=n[r];var u=l[0],c=e[u],h=l[1];if(a&&l[2]){if(c===o&&!(u in e))return!1}else{var d=new Ki;if(i)var p=i(c,h,u,e,t,d);if(!(p===o?qr(h,c,v|y,i,d):p))return!1}}return!0}function Jr(e){if(!Sc(e)||ha(e))return!1;var t=wc(e)?vt:Ze;return t.test(Oa(e))}function Kr(e){return Ec(e)&&kr(e)==oe}function Qr(e){return Ec(e)&&Js(e)==se}function eo(e){return Ec(e)&&Ac(e.length)&&!!Jt[kr(e)]}function to(e){return"function"==typeof e?e:null==e?Rd:"object"==typeof e?lc(e)?ao(e[0],e[1]):so(e):$d(e)}function no(e){if(!pa(e))return Ft(e);var t=[];for(var n in nt(e))ht.call(e,n)&&"constructor"!=n&&t.push(n);return t}function io(e){if(!Sc(e))return ya(e);var t=pa(e),n=[];for(var i in e)("constructor"!=i||!t&&ht.call(e,i))&&n.push(i);return n}function ro(e,t){return e<t}function oo(e,t){var i=-1,r=cc(e)?n(e.length):[];return _r(e,(function(e,n,o){r[++i]=t(e,n,o)})),r}function so(e){var t=Ws(e);return 1==t.length&&t[0][2]?ma(t[0][0],t[0][1]):function(n){return n===e||Zr(n,e,t)}}function ao(e,t){return la(e)&&fa(t)?ma(La(e),t):function(n){var i=gh(n,e);return i===o&&i===t?yh(n,e):qr(t,i,v|y)}}function lo(e,t,n,i,r){e!==t&&Pr(t,(function(s,a){if(r||(r=new Ki),Sc(s))uo(e,t,a,n,lo,i,r);else{var l=i?i(Aa(e,a),s,a+"",e,t,r):o;l===o&&(l=s),lr(e,a,l)}}),Ah)}function uo(e,t,n,i,r,s,a){var l=Aa(e,n),u=Aa(t,n),c=a.get(u);if(c)lr(e,n,c);else{var h=s?s(l,u,n+"",e,t,a):o,d=h===o;if(d){var p=lc(u),f=!p&&pc(u),m=!p&&!f&&zc(u);h=u,p||f||m?lc(l)?h=l:hc(l)?h=rs(l):f?(d=!1,h=Yo(u,!0)):m?(d=!1,h=Qo(u,!0)):h=[]:Ic(u)||ac(u)?(h=l,ac(l)?h=Jc(l):Sc(l)&&!wc(l)||(h=na(u))):d=!1}d&&(a.set(u,h),r(h,u,i,s,a),a["delete"](u)),lr(e,n,h)}}function co(e,t){var n=e.length;if(n)return t+=t<0?n:0,sa(t,n)?e[t]:o}function ho(e,t,n){t=t.length?Cn(t,(function(e){return lc(e)?function(t){return Ir(t,1===e.length?e[0]:e)}:e})):[Rd];var i=-1;t=Cn(t,Zn(Hs()));var r=oo(e,(function(e,n,r){var o=Cn(t,(function(t){return t(e)}));return{criteria:o,index:++i,value:e}}));return Gn(r,(function(e,t){return ts(e,t,n)}))}function po(e,t){return fo(e,t,(function(t,n){return yh(e,n)}))}function fo(e,t,n){var i=-1,r=t.length,o={};while(++i<r){var s=t[i],a=Ir(e,s);n(a,s)&&So(o,Ho(s,e),a)}return o}function mo(e){return function(t){return Ir(t,e)}}function go(e,t,n,i){var r=i?Fn:Un,o=-1,s=t.length,a=e;e===t&&(t=rs(t)),n&&(a=Cn(e,Zn(n)));while(++o<s){var l=0,u=t[o],c=n?n(u):u;while((l=r(a,c,l,i))>-1)a!==e&&Et.call(a,l,1),Et.call(e,l,1)}return e}function vo(e,t){var n=e?t.length:0,i=n-1;while(n--){var r=t[n];if(n==i||r!==o){var o=r;sa(r)?Et.call(e,r,1):ko(e,r)}}return e}function yo(e,t){return e+It(Wt()*(t-e+1))}function xo(e,t,i,r){var o=-1,s=zt(Dt((t-e)/(i||1)),0),a=n(s);while(s--)a[r?s:++o]=e,e+=i;return a}function bo(e,t){var n="";if(!e||t<1||t>V)return n;do{t%2&&(n+=e),t=It(t/2),t&&(e+=e)}while(t);return n}function wo(e,t){return Ma(ba(e,t,Rd),e+"")}function _o(e){return or(jh(e))}function Ao(e,t){var n=jh(e);return Pa(n,gr(t,0,n.length))}function So(e,t,n,i){if(!Sc(e))return e;t=Ho(t,e);var r=-1,s=t.length,a=s-1,l=e;while(null!=l&&++r<s){var u=La(t[r]),c=n;if("__proto__"===u||"constructor"===u||"prototype"===u)return e;if(r!=a){var h=l[u];c=i?i(h,u,l):o,c===o&&(c=Sc(h)?h:sa(t[r+1])?[]:{})}ur(l,u,c),l=l[u]}return e}var Eo=an?function(e,t){return an.set(e,t),e}:Rd,Mo=Pt?function(e,t){return Pt(e,"toString",{configurable:!0,enumerable:!1,value:Md(t),writable:!0})}:Rd;function To(e){return Pa(jh(e))}function Co(e,t,i){var r=-1,o=e.length;t<0&&(t=-t>o?0:o+t),i=i>o?o:i,i<0&&(i+=o),o=t>i?0:i-t>>>0,t>>>=0;var s=n(o);while(++r<o)s[r]=e[r+t];return s}function Po(e,t){var n;return _r(e,(function(e,i,r){return n=t(e,i,r),!n})),!!n}function Ro(e,t,n){var i=0,r=null==e?i:e.length;if("number"==typeof t&&t===t&&r<=B){while(i<r){var o=i+r>>>1,s=e[o];null!==s&&!Fc(s)&&(n?s<=t:s<t)?i=o+1:r=o}return r}return Lo(e,t,Rd,n)}function Lo(e,t,n,i){var r=0,s=null==e?0:e.length;if(0===s)return 0;t=n(t);var a=t!==t,l=null===t,u=Fc(t),c=t===o;while(r<s){var h=It((r+s)/2),d=n(e[h]),p=d!==o,f=null===d,m=d===d,g=Fc(d);if(a)var v=i||m;else v=c?m&&(i||p):l?m&&p&&(i||!f):u?m&&p&&!f&&(i||!g):!f&&!g&&(i?d<=t:d<t);v?r=h+1:s=h}return jt(s,j)}function Oo(e,t){var n=-1,i=e.length,r=0,o=[];while(++n<i){var s=e[n],a=t?t(s):s;if(!n||!rc(a,l)){var l=a;o[r++]=0===s?0:s}}return o}function Do(e){return"number"==typeof e?e:Fc(e)?F:+e}function Io(e){if("string"==typeof e)return e;if(lc(e))return Cn(e,Io)+"";if(Fc(e))return bi?bi.call(e):"";var t=e+"";return"0"==t&&1/e==-k?"-0":t}function No(e,t,n){var i=-1,r=Mn,o=e.length,s=!0,l=[],u=l;if(n)s=!1,r=Tn;else if(o>=a){var c=t?null:Ps(e);if(c)return di(c);s=!1,r=Kn,u=new Xi}else u=t?[]:l;e:while(++i<o){var h=e[i],d=t?t(h):h;if(h=n||0!==h?h:0,s&&d===d){var p=u.length;while(p--)if(u[p]===d)continue e;t&&u.push(d),l.push(h)}else r(u,d,n)||(u!==l&&u.push(d),l.push(h))}return l}function ko(e,t){return t=Ho(t,e),e=wa(e,t),null==e||delete e[La(ol(t))]}function Vo(e,t,n,i){return So(e,t,n(Ir(e,t)),i)}function Uo(e,t,n,i){var r=e.length,o=i?r:-1;while((i?o--:++o<r)&&t(e[o],o,e));return n?Co(e,i?0:o,i?o+1:r):Co(e,i?o+1:0,i?r:o)}function Fo(e,t){var n=e;return n instanceof Ti&&(n=n.value()),Rn(t,(function(e,t){return t.func.apply(t.thisArg,Pn([e],t.args))}),n)}function zo(e,t,i){var r=e.length;if(r<2)return r?No(e[0]):[];var o=-1,s=n(r);while(++o<r){var a=e[o],l=-1;while(++l<r)l!=o&&(s[o]=wr(s[o]||a,e[l],t,i))}return No(Cr(s,1),t,i)}function jo(e,t,n){var i=-1,r=e.length,s=t.length,a={};while(++i<r){var l=i<s?t[i]:o;n(a,e[i],l)}return a}function Bo(e){return hc(e)?e:[]}function $o(e){return"function"==typeof e?e:Rd}function Ho(e,t){return lc(e)?e:la(e,t)?[e]:Ra(Qc(e))}var Go=wo;function Wo(e,t,n){var i=e.length;return n=n===o?i:n,!t&&n>=i?e:Co(e,t,n)}var qo=Rt||function(e){return ln.clearTimeout(e)};function Yo(e,t){if(t)return e.slice();var n=e.length,i=wt?wt(n):new e.constructor(n);return e.copy(i),i}function Xo(e){var t=new e.constructor(e.byteLength);return new bt(t).set(new bt(e)),t}function Zo(e,t){var n=t?Xo(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}function Jo(e){var t=new e.constructor(e.source,qe.exec(e));return t.lastIndex=e.lastIndex,t}function Ko(e){return fi?nt(fi.call(e)):{}}function Qo(e,t){var n=t?Xo(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function es(e,t){if(e!==t){var n=e!==o,i=null===e,r=e===e,s=Fc(e),a=t!==o,l=null===t,u=t===t,c=Fc(t);if(!l&&!c&&!s&&e>t||s&&a&&u&&!l&&!c||i&&a&&u||!n&&u||!r)return 1;if(!i&&!s&&!c&&e<t||c&&n&&r&&!i&&!s||l&&n&&r||!a&&r||!u)return-1}return 0}function ts(e,t,n){var i=-1,r=e.criteria,o=t.criteria,s=r.length,a=n.length;while(++i<s){var l=es(r[i],o[i]);if(l){if(i>=a)return l;var u=n[i];return l*("desc"==u?-1:1)}}return e.index-t.index}function ns(e,t,i,r){var o=-1,s=e.length,a=i.length,l=-1,u=t.length,c=zt(s-a,0),h=n(u+c),d=!r;while(++l<u)h[l]=t[l];while(++o<a)(d||o<s)&&(h[i[o]]=e[o]);while(c--)h[l++]=e[o++];return h}function is(e,t,i,r){var o=-1,s=e.length,a=-1,l=i.length,u=-1,c=t.length,h=zt(s-l,0),d=n(h+c),p=!r;while(++o<h)d[o]=e[o];var f=o;while(++u<c)d[f+u]=t[u];while(++a<l)(p||o<s)&&(d[f+i[a]]=e[o++]);return d}function rs(e,t){var i=-1,r=e.length;t||(t=n(r));while(++i<r)t[i]=e[i];return t}function os(e,t,n,i){var r=!n;n||(n={});var s=-1,a=t.length;while(++s<a){var l=t[s],u=i?i(n[l],e[l],l,n,e):o;u===o&&(u=e[l]),r?fr(n,l,u):ur(n,l,u)}return n}function ss(e,t){return os(e,Xs(e),t)}function as(e,t){return os(e,Zs(e),t)}function ls(e,t){return function(n,i){var r=lc(n)?wn:hr,o=t?t():{};return r(n,e,Hs(i,2),o)}}function us(e){return wo((function(t,n){var i=-1,r=n.length,s=r>1?n[r-1]:o,a=r>2?n[2]:o;s=e.length>3&&"function"==typeof s?(r--,s):o,a&&aa(n[0],n[1],a)&&(s=r<3?o:s,r=1),t=nt(t);while(++i<r){var l=n[i];l&&e(t,l,i,s)}return t}))}function cs(e,t){return function(n,i){if(null==n)return n;if(!cc(n))return e(n,i);var r=n.length,o=t?r:-1,s=nt(n);while(t?o--:++o<r)if(!1===i(s[o],o,s))break;return n}}function hs(e){return function(t,n,i){var r=-1,o=nt(t),s=i(t),a=s.length;while(a--){var l=s[e?a:++r];if(!1===n(o[l],l,o))break}return t}}function ds(e,t,n){var i=t&x,r=ms(e);function o(){var t=this&&this!==ln&&this instanceof o?r:e;return t.apply(i?n:this,arguments)}return o}function ps(e){return function(t){t=Qc(t);var n=si(t)?vi(t):o,i=n?n[0]:t.charAt(0),r=n?Wo(n,1).join(""):t.slice(1);return i[e]()+r}}function fs(e){return function(t){return Rn(wd(Yh(t).replace($t,"")),e,"")}}function ms(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Ai(e.prototype),i=e.apply(n,t);return Sc(i)?i:n}}function gs(e,t,i){var r=ms(e);function s(){var a=arguments.length,l=n(a),u=a,c=$s(s);while(u--)l[u]=arguments[u];var h=a<3&&l[0]!==c&&l[a-1]!==c?[]:hi(l,c);if(a-=h.length,a<i)return Ts(e,t,xs,s.placeholder,o,l,h,o,o,i-a);var d=this&&this!==ln&&this instanceof s?r:e;return bn(d,this,l)}return s}function vs(e){return function(t,n,i){var r=nt(t);if(!cc(t)){var s=Hs(n,3);t=_h(t),n=function(e){return s(r[e],e,r)}}var a=e(t,n,i);return a>-1?r[s?t[a]:a]:o}}function ys(e){return Us((function(t){var n=t.length,i=n,r=Mi.prototype.thru;e&&t.reverse();while(i--){var s=t[i];if("function"!=typeof s)throw new ot(u);if(r&&!a&&"wrapper"==Bs(s))var a=new Mi([],!0)}i=a?i:n;while(++i<n){s=t[i];var l=Bs(s),c="wrapper"==l?js(s):o;a=c&&ca(c[0])&&c[1]==(M|_|S|T)&&!c[4].length&&1==c[9]?a[Bs(c[0])].apply(a,c[3]):1==s.length&&ca(s)?a[l]():a.thru(s)}return function(){var e=arguments,i=e[0];if(a&&1==e.length&&lc(i))return a.plant(i).value();var r=0,o=n?t[r].apply(this,e):i;while(++r<n)o=t[r].call(this,o);return o}}))}function xs(e,t,i,r,s,a,l,u,c,h){var d=t&M,p=t&x,f=t&b,m=t&(_|A),g=t&C,v=f?o:ms(e);function y(){var o=arguments.length,x=n(o),b=o;while(b--)x[b]=arguments[b];if(m)var w=$s(y),_=ti(x,w);if(r&&(x=ns(x,r,s,m)),a&&(x=is(x,a,l,m)),o-=_,m&&o<h){var A=hi(x,w);return Ts(e,t,xs,y.placeholder,i,x,A,u,c,h-o)}var S=p?i:this,E=f?S[e]:e;return o=x.length,u?x=_a(x,u):g&&o>1&&x.reverse(),d&&c<o&&(x.length=c),this&&this!==ln&&this instanceof y&&(E=v||ms(E)),E.apply(S,x)}return y}function bs(e,t){return function(n,i){return Br(n,e,t(i),{})}}function ws(e,t){return function(n,i){var r;if(n===o&&i===o)return t;if(n!==o&&(r=n),i!==o){if(r===o)return i;"string"==typeof n||"string"==typeof i?(n=Io(n),i=Io(i)):(n=Do(n),i=Do(i)),r=e(n,i)}return r}}function _s(e){return Us((function(t){return t=Cn(t,Zn(Hs())),wo((function(n){var i=this;return e(t,(function(e){return bn(e,i,n)}))}))}))}function As(e,t){t=t===o?" ":Io(t);var n=t.length;if(n<2)return n?bo(t,e):t;var i=bo(t,Dt(e/gi(t)));return si(t)?Wo(vi(i),0,e).join(""):i.slice(0,e)}function Ss(e,t,i,r){var o=t&x,s=ms(e);function a(){var t=-1,l=arguments.length,u=-1,c=r.length,h=n(c+l),d=this&&this!==ln&&this instanceof a?s:e;while(++u<c)h[u]=r[u];while(l--)h[u++]=arguments[++t];return bn(d,o?i:this,h)}return a}function Es(e){return function(t,n,i){return i&&"number"!=typeof i&&aa(t,n,i)&&(n=i=o),t=qc(t),n===o?(n=t,t=0):n=qc(n),i=i===o?t<n?1:-1:qc(i),xo(t,n,i,e)}}function Ms(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=Zc(t),n=Zc(n)),e(t,n)}}function Ts(e,t,n,i,r,s,a,l,u,c){var h=t&_,d=h?a:o,p=h?o:a,f=h?s:o,m=h?o:s;t|=h?S:E,t&=~(h?E:S),t&w||(t&=~(x|b));var g=[e,t,r,f,d,m,p,l,u,c],v=n.apply(o,g);return ca(e)&&Sa(v,g),v.placeholder=i,Ta(v,e,t)}function Cs(e){var t=$e[e];return function(e,n){if(e=Zc(e),n=null==n?0:jt(Yc(n),292),n&&Vt(e)){var i=(Qc(e)+"e").split("e"),r=t(i[0]+"e"+(+i[1]+n));return i=(Qc(r)+"e").split("e"),+(i[0]+"e"+(+i[1]-n))}return t(e)}}var Ps=tn&&1/di(new tn([,-0]))[1]==k?function(e){return new tn(e)}:Ud;function Rs(e){return function(t){var n=Js(t);return n==Q?ui(t):n==se?pi(t):Yn(t,e(t))}}function Ls(e,t,n,i,r,s,a,l){var c=t&b;if(!c&&"function"!=typeof e)throw new ot(u);var h=i?i.length:0;if(h||(t&=~(S|E),i=r=o),a=a===o?a:zt(Yc(a),0),l=l===o?l:Yc(l),h-=r?r.length:0,t&E){var d=i,p=r;i=r=o}var f=c?o:js(e),m=[e,t,n,i,r,d,p,s,a,l];if(f&&va(m,f),e=m[0],t=m[1],n=m[2],i=m[3],r=m[4],l=m[9]=m[9]===o?c?0:e.length:zt(m[9]-h,0),!l&&t&(_|A)&&(t&=~(_|A)),t&&t!=x)g=t==_||t==A?gs(e,t,l):t!=S&&t!=(x|S)||r.length?xs.apply(o,m):Ss(e,t,n,i);else var g=ds(e,t,n);var v=f?Eo:Sa;return Ta(v(g,m),e,t)}function Os(e,t,n,i){return e===o||rc(e,lt[n])&&!ht.call(i,n)?t:e}function Ds(e,t,n,i,r,s){return Sc(e)&&Sc(t)&&(s.set(t,e),lo(e,t,o,Ds,s),s["delete"](t)),e}function Is(e){return Ic(e)?o:e}function Ns(e,t,n,i,r,s){var a=n&v,l=e.length,u=t.length;if(l!=u&&!(a&&u>l))return!1;var c=s.get(e),h=s.get(t);if(c&&h)return c==t&&h==e;var d=-1,p=!0,f=n&y?new Xi:o;s.set(e,t),s.set(t,e);while(++d<l){var m=e[d],g=t[d];if(i)var x=a?i(g,m,d,t,e,s):i(m,g,d,e,t,s);if(x!==o){if(x)continue;p=!1;break}if(f){if(!On(t,(function(e,t){if(!Kn(f,t)&&(m===e||r(m,e,n,i,s)))return f.push(t)}))){p=!1;break}}else if(m!==g&&!r(m,g,n,i,s)){p=!1;break}}return s["delete"](e),s["delete"](t),p}function ks(e,t,n,i,r,o,s){switch(n){case pe:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case de:return!(e.byteLength!=t.byteLength||!o(new bt(e),new bt(t)));case q:case Y:case ee:return rc(+e,+t);case Z:return e.name==t.name&&e.message==t.message;case oe:case ae:return e==t+"";case Q:var a=ui;case se:var l=i&v;if(a||(a=di),e.size!=t.size&&!l)return!1;var u=s.get(e);if(u)return u==t;i|=y,s.set(e,t);var c=Ns(a(e),a(t),i,r,o,s);return s["delete"](e),c;case le:if(fi)return fi.call(e)==fi.call(t)}return!1}function Vs(e,t,n,i,r,s){var a=n&v,l=Fs(e),u=l.length,c=Fs(t),h=c.length;if(u!=h&&!a)return!1;var d=u;while(d--){var p=l[d];if(!(a?p in t:ht.call(t,p)))return!1}var f=s.get(e),m=s.get(t);if(f&&m)return f==t&&m==e;var g=!0;s.set(e,t),s.set(t,e);var y=a;while(++d<u){p=l[d];var x=e[p],b=t[p];if(i)var w=a?i(b,x,p,t,e,s):i(x,b,p,e,t,s);if(!(w===o?x===b||r(x,b,n,i,s):w)){g=!1;break}y||(y="constructor"==p)}if(g&&!y){var _=e.constructor,A=t.constructor;_==A||!("constructor"in e)||!("constructor"in t)||"function"==typeof _&&_ instanceof _&&"function"==typeof A&&A instanceof A||(g=!1)}return s["delete"](e),s["delete"](t),g}function Us(e){return Ma(ba(e,o,Ya),e+"")}function Fs(e){return Nr(e,_h,Xs)}function zs(e){return Nr(e,Ah,Zs)}var js=an?function(e){return an.get(e)}:Ud;function Bs(e){var t=e.name+"",n=un[t],i=ht.call(un,t)?n.length:0;while(i--){var r=n[i],o=r.func;if(null==o||o==e)return r.name}return t}function $s(e){var t=ht.call(wi,"placeholder")?wi:e;return t.placeholder}function Hs(){var e=wi.iteratee||Ld;return e=e===Ld?to:e,arguments.length?e(arguments[0],arguments[1]):e}function Gs(e,t){var n=e.__data__;return ua(t)?n["string"==typeof t?"string":"hash"]:n.map}function Ws(e){var t=_h(e),n=t.length;while(n--){var i=t[n],r=e[i];t[n]=[i,r,fa(r)]}return t}function qs(e,t){var n=oi(e,t);return Jr(n)?n:o}function Ys(e){var t=ht.call(e,Ct),n=e[Ct];try{e[Ct]=o;var i=!0}catch(s){}var r=ft.call(e);return i&&(t?e[Ct]=n:delete e[Ct]),r}var Xs=Nt?function(e){return null==e?[]:(e=nt(e),En(Nt(e),(function(t){return St.call(e,t)})))}:qd,Zs=Nt?function(e){var t=[];while(e)Pn(t,Xs(e)),e=_t(e);return t}:qd,Js=kr;function Ks(e,t,n){var i=-1,r=n.length;while(++i<r){var o=n[i],s=o.size;switch(o.type){case"drop":e+=s;break;case"dropRight":t-=s;break;case"take":t=jt(t,e+s);break;case"takeRight":e=zt(e,t-s);break}}return{start:e,end:t}}function Qs(e){var t=e.match(je);return t?t[1].split(Be):[]}function ea(e,t,n){t=Ho(t,e);var i=-1,r=t.length,o=!1;while(++i<r){var s=La(t[i]);if(!(o=null!=e&&n(e,s)))break;e=e[s]}return o||++i!=r?o:(r=null==e?0:e.length,!!r&&Ac(r)&&sa(s,r)&&(lc(e)||ac(e)))}function ta(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&ht.call(e,"index")&&(n.index=e.index,n.input=e.input),n}function na(e){return"function"!=typeof e.constructor||pa(e)?{}:Ai(_t(e))}function ia(e,t,n){var i=e.constructor;switch(t){case de:return Xo(e);case q:case Y:return new i(+e);case pe:return Zo(e,n);case fe:case me:case ge:case ve:case ye:case xe:case be:case we:case _e:return Qo(e,n);case Q:return new i;case ee:case ae:return new i(e);case oe:return Jo(e);case se:return new i;case le:return Ko(e)}}function ra(e,t){var n=t.length;if(!n)return e;var i=n-1;return t[i]=(n>1?"& ":"")+t[i],t=t.join(n>2?", ":" "),e.replace(ze,"{\n/* [wrapped with "+t+"] */\n")}function oa(e){return lc(e)||ac(e)||!!(Mt&&e&&e[Mt])}function sa(e,t){var n=typeof e;return t=null==t?V:t,!!t&&("number"==n||"symbol"!=n&&Ke.test(e))&&e>-1&&e%1==0&&e<t}function aa(e,t,n){if(!Sc(n))return!1;var i=typeof t;return!!("number"==i?cc(n)&&sa(t,n.length):"string"==i&&t in n)&&rc(n[t],e)}function la(e,t){if(lc(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!Fc(e))||(Ie.test(e)||!De.test(e)||null!=t&&e in nt(t))}function ua(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}function ca(e){var t=Bs(e),n=wi[t];if("function"!=typeof n||!(t in Ti.prototype))return!1;if(e===n)return!0;var i=js(n);return!!i&&e===i[0]}function ha(e){return!!pt&&pt in e}(Yt&&Js(new Yt(new ArrayBuffer(1)))!=pe||Qt&&Js(new Qt)!=Q||en&&Js(en.resolve())!=ie||tn&&Js(new tn)!=se||nn&&Js(new nn)!=ce)&&(Js=function(e){var t=kr(e),n=t==ne?e.constructor:o,i=n?Oa(n):"";if(i)switch(i){case cn:return pe;case dn:return Q;case pn:return ie;case Dn:return se;case In:return ce}return t});var da=ut?wc:Yd;function pa(e){var t=e&&e.constructor,n="function"==typeof t&&t.prototype||lt;return e===n}function fa(e){return e===e&&!Sc(e)}function ma(e,t){return function(n){return null!=n&&(n[e]===t&&(t!==o||e in nt(n)))}}function ga(e){var t=zu(e,(function(e){return n.size===d&&n.clear(),e})),n=t.cache;return t}function va(e,t){var n=e[1],i=t[1],r=n|i,o=r<(x|b|M),s=i==M&&n==_||i==M&&n==T&&e[7].length<=t[8]||i==(M|T)&&t[7].length<=t[8]&&n==_;if(!o&&!s)return e;i&x&&(e[2]=t[2],r|=n&x?0:w);var a=t[3];if(a){var l=e[3];e[3]=l?ns(l,a,t[4]):a,e[4]=l?hi(e[3],p):t[4]}return a=t[5],a&&(l=e[5],e[5]=l?is(l,a,t[6]):a,e[6]=l?hi(e[5],p):t[6]),a=t[7],a&&(e[7]=a),i&M&&(e[8]=null==e[8]?t[8]:jt(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=r,e}function ya(e){var t=[];if(null!=e)for(var n in nt(e))t.push(n);return t}function xa(e){return ft.call(e)}function ba(e,t,i){return t=zt(t===o?e.length-1:t,0),function(){var r=arguments,o=-1,s=zt(r.length-t,0),a=n(s);while(++o<s)a[o]=r[t+o];o=-1;var l=n(t+1);while(++o<t)l[o]=r[o];return l[t]=i(a),bn(e,this,l)}}function wa(e,t){return t.length<2?e:Ir(e,Co(t,0,-1))}function _a(e,t){var n=e.length,i=jt(t.length,n),r=rs(e);while(i--){var s=t[i];e[i]=sa(s,n)?r[s]:o}return e}function Aa(e,t){if(("constructor"!==t||"function"!==typeof e[t])&&"__proto__"!=t)return e[t]}var Sa=Ca(Eo),Ea=Ot||function(e,t){return ln.setTimeout(e,t)},Ma=Ca(Mo);function Ta(e,t,n){var i=t+"";return Ma(e,ra(i,Da(Qs(i),n)))}function Ca(e){var t=0,n=0;return function(){var i=Bt(),r=O-(i-n);if(n=i,r>0){if(++t>=L)return arguments[0]}else t=0;return e.apply(o,arguments)}}function Pa(e,t){var n=-1,i=e.length,r=i-1;t=t===o?i:t;while(++n<t){var s=yo(n,r),a=e[s];e[s]=e[n],e[n]=a}return e.length=t,e}var Ra=ga((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Ne,(function(e,n,i,r){t.push(i?r.replace(Ge,"$1"):n||e)})),t}));function La(e){if("string"==typeof e||Fc(e))return e;var t=e+"";return"0"==t&&1/e==-k?"-0":t}function Oa(e){if(null!=e){try{return ct.call(e)}catch(t){}try{return e+""}catch(t){}}return""}function Da(e,t){return _n($,(function(n){var i="_."+n[0];t&n[1]&&!Mn(e,i)&&e.push(i)})),e.sort()}function Ia(e){if(e instanceof Ti)return e.clone();var t=new Mi(e.__wrapped__,e.__chain__);return t.__actions__=rs(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function Na(e,t,i){t=(i?aa(e,t,i):t===o)?1:zt(Yc(t),0);var r=null==e?0:e.length;if(!r||t<1)return[];var s=0,a=0,l=n(Dt(r/t));while(s<r)l[a++]=Co(e,s,s+=t);return l}function ka(e){var t=-1,n=null==e?0:e.length,i=0,r=[];while(++t<n){var o=e[t];o&&(r[i++]=o)}return r}function Va(){var e=arguments.length;if(!e)return[];var t=n(e-1),i=arguments[0],r=e;while(r--)t[r-1]=arguments[r];return Pn(lc(i)?rs(i):[i],Cr(t,1))}var Ua=wo((function(e,t){return hc(e)?wr(e,Cr(t,1,hc,!0)):[]})),Fa=wo((function(e,t){var n=ol(t);return hc(n)&&(n=o),hc(e)?wr(e,Cr(t,1,hc,!0),Hs(n,2)):[]})),za=wo((function(e,t){var n=ol(t);return hc(n)&&(n=o),hc(e)?wr(e,Cr(t,1,hc,!0),o,n):[]}));function ja(e,t,n){var i=null==e?0:e.length;return i?(t=n||t===o?1:Yc(t),Co(e,t<0?0:t,i)):[]}function Ba(e,t,n){var i=null==e?0:e.length;return i?(t=n||t===o?1:Yc(t),t=i-t,Co(e,0,t<0?0:t)):[]}function $a(e,t){return e&&e.length?Uo(e,Hs(t,3),!0,!0):[]}function Ha(e,t){return e&&e.length?Uo(e,Hs(t,3),!0):[]}function Ga(e,t,n,i){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&aa(e,t,n)&&(n=0,i=r),Mr(e,t,n,i)):[]}function Wa(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var r=null==n?0:Yc(n);return r<0&&(r=zt(i+r,0)),Vn(e,Hs(t,3),r)}function qa(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var r=i-1;return n!==o&&(r=Yc(n),r=n<0?zt(i+r,0):jt(r,i-1)),Vn(e,Hs(t,3),r,!0)}function Ya(e){var t=null==e?0:e.length;return t?Cr(e,1):[]}function Xa(e){var t=null==e?0:e.length;return t?Cr(e,k):[]}function Za(e,t){var n=null==e?0:e.length;return n?(t=t===o?1:Yc(t),Cr(e,t)):[]}function Ja(e){var t=-1,n=null==e?0:e.length,i={};while(++t<n){var r=e[t];i[r[0]]=r[1]}return i}function Ka(e){return e&&e.length?e[0]:o}function Qa(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var r=null==n?0:Yc(n);return r<0&&(r=zt(i+r,0)),Un(e,t,r)}function el(e){var t=null==e?0:e.length;return t?Co(e,0,-1):[]}var tl=wo((function(e){var t=Cn(e,Bo);return t.length&&t[0]===e[0]?jr(t):[]})),nl=wo((function(e){var t=ol(e),n=Cn(e,Bo);return t===ol(n)?t=o:n.pop(),n.length&&n[0]===e[0]?jr(n,Hs(t,2)):[]})),il=wo((function(e){var t=ol(e),n=Cn(e,Bo);return t="function"==typeof t?t:o,t&&n.pop(),n.length&&n[0]===e[0]?jr(n,o,t):[]}));function rl(e,t){return null==e?"":Ut.call(e,t)}function ol(e){var t=null==e?0:e.length;return t?e[t-1]:o}function sl(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var r=i;return n!==o&&(r=Yc(n),r=r<0?zt(i+r,0):jt(r,i-1)),t===t?mi(e,t,r):Vn(e,zn,r,!0)}function al(e,t){return e&&e.length?co(e,Yc(t)):o}var ll=wo(ul);function ul(e,t){return e&&e.length&&t&&t.length?go(e,t):e}function cl(e,t,n){return e&&e.length&&t&&t.length?go(e,t,Hs(n,2)):e}function hl(e,t,n){return e&&e.length&&t&&t.length?go(e,t,o,n):e}var dl=Us((function(e,t){var n=null==e?0:e.length,i=mr(e,t);return vo(e,Cn(t,(function(e){return sa(e,n)?+e:e})).sort(es)),i}));function pl(e,t){var n=[];if(!e||!e.length)return n;var i=-1,r=[],o=e.length;t=Hs(t,3);while(++i<o){var s=e[i];t(s,i,e)&&(n.push(s),r.push(i))}return vo(e,r),n}function fl(e){return null==e?e:qt.call(e)}function ml(e,t,n){var i=null==e?0:e.length;return i?(n&&"number"!=typeof n&&aa(e,t,n)?(t=0,n=i):(t=null==t?0:Yc(t),n=n===o?i:Yc(n)),Co(e,t,n)):[]}function gl(e,t){return Ro(e,t)}function vl(e,t,n){return Lo(e,t,Hs(n,2))}function yl(e,t){var n=null==e?0:e.length;if(n){var i=Ro(e,t);if(i<n&&rc(e[i],t))return i}return-1}function xl(e,t){return Ro(e,t,!0)}function bl(e,t,n){return Lo(e,t,Hs(n,2),!0)}function wl(e,t){var n=null==e?0:e.length;if(n){var i=Ro(e,t,!0)-1;if(rc(e[i],t))return i}return-1}function _l(e){return e&&e.length?Oo(e):[]}function Al(e,t){return e&&e.length?Oo(e,Hs(t,2)):[]}function Sl(e){var t=null==e?0:e.length;return t?Co(e,1,t):[]}function El(e,t,n){return e&&e.length?(t=n||t===o?1:Yc(t),Co(e,0,t<0?0:t)):[]}function Ml(e,t,n){var i=null==e?0:e.length;return i?(t=n||t===o?1:Yc(t),t=i-t,Co(e,t<0?0:t,i)):[]}function Tl(e,t){return e&&e.length?Uo(e,Hs(t,3),!1,!0):[]}function Cl(e,t){return e&&e.length?Uo(e,Hs(t,3)):[]}var Pl=wo((function(e){return No(Cr(e,1,hc,!0))})),Rl=wo((function(e){var t=ol(e);return hc(t)&&(t=o),No(Cr(e,1,hc,!0),Hs(t,2))})),Ll=wo((function(e){var t=ol(e);return t="function"==typeof t?t:o,No(Cr(e,1,hc,!0),o,t)}));function Ol(e){return e&&e.length?No(e):[]}function Dl(e,t){return e&&e.length?No(e,Hs(t,2)):[]}function Il(e,t){return t="function"==typeof t?t:o,e&&e.length?No(e,o,t):[]}function Nl(e){if(!e||!e.length)return[];var t=0;return e=En(e,(function(e){if(hc(e))return t=zt(e.length,t),!0})),qn(t,(function(t){return Cn(e,Bn(t))}))}function kl(e,t){if(!e||!e.length)return[];var n=Nl(e);return null==t?n:Cn(n,(function(e){return bn(t,o,e)}))}var Vl=wo((function(e,t){return hc(e)?wr(e,t):[]})),Ul=wo((function(e){return zo(En(e,hc))})),Fl=wo((function(e){var t=ol(e);return hc(t)&&(t=o),zo(En(e,hc),Hs(t,2))})),zl=wo((function(e){var t=ol(e);return t="function"==typeof t?t:o,zo(En(e,hc),o,t)})),jl=wo(Nl);function Bl(e,t){return jo(e||[],t||[],ur)}function $l(e,t){return jo(e||[],t||[],So)}var Hl=wo((function(e){var t=e.length,n=t>1?e[t-1]:o;return n="function"==typeof n?(e.pop(),n):o,kl(e,n)}));function Gl(e){var t=wi(e);return t.__chain__=!0,t}function Wl(e,t){return t(e),e}function ql(e,t){return t(e)}var Yl=Us((function(e){var t=e.length,n=t?e[0]:0,i=this.__wrapped__,r=function(t){return mr(t,e)};return!(t>1||this.__actions__.length)&&i instanceof Ti&&sa(n)?(i=i.slice(n,+n+(t?1:0)),i.__actions__.push({func:ql,args:[r],thisArg:o}),new Mi(i,this.__chain__).thru((function(e){return t&&!e.length&&e.push(o),e}))):this.thru(r)}));function Xl(){return Gl(this)}function Zl(){return new Mi(this.value(),this.__chain__)}function Jl(){this.__values__===o&&(this.__values__=Wc(this.value()));var e=this.__index__>=this.__values__.length,t=e?o:this.__values__[this.__index__++];return{done:e,value:t}}function Kl(){return this}function Ql(e){var t,n=this;while(n instanceof Ei){var i=Ia(n);i.__index__=0,i.__values__=o,t?r.__wrapped__=i:t=i;var r=i;n=n.__wrapped__}return r.__wrapped__=e,t}function eu(){var e=this.__wrapped__;if(e instanceof Ti){var t=e;return this.__actions__.length&&(t=new Ti(this)),t=t.reverse(),t.__actions__.push({func:ql,args:[fl],thisArg:o}),new Mi(t,this.__chain__)}return this.thru(fl)}function tu(){return Fo(this.__wrapped__,this.__actions__)}var nu=ls((function(e,t,n){ht.call(e,n)?++e[n]:fr(e,n,1)}));function iu(e,t,n){var i=lc(e)?Sn:Sr;return n&&aa(e,t,n)&&(t=o),i(e,Hs(t,3))}function ru(e,t){var n=lc(e)?En:Tr;return n(e,Hs(t,3))}var ou=vs(Wa),su=vs(qa);function au(e,t){return Cr(gu(e,t),1)}function lu(e,t){return Cr(gu(e,t),k)}function uu(e,t,n){return n=n===o?1:Yc(n),Cr(gu(e,t),n)}function cu(e,t){var n=lc(e)?_n:_r;return n(e,Hs(t,3))}function hu(e,t){var n=lc(e)?An:Ar;return n(e,Hs(t,3))}var du=ls((function(e,t,n){ht.call(e,n)?e[n].push(t):fr(e,n,[t])}));function pu(e,t,n,i){e=cc(e)?e:jh(e),n=n&&!i?Yc(n):0;var r=e.length;return n<0&&(n=zt(r+n,0)),Uc(e)?n<=r&&e.indexOf(t,n)>-1:!!r&&Un(e,t,n)>-1}var fu=wo((function(e,t,i){var r=-1,o="function"==typeof t,s=cc(e)?n(e.length):[];return _r(e,(function(e){s[++r]=o?bn(t,e,i):$r(e,t,i)})),s})),mu=ls((function(e,t,n){fr(e,n,t)}));function gu(e,t){var n=lc(e)?Cn:oo;return n(e,Hs(t,3))}function vu(e,t,n,i){return null==e?[]:(lc(t)||(t=null==t?[]:[t]),n=i?o:n,lc(n)||(n=null==n?[]:[n]),ho(e,t,n))}var yu=ls((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]}));function xu(e,t,n){var i=lc(e)?Rn:Hn,r=arguments.length<3;return i(e,Hs(t,4),n,r,_r)}function bu(e,t,n){var i=lc(e)?Ln:Hn,r=arguments.length<3;return i(e,Hs(t,4),n,r,Ar)}function wu(e,t){var n=lc(e)?En:Tr;return n(e,ju(Hs(t,3)))}function _u(e){var t=lc(e)?or:_o;return t(e)}function Au(e,t,n){t=(n?aa(e,t,n):t===o)?1:Yc(t);var i=lc(e)?sr:Ao;return i(e,t)}function Su(e){var t=lc(e)?ar:To;return t(e)}function Eu(e){if(null==e)return 0;if(cc(e))return Uc(e)?gi(e):e.length;var t=Js(e);return t==Q||t==se?e.size:no(e).length}function Mu(e,t,n){var i=lc(e)?On:Po;return n&&aa(e,t,n)&&(t=o),i(e,Hs(t,3))}var Tu=wo((function(e,t){if(null==e)return[];var n=t.length;return n>1&&aa(e,t[0],t[1])?t=[]:n>2&&aa(t[0],t[1],t[2])&&(t=[t[0]]),ho(e,Cr(t,1),[])})),Cu=Lt||function(){return ln.Date.now()};function Pu(e,t){if("function"!=typeof t)throw new ot(u);return e=Yc(e),function(){if(--e<1)return t.apply(this,arguments)}}function Ru(e,t,n){return t=n?o:t,t=e&&null==t?e.length:t,Ls(e,M,o,o,o,o,t)}function Lu(e,t){var n;if("function"!=typeof t)throw new ot(u);return e=Yc(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=o),n}}var Ou=wo((function(e,t,n){var i=x;if(n.length){var r=hi(n,$s(Ou));i|=S}return Ls(e,i,t,n,r)})),Du=wo((function(e,t,n){var i=x|b;if(n.length){var r=hi(n,$s(Du));i|=S}return Ls(t,i,e,n,r)}));function Iu(e,t,n){t=n?o:t;var i=Ls(e,_,o,o,o,o,o,t);return i.placeholder=Iu.placeholder,i}function Nu(e,t,n){t=n?o:t;var i=Ls(e,A,o,o,o,o,o,t);return i.placeholder=Nu.placeholder,i}function ku(e,t,n){var i,r,s,a,l,c,h=0,d=!1,p=!1,f=!0;if("function"!=typeof e)throw new ot(u);function m(t){var n=i,s=r;return i=r=o,h=t,a=e.apply(s,n),a}function g(e){return h=e,l=Ea(x,t),d?m(e):a}function v(e){var n=e-c,i=e-h,r=t-n;return p?jt(r,s-i):r}function y(e){var n=e-c,i=e-h;return c===o||n>=t||n<0||p&&i>=s}function x(){var e=Cu();if(y(e))return b(e);l=Ea(x,v(e))}function b(e){return l=o,f&&i?m(e):(i=r=o,a)}function w(){l!==o&&qo(l),h=0,i=c=r=l=o}function _(){return l===o?a:b(Cu())}function A(){var e=Cu(),n=y(e);if(i=arguments,r=this,c=e,n){if(l===o)return g(c);if(p)return qo(l),l=Ea(x,t),m(c)}return l===o&&(l=Ea(x,t)),a}return t=Zc(t)||0,Sc(n)&&(d=!!n.leading,p="maxWait"in n,s=p?zt(Zc(n.maxWait)||0,t):s,f="trailing"in n?!!n.trailing:f),A.cancel=w,A.flush=_,A}var Vu=wo((function(e,t){return br(e,1,t)})),Uu=wo((function(e,t,n){return br(e,Zc(t)||0,n)}));function Fu(e){return Ls(e,C)}function zu(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new ot(u);var n=function(){var i=arguments,r=t?t.apply(this,i):i[0],o=n.cache;if(o.has(r))return o.get(r);var s=e.apply(this,i);return n.cache=o.set(r,s)||o,s};return n.cache=new(zu.Cache||$i),n}function ju(e){if("function"!=typeof e)throw new ot(u);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function Bu(e){return Lu(2,e)}zu.Cache=$i;var $u=Go((function(e,t){t=1==t.length&&lc(t[0])?Cn(t[0],Zn(Hs())):Cn(Cr(t,1),Zn(Hs()));var n=t.length;return wo((function(i){var r=-1,o=jt(i.length,n);while(++r<o)i[r]=t[r].call(this,i[r]);return bn(e,this,i)}))})),Hu=wo((function(e,t){var n=hi(t,$s(Hu));return Ls(e,S,o,t,n)})),Gu=wo((function(e,t){var n=hi(t,$s(Gu));return Ls(e,E,o,t,n)})),Wu=Us((function(e,t){return Ls(e,T,o,o,o,t)}));function qu(e,t){if("function"!=typeof e)throw new ot(u);return t=t===o?t:Yc(t),wo(e,t)}function Yu(e,t){if("function"!=typeof e)throw new ot(u);return t=null==t?0:zt(Yc(t),0),wo((function(n){var i=n[t],r=Wo(n,0,t);return i&&Pn(r,i),bn(e,this,r)}))}function Xu(e,t,n){var i=!0,r=!0;if("function"!=typeof e)throw new ot(u);return Sc(n)&&(i="leading"in n?!!n.leading:i,r="trailing"in n?!!n.trailing:r),ku(e,t,{leading:i,maxWait:t,trailing:r})}function Zu(e){return Ru(e,1)}function Ju(e,t){return Hu($o(t),e)}function Ku(){if(!arguments.length)return[];var e=arguments[0];return lc(e)?e:[e]}function Qu(e){return vr(e,g)}function ec(e,t){return t="function"==typeof t?t:o,vr(e,g,t)}function tc(e){return vr(e,f|g)}function nc(e,t){return t="function"==typeof t?t:o,vr(e,f|g,t)}function ic(e,t){return null==t||xr(e,t,_h(t))}function rc(e,t){return e===t||e!==e&&t!==t}var oc=Ms(Vr),sc=Ms((function(e,t){return e>=t})),ac=Hr(function(){return arguments}())?Hr:function(e){return Ec(e)&&ht.call(e,"callee")&&!St.call(e,"callee")},lc=n.isArray,uc=fn?Zn(fn):Gr;function cc(e){return null!=e&&Ac(e.length)&&!wc(e)}function hc(e){return Ec(e)&&cc(e)}function dc(e){return!0===e||!1===e||Ec(e)&&kr(e)==q}var pc=kt||Yd,fc=mn?Zn(mn):Wr;function mc(e){return Ec(e)&&1===e.nodeType&&!Ic(e)}function gc(e){if(null==e)return!0;if(cc(e)&&(lc(e)||"string"==typeof e||"function"==typeof e.splice||pc(e)||zc(e)||ac(e)))return!e.length;var t=Js(e);if(t==Q||t==se)return!e.size;if(pa(e))return!no(e).length;for(var n in e)if(ht.call(e,n))return!1;return!0}function vc(e,t){return qr(e,t)}function yc(e,t,n){n="function"==typeof n?n:o;var i=n?n(e,t):o;return i===o?qr(e,t,o,n):!!i}function xc(e){if(!Ec(e))return!1;var t=kr(e);return t==Z||t==X||"string"==typeof e.message&&"string"==typeof e.name&&!Ic(e)}function bc(e){return"number"==typeof e&&Vt(e)}function wc(e){if(!Sc(e))return!1;var t=kr(e);return t==J||t==K||t==W||t==re}function _c(e){return"number"==typeof e&&e==Yc(e)}function Ac(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=V}function Sc(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Ec(e){return null!=e&&"object"==typeof e}var Mc=gn?Zn(gn):Xr;function Tc(e,t){return e===t||Zr(e,t,Ws(t))}function Cc(e,t,n){return n="function"==typeof n?n:o,Zr(e,t,Ws(t),n)}function Pc(e){return Dc(e)&&e!=+e}function Rc(e){if(da(e))throw new r(l);return Jr(e)}function Lc(e){return null===e}function Oc(e){return null==e}function Dc(e){return"number"==typeof e||Ec(e)&&kr(e)==ee}function Ic(e){if(!Ec(e)||kr(e)!=ne)return!1;var t=_t(e);if(null===t)return!0;var n=ht.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&ct.call(n)==mt}var Nc=vn?Zn(vn):Kr;function kc(e){return _c(e)&&e>=-V&&e<=V}var Vc=yn?Zn(yn):Qr;function Uc(e){return"string"==typeof e||!lc(e)&&Ec(e)&&kr(e)==ae}function Fc(e){return"symbol"==typeof e||Ec(e)&&kr(e)==le}var zc=xn?Zn(xn):eo;function jc(e){return e===o}function Bc(e){return Ec(e)&&Js(e)==ce}function $c(e){return Ec(e)&&kr(e)==he}var Hc=Ms(ro),Gc=Ms((function(e,t){return e<=t}));function Wc(e){if(!e)return[];if(cc(e))return Uc(e)?vi(e):rs(e);if(Tt&&e[Tt])return li(e[Tt]());var t=Js(e),n=t==Q?ui:t==se?di:jh;return n(e)}function qc(e){if(!e)return 0===e?e:0;if(e=Zc(e),e===k||e===-k){var t=e<0?-1:1;return t*U}return e===e?e:0}function Yc(e){var t=qc(e),n=t%1;return t===t?n?t-n:t:0}function Xc(e){return e?gr(Yc(e),0,z):0}function Zc(e){if("number"==typeof e)return e;if(Fc(e))return F;if(Sc(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Sc(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Xn(e);var n=Xe.test(e);return n||Je.test(e)?on(e.slice(2),n?2:8):Ye.test(e)?F:+e}function Jc(e){return os(e,Ah(e))}function Kc(e){return e?gr(Yc(e),-V,V):0===e?e:0}function Qc(e){return null==e?"":Io(e)}var eh=us((function(e,t){if(pa(t)||cc(t))os(t,_h(t),e);else for(var n in t)ht.call(t,n)&&ur(e,n,t[n])})),th=us((function(e,t){os(t,Ah(t),e)})),nh=us((function(e,t,n,i){os(t,Ah(t),e,i)})),ih=us((function(e,t,n,i){os(t,_h(t),e,i)})),rh=Us(mr);function oh(e,t){var n=Ai(e);return null==t?n:dr(n,t)}var sh=wo((function(e,t){e=nt(e);var n=-1,i=t.length,r=i>2?t[2]:o;r&&aa(t[0],t[1],r)&&(i=1);while(++n<i){var s=t[n],a=Ah(s),l=-1,u=a.length;while(++l<u){var c=a[l],h=e[c];(h===o||rc(h,lt[c])&&!ht.call(e,c))&&(e[c]=s[c])}}return e})),ah=wo((function(e){return e.push(o,Ds),bn(Th,o,e)}));function lh(e,t){return kn(e,Hs(t,3),Lr)}function uh(e,t){return kn(e,Hs(t,3),Or)}function ch(e,t){return null==e?e:Pr(e,Hs(t,3),Ah)}function hh(e,t){return null==e?e:Rr(e,Hs(t,3),Ah)}function dh(e,t){return e&&Lr(e,Hs(t,3))}function ph(e,t){return e&&Or(e,Hs(t,3))}function fh(e){return null==e?[]:Dr(e,_h(e))}function mh(e){return null==e?[]:Dr(e,Ah(e))}function gh(e,t,n){var i=null==e?o:Ir(e,t);return i===o?n:i}function vh(e,t){return null!=e&&ea(e,t,Ur)}function yh(e,t){return null!=e&&ea(e,t,Fr)}var xh=bs((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=ft.call(t)),e[t]=n}),Md(Rd)),bh=bs((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=ft.call(t)),ht.call(e,t)?e[t].push(n):e[t]=[n]}),Hs),wh=wo($r);function _h(e){return cc(e)?rr(e):no(e)}function Ah(e){return cc(e)?rr(e,!0):io(e)}function Sh(e,t){var n={};return t=Hs(t,3),Lr(e,(function(e,i,r){fr(n,t(e,i,r),e)})),n}function Eh(e,t){var n={};return t=Hs(t,3),Lr(e,(function(e,i,r){fr(n,i,t(e,i,r))})),n}var Mh=us((function(e,t,n){lo(e,t,n)})),Th=us((function(e,t,n,i){lo(e,t,n,i)})),Ch=Us((function(e,t){var n={};if(null==e)return n;var i=!1;t=Cn(t,(function(t){return t=Ho(t,e),i||(i=t.length>1),t})),os(e,zs(e),n),i&&(n=vr(n,f|m|g,Is));var r=t.length;while(r--)ko(n,t[r]);return n}));function Ph(e,t){return Lh(e,ju(Hs(t)))}var Rh=Us((function(e,t){return null==e?{}:po(e,t)}));function Lh(e,t){if(null==e)return{};var n=Cn(zs(e),(function(e){return[e]}));return t=Hs(t),fo(e,n,(function(e,n){return t(e,n[0])}))}function Oh(e,t,n){t=Ho(t,e);var i=-1,r=t.length;r||(r=1,e=o);while(++i<r){var s=null==e?o:e[La(t[i])];s===o&&(i=r,s=n),e=wc(s)?s.call(e):s}return e}function Dh(e,t,n){return null==e?e:So(e,t,n)}function Ih(e,t,n,i){return i="function"==typeof i?i:o,null==e?e:So(e,t,n,i)}var Nh=Rs(_h),kh=Rs(Ah);function Vh(e,t,n){var i=lc(e),r=i||pc(e)||zc(e);if(t=Hs(t,4),null==n){var o=e&&e.constructor;n=r?i?new o:[]:Sc(e)&&wc(o)?Ai(_t(e)):{}}return(r?_n:Lr)(e,(function(e,i,r){return t(n,e,i,r)})),n}function Uh(e,t){return null==e||ko(e,t)}function Fh(e,t,n){return null==e?e:Vo(e,t,$o(n))}function zh(e,t,n,i){return i="function"==typeof i?i:o,null==e?e:Vo(e,t,$o(n),i)}function jh(e){return null==e?[]:Jn(e,_h(e))}function Bh(e){return null==e?[]:Jn(e,Ah(e))}function $h(e,t,n){return n===o&&(n=t,t=o),n!==o&&(n=Zc(n),n=n===n?n:0),t!==o&&(t=Zc(t),t=t===t?t:0),gr(Zc(e),t,n)}function Hh(e,t,n){return t=qc(t),n===o?(n=t,t=0):n=qc(n),e=Zc(e),zr(e,t,n)}function Gh(e,t,n){if(n&&"boolean"!=typeof n&&aa(e,t,n)&&(t=n=o),n===o&&("boolean"==typeof t?(n=t,t=o):"boolean"==typeof e&&(n=e,e=o)),e===o&&t===o?(e=0,t=1):(e=qc(e),t===o?(t=e,e=0):t=qc(t)),e>t){var i=e;e=t,t=i}if(n||e%1||t%1){var r=Wt();return jt(e+r*(t-e+rn("1e-"+((r+"").length-1))),t)}return yo(e,t)}var Wh=fs((function(e,t,n){return t=t.toLowerCase(),e+(n?qh(t):t)}));function qh(e){return bd(Qc(e).toLowerCase())}function Yh(e){return e=Qc(e),e&&e.replace(Qe,ni).replace(Ht,"")}function Xh(e,t,n){e=Qc(e),t=Io(t);var i=e.length;n=n===o?i:gr(Yc(n),0,i);var r=n;return n-=t.length,n>=0&&e.slice(n,r)==t}function Zh(e){return e=Qc(e),e&&Pe.test(e)?e.replace(Te,ii):e}function Jh(e){return e=Qc(e),e&&Ve.test(e)?e.replace(ke,"\\$&"):e}var Kh=fs((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),Qh=fs((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),ed=ps("toLowerCase");function td(e,t,n){e=Qc(e),t=Yc(t);var i=t?gi(e):0;if(!t||i>=t)return e;var r=(t-i)/2;return As(It(r),n)+e+As(Dt(r),n)}function nd(e,t,n){e=Qc(e),t=Yc(t);var i=t?gi(e):0;return t&&i<t?e+As(t-i,n):e}function id(e,t,n){e=Qc(e),t=Yc(t);var i=t?gi(e):0;return t&&i<t?As(t-i,n)+e:e}function rd(e,t,n){return n||null==t?t=0:t&&(t=+t),Gt(Qc(e).replace(Ue,""),t||0)}function od(e,t,n){return t=(n?aa(e,t,n):t===o)?1:Yc(t),bo(Qc(e),t)}function sd(){var e=arguments,t=Qc(e[0]);return e.length<3?t:t.replace(e[1],e[2])}var ad=fs((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}));function ld(e,t,n){return n&&"number"!=typeof n&&aa(e,t,n)&&(t=n=o),n=n===o?z:n>>>0,n?(e=Qc(e),e&&("string"==typeof t||null!=t&&!Nc(t))&&(t=Io(t),!t&&si(e))?Wo(vi(e),0,n):e.split(t,n)):[]}var ud=fs((function(e,t,n){return e+(n?" ":"")+bd(t)}));function cd(e,t,n){return e=Qc(e),n=null==n?0:gr(Yc(n),0,e.length),t=Io(t),e.slice(n,n+t.length)==t}function hd(e,t,n){var i=wi.templateSettings;n&&aa(e,t,n)&&(t=o),e=Qc(e),t=nh({},t,i,Os);var s,a,l=nh({},t.imports,i.imports,Os),u=_h(l),h=Jn(l,u),d=0,p=t.interpolate||et,f="__p += '",m=it((t.escape||et).source+"|"+p.source+"|"+(p===Oe?We:et).source+"|"+(t.evaluate||et).source+"|$","g"),g="//# sourceURL="+(ht.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Zt+"]")+"\n";e.replace(m,(function(t,n,i,r,o,l){return i||(i=r),f+=e.slice(d,l).replace(tt,ri),n&&(s=!0,f+="' +\n__e("+n+") +\n'"),o&&(a=!0,f+="';\n"+o+";\n__p += '"),i&&(f+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),d=l+t.length,t})),f+="';\n";var v=ht.call(t,"variable")&&t.variable;if(v){if(He.test(v))throw new r(c)}else f="with (obj) {\n"+f+"\n}\n";f=(a?f.replace(Ae,""):f).replace(Se,"$1").replace(Ee,"$1;"),f="function("+(v||"obj")+") {\n"+(v?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(s?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+f+"return __p\n}";var y=_d((function(){return Fe(u,g+"return "+f).apply(o,h)}));if(y.source=f,xc(y))throw y;return y}function dd(e){return Qc(e).toLowerCase()}function pd(e){return Qc(e).toUpperCase()}function fd(e,t,n){if(e=Qc(e),e&&(n||t===o))return Xn(e);if(!e||!(t=Io(t)))return e;var i=vi(e),r=vi(t),s=Qn(i,r),a=ei(i,r)+1;return Wo(i,s,a).join("")}function md(e,t,n){if(e=Qc(e),e&&(n||t===o))return e.slice(0,yi(e)+1);if(!e||!(t=Io(t)))return e;var i=vi(e),r=ei(i,vi(t))+1;return Wo(i,0,r).join("")}function gd(e,t,n){if(e=Qc(e),e&&(n||t===o))return e.replace(Ue,"");if(!e||!(t=Io(t)))return e;var i=vi(e),r=Qn(i,vi(t));return Wo(i,r).join("")}function vd(e,t){var n=P,i=R;if(Sc(t)){var r="separator"in t?t.separator:r;n="length"in t?Yc(t.length):n,i="omission"in t?Io(t.omission):i}e=Qc(e);var s=e.length;if(si(e)){var a=vi(e);s=a.length}if(n>=s)return e;var l=n-gi(i);if(l<1)return i;var u=a?Wo(a,0,l).join(""):e.slice(0,l);if(r===o)return u+i;if(a&&(l+=u.length-l),Nc(r)){if(e.slice(l).search(r)){var c,h=u;r.global||(r=it(r.source,Qc(qe.exec(r))+"g")),r.lastIndex=0;while(c=r.exec(h))var d=c.index;u=u.slice(0,d===o?l:d)}}else if(e.indexOf(Io(r),l)!=l){var p=u.lastIndexOf(r);p>-1&&(u=u.slice(0,p))}return u+i}function yd(e){return e=Qc(e),e&&Ce.test(e)?e.replace(Me,xi):e}var xd=fs((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()})),bd=ps("toUpperCase");function wd(e,t,n){return e=Qc(e),t=n?o:t,t===o?ai(e)?_i(e):Nn(e):e.match(t)||[]}var _d=wo((function(e,t){try{return bn(e,o,t)}catch(n){return xc(n)?n:new r(n)}})),Ad=Us((function(e,t){return _n(t,(function(t){t=La(t),fr(e,t,Ou(e[t],e))})),e}));function Sd(e){var t=null==e?0:e.length,n=Hs();return e=t?Cn(e,(function(e){if("function"!=typeof e[1])throw new ot(u);return[n(e[0]),e[1]]})):[],wo((function(n){var i=-1;while(++i<t){var r=e[i];if(bn(r[0],this,n))return bn(r[1],this,n)}}))}function Ed(e){return yr(vr(e,f))}function Md(e){return function(){return e}}function Td(e,t){return null==e||e!==e?t:e}var Cd=ys(),Pd=ys(!0);function Rd(e){return e}function Ld(e){return to("function"==typeof e?e:vr(e,f))}function Od(e){return so(vr(e,f))}function Dd(e,t){return ao(e,vr(t,f))}var Id=wo((function(e,t){return function(n){return $r(n,e,t)}})),Nd=wo((function(e,t){return function(n){return $r(e,n,t)}}));function kd(e,t,n){var i=_h(t),r=Dr(t,i);null!=n||Sc(t)&&(r.length||!i.length)||(n=t,t=e,e=this,r=Dr(t,_h(t)));var o=!(Sc(n)&&"chain"in n)||!!n.chain,s=wc(e);return _n(r,(function(n){var i=t[n];e[n]=i,s&&(e.prototype[n]=function(){var t=this.__chain__;if(o||t){var n=e(this.__wrapped__),r=n.__actions__=rs(this.__actions__);return r.push({func:i,args:arguments,thisArg:e}),n.__chain__=t,n}return i.apply(e,Pn([this.value()],arguments))})})),e}function Vd(){return ln._===this&&(ln._=gt),this}function Ud(){}function Fd(e){return e=Yc(e),wo((function(t){return co(t,e)}))}var zd=_s(Cn),jd=_s(Sn),Bd=_s(On);function $d(e){return la(e)?Bn(La(e)):mo(e)}function Hd(e){return function(t){return null==e?o:Ir(e,t)}}var Gd=Es(),Wd=Es(!0);function qd(){return[]}function Yd(){return!1}function Xd(){return{}}function Zd(){return""}function Jd(){return!0}function Kd(e,t){if(e=Yc(e),e<1||e>V)return[];var n=z,i=jt(e,z);t=Hs(t),e-=z;var r=qn(i,t);while(++n<e)t(n);return r}function Qd(e){return lc(e)?Cn(e,La):Fc(e)?[e]:rs(Ra(Qc(e)))}function ep(e){var t=++dt;return Qc(e)+t}var tp=ws((function(e,t){return e+t}),0),np=Cs("ceil"),ip=ws((function(e,t){return e/t}),1),rp=Cs("floor");function op(e){return e&&e.length?Er(e,Rd,Vr):o}function sp(e,t){return e&&e.length?Er(e,Hs(t,2),Vr):o}function ap(e){return jn(e,Rd)}function lp(e,t){return jn(e,Hs(t,2))}function up(e){return e&&e.length?Er(e,Rd,ro):o}function cp(e,t){return e&&e.length?Er(e,Hs(t,2),ro):o}var hp=ws((function(e,t){return e*t}),1),dp=Cs("round"),pp=ws((function(e,t){return e-t}),0);function fp(e){return e&&e.length?Wn(e,Rd):0}function mp(e,t){return e&&e.length?Wn(e,Hs(t,2)):0}return wi.after=Pu,wi.ary=Ru,wi.assign=eh,wi.assignIn=th,wi.assignInWith=nh,wi.assignWith=ih,wi.at=rh,wi.before=Lu,wi.bind=Ou,wi.bindAll=Ad,wi.bindKey=Du,wi.castArray=Ku,wi.chain=Gl,wi.chunk=Na,wi.compact=ka,wi.concat=Va,wi.cond=Sd,wi.conforms=Ed,wi.constant=Md,wi.countBy=nu,wi.create=oh,wi.curry=Iu,wi.curryRight=Nu,wi.debounce=ku,wi.defaults=sh,wi.defaultsDeep=ah,wi.defer=Vu,wi.delay=Uu,wi.difference=Ua,wi.differenceBy=Fa,wi.differenceWith=za,wi.drop=ja,wi.dropRight=Ba,wi.dropRightWhile=$a,wi.dropWhile=Ha,wi.fill=Ga,wi.filter=ru,wi.flatMap=au,wi.flatMapDeep=lu,wi.flatMapDepth=uu,wi.flatten=Ya,wi.flattenDeep=Xa,wi.flattenDepth=Za,wi.flip=Fu,wi.flow=Cd,wi.flowRight=Pd,wi.fromPairs=Ja,wi.functions=fh,wi.functionsIn=mh,wi.groupBy=du,wi.initial=el,wi.intersection=tl,wi.intersectionBy=nl,wi.intersectionWith=il,wi.invert=xh,wi.invertBy=bh,wi.invokeMap=fu,wi.iteratee=Ld,wi.keyBy=mu,wi.keys=_h,wi.keysIn=Ah,wi.map=gu,wi.mapKeys=Sh,wi.mapValues=Eh,wi.matches=Od,wi.matchesProperty=Dd,wi.memoize=zu,wi.merge=Mh,wi.mergeWith=Th,wi.method=Id,wi.methodOf=Nd,wi.mixin=kd,wi.negate=ju,wi.nthArg=Fd,wi.omit=Ch,wi.omitBy=Ph,wi.once=Bu,wi.orderBy=vu,wi.over=zd,wi.overArgs=$u,wi.overEvery=jd,wi.overSome=Bd,wi.partial=Hu,wi.partialRight=Gu,wi.partition=yu,wi.pick=Rh,wi.pickBy=Lh,wi.property=$d,wi.propertyOf=Hd,wi.pull=ll,wi.pullAll=ul,wi.pullAllBy=cl,wi.pullAllWith=hl,wi.pullAt=dl,wi.range=Gd,wi.rangeRight=Wd,wi.rearg=Wu,wi.reject=wu,wi.remove=pl,wi.rest=qu,wi.reverse=fl,wi.sampleSize=Au,wi.set=Dh,wi.setWith=Ih,wi.shuffle=Su,wi.slice=ml,wi.sortBy=Tu,wi.sortedUniq=_l,wi.sortedUniqBy=Al,wi.split=ld,wi.spread=Yu,wi.tail=Sl,wi.take=El,wi.takeRight=Ml,wi.takeRightWhile=Tl,wi.takeWhile=Cl,wi.tap=Wl,wi.throttle=Xu,wi.thru=ql,wi.toArray=Wc,wi.toPairs=Nh,wi.toPairsIn=kh,wi.toPath=Qd,wi.toPlainObject=Jc,wi.transform=Vh,wi.unary=Zu,wi.union=Pl,wi.unionBy=Rl,wi.unionWith=Ll,wi.uniq=Ol,wi.uniqBy=Dl,wi.uniqWith=Il,wi.unset=Uh,wi.unzip=Nl,wi.unzipWith=kl,wi.update=Fh,wi.updateWith=zh,wi.values=jh,wi.valuesIn=Bh,wi.without=Vl,wi.words=wd,wi.wrap=Ju,wi.xor=Ul,wi.xorBy=Fl,wi.xorWith=zl,wi.zip=jl,wi.zipObject=Bl,wi.zipObjectDeep=$l,wi.zipWith=Hl,wi.entries=Nh,wi.entriesIn=kh,wi.extend=th,wi.extendWith=nh,kd(wi,wi),wi.add=tp,wi.attempt=_d,wi.camelCase=Wh,wi.capitalize=qh,wi.ceil=np,wi.clamp=$h,wi.clone=Qu,wi.cloneDeep=tc,wi.cloneDeepWith=nc,wi.cloneWith=ec,wi.conformsTo=ic,wi.deburr=Yh,wi.defaultTo=Td,wi.divide=ip,wi.endsWith=Xh,wi.eq=rc,wi.escape=Zh,wi.escapeRegExp=Jh,wi.every=iu,wi.find=ou,wi.findIndex=Wa,wi.findKey=lh,wi.findLast=su,wi.findLastIndex=qa,wi.findLastKey=uh,wi.floor=rp,wi.forEach=cu,wi.forEachRight=hu,wi.forIn=ch,wi.forInRight=hh,wi.forOwn=dh,wi.forOwnRight=ph,wi.get=gh,wi.gt=oc,wi.gte=sc,wi.has=vh,wi.hasIn=yh,wi.head=Ka,wi.identity=Rd,wi.includes=pu,wi.indexOf=Qa,wi.inRange=Hh,wi.invoke=wh,wi.isArguments=ac,wi.isArray=lc,wi.isArrayBuffer=uc,wi.isArrayLike=cc,wi.isArrayLikeObject=hc,wi.isBoolean=dc,wi.isBuffer=pc,wi.isDate=fc,wi.isElement=mc,wi.isEmpty=gc,wi.isEqual=vc,wi.isEqualWith=yc,wi.isError=xc,wi.isFinite=bc,wi.isFunction=wc,wi.isInteger=_c,wi.isLength=Ac,wi.isMap=Mc,wi.isMatch=Tc,wi.isMatchWith=Cc,wi.isNaN=Pc,wi.isNative=Rc,wi.isNil=Oc,wi.isNull=Lc,wi.isNumber=Dc,wi.isObject=Sc,wi.isObjectLike=Ec,wi.isPlainObject=Ic,wi.isRegExp=Nc,wi.isSafeInteger=kc,wi.isSet=Vc,wi.isString=Uc,wi.isSymbol=Fc,wi.isTypedArray=zc,wi.isUndefined=jc,wi.isWeakMap=Bc,wi.isWeakSet=$c,wi.join=rl,wi.kebabCase=Kh,wi.last=ol,wi.lastIndexOf=sl,wi.lowerCase=Qh,wi.lowerFirst=ed,wi.lt=Hc,wi.lte=Gc,wi.max=op,wi.maxBy=sp,wi.mean=ap,wi.meanBy=lp,wi.min=up,wi.minBy=cp,wi.stubArray=qd,wi.stubFalse=Yd,wi.stubObject=Xd,wi.stubString=Zd,wi.stubTrue=Jd,wi.multiply=hp,wi.nth=al,wi.noConflict=Vd,wi.noop=Ud,wi.now=Cu,wi.pad=td,wi.padEnd=nd,wi.padStart=id,wi.parseInt=rd,wi.random=Gh,wi.reduce=xu,wi.reduceRight=bu,wi.repeat=od,wi.replace=sd,wi.result=Oh,wi.round=dp,wi.runInContext=e,wi.sample=_u,wi.size=Eu,wi.snakeCase=ad,wi.some=Mu,wi.sortedIndex=gl,wi.sortedIndexBy=vl,wi.sortedIndexOf=yl,wi.sortedLastIndex=xl,wi.sortedLastIndexBy=bl,wi.sortedLastIndexOf=wl,wi.startCase=ud,wi.startsWith=cd,wi.subtract=pp,wi.sum=fp,wi.sumBy=mp,wi.template=hd,wi.times=Kd,wi.toFinite=qc,wi.toInteger=Yc,wi.toLength=Xc,wi.toLower=dd,wi.toNumber=Zc,wi.toSafeInteger=Kc,wi.toString=Qc,wi.toUpper=pd,wi.trim=fd,wi.trimEnd=md,wi.trimStart=gd,wi.truncate=vd,wi.unescape=yd,wi.uniqueId=ep,wi.upperCase=xd,wi.upperFirst=bd,wi.each=cu,wi.eachRight=hu,wi.first=Ka,kd(wi,function(){var e={};return Lr(wi,(function(t,n){ht.call(wi.prototype,n)||(e[n]=t)})),e}(),{chain:!1}),wi.VERSION=s,_n(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){wi[e].placeholder=wi})),_n(["drop","take"],(function(e,t){Ti.prototype[e]=function(n){n=n===o?1:zt(Yc(n),0);var i=this.__filtered__&&!t?new Ti(this):this.clone();return i.__filtered__?i.__takeCount__=jt(n,i.__takeCount__):i.__views__.push({size:jt(n,z),type:e+(i.__dir__<0?"Right":"")}),i},Ti.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),_n(["filter","map","takeWhile"],(function(e,t){var n=t+1,i=n==D||n==N;Ti.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:Hs(e,3),type:n}),t.__filtered__=t.__filtered__||i,t}})),_n(["head","last"],(function(e,t){var n="take"+(t?"Right":"");Ti.prototype[e]=function(){return this[n](1).value()[0]}})),_n(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");Ti.prototype[e]=function(){return this.__filtered__?new Ti(this):this[n](1)}})),Ti.prototype.compact=function(){return this.filter(Rd)},Ti.prototype.find=function(e){return this.filter(e).head()},Ti.prototype.findLast=function(e){return this.reverse().find(e)},Ti.prototype.invokeMap=wo((function(e,t){return"function"==typeof e?new Ti(this):this.map((function(n){return $r(n,e,t)}))})),Ti.prototype.reject=function(e){return this.filter(ju(Hs(e)))},Ti.prototype.slice=function(e,t){e=Yc(e);var n=this;return n.__filtered__&&(e>0||t<0)?new Ti(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==o&&(t=Yc(t),n=t<0?n.dropRight(-t):n.take(t-e)),n)},Ti.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Ti.prototype.toArray=function(){return this.take(z)},Lr(Ti.prototype,(function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),i=/^(?:head|last)$/.test(t),r=wi[i?"take"+("last"==t?"Right":""):t],s=i||/^find/.test(t);r&&(wi.prototype[t]=function(){var t=this.__wrapped__,a=i?[1]:arguments,l=t instanceof Ti,u=a[0],c=l||lc(t),h=function(e){var t=r.apply(wi,Pn([e],a));return i&&d?t[0]:t};c&&n&&"function"==typeof u&&1!=u.length&&(l=c=!1);var d=this.__chain__,p=!!this.__actions__.length,f=s&&!d,m=l&&!p;if(!s&&c){t=m?t:new Ti(this);var g=e.apply(t,a);return g.__actions__.push({func:ql,args:[h],thisArg:o}),new Mi(g,d)}return f&&m?e.apply(this,a):(g=this.thru(h),f?i?g.value()[0]:g.value():g)})})),_n(["pop","push","shift","sort","splice","unshift"],(function(e){var t=st[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",i=/^(?:pop|shift)$/.test(e);wi.prototype[e]=function(){var e=arguments;if(i&&!this.__chain__){var r=this.value();return t.apply(lc(r)?r:[],e)}return this[n]((function(n){return t.apply(lc(n)?n:[],e)}))}})),Lr(Ti.prototype,(function(e,t){var n=wi[t];if(n){var i=n.name+"";ht.call(un,i)||(un[i]=[]),un[i].push({name:t,func:n})}})),un[xs(o,b).name]=[{name:"wrapper",func:o}],Ti.prototype.clone=Ci,Ti.prototype.reverse=Pi,Ti.prototype.value=Ri,wi.prototype.at=Yl,wi.prototype.chain=Xl,wi.prototype.commit=Zl,wi.prototype.next=Jl,wi.prototype.plant=Ql,wi.prototype.reverse=eu,wi.prototype.toJSON=wi.prototype.valueOf=wi.prototype.value=tu,wi.prototype.first=wi.prototype.head,Tt&&(wi.prototype[Tt]=Kl),wi},Si=Ai();ln._=Si,r=function(){return Si}.call(t,n,t,i),r===o||(i.exports=r)}).call(this)}).call(this,n("c8ba"),n("62e4")(e))},3107:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("04d0"),r=n("079c"),o=n("3712"),s=n("9ecd"),a=n("a797"),l=n("0c1a"),u=n("5b70"),c=n("2e32"),h=n("ef68"),d=n("ec32"),p=n("c618"),f=n("4017"),m=n("35cd"),g=n("bc94"),v=n("a2b8"),y=n("3e48");function x(e=!1){const t=[p.default,f.default,m.default,g.default,v.default,y.default,u.default,c.default,l.default,h.default,d.default];return e?t.push(r.default,s.default):t.push(i.default,o.default),t.push(a.default),t}t.default=x},3280:function(e,t,n){"use strict";var i=n("ebb5"),r=n("e58c"),o=i.aTypedArray,s=i.exportTypedArrayMethod;s("lastIndexOf",(function(e){return r.apply(o(this),arguments)}))},"337b":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("96ab"),r={message({keyword:e,schemaCode:t}){const n="maxProperties"===e?"more":"fewer";return i.str`must NOT have ${n} than ${t} items`},params:({schemaCode:e})=>i._`{limit: ${e}}`},o={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:r,code(e){const{keyword:t,data:n,schemaCode:r}=e,o="maxProperties"===t?i.operators.GT:i.operators.LT;e.fail$data(i._`Object.keys(${n}).length ${o} ${r}`)}};t.default=o},"35cd":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("96ab"),r=n("417a"),o={message:"must match exactly one schema in oneOf",params:({params:e})=>i._`{passingSchemas: ${e.passing}}`},s={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:o,code(e){const{gen:t,schema:n,parentSchema:o,it:s}=e;if(!Array.isArray(n))throw new Error("ajv implementation error");if(s.opts.discriminator&&o.discriminator)return;const a=n,l=t.let("valid",!1),u=t.let("passing",null),c=t.name("_valid");function h(){a.forEach((n,o)=>{let a;r.alwaysValidSchema(s,n)?t.var(c,!0):a=e.subschema({keyword:"oneOf",schemaProp:o,compositeRule:!0},c),o>0&&t.if(i._`${c} && ${l}`).assign(l,!1).assign(u,i._`[${u}, ${o}]`).else(),t.if(c,()=>{t.assign(l,!0),t.assign(u,o),a&&e.mergeEvaluated(a,i.Name)})})}e.setParams({passing:u}),t.block(h),e.result(l,()=>e.reset(),()=>e.error(!0))}};t.default=s},"35e8":function(e,t,n){"use strict";e.exports={isString:function(e){return"string"===typeof e},isObject:function(e){return"object"===typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},"364e":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("4c26"),r=n("96ab"),o={message:({schemaCode:e})=>r.str`must match pattern "${e}"`,params:({schemaCode:e})=>r._`{pattern: ${e}}`},s={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:o,code(e){const{data:t,$data:n,schema:o,schemaCode:s,it:a}=e,l=a.opts.unicodeRegExp?"u":"",u=n?r._`(new RegExp(${s}, ${l}))`:i.usePattern(e,o);e.fail$data(r._`!${u}.test(${t})`)}};t.default=s},3712:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateTuple=void 0;const i=n("96ab"),r=n("417a"),o=n("4c26"),s={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(e){const{schema:t,it:n}=e;if(Array.isArray(t))return a(e,"additionalItems",t);n.items=!0,r.alwaysValidSchema(n,t)||e.ok(o.validateArray(e))}};function a(e,t,n=e.schema){const{gen:o,parentSchema:s,data:a,keyword:l,it:u}=e;d(s),u.opts.unevaluated&&n.length&&!0!==u.items&&(u.items=r.mergeEvaluated.items(o,n.length,u.items));const c=o.name("valid"),h=o.const("len",i._`${a}.length`);function d(e){const{opts:i,errSchemaPath:o}=u,s=n.length,a=s===e.minItems&&(s===e.maxItems||!1===e[t]);if(i.strictTuples&&!a){const e=`"${l}" is ${s}-tuple, but minItems or maxItems/${t} are not specified or different at path "${o}"`;r.checkStrictMode(u,e,i.strictTuples)}}n.forEach((t,n)=>{r.alwaysValidSchema(u,t)||(o.if(i._`${h} > ${n}`,()=>e.subschema({keyword:l,schemaProp:n,dataProp:n},c)),e.ok(c))})}t.validateTuple=a,t.default=s},"38cf":function(e,t,n){var i=n("23e7"),r=n("1148");i({target:"String",proto:!0},{repeat:r})},"38d7":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.extendErrors=t.resetErrorsCount=t.reportExtraError=t.reportError=t.keyword$DataError=t.keywordError=void 0;const i=n("96ab"),r=n("417a"),o=n("a3a3");function s(e,n=t.keywordError,r,o){const{it:s}=e,{gen:a,compositeRule:l,allErrors:u}=s,d=p(e,n,r);(null!==o&&void 0!==o?o:l||u)?c(a,d):h(s,i._`[${d}]`)}function a(e,n=t.keywordError,i){const{it:r}=e,{gen:s,compositeRule:a,allErrors:l}=r,u=p(e,n,i);c(s,u),a||l||h(r,o.default.vErrors)}function l(e,t){e.assign(o.default.errors,t),e.if(i._`${o.default.vErrors} !== null`,()=>e.if(t,()=>e.assign(i._`${o.default.vErrors}.length`,t),()=>e.assign(o.default.vErrors,null)))}function u({gen:e,keyword:t,schemaValue:n,data:r,errsCount:s,it:a}){if(void 0===s)throw new Error("ajv implementation error");const l=e.name("err");e.forRange("i",s,o.default.errors,s=>{e.const(l,i._`${o.default.vErrors}[${s}]`),e.if(i._`${l}.instancePath === undefined`,()=>e.assign(i._`${l}.instancePath`,i.strConcat(o.default.instancePath,a.errorPath))),e.assign(i._`${l}.schemaPath`,i.str`${a.errSchemaPath}/${t}`),a.opts.verbose&&(e.assign(i._`${l}.schema`,n),e.assign(i._`${l}.data`,r))})}function c(e,t){const n=e.const("err",t);e.if(i._`${o.default.vErrors} === null`,()=>e.assign(o.default.vErrors,i._`[${n}]`),i._`${o.default.vErrors}.push(${n})`),e.code(i._`${o.default.errors}++`)}function h(e,t){const{gen:n,validateName:r,schemaEnv:o}=e;o.$async?n.throw(i._`new ${e.ValidationError}(${t})`):(n.assign(i._`${r}.errors`,t),n.return(!1))}t.keywordError={message:({keyword:e})=>i.str`must pass "${e}" keyword validation`},t.keyword$DataError={message:({keyword:e,schemaType:t})=>t?i.str`"${e}" keyword must be ${t} ($data)`:i.str`"${e}" keyword is invalid ($data)`},t.reportError=s,t.reportExtraError=a,t.resetErrorsCount=l,t.extendErrors=u;const d={keyword:new i.Name("keyword"),schemaPath:new i.Name("schemaPath"),params:new i.Name("params"),propertyName:new i.Name("propertyName"),message:new i.Name("message"),schema:new i.Name("schema"),parentSchema:new i.Name("parentSchema")};function p(e,t,n){const{createErrors:r}=e.it;return!1===r?i._`{}`:f(e,t,n)}function f(e,t,n={}){const{gen:i,it:r}=e,o=[m(r,n),g(e,n)];return v(e,t,o),i.object(...o)}function m({errorPath:e},{instancePath:t}){const n=t?i.str`${e}${r.getErrorPath(t,r.Type.Str)}`:e;return[o.default.instancePath,i.strConcat(o.default.instancePath,n)]}function g({keyword:e,it:{errSchemaPath:t}},{schemaPath:n,parentSchema:o}){let s=o?t:i.str`${t}/${e}`;return n&&(s=i.str`${s}${r.getErrorPath(n,r.Type.Str)}`),[d.schemaPath,s]}function v(e,{params:t,message:n},r){const{keyword:s,data:a,schemaValue:l,it:u}=e,{opts:c,propertyName:h,topSchemaRef:p,schemaPath:f}=u;r.push([d.keyword,s],[d.params,"function"==typeof t?t(e):t||i._`{}`]),c.messages&&r.push([d.message,"function"==typeof n?n(e):n]),c.verbose&&r.push([d.schema,l],[d.parentSchema,i._`${p}${f}`],[o.default.data,a]),h&&r.push([d.propertyName,h])}},"3a7b":function(e,t,n){"use strict";var i=n("ebb5"),r=n("b727").findIndex,o=i.aTypedArray,s=i.exportTypedArrayMethod;s("findIndex",(function(e){return r(o(this),e,arguments.length>1?arguments[1]:void 0)}))},"3c35":function(e,t){(function(t){e.exports=t}).call(this,{})},"3c5d":function(e,t,n){"use strict";var i=n("ebb5"),r=n("50c4"),o=n("182d"),s=n("7b0b"),a=n("d039"),l=i.aTypedArray,u=i.exportTypedArrayMethod,c=a((function(){new Int8Array(1).set({})}));u("set",(function(e){l(this);var t=o(arguments.length>1?arguments[1]:void 0,1),n=this.length,i=s(e),a=r(i.length),u=0;if(a+t>n)throw RangeError("Wrong length");while(u<a)this[t+u]=i[u++]}),c)},"3e48":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("417a"),r={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:e,parentSchema:t,it:n}){void 0===t.if&&i.checkStrictMode(n,`"${e}" without "if" is ignored`)}};t.default=r},"3fcc":function(e,t,n){"use strict";var i=n("ebb5"),r=n("b727").map,o=n("b6b7"),s=i.aTypedArray,a=i.exportTypedArrayMethod;a("map",(function(e){return r(s(this),e,arguments.length>1?arguments[1]:void 0,(function(e,t){return new(o(e))(t)}))}))},4017:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("4c26"),r={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:i.validateUnion,error:{message:"must match a schema in anyOf"}};t.default=r},"417a":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkStrictMode=t.getErrorPath=t.Type=t.useFunc=t.setEvaluated=t.evaluatedPropsToName=t.mergeEvaluated=t.eachItem=t.unescapeJsonPointer=t.escapeJsonPointer=t.escapeFragment=t.unescapeFragment=t.schemaRefOrVal=t.schemaHasRulesButRef=t.schemaHasRules=t.checkUnknownRules=t.alwaysValidSchema=t.toHash=void 0;const i=n("96ab"),r=n("ab2c");function o(e){const t={};for(const n of e)t[n]=!0;return t}function s(e,t){return"boolean"==typeof t?t:0===Object.keys(t).length||(a(e,t),!l(t,e.self.RULES.all))}function a(e,t=e.schema){const{opts:n,self:i}=e;if(!n.strictSchema)return;if("boolean"===typeof t)return;const r=i.RULES.keywords;for(const o in t)r[o]||A(e,`unknown keyword: "${o}"`)}function l(e,t){if("boolean"==typeof e)return!e;for(const n in e)if(t[n])return!0;return!1}function u(e,t){if("boolean"==typeof e)return!e;for(const n in e)if("$ref"!==n&&t.all[n])return!0;return!1}function c({topSchemaRef:e,schemaPath:t},n,r,o){if(!o){if("number"==typeof n||"boolean"==typeof n)return n;if("string"==typeof n)return i._`${n}`}return i._`${e}${t}${i.getProperty(r)}`}function h(e){return f(decodeURIComponent(e))}function d(e){return encodeURIComponent(p(e))}function p(e){return"number"==typeof e?""+e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function f(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function m(e,t){if(Array.isArray(e))for(const n of e)t(n);else t(e)}function g({mergeNames:e,mergeToName:t,mergeValues:n,resultToName:r}){return(o,s,a,l)=>{const u=void 0===a?s:a instanceof i.Name?(s instanceof i.Name?e(o,s,a):t(o,s,a),a):s instanceof i.Name?(t(o,a,s),s):n(s,a);return l!==i.Name||u instanceof i.Name?u:r(o,u)}}function v(e,t){if(!0===t)return e.var("props",!0);const n=e.var("props",i._`{}`);return void 0!==t&&y(e,n,t),n}function y(e,t,n){Object.keys(n).forEach(n=>e.assign(i._`${t}${i.getProperty(n)}`,!0))}t.toHash=o,t.alwaysValidSchema=s,t.checkUnknownRules=a,t.schemaHasRules=l,t.schemaHasRulesButRef=u,t.schemaRefOrVal=c,t.unescapeFragment=h,t.escapeFragment=d,t.escapeJsonPointer=p,t.unescapeJsonPointer=f,t.eachItem=m,t.mergeEvaluated={props:g({mergeNames:(e,t,n)=>e.if(i._`${n} !== true && ${t} !== undefined`,()=>{e.if(i._`${t} === true`,()=>e.assign(n,!0),()=>e.assign(n,i._`${n} || {}`).code(i._`Object.assign(${n}, ${t})`))}),mergeToName:(e,t,n)=>e.if(i._`${n} !== true`,()=>{!0===t?e.assign(n,!0):(e.assign(n,i._`${n} || {}`),y(e,n,t))}),mergeValues:(e,t)=>!0===e||{...e,...t},resultToName:v}),items:g({mergeNames:(e,t,n)=>e.if(i._`${n} !== true && ${t} !== undefined`,()=>e.assign(n,i._`${t} === true ? true : ${n} > ${t} ? ${n} : ${t}`)),mergeToName:(e,t,n)=>e.if(i._`${n} !== true`,()=>e.assign(n,!0===t||i._`${n} > ${t} ? ${n} : ${t}`)),mergeValues:(e,t)=>!0===e||Math.max(e,t),resultToName:(e,t)=>e.var("items",t)})},t.evaluatedPropsToName=v,t.setEvaluated=y;const x={};function b(e,t){return e.scopeValue("func",{ref:t,code:x[t.code]||(x[t.code]=new r._Code(t.code))})}var w;function _(e,t,n){if(e instanceof i.Name){const r=t===w.Num;return n?r?i._`"[" + ${e} + "]"`:i._`"['" + ${e} + "']"`:r?i._`"/" + ${e}`:i._`"/" + ${e}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return n?i.getProperty(e).toString():"/"+p(e)}function A(e,t,n=e.opts.strictSchema){if(n){if(t="strict mode: "+t,!0===n)throw new Error(t);e.self.logger.warn(t)}}t.useFunc=b,function(e){e[e["Num"]=0]="Num",e[e["Str"]=1]="Str"}(w=t.Type||(t.Type={})),t.getErrorPath=_,t.checkStrictMode=A},"466d":function(e,t,n){"use strict";var i=n("d784"),r=n("825a"),o=n("50c4"),s=n("577e"),a=n("1d80"),l=n("8aa5"),u=n("14c3");i("match",(function(e,t,n){return[function(t){var n=a(this),i=void 0==t?void 0:t[e];return void 0!==i?i.call(t,n):new RegExp(t)[e](s(n))},function(e){var i=r(this),a=s(e),c=n(t,i,a);if(c.done)return c.value;if(!i.global)return u(i,a);var h=i.unicode;i.lastIndex=0;var d,p=[],f=0;while(null!==(d=u(i,a))){var m=s(d[0]);p[f]=m,""===m&&(i.lastIndex=l(a,o(i.lastIndex),h)),f++}return 0===f?null:p}]}))},"47bb":function(e,t,n){
/*!
  * domready (c) Dustin Diaz 2014 - License MIT
  */
!function(t,n){e.exports=n()}(0,(function(){var e,t=[],n=document,i=n.documentElement.doScroll,r="DOMContentLoaded",o=(i?/^loaded|^c/:/^loaded|^i|^c/).test(n.readyState);return o||n.addEventListener(r,e=function(){n.removeEventListener(r,e),o=1;while(e=t.shift())e()}),function(e){o?setTimeout(e,0):t.push(e)}}))},4939:function(e,t,n){},"4a69":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveSchema=t.getCompilingSchema=t.resolveRef=t.compileSchema=t.SchemaEnv=void 0;const i=n("96ab"),r=n("6267"),o=n("a3a3"),s=n("a98d"),a=n("417a"),l=n("2b0b"),u=n("4e14");class c{constructor(e){var t;let n;this.refs={},this.dynamicAnchors={},"object"==typeof e.schema&&(n=e.schema),this.schema=e.schema,this.schemaId=e.schemaId,this.root=e.root||this,this.baseId=null!==(t=e.baseId)&&void 0!==t?t:s.normalizeId(null===n||void 0===n?void 0:n[e.schemaId||"$id"]),this.schemaPath=e.schemaPath,this.localRefs=e.localRefs,this.meta=e.meta,this.$async=null===n||void 0===n?void 0:n.$async,this.refs={}}}function h(e){const t=f.call(this,e);if(t)return t;const n=s.getFullPath(e.root.baseId),{es5:a,lines:u}=this.opts.code,{ownProperties:c}=this.opts,h=new i.CodeGen(this.scope,{es5:a,lines:u,ownProperties:c});let d;e.$async&&(d=h.scopeValue("Error",{ref:r.default,code:i._`require("ajv/dist/runtime/validation_error").default`}));const p=h.scopeName("validate");e.validateName=p;const m={gen:h,allErrors:this.opts.allErrors,data:o.default.data,parentData:o.default.parentData,parentDataProperty:o.default.parentDataProperty,dataNames:[o.default.data],dataPathArr:[i.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:h.scopeValue("schema",!0===this.opts.code.source?{ref:e.schema,code:i.stringify(e.schema)}:{ref:e.schema}),validateName:p,ValidationError:d,schema:e.schema,schemaEnv:e,rootId:n,baseId:e.baseId||n,schemaPath:i.nil,errSchemaPath:e.schemaPath||(this.opts.jtd?"":"#"),errorPath:i._`""`,opts:this.opts,self:this};let g;try{this._compilations.add(e),l.validateFunctionCode(m),h.optimize(this.opts.code.optimize);const t=h.toString();g=`${h.scopeRefs(o.default.scope)}return ${t}`,this.opts.code.process&&(g=this.opts.code.process(g,e));const n=new Function(""+o.default.self,""+o.default.scope,g),r=n(this,this.scope.get());if(this.scope.value(p,{ref:r}),r.errors=null,r.schema=e.schema,r.schemaEnv=e,e.$async&&(r.$async=!0),!0===this.opts.code.source&&(r.source={validateName:p,validateCode:t,scopeValues:h._values}),this.opts.unevaluated){const{props:e,items:t}=m;r.evaluated={props:e instanceof i.Name?void 0:e,items:t instanceof i.Name?void 0:t,dynamicProps:e instanceof i.Name,dynamicItems:t instanceof i.Name},r.source&&(r.source.evaluated=i.stringify(r.evaluated))}return e.validate=r,e}catch(v){throw delete e.validate,delete e.validateName,g&&this.logger.error("Error compiling schema, function code:",g),v}finally{this._compilations.delete(e)}}function d(e,t,n){var i;n=s.resolveUrl(t,n);const r=e.refs[n];if(r)return r;let o=g.call(this,e,n);if(void 0===o){const r=null===(i=e.localRefs)||void 0===i?void 0:i[n],{schemaId:s}=this.opts;r&&(o=new c({schema:r,schemaId:s,root:e,baseId:t}))}return void 0!==o?e.refs[n]=p.call(this,o):void 0}function p(e){return s.inlineRef(e.schema,this.opts.inlineRefs)?e.schema:e.validate?e:h.call(this,e)}function f(e){for(const t of this._compilations)if(m(t,e))return t}function m(e,t){return e.schema===t.schema&&e.root===t.root&&e.baseId===t.baseId}function g(e,t){let n;while("string"==typeof(n=this.refs[t]))t=n;return n||this.schemas[t]||v.call(this,e,t)}function v(e,t){const n=u.parse(t),i=s._getFullPath(n);let r=s.getFullPath(e.baseId);if(Object.keys(e.schema).length>0&&i===r)return x.call(this,n,e);const o=s.normalizeId(i),a=this.refs[o]||this.schemas[o];if("string"==typeof a){const t=v.call(this,e,a);if("object"!==typeof(null===t||void 0===t?void 0:t.schema))return;return x.call(this,n,t)}if("object"===typeof(null===a||void 0===a?void 0:a.schema)){if(a.validate||h.call(this,a),o===s.normalizeId(t)){const{schema:t}=a,{schemaId:n}=this.opts,i=t[n];return i&&(r=s.resolveUrl(r,i)),new c({schema:t,schemaId:n,root:e,baseId:r})}return x.call(this,n,a)}}t.SchemaEnv=c,t.compileSchema=h,t.resolveRef=d,t.getCompilingSchema=f,t.resolveSchema=v;const y=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function x(e,{baseId:t,schema:n,root:i}){var r;if("/"!==(null===(r=e.fragment)||void 0===r?void 0:r[0]))return;for(const u of e.fragment.slice(1).split("/")){if("boolean"==typeof n)return;if(n=n[a.unescapeFragment(u)],void 0===n)return;const e="object"==typeof n&&n[this.opts.schemaId];!y.has(u)&&e&&(t=s.resolveUrl(t,e))}let o;if("boolean"!=typeof n&&n.$ref&&!a.schemaHasRulesButRef(n,this.RULES)){const e=s.resolveUrl(t,n.$ref);o=v.call(this,i,e)}const{schemaId:l}=this.opts;return o=o||new c({schema:n,schemaId:l,root:i,baseId:t}),o.schema!==o.root.schema?o:void 0}},"4c26":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateUnion=t.validateArray=t.usePattern=t.callValidateCode=t.schemaProperties=t.allSchemaProperties=t.noPropertyInData=t.propertyInData=t.isOwnProperty=t.hasPropFunc=t.reportMissingProp=t.checkMissingProp=t.checkReportMissingProp=void 0;const i=n("96ab"),r=n("417a"),o=n("a3a3");function s(e,t){const{gen:n,data:r,it:o}=e;n.if(d(n,r,t,o.opts.ownProperties),()=>{e.setParams({missingProperty:i._`${t}`},!0),e.error()})}function a({gen:e,data:t,it:{opts:n}},r,o){return i.or(...r.map(r=>i.and(d(e,t,r,n.ownProperties),i._`${o} = ${r}`)))}function l(e,t){e.setParams({missingProperty:t},!0),e.error()}function u(e){return e.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:i._`Object.prototype.hasOwnProperty`})}function c(e,t,n){return i._`${u(e)}.call(${t}, ${n})`}function h(e,t,n,r){const o=i._`${t}${i.getProperty(n)} !== undefined`;return r?i._`${o} && ${c(e,t,n)}`:o}function d(e,t,n,r){const o=i._`${t}${i.getProperty(n)} === undefined`;return r?i.or(o,i.not(c(e,t,n))):o}function p(e){return e?Object.keys(e).filter(e=>"__proto__"!==e):[]}function f(e,t){return p(t).filter(n=>!r.alwaysValidSchema(e,t[n]))}function m({schemaCode:e,data:t,it:{gen:n,topSchemaRef:r,schemaPath:s,errorPath:a},it:l},u,c,h){const d=h?i._`${e}, ${t}, ${r}${s}`:t,p=[[o.default.instancePath,i.strConcat(o.default.instancePath,a)],[o.default.parentData,l.parentData],[o.default.parentDataProperty,l.parentDataProperty],[o.default.rootData,o.default.rootData]];l.opts.dynamicRef&&p.push([o.default.dynamicAnchors,o.default.dynamicAnchors]);const f=i._`${d}, ${n.object(...p)}`;return c!==i.nil?i._`${u}.call(${c}, ${f})`:i._`${u}(${f})`}function g({gen:e,it:{opts:t}},n){const r=t.unicodeRegExp?"u":"";return e.scopeValue("pattern",{key:n,ref:new RegExp(n,r),code:i._`new RegExp(${n}, ${r})`})}function v(e){const{gen:t,data:n,keyword:o,it:s}=e,a=t.name("valid");if(s.allErrors){const e=t.let("valid",!0);return l(()=>t.assign(e,!1)),e}return t.var(a,!0),l(()=>t.break()),a;function l(s){const l=t.const("len",i._`${n}.length`);t.forRange("i",0,l,n=>{e.subschema({keyword:o,dataProp:n,dataPropType:r.Type.Num},a),t.if(i.not(a),s)})}}function y(e){const{gen:t,schema:n,keyword:o,it:s}=e;if(!Array.isArray(n))throw new Error("ajv implementation error");const a=n.some(e=>r.alwaysValidSchema(s,e));if(a&&!s.opts.unevaluated)return;const l=t.let("valid",!1),u=t.name("_valid");t.block(()=>n.forEach((n,r)=>{const s=e.subschema({keyword:o,schemaProp:r,compositeRule:!0},u);t.assign(l,i._`${l} || ${u}`);const a=e.mergeValidEvaluated(s,u);a||t.if(i.not(l))})),e.result(l,()=>e.reset(),()=>e.error(!0))}t.checkReportMissingProp=s,t.checkMissingProp=a,t.reportMissingProp=l,t.hasPropFunc=u,t.isOwnProperty=c,t.propertyInData=h,t.noPropertyInData=d,t.allSchemaProperties=p,t.schemaProperties=f,t.callValidateCode=m,t.usePattern=g,t.validateArray=v,t.validateUnion=y},"4d63":function(e,t,n){var i=n("83ab"),r=n("da84"),o=n("94ca"),s=n("7156"),a=n("9112"),l=n("9bf2").f,u=n("241c").f,c=n("44e7"),h=n("577e"),d=n("ad6d"),p=n("9f7f"),f=n("6eeb"),m=n("d039"),g=n("5135"),v=n("69f3").enforce,y=n("2626"),x=n("b622"),b=n("fce3"),w=n("107c"),_=x("match"),A=r.RegExp,S=A.prototype,E=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,M=/a/g,T=/a/g,C=new A(M)!==M,P=p.UNSUPPORTED_Y,R=i&&(!C||P||b||w||m((function(){return T[_]=!1,A(M)!=M||A(T)==T||"/a/i"!=A(M,"i")}))),L=function(e){for(var t,n=e.length,i=0,r="",o=!1;i<=n;i++)t=e.charAt(i),"\\"!==t?o||"."!==t?("["===t?o=!0:"]"===t&&(o=!1),r+=t):r+="[\\s\\S]":r+=t+e.charAt(++i);return r},O=function(e){for(var t,n=e.length,i=0,r="",o=[],s={},a=!1,l=!1,u=0,c="";i<=n;i++){if(t=e.charAt(i),"\\"===t)t+=e.charAt(++i);else if("]"===t)a=!1;else if(!a)switch(!0){case"["===t:a=!0;break;case"("===t:E.test(e.slice(i+1))&&(i+=2,l=!0),r+=t,u++;continue;case">"===t&&l:if(""===c||g(s,c))throw new SyntaxError("Invalid capture group name");s[c]=!0,o.push([c,u]),l=!1,c="";continue}l?c+=t:r+=t}return[r,o]};if(o("RegExp",R)){for(var D=function(e,t){var n,i,r,o,l,u,p=this instanceof D,f=c(e),m=void 0===t,g=[],y=e;if(!p&&f&&m&&e.constructor===D)return e;if((f||e instanceof D)&&(e=e.source,m&&(t="flags"in y?y.flags:d.call(y))),e=void 0===e?"":h(e),t=void 0===t?"":h(t),y=e,b&&"dotAll"in M&&(i=!!t&&t.indexOf("s")>-1,i&&(t=t.replace(/s/g,""))),n=t,P&&"sticky"in M&&(r=!!t&&t.indexOf("y")>-1,r&&(t=t.replace(/y/g,""))),w&&(o=O(e),e=o[0],g=o[1]),l=s(A(e,t),p?this:S,D),(i||r||g.length)&&(u=v(l),i&&(u.dotAll=!0,u.raw=D(L(e),n)),r&&(u.sticky=!0),g.length&&(u.groups=g)),e!==y)try{a(l,"source",""===y?"(?:)":y)}catch(x){}return l},I=function(e){e in D||l(D,e,{configurable:!0,get:function(){return A[e]},set:function(t){A[e]=t}})},N=u(A),k=0;N.length>k;)I(N[k++]);S.constructor=D,D.prototype=S,f(r,"RegExp",D)}y("RegExp")},"4de4":function(e,t,n){"use strict";var i=n("23e7"),r=n("b727").filter,o=n("1dde"),s=o("filter");i({target:"Array",proto:!0,forced:!s},{filter:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})},"4e14":function(e,t,n){
/** @license URI.js v4.4.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js */
(function(e,n){n(t)})(0,(function(e){"use strict";function t(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(t.length>1){t[0]=t[0].slice(0,-1);for(var i=t.length-1,r=1;r<i;++r)t[r]=t[r].slice(1,-1);return t[i]=t[i].slice(1),t.join("")}return t[0]}function n(e){return"(?:"+e+")"}function i(e){return void 0===e?"undefined":null===e?"null":Object.prototype.toString.call(e).split(" ").pop().split("]").shift().toLowerCase()}function r(e){return e.toUpperCase()}function o(e){return void 0!==e&&null!==e?e instanceof Array?e:"number"!==typeof e.length||e.split||e.setInterval||e.call?[e]:Array.prototype.slice.call(e):[]}function s(e,t){var n=e;if(t)for(var i in t)n[i]=t[i];return n}function a(e){var i="[A-Za-z]",r="[0-9]",o=t(r,"[A-Fa-f]"),s=n(n("%[EFef]"+o+"%"+o+o+"%"+o+o)+"|"+n("%[89A-Fa-f]"+o+"%"+o+o)+"|"+n("%"+o+o)),a="[\\:\\/\\?\\#\\[\\]\\@]",l="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",u=t(a,l),c=e?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",h=e?"[\\uE000-\\uF8FF]":"[]",d=t(i,r,"[\\-\\.\\_\\~]",c),p=n(i+t(i,r,"[\\+\\-\\.]")+"*"),f=n(n(s+"|"+t(d,l,"[\\:]"))+"*"),m=(n(n("25[0-5]")+"|"+n("2[0-4]"+r)+"|"+n("1"+r+r)+"|"+n("[1-9]"+r)+"|"+r),n(n("25[0-5]")+"|"+n("2[0-4]"+r)+"|"+n("1"+r+r)+"|"+n("0?[1-9]"+r)+"|0?0?"+r)),g=n(m+"\\."+m+"\\."+m+"\\."+m),v=n(o+"{1,4}"),y=n(n(v+"\\:"+v)+"|"+g),x=n(n(v+"\\:")+"{6}"+y),b=n("\\:\\:"+n(v+"\\:")+"{5}"+y),w=n(n(v)+"?\\:\\:"+n(v+"\\:")+"{4}"+y),_=n(n(n(v+"\\:")+"{0,1}"+v)+"?\\:\\:"+n(v+"\\:")+"{3}"+y),A=n(n(n(v+"\\:")+"{0,2}"+v)+"?\\:\\:"+n(v+"\\:")+"{2}"+y),S=n(n(n(v+"\\:")+"{0,3}"+v)+"?\\:\\:"+v+"\\:"+y),E=n(n(n(v+"\\:")+"{0,4}"+v)+"?\\:\\:"+y),M=n(n(n(v+"\\:")+"{0,5}"+v)+"?\\:\\:"+v),T=n(n(n(v+"\\:")+"{0,6}"+v)+"?\\:\\:"),C=n([x,b,w,_,A,S,E,M,T].join("|")),P=n(n(d+"|"+s)+"+"),R=(n(C+"\\%25"+P),n(C+n("\\%25|\\%(?!"+o+"{2})")+P)),L=n("[vV]"+o+"+\\."+t(d,l,"[\\:]")+"+"),O=n("\\["+n(R+"|"+C+"|"+L)+"\\]"),D=n(n(s+"|"+t(d,l))+"*"),I=n(O+"|"+g+"(?!"+D+")|"+D),N=n(r+"*"),k=n(n(f+"@")+"?"+I+n("\\:"+N)+"?"),V=n(s+"|"+t(d,l,"[\\:\\@]")),U=n(V+"*"),F=n(V+"+"),z=n(n(s+"|"+t(d,l,"[\\@]"))+"+"),j=n(n("\\/"+U)+"*"),B=n("\\/"+n(F+j)+"?"),$=n(z+j),H=n(F+j),G="(?!"+V+")",W=(n(j+"|"+B+"|"+$+"|"+H+"|"+G),n(n(V+"|"+t("[\\/\\?]",h))+"*")),q=n(n(V+"|[\\/\\?]")+"*"),Y=n(n("\\/\\/"+k+j)+"|"+B+"|"+H+"|"+G),X=n(p+"\\:"+Y+n("\\?"+W)+"?"+n("\\#"+q)+"?"),Z=n(n("\\/\\/"+k+j)+"|"+B+"|"+$+"|"+G),J=n(Z+n("\\?"+W)+"?"+n("\\#"+q)+"?");n(X+"|"+J),n(p+"\\:"+Y+n("\\?"+W)+"?"),n(n("\\/\\/("+n("("+f+")@")+"?("+I+")"+n("\\:("+N+")")+"?)")+"?("+j+"|"+B+"|"+H+"|"+G+")"),n("\\?("+W+")"),n("\\#("+q+")"),n(n("\\/\\/("+n("("+f+")@")+"?("+I+")"+n("\\:("+N+")")+"?)")+"?("+j+"|"+B+"|"+$+"|"+G+")"),n("\\?("+W+")"),n("\\#("+q+")"),n(n("\\/\\/("+n("("+f+")@")+"?("+I+")"+n("\\:("+N+")")+"?)")+"?("+j+"|"+B+"|"+H+"|"+G+")"),n("\\?("+W+")"),n("\\#("+q+")"),n("("+f+")@"),n("\\:("+N+")");return{NOT_SCHEME:new RegExp(t("[^]",i,r,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(t("[^\\%\\:]",d,l),"g"),NOT_HOST:new RegExp(t("[^\\%\\[\\]\\:]",d,l),"g"),NOT_PATH:new RegExp(t("[^\\%\\/\\:\\@]",d,l),"g"),NOT_PATH_NOSCHEME:new RegExp(t("[^\\%\\/\\@]",d,l),"g"),NOT_QUERY:new RegExp(t("[^\\%]",d,l,"[\\:\\@\\/\\?]",h),"g"),NOT_FRAGMENT:new RegExp(t("[^\\%]",d,l,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(t("[^]",d,l),"g"),UNRESERVED:new RegExp(d,"g"),OTHER_CHARS:new RegExp(t("[^\\%]",d,u),"g"),PCT_ENCODED:new RegExp(s,"g"),IPV4ADDRESS:new RegExp("^("+g+")$"),IPV6ADDRESS:new RegExp("^\\[?("+C+")"+n(n("\\%25|\\%(?!"+o+"{2})")+"("+P+")")+"?\\]?$")}}var l=a(!1),u=a(!0),c=function(){function e(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(i=(s=a.next()).done);i=!0)if(n.push(s.value),t&&n.length===t)break}catch(l){r=!0,o=l}finally{try{!i&&a["return"]&&a["return"]()}finally{if(r)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),h=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)},d=2147483647,p=36,f=1,m=26,g=38,v=700,y=72,x=128,b="-",w=/^xn--/,_=/[^\0-\x7E]/,A=/[\x2E\u3002\uFF0E\uFF61]/g,S={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},E=p-f,M=Math.floor,T=String.fromCharCode;function C(e){throw new RangeError(S[e])}function P(e,t){var n=[],i=e.length;while(i--)n[i]=t(e[i]);return n}function R(e,t){var n=e.split("@"),i="";n.length>1&&(i=n[0]+"@",e=n[1]),e=e.replace(A,".");var r=e.split("."),o=P(r,t).join(".");return i+o}function L(e){var t=[],n=0,i=e.length;while(n<i){var r=e.charCodeAt(n++);if(r>=55296&&r<=56319&&n<i){var o=e.charCodeAt(n++);56320==(64512&o)?t.push(((1023&r)<<10)+(1023&o)+65536):(t.push(r),n--)}else t.push(r)}return t}var O=function(e){return String.fromCodePoint.apply(String,h(e))},D=function(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:p},I=function(e,t){return e+22+75*(e<26)-((0!=t)<<5)},N=function(e,t,n){var i=0;for(e=n?M(e/v):e>>1,e+=M(e/t);e>E*m>>1;i+=p)e=M(e/E);return M(i+(E+1)*e/(e+g))},k=function(e){var t=[],n=e.length,i=0,r=x,o=y,s=e.lastIndexOf(b);s<0&&(s=0);for(var a=0;a<s;++a)e.charCodeAt(a)>=128&&C("not-basic"),t.push(e.charCodeAt(a));for(var l=s>0?s+1:0;l<n;){for(var u=i,c=1,h=p;;h+=p){l>=n&&C("invalid-input");var g=D(e.charCodeAt(l++));(g>=p||g>M((d-i)/c))&&C("overflow"),i+=g*c;var v=h<=o?f:h>=o+m?m:h-o;if(g<v)break;var w=p-v;c>M(d/w)&&C("overflow"),c*=w}var _=t.length+1;o=N(i-u,_,0==u),M(i/_)>d-r&&C("overflow"),r+=M(i/_),i%=_,t.splice(i++,0,r)}return String.fromCodePoint.apply(String,t)},V=function(e){var t=[];e=L(e);var n=e.length,i=x,r=0,o=y,s=!0,a=!1,l=void 0;try{for(var u,c=e[Symbol.iterator]();!(s=(u=c.next()).done);s=!0){var h=u.value;h<128&&t.push(T(h))}}catch(W){a=!0,l=W}finally{try{!s&&c.return&&c.return()}finally{if(a)throw l}}var g=t.length,v=g;g&&t.push(b);while(v<n){var w=d,_=!0,A=!1,S=void 0;try{for(var E,P=e[Symbol.iterator]();!(_=(E=P.next()).done);_=!0){var R=E.value;R>=i&&R<w&&(w=R)}}catch(W){A=!0,S=W}finally{try{!_&&P.return&&P.return()}finally{if(A)throw S}}var O=v+1;w-i>M((d-r)/O)&&C("overflow"),r+=(w-i)*O,i=w;var D=!0,k=!1,V=void 0;try{for(var U,F=e[Symbol.iterator]();!(D=(U=F.next()).done);D=!0){var z=U.value;if(z<i&&++r>d&&C("overflow"),z==i){for(var j=r,B=p;;B+=p){var $=B<=o?f:B>=o+m?m:B-o;if(j<$)break;var H=j-$,G=p-$;t.push(T(I($+H%G,0))),j=M(H/G)}t.push(T(I(j,0))),o=N(r,O,v==g),r=0,++v}}}catch(W){k=!0,V=W}finally{try{!D&&F.return&&F.return()}finally{if(k)throw V}}++r,++i}return t.join("")},U=function(e){return R(e,(function(e){return w.test(e)?k(e.slice(4).toLowerCase()):e}))},F=function(e){return R(e,(function(e){return _.test(e)?"xn--"+V(e):e}))},z={version:"2.1.0",ucs2:{decode:L,encode:O},decode:k,encode:V,toASCII:F,toUnicode:U},j={};function B(e){var t=e.charCodeAt(0),n=void 0;return n=t<16?"%0"+t.toString(16).toUpperCase():t<128?"%"+t.toString(16).toUpperCase():t<2048?"%"+(t>>6|192).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase():"%"+(t>>12|224).toString(16).toUpperCase()+"%"+(t>>6&63|128).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase(),n}function $(e){var t="",n=0,i=e.length;while(n<i){var r=parseInt(e.substr(n+1,2),16);if(r<128)t+=String.fromCharCode(r),n+=3;else if(r>=194&&r<224){if(i-n>=6){var o=parseInt(e.substr(n+4,2),16);t+=String.fromCharCode((31&r)<<6|63&o)}else t+=e.substr(n,6);n+=6}else if(r>=224){if(i-n>=9){var s=parseInt(e.substr(n+4,2),16),a=parseInt(e.substr(n+7,2),16);t+=String.fromCharCode((15&r)<<12|(63&s)<<6|63&a)}else t+=e.substr(n,9);n+=9}else t+=e.substr(n,3),n+=3}return t}function H(e,t){function n(e){var n=$(e);return n.match(t.UNRESERVED)?n:e}return e.scheme&&(e.scheme=String(e.scheme).replace(t.PCT_ENCODED,n).toLowerCase().replace(t.NOT_SCHEME,"")),void 0!==e.userinfo&&(e.userinfo=String(e.userinfo).replace(t.PCT_ENCODED,n).replace(t.NOT_USERINFO,B).replace(t.PCT_ENCODED,r)),void 0!==e.host&&(e.host=String(e.host).replace(t.PCT_ENCODED,n).toLowerCase().replace(t.NOT_HOST,B).replace(t.PCT_ENCODED,r)),void 0!==e.path&&(e.path=String(e.path).replace(t.PCT_ENCODED,n).replace(e.scheme?t.NOT_PATH:t.NOT_PATH_NOSCHEME,B).replace(t.PCT_ENCODED,r)),void 0!==e.query&&(e.query=String(e.query).replace(t.PCT_ENCODED,n).replace(t.NOT_QUERY,B).replace(t.PCT_ENCODED,r)),void 0!==e.fragment&&(e.fragment=String(e.fragment).replace(t.PCT_ENCODED,n).replace(t.NOT_FRAGMENT,B).replace(t.PCT_ENCODED,r)),e}function G(e){return e.replace(/^0*(.*)/,"$1")||"0"}function W(e,t){var n=e.match(t.IPV4ADDRESS)||[],i=c(n,2),r=i[1];return r?r.split(".").map(G).join("."):e}function q(e,t){var n=e.match(t.IPV6ADDRESS)||[],i=c(n,3),r=i[1],o=i[2];if(r){for(var s=r.toLowerCase().split("::").reverse(),a=c(s,2),l=a[0],u=a[1],h=u?u.split(":").map(G):[],d=l.split(":").map(G),p=t.IPV4ADDRESS.test(d[d.length-1]),f=p?7:8,m=d.length-f,g=Array(f),v=0;v<f;++v)g[v]=h[v]||d[m+v]||"";p&&(g[f-1]=W(g[f-1],t));var y=g.reduce((function(e,t,n){if(!t||"0"===t){var i=e[e.length-1];i&&i.index+i.length===n?i.length++:e.push({index:n,length:1})}return e}),[]),x=y.sort((function(e,t){return t.length-e.length}))[0],b=void 0;if(x&&x.length>1){var w=g.slice(0,x.index),_=g.slice(x.index+x.length);b=w.join(":")+"::"+_.join(":")}else b=g.join(":");return o&&(b+="%"+o),b}return e}var Y=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,X=void 0==="".match(/(){0}/)[1];function Z(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={},i=!1!==t.iri?u:l;"suffix"===t.reference&&(e=(t.scheme?t.scheme+":":"")+"//"+e);var r=e.match(Y);if(r){X?(n.scheme=r[1],n.userinfo=r[3],n.host=r[4],n.port=parseInt(r[5],10),n.path=r[6]||"",n.query=r[7],n.fragment=r[8],isNaN(n.port)&&(n.port=r[5])):(n.scheme=r[1]||void 0,n.userinfo=-1!==e.indexOf("@")?r[3]:void 0,n.host=-1!==e.indexOf("//")?r[4]:void 0,n.port=parseInt(r[5],10),n.path=r[6]||"",n.query=-1!==e.indexOf("?")?r[7]:void 0,n.fragment=-1!==e.indexOf("#")?r[8]:void 0,isNaN(n.port)&&(n.port=e.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?r[4]:void 0)),n.host&&(n.host=q(W(n.host,i),i)),void 0!==n.scheme||void 0!==n.userinfo||void 0!==n.host||void 0!==n.port||n.path||void 0!==n.query?void 0===n.scheme?n.reference="relative":void 0===n.fragment?n.reference="absolute":n.reference="uri":n.reference="same-document",t.reference&&"suffix"!==t.reference&&t.reference!==n.reference&&(n.error=n.error||"URI is not a "+t.reference+" reference.");var o=j[(t.scheme||n.scheme||"").toLowerCase()];if(t.unicodeSupport||o&&o.unicodeSupport)H(n,i);else{if(n.host&&(t.domainHost||o&&o.domainHost))try{n.host=z.toASCII(n.host.replace(i.PCT_ENCODED,$).toLowerCase())}catch(s){n.error=n.error||"Host's domain name can not be converted to ASCII via punycode: "+s}H(n,l)}o&&o.parse&&o.parse(n,t)}else n.error=n.error||"URI can not be parsed.";return n}function J(e,t){var n=!1!==t.iri?u:l,i=[];return void 0!==e.userinfo&&(i.push(e.userinfo),i.push("@")),void 0!==e.host&&i.push(q(W(String(e.host),n),n).replace(n.IPV6ADDRESS,(function(e,t,n){return"["+t+(n?"%25"+n:"")+"]"}))),"number"!==typeof e.port&&"string"!==typeof e.port||(i.push(":"),i.push(String(e.port))),i.length?i.join(""):void 0}var K=/^\.\.?\//,Q=/^\/\.(\/|$)/,ee=/^\/\.\.(\/|$)/,te=/^\/?(?:.|\n)*?(?=\/|$)/;function ne(e){var t=[];while(e.length)if(e.match(K))e=e.replace(K,"");else if(e.match(Q))e=e.replace(Q,"/");else if(e.match(ee))e=e.replace(ee,"/"),t.pop();else if("."===e||".."===e)e="";else{var n=e.match(te);if(!n)throw new Error("Unexpected dot segment condition");var i=n[0];e=e.slice(i.length),t.push(i)}return t.join("")}function ie(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.iri?u:l,i=[],r=j[(t.scheme||e.scheme||"").toLowerCase()];if(r&&r.serialize&&r.serialize(e,t),e.host)if(n.IPV6ADDRESS.test(e.host));else if(t.domainHost||r&&r.domainHost)try{e.host=t.iri?z.toUnicode(e.host):z.toASCII(e.host.replace(n.PCT_ENCODED,$).toLowerCase())}catch(a){e.error=e.error||"Host's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+a}H(e,n),"suffix"!==t.reference&&e.scheme&&(i.push(e.scheme),i.push(":"));var o=J(e,t);if(void 0!==o&&("suffix"!==t.reference&&i.push("//"),i.push(o),e.path&&"/"!==e.path.charAt(0)&&i.push("/")),void 0!==e.path){var s=e.path;t.absolutePath||r&&r.absolutePath||(s=ne(s)),void 0===o&&(s=s.replace(/^\/\//,"/%2F")),i.push(s)}return void 0!==e.query&&(i.push("?"),i.push(e.query)),void 0!==e.fragment&&(i.push("#"),i.push(e.fragment)),i.join("")}function re(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments[3],r={};return i||(e=Z(ie(e,n),n),t=Z(ie(t,n),n)),n=n||{},!n.tolerant&&t.scheme?(r.scheme=t.scheme,r.userinfo=t.userinfo,r.host=t.host,r.port=t.port,r.path=ne(t.path||""),r.query=t.query):(void 0!==t.userinfo||void 0!==t.host||void 0!==t.port?(r.userinfo=t.userinfo,r.host=t.host,r.port=t.port,r.path=ne(t.path||""),r.query=t.query):(t.path?("/"===t.path.charAt(0)?r.path=ne(t.path):(void 0===e.userinfo&&void 0===e.host&&void 0===e.port||e.path?e.path?r.path=e.path.slice(0,e.path.lastIndexOf("/")+1)+t.path:r.path=t.path:r.path="/"+t.path,r.path=ne(r.path)),r.query=t.query):(r.path=e.path,void 0!==t.query?r.query=t.query:r.query=e.query),r.userinfo=e.userinfo,r.host=e.host,r.port=e.port),r.scheme=e.scheme),r.fragment=t.fragment,r}function oe(e,t,n){var i=s({scheme:"null"},n);return ie(re(Z(e,i),Z(t,i),i,!0),i)}function se(e,t){return"string"===typeof e?e=ie(Z(e,t),t):"object"===i(e)&&(e=Z(ie(e,t),t)),e}function ae(e,t,n){return"string"===typeof e?e=ie(Z(e,n),n):"object"===i(e)&&(e=ie(e,n)),"string"===typeof t?t=ie(Z(t,n),n):"object"===i(t)&&(t=ie(t,n)),e===t}function le(e,t){return e&&e.toString().replace(t&&t.iri?u.ESCAPE:l.ESCAPE,B)}function ue(e,t){return e&&e.toString().replace(t&&t.iri?u.PCT_ENCODED:l.PCT_ENCODED,$)}var ce={scheme:"http",domainHost:!0,parse:function(e,t){return e.host||(e.error=e.error||"HTTP URIs must have a host."),e},serialize:function(e,t){var n="https"===String(e.scheme).toLowerCase();return e.port!==(n?443:80)&&""!==e.port||(e.port=void 0),e.path||(e.path="/"),e}},he={scheme:"https",domainHost:ce.domainHost,parse:ce.parse,serialize:ce.serialize};function de(e){return"boolean"===typeof e.secure?e.secure:"wss"===String(e.scheme).toLowerCase()}var pe={scheme:"ws",domainHost:!0,parse:function(e,t){var n=e;return n.secure=de(n),n.resourceName=(n.path||"/")+(n.query?"?"+n.query:""),n.path=void 0,n.query=void 0,n},serialize:function(e,t){if(e.port!==(de(e)?443:80)&&""!==e.port||(e.port=void 0),"boolean"===typeof e.secure&&(e.scheme=e.secure?"wss":"ws",e.secure=void 0),e.resourceName){var n=e.resourceName.split("?"),i=c(n,2),r=i[0],o=i[1];e.path=r&&"/"!==r?r:void 0,e.query=o,e.resourceName=void 0}return e.fragment=void 0,e}},fe={scheme:"wss",domainHost:pe.domainHost,parse:pe.parse,serialize:pe.serialize},me={},ge=!0,ve="[A-Za-z0-9\\-\\.\\_\\~"+(ge?"\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF":"")+"]",ye="[0-9A-Fa-f]",xe=n(n("%[EFef]"+ye+"%"+ye+ye+"%"+ye+ye)+"|"+n("%[89A-Fa-f]"+ye+"%"+ye+ye)+"|"+n("%"+ye+ye)),be="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",we="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",_e=t(we,'[\\"\\\\]'),Ae="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",Se=new RegExp(ve,"g"),Ee=new RegExp(xe,"g"),Me=new RegExp(t("[^]",be,"[\\.]",'[\\"]',_e),"g"),Te=new RegExp(t("[^]",ve,Ae),"g"),Ce=Te;function Pe(e){var t=$(e);return t.match(Se)?t:e}var Re={scheme:"mailto",parse:function(e,t){var n=e,i=n.to=n.path?n.path.split(","):[];if(n.path=void 0,n.query){for(var r=!1,o={},s=n.query.split("&"),a=0,l=s.length;a<l;++a){var u=s[a].split("=");switch(u[0]){case"to":for(var c=u[1].split(","),h=0,d=c.length;h<d;++h)i.push(c[h]);break;case"subject":n.subject=ue(u[1],t);break;case"body":n.body=ue(u[1],t);break;default:r=!0,o[ue(u[0],t)]=ue(u[1],t);break}}r&&(n.headers=o)}n.query=void 0;for(var p=0,f=i.length;p<f;++p){var m=i[p].split("@");if(m[0]=ue(m[0]),t.unicodeSupport)m[1]=ue(m[1],t).toLowerCase();else try{m[1]=z.toASCII(ue(m[1],t).toLowerCase())}catch(g){n.error=n.error||"Email address's domain name can not be converted to ASCII via punycode: "+g}i[p]=m.join("@")}return n},serialize:function(e,t){var n=e,i=o(e.to);if(i){for(var s=0,a=i.length;s<a;++s){var l=String(i[s]),u=l.lastIndexOf("@"),c=l.slice(0,u).replace(Ee,Pe).replace(Ee,r).replace(Me,B),h=l.slice(u+1);try{h=t.iri?z.toUnicode(h):z.toASCII(ue(h,t).toLowerCase())}catch(m){n.error=n.error||"Email address's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+m}i[s]=c+"@"+h}n.path=i.join(",")}var d=e.headers=e.headers||{};e.subject&&(d["subject"]=e.subject),e.body&&(d["body"]=e.body);var p=[];for(var f in d)d[f]!==me[f]&&p.push(f.replace(Ee,Pe).replace(Ee,r).replace(Te,B)+"="+d[f].replace(Ee,Pe).replace(Ee,r).replace(Ce,B));return p.length&&(n.query=p.join("&")),n}},Le=/^([^\:]+)\:(.*)/,Oe={scheme:"urn",parse:function(e,t){var n=e.path&&e.path.match(Le),i=e;if(n){var r=t.scheme||i.scheme||"urn",o=n[1].toLowerCase(),s=n[2],a=r+":"+(t.nid||o),l=j[a];i.nid=o,i.nss=s,i.path=void 0,l&&(i=l.parse(i,t))}else i.error=i.error||"URN can not be parsed.";return i},serialize:function(e,t){var n=t.scheme||e.scheme||"urn",i=e.nid,r=n+":"+(t.nid||i),o=j[r];o&&(e=o.serialize(e,t));var s=e,a=e.nss;return s.path=(i||t.nid)+":"+a,s}},De=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,Ie={scheme:"urn:uuid",parse:function(e,t){var n=e;return n.uuid=n.nss,n.nss=void 0,t.tolerant||n.uuid&&n.uuid.match(De)||(n.error=n.error||"UUID is not valid."),n},serialize:function(e,t){var n=e;return n.nss=(e.uuid||"").toLowerCase(),n}};j[ce.scheme]=ce,j[he.scheme]=he,j[pe.scheme]=pe,j[fe.scheme]=fe,j[Re.scheme]=Re,j[Oe.scheme]=Oe,j[Ie.scheme]=Ie,e.SCHEMES=j,e.pctEncChar=B,e.pctDecChars=$,e.parse=Z,e.removeDotSegments=ne,e.serialize=ie,e.resolveComponents=re,e.resolve=oe,e.normalize=se,e.equal=ae,e.escapeComponent=le,e.unescapeComponent=ue,Object.defineProperty(e,"__esModule",{value:!0})}))},"527c":function(e,t,n){"use strict";function i(e){const t=e.length;let n,i=0,r=0;while(r<t)i++,n=e.charCodeAt(r++),n>=55296&&n<=56319&&r<t&&(n=e.charCodeAt(r),56320===(64512&n)&&r++);return i}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i,i.code='require("ajv/dist/runtime/ucs2length").default'},5377:function(e,t,n){var i=n("83ab"),r=n("9bf2"),o=n("ad6d"),s=n("d039"),a=i&&s((function(){return"sy"!==Object.getOwnPropertyDescriptor(RegExp.prototype,"flags").get.call({dotAll:!0,sticky:!0})}));a&&r.f(RegExp.prototype,"flags",{configurable:!0,get:o})},"53ca":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0");function i(e){return i="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}},5530:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));n("b64b"),n("a4d3"),n("4de4"),n("e439"),n("159b"),n("dbb4");function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}},5698:function(e,t,n){var i=this,r=["document","window","navigator","CSSStyleDeclaration","d3","Sizzle"],o={};r.forEach((function(e){e in i&&(o[e]=i[e])})),navigator=window.navigator,CSSStyleDeclaration=window.CSSStyleDeclaration,Sizzle=n("9091"),n("e735"),e.exports=d3,r.forEach((function(e){e in o?i[e]=o[e]:delete i[e]}))},"5a43":function(e,t){function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}e.exports=n,e.exports["default"]=e.exports,e.exports.__esModule=!0},"5b70":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("96ab"),r=n("417a"),o={message:"property name must be valid",params:({params:e})=>i._`{propertyName: ${e.propertyName}}`},s={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:o,code(e){const{gen:t,schema:n,data:o,it:s}=e;if(r.alwaysValidSchema(s,n))return;const a=t.name("valid");t.forIn("key",o,n=>{e.setParams({propertyName:n}),e.subschema({keyword:"propertyNames",data:n,dataTypes:["string"],propertyName:n,compositeRule:!0},a),t.if(i.not(a),()=>{e.error(!0),s.allErrors||t.break()})}),e.ok(a)}};t.default=s},"5c62":function(e,t,n){"use strict";n.r(t),n.d(t,"initEmbedJolecule",(function(){return zp})),n.d(t,"initFullPageJolecule",(function(){return jp})),n.d(t,"makePdbDataServer",(function(){return $p})),n.d(t,"makeDataServer",(function(){return Hp})),n.d(t,"AquariaAlignment",(function(){return Fp}));var i=n("1157"),r=n.n(i),o=n("2ef0"),s=n.n(o);function a(){}void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(e){return"number"===typeof e&&isFinite(e)&&Math.floor(e)===e}),void 0===Math.sign&&(Math.sign=function(e){return e<0?-1:e>0?1:+e}),"name"in Function.prototype===!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&function(){Object.assign=function(e){if(void 0===e||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var i=arguments[n];if(void 0!==i&&null!==i)for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t}}(),Object.assign(a.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)},removeEventListener:function(e,t){if(void 0!==this._listeners){var n=this._listeners,i=n[e];if(void 0!==i){var r=i.indexOf(t);-1!==r&&i.splice(r,1)}}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners,n=t[e.type];if(void 0!==n){e.target=this;for(var i=n.slice(0),r=0,o=i.length;r<o;r++)i[r].call(this,e)}}}});var l="92",u=0,c=1,h=2,d=1,p=2,f=0,m=1,g=2,v=1,y=0,x=1,b=2,w=0,_=1,A=2,S=3,E=4,M=5,T=100,C=101,P=102,R=103,L=104,O=200,D=201,I=202,N=203,k=204,V=205,U=206,F=207,z=208,j=209,B=210,$=0,H=1,G=2,W=3,q=4,Y=5,X=6,Z=7,J=0,K=1,Q=2,ee=0,te=1,ne=2,ie=3,re=4,oe=300,se=301,ae=302,le=303,ue=304,ce=305,he=306,de=307,pe=1e3,fe=1001,me=1002,ge=1003,ve=1004,ye=1005,xe=1006,be=1007,we=1008,_e=1009,Ae=1010,Se=1011,Ee=1012,Me=1013,Te=1014,Ce=1015,Pe=1016,Re=1017,Le=1018,Oe=1019,De=1020,Ie=1021,Ne=1022,ke=1023,Ve=1024,Ue=1025,Fe=1026,ze=1027,je=33776,Be=33777,$e=33778,He=33779,Ge=35840,We=35841,qe=35842,Ye=35843,Xe=36196,Ze=37808,Je=37809,Ke=37810,Qe=37811,et=37812,tt=37813,nt=37814,it=37815,rt=37816,ot=37817,st=37818,at=37819,lt=37820,ut=37821,ct=2200,ht=2201,dt=2202,pt=2300,ft=2301,mt=2302,gt=2400,vt=2401,yt=2402,xt=0,bt=1,wt=2,_t=3e3,At=3001,St=3007,Et=3002,Mt=3004,Tt=3005,Ct=3006,Pt=3200,Rt=3201,Lt={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var e=[],t=0;t<256;t++)e[t]=(t<16?"0":"")+t.toString(16);return function(){var t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0,r=4294967295*Math.random()|0,o=e[255&t]+e[t>>8&255]+e[t>>16&255]+e[t>>24&255]+"-"+e[255&n]+e[n>>8&255]+"-"+e[n>>16&15|64]+e[n>>24&255]+"-"+e[63&i|128]+e[i>>8&255]+"-"+e[i>>16&255]+e[i>>24&255]+e[255&r]+e[r>>8&255]+e[r>>16&255]+e[r>>24&255];return o.toUpperCase()}}(),clamp:function(e,t,n){return Math.max(t,Math.min(n,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,n,i,r){return i+(e-t)*(r-i)/(n-t)},lerp:function(e,t,n){return(1-n)*e+n*t},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t),e*e*(3-2*e))},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t),e*e*e*(e*(6*e-15)+10))},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*Lt.DEG2RAD},radToDeg:function(e){return e*Lt.RAD2DEG},isPowerOfTwo:function(e){return 0===(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}};function Ot(e,t){this.x=e||0,this.y=t||0}function Dt(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function It(e,t,n,i){this._x=e||0,this._y=t||0,this._z=n||0,this._w=void 0!==i?i:1}function Nt(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0}function kt(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}Object.defineProperties(Ot.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),Object.assign(Ot.prototype,{isVector2:!0,set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.x=e,this.y=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){var t=this.x,n=this.y,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6],this.y=i[1]*t+i[4]*n+i[7],this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},clampScalar:function(){var e=new Ot,t=new Ot;return function(n,i){return e.set(n,n),t.set(i,i),this.clamp(e,t)}}(),clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var e=Math.atan2(this.y,this.x);return e<0&&(e+=2*Math.PI),e},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},rotateAround:function(e,t){var n=Math.cos(t),i=Math.sin(t),r=this.x-e.x,o=this.y-e.y;return this.x=r*n-o*i+e.x,this.y=r*i+o*n+e.y,this}}),Object.assign(Dt.prototype,{isMatrix4:!0,set:function(e,t,n,i,r,o,s,a,l,u,c,h,d,p,f,m){var g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=i,g[1]=r,g[5]=o,g[9]=s,g[13]=a,g[2]=l,g[6]=u,g[10]=c,g[14]=h,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new Dt).fromArray(this.elements)},copy:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this},copyPosition:function(e){var t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this},extractBasis:function(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this},extractRotation:function(){var e=new Nt;return function(t){var n=this.elements,i=t.elements,r=1/e.setFromMatrixColumn(t,0).length(),o=1/e.setFromMatrixColumn(t,1).length(),s=1/e.setFromMatrixColumn(t,2).length();return n[0]=i[0]*r,n[1]=i[1]*r,n[2]=i[2]*r,n[4]=i[4]*o,n[5]=i[5]*o,n[6]=i[6]*o,n[8]=i[8]*s,n[9]=i[9]*s,n[10]=i[10]*s,this}}(),makeRotationFromEuler:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,n=e.x,i=e.y,r=e.z,o=Math.cos(n),s=Math.sin(n),a=Math.cos(i),l=Math.sin(i),u=Math.cos(r),c=Math.sin(r);if("XYZ"===e.order){var h=o*u,d=o*c,p=s*u,f=s*c;t[0]=a*u,t[4]=-a*c,t[8]=l,t[1]=d+p*l,t[5]=h-f*l,t[9]=-s*a,t[2]=f-h*l,t[6]=p+d*l,t[10]=o*a}else if("YXZ"===e.order){var m=a*u,g=a*c,v=l*u,y=l*c;t[0]=m+y*s,t[4]=v*s-g,t[8]=o*l,t[1]=o*c,t[5]=o*u,t[9]=-s,t[2]=g*s-v,t[6]=y+m*s,t[10]=o*a}else if("ZXY"===e.order){m=a*u,g=a*c,v=l*u,y=l*c;t[0]=m-y*s,t[4]=-o*c,t[8]=v+g*s,t[1]=g+v*s,t[5]=o*u,t[9]=y-m*s,t[2]=-o*l,t[6]=s,t[10]=o*a}else if("ZYX"===e.order){h=o*u,d=o*c,p=s*u,f=s*c;t[0]=a*u,t[4]=p*l-d,t[8]=h*l+f,t[1]=a*c,t[5]=f*l+h,t[9]=d*l-p,t[2]=-l,t[6]=s*a,t[10]=o*a}else if("YZX"===e.order){var x=o*a,b=o*l,w=s*a,_=s*l;t[0]=a*u,t[4]=_-x*c,t[8]=w*c+b,t[1]=c,t[5]=o*u,t[9]=-s*u,t[2]=-l*u,t[6]=b*c+w,t[10]=x-_*c}else if("XZY"===e.order){x=o*a,b=o*l,w=s*a,_=s*l;t[0]=a*u,t[4]=-c,t[8]=l*u,t[1]=x*c+_,t[5]=o*u,t[9]=b*c-w,t[2]=w*c-b,t[6]=s*u,t[10]=_*c+x}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromQuaternion:function(e){var t=this.elements,n=e._x,i=e._y,r=e._z,o=e._w,s=n+n,a=i+i,l=r+r,u=n*s,c=n*a,h=n*l,d=i*a,p=i*l,f=r*l,m=o*s,g=o*a,v=o*l;return t[0]=1-(d+f),t[4]=c-v,t[8]=h+g,t[1]=c+v,t[5]=1-(u+f),t[9]=p-m,t[2]=h-g,t[6]=p+m,t[10]=1-(u+d),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},lookAt:function(){var e=new Nt,t=new Nt,n=new Nt;return function(i,r,o){var s=this.elements;return n.subVectors(i,r),0===n.lengthSq()&&(n.z=1),n.normalize(),e.crossVectors(o,n),0===e.lengthSq()&&(1===Math.abs(o.z)?n.x+=1e-4:n.z+=1e-4,n.normalize(),e.crossVectors(o,n)),e.normalize(),t.crossVectors(n,e),s[0]=e.x,s[4]=t.x,s[8]=n.x,s[1]=e.y,s[5]=t.y,s[9]=n.y,s[2]=e.z,s[6]=t.z,s[10]=n.z,this}}(),multiply:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var n=e.elements,i=t.elements,r=this.elements,o=n[0],s=n[4],a=n[8],l=n[12],u=n[1],c=n[5],h=n[9],d=n[13],p=n[2],f=n[6],m=n[10],g=n[14],v=n[3],y=n[7],x=n[11],b=n[15],w=i[0],_=i[4],A=i[8],S=i[12],E=i[1],M=i[5],T=i[9],C=i[13],P=i[2],R=i[6],L=i[10],O=i[14],D=i[3],I=i[7],N=i[11],k=i[15];return r[0]=o*w+s*E+a*P+l*D,r[4]=o*_+s*M+a*R+l*I,r[8]=o*A+s*T+a*L+l*N,r[12]=o*S+s*C+a*O+l*k,r[1]=u*w+c*E+h*P+d*D,r[5]=u*_+c*M+h*R+d*I,r[9]=u*A+c*T+h*L+d*N,r[13]=u*S+c*C+h*O+d*k,r[2]=p*w+f*E+m*P+g*D,r[6]=p*_+f*M+m*R+g*I,r[10]=p*A+f*T+m*L+g*N,r[14]=p*S+f*C+m*O+g*k,r[3]=v*w+y*E+x*P+b*D,r[7]=v*_+y*M+x*R+b*I,r[11]=v*A+y*T+x*L+b*N,r[15]=v*S+y*C+x*O+b*k,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},applyToBufferAttribute:function(){var e=new Nt;return function(t){for(var n=0,i=t.count;n<i;n++)e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.applyMatrix4(this),t.setXYZ(n,e.x,e.y,e.z);return t}}(),determinant:function(){var e=this.elements,t=e[0],n=e[4],i=e[8],r=e[12],o=e[1],s=e[5],a=e[9],l=e[13],u=e[2],c=e[6],h=e[10],d=e[14],p=e[3],f=e[7],m=e[11],g=e[15];return p*(+r*a*c-i*l*c-r*s*h+n*l*h+i*s*d-n*a*d)+f*(+t*a*d-t*l*h+r*o*h-i*o*d+i*l*u-r*a*u)+m*(+t*l*c-t*s*d-r*o*c+n*o*d+r*s*u-n*l*u)+g*(-i*s*u-t*a*c+t*s*h+i*o*c-n*o*h+n*a*u)},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},setPosition:function(e){var t=this.elements;return t[12]=e.x,t[13]=e.y,t[14]=e.z,this},getInverse:function(e,t){var n=this.elements,i=e.elements,r=i[0],o=i[1],s=i[2],a=i[3],l=i[4],u=i[5],c=i[6],h=i[7],d=i[8],p=i[9],f=i[10],m=i[11],g=i[12],v=i[13],y=i[14],x=i[15],b=p*y*h-v*f*h+v*c*m-u*y*m-p*c*x+u*f*x,w=g*f*h-d*y*h-g*c*m+l*y*m+d*c*x-l*f*x,_=d*v*h-g*p*h+g*u*m-l*v*m-d*u*x+l*p*x,A=g*p*c-d*v*c-g*u*f+l*v*f+d*u*y-l*p*y,S=r*b+o*w+s*_+a*A;if(0===S){var E="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(E);return console.warn(E),this.identity()}var M=1/S;return n[0]=b*M,n[1]=(v*f*a-p*y*a-v*s*m+o*y*m+p*s*x-o*f*x)*M,n[2]=(u*y*a-v*c*a+v*s*h-o*y*h-u*s*x+o*c*x)*M,n[3]=(p*c*a-u*f*a-p*s*h+o*f*h+u*s*m-o*c*m)*M,n[4]=w*M,n[5]=(d*y*a-g*f*a+g*s*m-r*y*m-d*s*x+r*f*x)*M,n[6]=(g*c*a-l*y*a-g*s*h+r*y*h+l*s*x-r*c*x)*M,n[7]=(l*f*a-d*c*a+d*s*h-r*f*h-l*s*m+r*c*m)*M,n[8]=_*M,n[9]=(g*p*a-d*v*a-g*o*m+r*v*m+d*o*x-r*p*x)*M,n[10]=(l*v*a-g*u*a+g*o*h-r*v*h-l*o*x+r*u*x)*M,n[11]=(d*u*a-l*p*a-d*o*h+r*p*h+l*o*m-r*u*m)*M,n[12]=A*M,n[13]=(d*v*s-g*p*s+g*o*f-r*v*f-d*o*y+r*p*y)*M,n[14]=(g*u*s-l*v*s-g*o*c+r*v*c+l*o*y-r*u*y)*M,n[15]=(l*p*s-d*u*s+d*o*c-r*p*c-l*o*f+r*u*f)*M,this},scale:function(e){var t=this.elements,n=e.x,i=e.y,r=e.z;return t[0]*=n,t[4]*=i,t[8]*=r,t[1]*=n,t[5]*=i,t[9]*=r,t[2]*=n,t[6]*=i,t[10]*=r,t[3]*=n,t[7]*=i,t[11]*=r,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,i))},makeTranslation:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var n=Math.cos(t),i=Math.sin(t),r=1-n,o=e.x,s=e.y,a=e.z,l=r*o,u=r*s;return this.set(l*o+n,l*s-i*a,l*a+i*s,0,l*s+i*a,u*s+n,u*a-i*o,0,l*a-i*s,u*a+i*o,r*a*a+n,0,0,0,0,1),this},makeScale:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(e,t,n){return this.set(1,t,n,0,e,1,n,0,e,t,1,0,0,0,0,1),this},compose:function(e,t,n){return this.makeRotationFromQuaternion(t),this.scale(n),this.setPosition(e),this},decompose:function(){var e=new Nt,t=new Dt;return function(n,i,r){var o=this.elements,s=e.set(o[0],o[1],o[2]).length(),a=e.set(o[4],o[5],o[6]).length(),l=e.set(o[8],o[9],o[10]).length(),u=this.determinant();u<0&&(s=-s),n.x=o[12],n.y=o[13],n.z=o[14],t.copy(this);var c=1/s,h=1/a,d=1/l;return t.elements[0]*=c,t.elements[1]*=c,t.elements[2]*=c,t.elements[4]*=h,t.elements[5]*=h,t.elements[6]*=h,t.elements[8]*=d,t.elements[9]*=d,t.elements[10]*=d,i.setFromRotationMatrix(t),r.x=s,r.y=a,r.z=l,this}}(),makePerspective:function(e,t,n,i,r,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var s=this.elements,a=2*r/(t-e),l=2*r/(n-i),u=(t+e)/(t-e),c=(n+i)/(n-i),h=-(o+r)/(o-r),d=-2*o*r/(o-r);return s[0]=a,s[4]=0,s[8]=u,s[12]=0,s[1]=0,s[5]=l,s[9]=c,s[13]=0,s[2]=0,s[6]=0,s[10]=h,s[14]=d,s[3]=0,s[7]=0,s[11]=-1,s[15]=0,this},makeOrthographic:function(e,t,n,i,r,o){var s=this.elements,a=1/(t-e),l=1/(n-i),u=1/(o-r),c=(t+e)*a,h=(n+i)*l,d=(o+r)*u;return s[0]=2*a,s[4]=0,s[8]=0,s[12]=-c,s[1]=0,s[5]=2*l,s[9]=0,s[13]=-h,s[2]=0,s[6]=0,s[10]=-2*u,s[14]=-d,s[3]=0,s[7]=0,s[11]=0,s[15]=1,this},equals:function(e){for(var t=this.elements,n=e.elements,i=0;i<16;i++)if(t[i]!==n[i])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var n=0;n<16;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}),Object.assign(It,{slerp:function(e,t,n,i){return n.copy(e).slerp(t,i)},slerpFlat:function(e,t,n,i,r,o,s){var a=n[i+0],l=n[i+1],u=n[i+2],c=n[i+3],h=r[o+0],d=r[o+1],p=r[o+2],f=r[o+3];if(c!==f||a!==h||l!==d||u!==p){var m=1-s,g=a*h+l*d+u*p+c*f,v=g>=0?1:-1,y=1-g*g;if(y>Number.EPSILON){var x=Math.sqrt(y),b=Math.atan2(x,g*v);m=Math.sin(m*b)/x,s=Math.sin(s*b)/x}var w=s*v;if(a=a*m+h*w,l=l*m+d*w,u=u*m+p*w,c=c*m+f*w,m===1-s){var _=1/Math.sqrt(a*a+l*l+u*u+c*c);a*=_,l*=_,u*=_,c*=_}}e[t]=a,e[t+1]=l,e[t+2]=u,e[t+3]=c}}),Object.defineProperties(It.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this.onChangeCallback()}}}),Object.assign(It.prototype,{set:function(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._w=i,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this.onChangeCallback(),this},setFromEuler:function(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=e._x,i=e._y,r=e._z,o=e.order,s=Math.cos,a=Math.sin,l=s(n/2),u=s(i/2),c=s(r/2),h=a(n/2),d=a(i/2),p=a(r/2);return"XYZ"===o?(this._x=h*u*c+l*d*p,this._y=l*d*c-h*u*p,this._z=l*u*p+h*d*c,this._w=l*u*c-h*d*p):"YXZ"===o?(this._x=h*u*c+l*d*p,this._y=l*d*c-h*u*p,this._z=l*u*p-h*d*c,this._w=l*u*c+h*d*p):"ZXY"===o?(this._x=h*u*c-l*d*p,this._y=l*d*c+h*u*p,this._z=l*u*p+h*d*c,this._w=l*u*c-h*d*p):"ZYX"===o?(this._x=h*u*c-l*d*p,this._y=l*d*c+h*u*p,this._z=l*u*p-h*d*c,this._w=l*u*c+h*d*p):"YZX"===o?(this._x=h*u*c+l*d*p,this._y=l*d*c+h*u*p,this._z=l*u*p-h*d*c,this._w=l*u*c-h*d*p):"XZY"===o&&(this._x=h*u*c-l*d*p,this._y=l*d*c-h*u*p,this._z=l*u*p+h*d*c,this._w=l*u*c+h*d*p),!1!==t&&this.onChangeCallback(),this},setFromAxisAngle:function(e,t){var n=t/2,i=Math.sin(n);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(n),this.onChangeCallback(),this},setFromRotationMatrix:function(e){var t,n=e.elements,i=n[0],r=n[4],o=n[8],s=n[1],a=n[5],l=n[9],u=n[2],c=n[6],h=n[10],d=i+a+h;return d>0?(t=.5/Math.sqrt(d+1),this._w=.25/t,this._x=(c-l)*t,this._y=(o-u)*t,this._z=(s-r)*t):i>a&&i>h?(t=2*Math.sqrt(1+i-a-h),this._w=(c-l)/t,this._x=.25*t,this._y=(r+s)/t,this._z=(o+u)/t):a>h?(t=2*Math.sqrt(1+a-i-h),this._w=(o-u)/t,this._x=(r+s)/t,this._y=.25*t,this._z=(l+c)/t):(t=2*Math.sqrt(1+h-i-a),this._w=(s-r)/t,this._x=(o+u)/t,this._y=(l+c)/t,this._z=.25*t),this.onChangeCallback(),this},setFromUnitVectors:function(){var e,t=new Nt,n=1e-6;return function(i,r){return void 0===t&&(t=new Nt),e=i.dot(r)+1,e<n?(e=0,Math.abs(i.x)>Math.abs(i.z)?t.set(-i.y,i.x,0):t.set(0,-i.z,i.y)):t.crossVectors(i,r),this._x=t.x,this._y=t.y,this._z=t.z,this._w=e,this.normalize()}}(),inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this.onChangeCallback(),this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){var n=e._x,i=e._y,r=e._z,o=e._w,s=t._x,a=t._y,l=t._z,u=t._w;return this._x=n*u+o*s+i*l-r*a,this._y=i*u+o*a+r*s-n*l,this._z=r*u+o*l+n*a-i*s,this._w=o*u-n*s-i*a-r*l,this.onChangeCallback(),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var n=this._x,i=this._y,r=this._z,o=this._w,s=o*e._w+n*e._x+i*e._y+r*e._z;if(s<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,s=-s):this.copy(e),s>=1)return this._w=o,this._x=n,this._y=i,this._z=r,this;var a=Math.sqrt(1-s*s);if(Math.abs(a)<.001)return this._w=.5*(o+this._w),this._x=.5*(n+this._x),this._y=.5*(i+this._y),this._z=.5*(r+this._z),this;var l=Math.atan2(a,s),u=Math.sin((1-t)*l)/a,c=Math.sin(t*l)/a;return this._w=o*u+this._w*c,this._x=n*u+this._x*c,this._y=i*u+this._y*c,this._z=r*u+this._z*c,this.onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(Nt.prototype,{isVector3:!0,set:function(e,t,n){return this.x=e,this.y=t,this.z=n,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:function(){var e=new It;return function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(e.setFromEuler(t))}}(),applyAxisAngle:function(){var e=new It;return function(t,n){return this.applyQuaternion(e.setFromAxisAngle(t,n))}}(),applyMatrix3:function(e){var t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6]*i,this.y=r[1]*t+r[4]*n+r[7]*i,this.z=r[2]*t+r[5]*n+r[8]*i,this},applyMatrix4:function(e){var t=this.x,n=this.y,i=this.z,r=e.elements,o=1/(r[3]*t+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*t+r[4]*n+r[8]*i+r[12])*o,this.y=(r[1]*t+r[5]*n+r[9]*i+r[13])*o,this.z=(r[2]*t+r[6]*n+r[10]*i+r[14])*o,this},applyQuaternion:function(e){var t=this.x,n=this.y,i=this.z,r=e.x,o=e.y,s=e.z,a=e.w,l=a*t+o*i-s*n,u=a*n+s*t-r*i,c=a*i+r*n-o*t,h=-r*t-o*n-s*i;return this.x=l*a+h*-r+u*-s-c*-o,this.y=u*a+h*-o+c*-r-l*-s,this.z=c*a+h*-s+l*-o-u*-r,this},project:function(){var e=new Dt;return function(t){return e.multiplyMatrices(t.projectionMatrix,e.getInverse(t.matrixWorld)),this.applyMatrix4(e)}}(),unproject:function(){var e=new Dt;return function(t){return e.multiplyMatrices(t.matrixWorld,e.getInverse(t.projectionMatrix)),this.applyMatrix4(e)}}(),transformDirection:function(e){var t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*i,this.y=r[1]*t+r[5]*n+r[9]*i,this.z=r[2]*t+r[6]*n+r[10]*i,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},clampScalar:function(){var e=new Nt,t=new Nt;return function(n,i){return e.set(n,n,n),t.set(i,i,i),this.clamp(e,t)}}(),clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},cross:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)},crossVectors:function(e,t){var n=e.x,i=e.y,r=e.z,o=t.x,s=t.y,a=t.z;return this.x=i*a-r*s,this.y=r*o-n*a,this.z=n*s-i*o,this},projectOnVector:function(e){var t=e.dot(this)/e.lengthSq();return this.copy(e).multiplyScalar(t)},projectOnPlane:function(){var e=new Nt;return function(t){return e.copy(this).projectOnVector(t),this.sub(e)}}(),reflect:function(){var e=new Nt;return function(t){return this.sub(e.copy(t).multiplyScalar(2*this.dot(t)))}}(),angleTo:function(e){var t=this.dot(e)/Math.sqrt(this.lengthSq()*e.lengthSq());return Math.acos(Lt.clamp(t,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return t*t+n*n+i*i},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){var t=Math.sin(e.phi)*e.radius;return this.x=t*Math.sin(e.theta),this.y=Math.cos(e.phi)*e.radius,this.z=t*Math.cos(e.theta),this},setFromCylindrical:function(e){return this.x=e.radius*Math.sin(e.theta),this.y=e.y,this.z=e.radius*Math.cos(e.theta),this},setFromMatrixPosition:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(e){var t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=i,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,4*t)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}}),Object.assign(kt.prototype,{isMatrix3:!0,set:function(e,t,n,i,r,o,s,a,l){var u=this.elements;return u[0]=e,u[1]=i,u[2]=s,u[3]=t,u[4]=r,u[5]=a,u[6]=n,u[7]=o,u[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this},setFromMatrix4:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},applyToBufferAttribute:function(){var e=new Nt;return function(t){for(var n=0,i=t.count;n<i;n++)e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.applyMatrix3(this),t.setXYZ(n,e.x,e.y,e.z);return t}}(),multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var n=e.elements,i=t.elements,r=this.elements,o=n[0],s=n[3],a=n[6],l=n[1],u=n[4],c=n[7],h=n[2],d=n[5],p=n[8],f=i[0],m=i[3],g=i[6],v=i[1],y=i[4],x=i[7],b=i[2],w=i[5],_=i[8];return r[0]=o*f+s*v+a*b,r[3]=o*m+s*y+a*w,r[6]=o*g+s*x+a*_,r[1]=l*f+u*v+c*b,r[4]=l*m+u*y+c*w,r[7]=l*g+u*x+c*_,r[2]=h*f+d*v+p*b,r[5]=h*m+d*y+p*w,r[8]=h*g+d*x+p*_,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],o=e[4],s=e[5],a=e[6],l=e[7],u=e[8];return t*o*u-t*s*l-n*r*u+n*s*a+i*r*l-i*o*a},getInverse:function(e,t){e&&e.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var n=e.elements,i=this.elements,r=n[0],o=n[1],s=n[2],a=n[3],l=n[4],u=n[5],c=n[6],h=n[7],d=n[8],p=d*l-u*h,f=u*c-d*a,m=h*a-l*c,g=r*p+o*f+s*m;if(0===g){var v="THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(v);return console.warn(v),this.identity()}var y=1/g;return i[0]=p*y,i[1]=(s*h-d*o)*y,i[2]=(u*o-s*l)*y,i[3]=f*y,i[4]=(d*r-s*c)*y,i[5]=(s*a-u*r)*y,i[6]=m*y,i[7]=(o*c-h*r)*y,i[8]=(l*r-o*a)*y,this},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},setUvTransform:function(e,t,n,i,r,o,s){var a=Math.cos(r),l=Math.sin(r);this.set(n*a,n*l,-n*(a*o+l*s)+o+e,-i*l,i*a,-i*(-l*o+a*s)+s+t,0,0,1)},scale:function(e,t){var n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this},rotate:function(e){var t=Math.cos(e),n=Math.sin(e),i=this.elements,r=i[0],o=i[3],s=i[6],a=i[1],l=i[4],u=i[7];return i[0]=t*r+n*a,i[3]=t*o+n*l,i[6]=t*s+n*u,i[1]=-n*r+t*a,i[4]=-n*o+t*l,i[7]=-n*s+t*u,this},translate:function(e,t){var n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this},equals:function(e){for(var t=this.elements,n=e.elements,i=0;i<9;i++)if(t[i]!==n[i])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var n=0;n<9;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}});var Vt=0;function Ut(e,t,n,i,r,o,s,a,l,u){Object.defineProperty(this,"id",{value:Vt++}),this.uuid=Lt.generateUUID(),this.name="",this.image=void 0!==e?e:Ut.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==t?t:Ut.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:fe,this.wrapT=void 0!==i?i:fe,this.magFilter=void 0!==r?r:xe,this.minFilter=void 0!==o?o:we,this.anisotropy=void 0!==l?l:1,this.format=void 0!==s?s:ke,this.type=void 0!==a?a:_e,this.offset=new Ot(0,0),this.repeat=new Ot(1,1),this.center=new Ot(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new kt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==u?u:_t,this.version=0,this.onUpdate=null}function Ft(e,t,n,i){this.x=e||0,this.y=t||0,this.z=n||0,this.w=void 0!==i?i:1}function zt(e,t,n){this.width=e,this.height=t,this.scissor=new Ft(0,0,e,t),this.scissorTest=!1,this.viewport=new Ft(0,0,e,t),n=n||{},void 0===n.minFilter&&(n.minFilter=xe),this.texture=new Ut(void 0,void 0,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}function jt(e,t,n){zt.call(this,e,t,n),this.activeCubeFace=0,this.activeMipMapLevel=0}function Bt(e,t,n,i,r,o,s,a,l,u,c,h){Ut.call(this,null,o,s,a,l,u,i,r,c,h),this.image={data:e,width:t,height:n},this.magFilter=void 0!==l?l:ge,this.minFilter=void 0!==u?u:ge,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}function $t(e,t){this.min=void 0!==e?e:new Nt(1/0,1/0,1/0),this.max=void 0!==t?t:new Nt(-1/0,-1/0,-1/0)}function Ht(e,t){this.center=void 0!==e?e:new Nt,this.radius=void 0!==t?t:0}function Gt(e,t){this.normal=void 0!==e?e:new Nt(1,0,0),this.constant=void 0!==t?t:0}function Wt(e,t,n,i,r,o){this.planes=[void 0!==e?e:new Gt,void 0!==t?t:new Gt,void 0!==n?n:new Gt,void 0!==i?i:new Gt,void 0!==r?r:new Gt,void 0!==o?o:new Gt]}Ut.DEFAULT_IMAGE=void 0,Ut.DEFAULT_MAPPING=oe,Ut.prototype=Object.assign(Object.create(a.prototype),{constructor:Ut,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){var t=void 0===e||"string"===typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];function n(e){var t;if(e instanceof HTMLCanvasElement)t=e;else{t=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),t.width=e.width,t.height=e.height;var n=t.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height)}return t.width>2048||t.height>2048?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}var i={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var r=this.image;void 0===r.uuid&&(r.uuid=Lt.generateUUID()),t||void 0!==e.images[r.uuid]||(e.images[r.uuid]={uuid:r.uuid,url:n(r)}),i.image=r.uuid}return t||(e.textures[this.uuid]=i),i},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(this.mapping===oe){if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case pe:e.x=e.x-Math.floor(e.x);break;case fe:e.x=e.x<0?0:1;break;case me:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case pe:e.y=e.y-Math.floor(e.y);break;case fe:e.y=e.y<0?0:1;break;case me:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}this.flipY&&(e.y=1-e.y)}}}),Object.defineProperty(Ut.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(Ft.prototype,{isVector4:!0,set:function(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,n=this.y,i=this.z,r=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*i+o[12]*r,this.y=o[1]*t+o[5]*n+o[9]*i+o[13]*r,this.z=o[2]*t+o[6]*n+o[10]*i+o[14]*r,this.w=o[3]*t+o[7]*n+o[11]*i+o[15]*r,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,n,i,r,o=.01,s=.1,a=e.elements,l=a[0],u=a[4],c=a[8],h=a[1],d=a[5],p=a[9],f=a[2],m=a[6],g=a[10];if(Math.abs(u-h)<o&&Math.abs(c-f)<o&&Math.abs(p-m)<o){if(Math.abs(u+h)<s&&Math.abs(c+f)<s&&Math.abs(p+m)<s&&Math.abs(l+d+g-3)<s)return this.set(1,0,0,0),this;t=Math.PI;var v=(l+1)/2,y=(d+1)/2,x=(g+1)/2,b=(u+h)/4,w=(c+f)/4,_=(p+m)/4;return v>y&&v>x?v<o?(n=0,i=.707106781,r=.707106781):(n=Math.sqrt(v),i=b/n,r=w/n):y>x?y<o?(n=.707106781,i=0,r=.707106781):(i=Math.sqrt(y),n=b/i,r=_/i):x<o?(n=.707106781,i=.707106781,r=0):(r=Math.sqrt(x),n=w/r,i=_/r),this.set(n,i,r,t),this}var A=Math.sqrt((m-p)*(m-p)+(c-f)*(c-f)+(h-u)*(h-u));return Math.abs(A)<.001&&(A=1),this.x=(m-p)/A,this.y=(c-f)/A,this.z=(h-u)/A,this.w=Math.acos((l+d+g-1)/2),this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this},clampScalar:function(){var e,t;return function(n,i){return void 0===e&&(e=new Ft,t=new Ft),e.set(n,n,n,n),t.set(i,i,i,i),this.clamp(e,t)}}(),clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}}),zt.prototype=Object.assign(Object.create(a.prototype),{constructor:zt,isWebGLRenderTarget:!0,setSize:function(e,t){this.width===e&&this.height===t||(this.width=e,this.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),jt.prototype=Object.create(zt.prototype),jt.prototype.constructor=jt,jt.prototype.isWebGLRenderTargetCube=!0,Bt.prototype=Object.create(Ut.prototype),Bt.prototype.constructor=Bt,Bt.prototype.isDataTexture=!0,Object.assign($t.prototype,{isBox3:!0,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromArray:function(e){for(var t=1/0,n=1/0,i=1/0,r=-1/0,o=-1/0,s=-1/0,a=0,l=e.length;a<l;a+=3){var u=e[a],c=e[a+1],h=e[a+2];u<t&&(t=u),c<n&&(n=c),h<i&&(i=h),u>r&&(r=u),c>o&&(o=c),h>s&&(s=h)}return this.min.set(t,n,i),this.max.set(r,o,s),this},setFromBufferAttribute:function(e){for(var t=1/0,n=1/0,i=1/0,r=-1/0,o=-1/0,s=-1/0,a=0,l=e.count;a<l;a++){var u=e.getX(a),c=e.getY(a),h=e.getZ(a);u<t&&(t=u),c<n&&(n=c),h<i&&(i=h),u>r&&(r=u),c>o&&(o=c),h>s&&(s=h)}return this.min.set(t,n,i),this.max.set(r,o,s),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new Nt;return function(t,n){var i=e.copy(n).multiplyScalar(.5);return this.min.copy(t).sub(i),this.max.copy(t).add(i),this}}(),setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new Nt),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new Nt),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:function(){var e,t,n,i=new Nt;function r(r){var o=r.geometry;if(void 0!==o)if(o.isGeometry){var s=o.vertices;for(t=0,n=s.length;t<n;t++)i.copy(s[t]),i.applyMatrix4(r.matrixWorld),e.expandByPoint(i)}else if(o.isBufferGeometry){var a=o.attributes.position;if(void 0!==a)for(t=0,n=a.count;t<n;t++)i.fromBufferAttribute(a,t).applyMatrix4(r.matrixWorld),e.expandByPoint(i)}}return function(t){return e=this,t.updateMatrixWorld(!0),t.traverse(r),this}}(),containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .getParameter() target is now required"),t=new Nt),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:function(){var e=new Nt;return function(t){return this.clampPoint(t.center,e),e.distanceToSquared(t.center)<=t.radius*t.radius}}(),intersectsPlane:function(e){var t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=e.constant&&n>=e.constant},intersectsTriangle:function(){var e=new Nt,t=new Nt,n=new Nt,i=new Nt,r=new Nt,o=new Nt,s=new Nt,a=new Nt,l=new Nt,u=new Nt;function c(i){var r,o;for(r=0,o=i.length-3;r<=o;r+=3){s.fromArray(i,r);var a=l.x*Math.abs(s.x)+l.y*Math.abs(s.y)+l.z*Math.abs(s.z),u=e.dot(s),c=t.dot(s),h=n.dot(s);if(Math.max(-Math.max(u,c,h),Math.min(u,c,h))>a)return!1}return!0}return function(s){if(this.isEmpty())return!1;this.getCenter(a),l.subVectors(this.max,a),e.subVectors(s.a,a),t.subVectors(s.b,a),n.subVectors(s.c,a),i.subVectors(t,e),r.subVectors(n,t),o.subVectors(e,n);var h=[0,-i.z,i.y,0,-r.z,r.y,0,-o.z,o.y,i.z,0,-i.x,r.z,0,-r.x,o.z,0,-o.x,-i.y,i.x,0,-r.y,r.x,0,-o.y,o.x,0];return!!c(h)&&(h=[1,0,0,0,1,0,0,0,1],!!c(h)&&(u.crossVectors(i,r),h=[u.x,u.y,u.z],c(h)))}}(),clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .clampPoint() target is now required"),t=new Nt),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new Nt;return function(t){var n=e.copy(t).clamp(this.min,this.max);return n.sub(t).length()}}(),getBoundingSphere:function(){var e=new Nt;return function(t){return void 0===t&&(console.warn("THREE.Box3: .getBoundingSphere() target is now required"),t=new Ht),this.getCenter(t.center),t.radius=.5*this.getSize(e).length(),t}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(){var e=[new Nt,new Nt,new Nt,new Nt,new Nt,new Nt,new Nt,new Nt];return function(t){return this.isEmpty()||(e[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),e[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),e[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),e[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),e[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),e[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),e[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),e[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(e)),this}}(),translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),Object.assign(Ht.prototype,{set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:function(){var e=new $t;return function(t,n){var i=this.center;void 0!==n?i.copy(n):e.setFromPoints(t).getCenter(i);for(var r=0,o=0,s=t.length;o<s;o++)r=Math.max(r,i.distanceToSquared(t[o]));return this.radius=Math.sqrt(r),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},clampPoint:function(e,t){var n=this.center.distanceToSquared(e);return void 0===t&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),t=new Nt),t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t},getBoundingBox:function(e){return void 0===e&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new $t),e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}}),Object.assign(Gt.prototype,{set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,n,i){return this.normal.set(e,t,n),this.constant=i,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(){var e=new Nt,t=new Nt;return function(n,i,r){var o=e.subVectors(r,i).cross(t.subVectors(n,i)).normalize();return this.setFromNormalAndCoplanarPoint(o,n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return void 0===t&&(console.warn("THREE.Plane: .projectPoint() target is now required"),t=new Nt),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:function(){var e=new Nt;return function(t,n){void 0===n&&(console.warn("THREE.Plane: .intersectLine() target is now required"),n=new Nt);var i=t.delta(e),r=this.normal.dot(i);if(0===r)return 0===this.distanceToPoint(t.start)?n.copy(t.start):void 0;var o=-(t.start.dot(this.normal)+this.constant)/r;return o<0||o>1?void 0:n.copy(i).multiplyScalar(o).add(t.start)}}(),intersectsLine:function(e){var t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return void 0===e&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new Nt),e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var e=new Nt,t=new kt;return function(n,i){var r=i||t.getNormalMatrix(n),o=this.coplanarPoint(e).applyMatrix4(n),s=this.normal.applyMatrix3(r).normalize();return this.constant=-o.dot(s),this}}(),translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}}),Object.assign(Wt.prototype,{set:function(e,t,n,i,r,o){var s=this.planes;return s[0].copy(e),s[1].copy(t),s[2].copy(n),s[3].copy(i),s[4].copy(r),s[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){for(var t=this.planes,n=0;n<6;n++)t[n].copy(e.planes[n]);return this},setFromMatrix:function(e){var t=this.planes,n=e.elements,i=n[0],r=n[1],o=n[2],s=n[3],a=n[4],l=n[5],u=n[6],c=n[7],h=n[8],d=n[9],p=n[10],f=n[11],m=n[12],g=n[13],v=n[14],y=n[15];return t[0].setComponents(s-i,c-a,f-h,y-m).normalize(),t[1].setComponents(s+i,c+a,f+h,y+m).normalize(),t[2].setComponents(s+r,c+l,f+d,y+g).normalize(),t[3].setComponents(s-r,c-l,f-d,y-g).normalize(),t[4].setComponents(s-o,c-u,f-p,y-v).normalize(),t[5].setComponents(s+o,c+u,f+p,y+v).normalize(),this},intersectsObject:function(){var e=new Ht;return function(t){var n=t.geometry;return null===n.boundingSphere&&n.computeBoundingSphere(),e.copy(n.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(e)}}(),intersectsSprite:function(){var e=new Ht;return function(t){return e.center.set(0,0,0),e.radius=.7071067811865476,e.applyMatrix4(t.matrixWorld),this.intersectsSphere(e)}}(),intersectsSphere:function(e){for(var t=this.planes,n=e.center,i=-e.radius,r=0;r<6;r++){var o=t[r].distanceToPoint(n);if(o<i)return!1}return!0},intersectsBox:function(){var e=new Nt,t=new Nt;return function(n){for(var i=this.planes,r=0;r<6;r++){var o=i[r];e.x=o.normal.x>0?n.min.x:n.max.x,t.x=o.normal.x>0?n.max.x:n.min.x,e.y=o.normal.y>0?n.min.y:n.max.y,t.y=o.normal.y>0?n.max.y:n.min.y,e.z=o.normal.z>0?n.min.z:n.max.z,t.z=o.normal.z>0?n.max.z:n.min.z;var s=o.distanceToPoint(e),a=o.distanceToPoint(t);if(s<0&&a<0)return!1}return!0}}(),containsPoint:function(e){for(var t=this.planes,n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}});var qt="#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",Yt="#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",Xt="#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",Zt="#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",Jt="#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",Kt="\nvec3 transformed = vec3( position );\n",Qt="\nvec3 objectNormal = vec3( normal );\n",en="float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t}\n\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",tn="#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",nn="#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif\n",rn="#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",on="#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",sn="#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",an="#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",ln="#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",un="#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",cn="#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",hn="#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\n",dn="#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",pn="vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n",fn="#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",mn="#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",gn="#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",vn="#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",yn="  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",xn="\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM            = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat D      = max( maxRange / maxRGB, 1.0 );\n\tD            = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract(Le);\n\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max(vRGB, 0.0), 1.0 );\n}\n",bn="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",wn="#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",_n="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",An="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",Sn="\n#ifdef USE_FOG\nfogDepth = -mvPosition.z;\n#endif",En="#ifdef USE_FOG\n  varying float fogDepth;\n#endif\n",Mn="#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",Tn="#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif\n",Cn="#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n",Pn="#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",Rn="#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",Ln="vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",On="uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n",Dn="#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",In="BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",Nn="varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",kn="PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",Vn="struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",Un="\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearCoatRadiance = vec3( 0.0 );\n#endif\n",Fn="#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), maxMipLevel );\n\t#ifndef STANDARD\n\t\tclearCoatRadiance += getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\n\t#endif\n#endif\n",zn="#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",jn="#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",Bn="#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",$n="#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",Hn="#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif\n",Gn="#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",Wn="#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",qn="#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",Yn="#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif\n",Xn="float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif\n",Zn="#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",Jn="#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",Kn="#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",Qn="#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",ei="#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n#endif\n",ti="#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",ni="#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\t\tscale *= float( gl_FrontFacing ) * 2.0 - 1.0;\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n",ii="vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",ri="#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",oi="vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n",si="#if defined( DITHERING )\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif\n",ai="#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif\n",li="float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif\n",ui="#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",ci="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",hi="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",di="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",pi="float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",fi="#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",mi="#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",gi="#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif\n",vi="#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",yi="float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",xi="#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",bi="#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",wi="#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",_i="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",Ai="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\n",Si="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",Ei="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",Mi="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",Ti="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",Ci="#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif\n",Pi="uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n",Ri="varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}\n",Li="#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",Oi="#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",Di="#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}\n",Ii="#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}\n",Ni="uniform sampler2D tEquirect;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",ki="varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",Vi="uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",Ui="uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n",Fi="uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",zi="#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}\n",ji="uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_pars_maps>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",Bi="#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_pars_maps>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",$i="#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_pars_maps>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",Hi="#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",Gi="#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars_begin>\n#include <lights_pars_maps>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",Wi="#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",qi="#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}\n",Yi="#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n",Xi="uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",Zi="uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",Ji="uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}\n",Ki="#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",Qi={alphamap_fragment:qt,alphamap_pars_fragment:Yt,alphatest_fragment:Xt,aomap_fragment:Zt,aomap_pars_fragment:Jt,begin_vertex:Kt,beginnormal_vertex:Qt,bsdfs:en,bumpmap_pars_fragment:tn,clipping_planes_fragment:nn,clipping_planes_pars_fragment:rn,clipping_planes_pars_vertex:on,clipping_planes_vertex:sn,color_fragment:an,color_pars_fragment:ln,color_pars_vertex:un,color_vertex:cn,common:hn,cube_uv_reflection_fragment:dn,defaultnormal_vertex:pn,displacementmap_pars_vertex:fn,displacementmap_vertex:mn,emissivemap_fragment:gn,emissivemap_pars_fragment:vn,encodings_fragment:yn,encodings_pars_fragment:xn,envmap_fragment:bn,envmap_pars_fragment:wn,envmap_pars_vertex:_n,envmap_vertex:An,fog_vertex:Sn,fog_pars_vertex:En,fog_fragment:Mn,fog_pars_fragment:Tn,gradientmap_pars_fragment:Cn,lightmap_fragment:Pn,lightmap_pars_fragment:Rn,lights_lambert_vertex:Ln,lights_pars_begin:On,lights_pars_maps:Dn,lights_phong_fragment:In,lights_phong_pars_fragment:Nn,lights_physical_fragment:kn,lights_physical_pars_fragment:Vn,lights_fragment_begin:Un,lights_fragment_maps:Fn,lights_fragment_end:zn,logdepthbuf_fragment:jn,logdepthbuf_pars_fragment:Bn,logdepthbuf_pars_vertex:$n,logdepthbuf_vertex:Hn,map_fragment:Gn,map_pars_fragment:Wn,map_particle_fragment:qn,map_particle_pars_fragment:Yn,metalnessmap_fragment:Xn,metalnessmap_pars_fragment:Zn,morphnormal_vertex:Jn,morphtarget_pars_vertex:Kn,morphtarget_vertex:Qn,normal_fragment_begin:ei,normal_fragment_maps:ti,normalmap_pars_fragment:ni,packing:ii,premultiplied_alpha_fragment:ri,project_vertex:oi,dithering_fragment:si,dithering_pars_fragment:ai,roughnessmap_fragment:li,roughnessmap_pars_fragment:ui,shadowmap_pars_fragment:ci,shadowmap_pars_vertex:hi,shadowmap_vertex:di,shadowmask_pars_fragment:pi,skinbase_vertex:fi,skinning_pars_vertex:mi,skinning_vertex:gi,skinnormal_vertex:vi,specularmap_fragment:yi,specularmap_pars_fragment:xi,tonemapping_fragment:bi,tonemapping_pars_fragment:wi,uv_pars_fragment:_i,uv_pars_vertex:Ai,uv_vertex:Si,uv2_pars_fragment:Ei,uv2_pars_vertex:Mi,uv2_vertex:Ti,worldpos_vertex:Ci,cube_frag:Pi,cube_vert:Ri,depth_frag:Li,depth_vert:Oi,distanceRGBA_frag:Di,distanceRGBA_vert:Ii,equirect_frag:Ni,equirect_vert:ki,linedashed_frag:Vi,linedashed_vert:Ui,meshbasic_frag:Fi,meshbasic_vert:zi,meshlambert_frag:ji,meshlambert_vert:Bi,meshphong_frag:$i,meshphong_vert:Hi,meshphysical_frag:Gi,meshphysical_vert:Wi,normal_frag:qi,normal_vert:Yi,points_frag:Xi,points_vert:Zi,shadow_frag:Ji,shadow_vert:Ki},er={merge:function(e){for(var t={},n=0;n<e.length;n++){var i=this.clone(e[n]);for(var r in i)t[r]=i[r]}return t},clone:function(e){var t={};for(var n in e)for(var i in t[n]={},e[n]){var r=e[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture)?t[n][i]=r.clone():Array.isArray(r)?t[n][i]=r.slice():t[n][i]=r}return t}},tr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function nr(e,t,n){return void 0===t&&void 0===n?this.set(e):this.setRGB(e,t,n)}Object.assign(nr.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):"number"===typeof e?this.setHex(e):"string"===typeof e&&this.setStyle(e),this},setScalar:function(e){return this.r=e,this.g=e,this.b=e,this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},setRGB:function(e,t,n){return this.r=e,this.g=t,this.b=n,this},setHSL:function(){function e(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}return function(t,n,i){if(t=Lt.euclideanModulo(t,1),n=Lt.clamp(n,0,1),i=Lt.clamp(i,0,1),0===n)this.r=this.g=this.b=i;else{var r=i<=.5?i*(1+n):i+n-i*n,o=2*i-r;this.r=e(o,r,t+1/3),this.g=e(o,r,t),this.b=e(o,r,t-1/3)}return this}}(),setStyle:function(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var i,r=n[1],o=n[2];switch(r){case"rgb":case"rgba":if(i=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(i[1],10))/255,this.g=Math.min(255,parseInt(i[2],10))/255,this.b=Math.min(255,parseInt(i[3],10))/255,t(i[5]),this;if(i=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(i[1],10))/100,this.g=Math.min(100,parseInt(i[2],10))/100,this.b=Math.min(100,parseInt(i[3],10))/100,t(i[5]),this;break;case"hsl":case"hsla":if(i=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o)){var s=parseFloat(i[1])/360,a=parseInt(i[2],10)/100,l=parseInt(i[3],10)/100;return t(i[5]),this.setHSL(s,a,l)}break}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(e)){var u=n[1],c=u.length;if(3===c)return this.r=parseInt(u.charAt(0)+u.charAt(0),16)/255,this.g=parseInt(u.charAt(1)+u.charAt(1),16)/255,this.b=parseInt(u.charAt(2)+u.charAt(2),16)/255,this;if(6===c)return this.r=parseInt(u.charAt(0)+u.charAt(1),16)/255,this.g=parseInt(u.charAt(2)+u.charAt(3),16)/255,this.b=parseInt(u.charAt(4)+u.charAt(5),16)/255,this}if(e&&e.length>0){u=tr[e];void 0!==u?this.setHex(u):console.warn("THREE.Color: Unknown color "+e)}return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return void 0===t&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){void 0===t&&(t=2);var n=t>0?1/t:1;return this.r=Math.pow(e.r,n),this.g=Math.pow(e.g,n),this.b=Math.pow(e.b,n),this},convertGammaToLinear:function(){var e=this.r,t=this.g,n=this.b;return this.r=e*e,this.g=t*t,this.b=n*n,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){void 0===e&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});var t,n,i=this.r,r=this.g,o=this.b,s=Math.max(i,r,o),a=Math.min(i,r,o),l=(a+s)/2;if(a===s)t=0,n=0;else{var u=s-a;switch(n=l<=.5?u/(s+a):u/(2-s-a),s){case i:t=(r-o)/u+(r<o?6:0);break;case r:t=(o-i)/u+2;break;case o:t=(i-r)/u+4;break}t/=6}return e.h=t,e.s=n,e.l=l,e},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(){var e={};return function(t,n,i){return this.getHSL(e),e.h+=t,e.s+=n,e.l+=i,this.setHSL(e.h,e.s,e.l),this}}(),add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){return void 0===t&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},toJSON:function(){return this.getHex()}});var ir={common:{diffuse:{value:new nr(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new kt},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Ot(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new nr(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new nr(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new kt}}},rr={basic:{uniforms:er.merge([ir.common,ir.specularmap,ir.envmap,ir.aomap,ir.lightmap,ir.fog]),vertexShader:Qi.meshbasic_vert,fragmentShader:Qi.meshbasic_frag},lambert:{uniforms:er.merge([ir.common,ir.specularmap,ir.envmap,ir.aomap,ir.lightmap,ir.emissivemap,ir.fog,ir.lights,{emissive:{value:new nr(0)}}]),vertexShader:Qi.meshlambert_vert,fragmentShader:Qi.meshlambert_frag},phong:{uniforms:er.merge([ir.common,ir.specularmap,ir.envmap,ir.aomap,ir.lightmap,ir.emissivemap,ir.bumpmap,ir.normalmap,ir.displacementmap,ir.gradientmap,ir.fog,ir.lights,{emissive:{value:new nr(0)},specular:{value:new nr(1118481)},shininess:{value:30}}]),vertexShader:Qi.meshphong_vert,fragmentShader:Qi.meshphong_frag},standard:{uniforms:er.merge([ir.common,ir.envmap,ir.aomap,ir.lightmap,ir.emissivemap,ir.bumpmap,ir.normalmap,ir.displacementmap,ir.roughnessmap,ir.metalnessmap,ir.fog,ir.lights,{emissive:{value:new nr(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:Qi.meshphysical_vert,fragmentShader:Qi.meshphysical_frag},points:{uniforms:er.merge([ir.points,ir.fog]),vertexShader:Qi.points_vert,fragmentShader:Qi.points_frag},dashed:{uniforms:er.merge([ir.common,ir.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Qi.linedashed_vert,fragmentShader:Qi.linedashed_frag},depth:{uniforms:er.merge([ir.common,ir.displacementmap]),vertexShader:Qi.depth_vert,fragmentShader:Qi.depth_frag},normal:{uniforms:er.merge([ir.common,ir.bumpmap,ir.normalmap,ir.displacementmap,{opacity:{value:1}}]),vertexShader:Qi.normal_vert,fragmentShader:Qi.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Qi.cube_vert,fragmentShader:Qi.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Qi.equirect_vert,fragmentShader:Qi.equirect_frag},distanceRGBA:{uniforms:er.merge([ir.common,ir.displacementmap,{referencePosition:{value:new Nt},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Qi.distanceRGBA_vert,fragmentShader:Qi.distanceRGBA_frag},shadow:{uniforms:er.merge([ir.lights,ir.fog,{color:{value:new nr(0)},opacity:{value:1}}]),vertexShader:Qi.shadow_vert,fragmentShader:Qi.shadow_frag}};function or(e){var t=new WeakMap;function n(t,n){var i=t.array,r=t.dynamic?e.DYNAMIC_DRAW:e.STATIC_DRAW,o=e.createBuffer();e.bindBuffer(n,o),e.bufferData(n,i,r),t.onUploadCallback();var s=e.FLOAT;return i instanceof Float32Array?s=e.FLOAT:i instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):i instanceof Uint16Array?s=e.UNSIGNED_SHORT:i instanceof Int16Array?s=e.SHORT:i instanceof Uint32Array?s=e.UNSIGNED_INT:i instanceof Int32Array?s=e.INT:i instanceof Int8Array?s=e.BYTE:i instanceof Uint8Array&&(s=e.UNSIGNED_BYTE),{buffer:o,type:s,bytesPerElement:i.BYTES_PER_ELEMENT,version:t.version}}function i(t,n,i){var r=n.array,o=n.updateRange;e.bindBuffer(i,t),!1===n.dynamic?e.bufferData(i,r,e.STATIC_DRAW):-1===o.count?e.bufferSubData(i,0,r):0===o.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(e.bufferSubData(i,o.offset*r.BYTES_PER_ELEMENT,r.subarray(o.offset,o.offset+o.count)),o.count=-1)}function r(e){return e.isInterleavedBufferAttribute&&(e=e.data),t.get(e)}function o(n){n.isInterleavedBufferAttribute&&(n=n.data);var i=t.get(n);i&&(e.deleteBuffer(i.buffer),t.delete(n))}function s(e,r){e.isInterleavedBufferAttribute&&(e=e.data);var o=t.get(e);void 0===o?t.set(e,n(e,r)):o.version<e.version&&(i(o.buffer,e,r),o.version=e.version)}return{get:r,remove:o,update:s}}function sr(e,t,n,i){this._x=e||0,this._y=t||0,this._z=n||0,this._order=i||sr.DefaultOrder}function ar(){this.mask=1}rr.physical={uniforms:er.merge([rr.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:Qi.meshphysical_vert,fragmentShader:Qi.meshphysical_frag},sr.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],sr.DefaultOrder="XYZ",Object.defineProperties(sr.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this.onChangeCallback()}}}),Object.assign(sr.prototype,{isEuler:!0,set:function(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._order=i||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this.onChangeCallback(),this},setFromRotationMatrix:function(e,t,n){var i=Lt.clamp,r=e.elements,o=r[0],s=r[4],a=r[8],l=r[1],u=r[5],c=r[9],h=r[2],d=r[6],p=r[10];return t=t||this._order,"XYZ"===t?(this._y=Math.asin(i(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(-c,p),this._z=Math.atan2(-s,o)):(this._x=Math.atan2(d,u),this._z=0)):"YXZ"===t?(this._x=Math.asin(-i(c,-1,1)),Math.abs(c)<.99999?(this._y=Math.atan2(a,p),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-h,o),this._z=0)):"ZXY"===t?(this._x=Math.asin(i(d,-1,1)),Math.abs(d)<.99999?(this._y=Math.atan2(-h,p),this._z=Math.atan2(-s,u)):(this._y=0,this._z=Math.atan2(l,o))):"ZYX"===t?(this._y=Math.asin(-i(h,-1,1)),Math.abs(h)<.99999?(this._x=Math.atan2(d,p),this._z=Math.atan2(l,o)):(this._x=0,this._z=Math.atan2(-s,u))):"YZX"===t?(this._z=Math.asin(i(l,-1,1)),Math.abs(l)<.99999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(a,p))):"XZY"===t?(this._z=Math.asin(-i(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(d,u),this._y=Math.atan2(a,o)):(this._x=Math.atan2(-c,p),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+t),this._order=t,!1!==n&&this.onChangeCallback(),this},setFromQuaternion:function(){var e=new Dt;return function(t,n,i){return e.makeRotationFromQuaternion(t),this.setFromRotationMatrix(e,n,i)}}(),setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:function(){var e=new It;return function(t){return e.setFromEuler(this),this.setFromQuaternion(e,t)}}(),equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new Nt(this._x,this._y,this._z)},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(ar.prototype,{set:function(e){this.mask=1<<e|0},enable:function(e){this.mask|=1<<e|0},toggle:function(e){this.mask^=1<<e|0},disable:function(e){this.mask&=~(1<<e|0)},test:function(e){return 0!==(this.mask&e.mask)}});var lr=0;function ur(){Object.defineProperty(this,"id",{value:lr++}),this.uuid=Lt.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ur.DefaultUp.clone();var e=new Nt,t=new sr,n=new It,i=new Nt(1,1,1);function r(){n.setFromEuler(t,!1)}function o(){t.setFromQuaternion(n,void 0,!1)}t.onChange(r),n.onChange(o),Object.defineProperties(this,{position:{enumerable:!0,value:e},rotation:{enumerable:!0,value:t},quaternion:{enumerable:!0,value:n},scale:{enumerable:!0,value:i},modelViewMatrix:{value:new Dt},normalMatrix:{value:new kt}}),this.matrix=new Dt,this.matrixWorld=new Dt,this.matrixAutoUpdate=ur.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new ar,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function cr(){ur.call(this),this.type="Camera",this.matrixWorldInverse=new Dt,this.projectionMatrix=new Dt}function hr(e,t,n,i,r,o){cr.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=i,this.near=void 0!==r?r:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()}function dr(e,t,n,i,r,o){this.a=e,this.b=t,this.c=n,this.normal=i&&i.isVector3?i:new Nt,this.vertexNormals=Array.isArray(i)?i:[],this.color=r&&r.isColor?r:new nr,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=void 0!==o?o:0}ur.DefaultUp=new Nt(0,1,0),ur.DefaultMatrixAutoUpdate=!0,ur.prototype=Object.assign(Object.create(a.prototype),{constructor:ur,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(e){this.matrix.multiplyMatrices(e,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(){var e=new It;return function(t,n){return e.setFromAxisAngle(t,n),this.quaternion.multiply(e),this}}(),rotateOnWorldAxis:function(){var e=new It;return function(t,n){return e.setFromAxisAngle(t,n),this.quaternion.premultiply(e),this}}(),rotateX:function(){var e=new Nt(1,0,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateY:function(){var e=new Nt(0,1,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateZ:function(){var e=new Nt(0,0,1);return function(t){return this.rotateOnAxis(e,t)}}(),translateOnAxis:function(){var e=new Nt;return function(t,n){return e.copy(t).applyQuaternion(this.quaternion),this.position.add(e.multiplyScalar(n)),this}}(),translateX:function(){var e=new Nt(1,0,0);return function(t){return this.translateOnAxis(e,t)}}(),translateY:function(){var e=new Nt(0,1,0);return function(t){return this.translateOnAxis(e,t)}}(),translateZ:function(){var e=new Nt(0,0,1);return function(t){return this.translateOnAxis(e,t)}}(),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var e=new Dt;return function(t){return t.applyMatrix4(e.getInverse(this.matrixWorld))}}(),lookAt:function(){var e=new Dt,t=new Nt;return function(n,i,r){n.isVector3?t.copy(n):t.set(n,i,r),this.isCamera?e.lookAt(this.position,t,this.up):e.lookAt(t,this.position,this.up),this.quaternion.setFromRotationMatrix(e)}}(),add:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,e.dispatchEvent({type:"added"}),this.children.push(e)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var n=this.children.indexOf(e);return-1!==n&&(e.parent=null,e.dispatchEvent({type:"removed"}),this.children.splice(n,1)),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var n=0,i=this.children.length;n<i;n++){var r=this.children[n],o=r.getObjectByProperty(e,t);if(void 0!==o)return o}},getWorldPosition:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new Nt),this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var e=new Nt,t=new Nt;return function(n){return void 0===n&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),n=new It),this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,n,t),n}}(),getWorldScale:function(){var e=new Nt,t=new It;return function(n){return void 0===n&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),n=new Nt),this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,t,n),n}}(),getWorldDirection:function(){var e=new It;return function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new Nt),this.getWorldQuaternion(e),t.set(0,0,1).applyQuaternion(e)}}(),raycast:function(){},traverse:function(e){e(this);for(var t=this.children,n=0,i=t.length;n<i;n++)t[n].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);for(var t=this.children,n=0,i=t.length;n<i;n++)t[n].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,n=0,i=t.length;n<i;n++)t[n].updateMatrixWorld(e)},toJSON:function(e){var t=void 0===e||"string"===typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var i={};function r(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),!0===this.castShadow&&(i.castShadow=!0),!0===this.receiveShadow&&(i.receiveShadow=!0),!1===this.visible&&(i.visible=!1),!1===this.frustumCulled&&(i.frustumCulled=!1),0!==this.renderOrder&&(i.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),i.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(i.matrixAutoUpdate=!1),void 0!==this.geometry){i.geometry=r(e.geometries,this.geometry);var o=this.geometry.parameters;if(void 0!==o&&void 0!==o.shapes){var s=o.shapes;if(Array.isArray(s))for(var a=0,l=s.length;a<l;a++){var u=s[a];r(e.shapes,u)}else r(e.shapes,s)}}if(void 0!==this.material)if(Array.isArray(this.material)){var c=[];for(a=0,l=this.material.length;a<l;a++)c.push(r(e.materials,this.material[a]));i.material=c}else i.material=r(e.materials,this.material);if(this.children.length>0){i.children=[];for(a=0;a<this.children.length;a++)i.children.push(this.children[a].toJSON(e).object)}if(t){var h=m(e.geometries),d=m(e.materials),p=m(e.textures),f=m(e.images);s=m(e.shapes);h.length>0&&(n.geometries=h),d.length>0&&(n.materials=d),p.length>0&&(n.textures=p),f.length>0&&(n.images=f),s.length>0&&(n.shapes=s)}return n.object=i,n;function m(e){var t=[];for(var n in e){var i=e[n];delete i.metadata,t.push(i)}return t}},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e,t){if(void 0===t&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var n=0;n<e.children.length;n++){var i=e.children[n];this.add(i.clone())}return this}}),cr.prototype=Object.assign(Object.create(ur.prototype),{constructor:cr,isCamera:!0,copy:function(e,t){return ur.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this},getWorldDirection:function(){var e=new It;return function(t){return void 0===t&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),t=new Nt),this.getWorldQuaternion(e),t.set(0,0,-1).applyQuaternion(e)}}(),updateMatrixWorld:function(e){ur.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),hr.prototype=Object.assign(Object.create(cr.prototype),{constructor:hr,isOrthographicCamera:!0,copy:function(e,t){return cr.prototype.copy.call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this},setViewOffset:function(e,t,n,i,r,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2,r=n-e,o=n+e,s=i+t,a=i-t;if(null!==this.view&&this.view.enabled){var l=this.zoom/(this.view.width/this.view.fullWidth),u=this.zoom/(this.view.height/this.view.fullHeight),c=(this.right-this.left)/this.view.width,h=(this.top-this.bottom)/this.view.height;r+=c*(this.view.offsetX/l),o=r+c*(this.view.width/l),s-=h*(this.view.offsetY/u),a=s-h*(this.view.height/u)}this.projectionMatrix.makeOrthographic(r,o,s,a,this.near,this.far)},toJSON:function(e){var t=ur.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}),Object.assign(dr.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var t=0,n=e.vertexNormals.length;t<n;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(t=0,n=e.vertexColors.length;t<n;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}});var pr=0;function fr(){Object.defineProperty(this,"id",{value:pr+=2}),this.uuid=Lt.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function mr(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===n,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function gr(e,t,n){mr.call(this,new Int8Array(e),t,n)}function vr(e,t,n){mr.call(this,new Uint8Array(e),t,n)}function yr(e,t,n){mr.call(this,new Uint8ClampedArray(e),t,n)}function xr(e,t,n){mr.call(this,new Int16Array(e),t,n)}function br(e,t,n){mr.call(this,new Uint16Array(e),t,n)}function wr(e,t,n){mr.call(this,new Int32Array(e),t,n)}function _r(e,t,n){mr.call(this,new Uint32Array(e),t,n)}function Ar(e,t,n){mr.call(this,new Float32Array(e),t,n)}function Sr(e,t,n){mr.call(this,new Float64Array(e),t,n)}function Er(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function Mr(e){if(0===e.length)return-1/0;for(var t=e[0],n=1,i=e.length;n<i;++n)e[n]>t&&(t=e[n]);return t}fr.prototype=Object.assign(Object.create(a.prototype),{constructor:fr,isGeometry:!0,applyMatrix:function(e){for(var t=(new kt).getNormalMatrix(e),n=0,i=this.vertices.length;n<i;n++){var r=this.vertices[n];r.applyMatrix4(e)}for(n=0,i=this.faces.length;n<i;n++){var o=this.faces[n];o.normal.applyMatrix3(t).normalize();for(var s=0,a=o.vertexNormals.length;s<a;s++)o.vertexNormals[s].applyMatrix3(t).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var e=new Dt;return function(t){return e.makeRotationX(t),this.applyMatrix(e),this}}(),rotateY:function(){var e=new Dt;return function(t){return e.makeRotationY(t),this.applyMatrix(e),this}}(),rotateZ:function(){var e=new Dt;return function(t){return e.makeRotationZ(t),this.applyMatrix(e),this}}(),translate:function(){var e=new Dt;return function(t,n,i){return e.makeTranslation(t,n,i),this.applyMatrix(e),this}}(),scale:function(){var e=new Dt;return function(t,n,i){return e.makeScale(t,n,i),this.applyMatrix(e),this}}(),lookAt:function(){var e=new ur;return function(t){e.lookAt(t),e.updateMatrix(),this.applyMatrix(e.matrix)}}(),fromBufferGeometry:function(e){var t=this,n=null!==e.index?e.index.array:void 0,i=e.attributes,r=i.position.array,o=void 0!==i.normal?i.normal.array:void 0,s=void 0!==i.color?i.color.array:void 0,a=void 0!==i.uv?i.uv.array:void 0,l=void 0!==i.uv2?i.uv2.array:void 0;void 0!==l&&(this.faceVertexUvs[1]=[]);for(var u=[],c=[],h=[],d=0,p=0;d<r.length;d+=3,p+=2)t.vertices.push(new Nt(r[d],r[d+1],r[d+2])),void 0!==o&&u.push(new Nt(o[d],o[d+1],o[d+2])),void 0!==s&&t.colors.push(new nr(s[d],s[d+1],s[d+2])),void 0!==a&&c.push(new Ot(a[p],a[p+1])),void 0!==l&&h.push(new Ot(l[p],l[p+1]));function f(e,n,i,r){var d=void 0!==o?[u[e].clone(),u[n].clone(),u[i].clone()]:[],p=void 0!==s?[t.colors[e].clone(),t.colors[n].clone(),t.colors[i].clone()]:[],f=new dr(e,n,i,d,p,r);t.faces.push(f),void 0!==a&&t.faceVertexUvs[0].push([c[e].clone(),c[n].clone(),c[i].clone()]),void 0!==l&&t.faceVertexUvs[1].push([h[e].clone(),h[n].clone(),h[i].clone()])}var m=e.groups;if(m.length>0)for(d=0;d<m.length;d++)for(var g=m[d],v=g.start,y=g.count,x=(p=v,v+y);p<x;p+=3)void 0!==n?f(n[p],n[p+1],n[p+2],g.materialIndex):f(p,p+1,p+2,g.materialIndex);else if(void 0!==n)for(d=0;d<n.length;d+=3)f(n[d],n[d+1],n[d+2]);else for(d=0;d<r.length/3;d+=3)f(d,d+1,d+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){var e=new Nt;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(e).negate(),this.translate(e.x,e.y,e.z),this}}(),normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,t=this.boundingSphere.radius,n=0===t?1:1/t,i=new Dt;return i.set(n,0,0,-n*e.x,0,n,0,-n*e.y,0,0,n,-n*e.z,0,0,0,1),this.applyMatrix(i),this},computeFaceNormals:function(){for(var e=new Nt,t=new Nt,n=0,i=this.faces.length;n<i;n++){var r=this.faces[n],o=this.vertices[r.a],s=this.vertices[r.b],a=this.vertices[r.c];e.subVectors(a,s),t.subVectors(o,s),e.cross(t),e.normalize(),r.normal.copy(e)}},computeVertexNormals:function(e){var t,n,i,r,o,s;for(void 0===e&&(e=!0),s=new Array(this.vertices.length),t=0,n=this.vertices.length;t<n;t++)s[t]=new Nt;if(e){var a,l,u,c=new Nt,h=new Nt;for(i=0,r=this.faces.length;i<r;i++)o=this.faces[i],a=this.vertices[o.a],l=this.vertices[o.b],u=this.vertices[o.c],c.subVectors(u,l),h.subVectors(a,l),c.cross(h),s[o.a].add(c),s[o.b].add(c),s[o.c].add(c)}else for(this.computeFaceNormals(),i=0,r=this.faces.length;i<r;i++)o=this.faces[i],s[o.a].add(o.normal),s[o.b].add(o.normal),s[o.c].add(o.normal);for(t=0,n=this.vertices.length;t<n;t++)s[t].normalize();for(i=0,r=this.faces.length;i<r;i++){o=this.faces[i];var d=o.vertexNormals;3===d.length?(d[0].copy(s[o.a]),d[1].copy(s[o.b]),d[2].copy(s[o.c])):(d[0]=s[o.a].clone(),d[1]=s[o.b].clone(),d[2]=s[o.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var e,t,n;for(this.computeFaceNormals(),e=0,t=this.faces.length;e<t;e++){n=this.faces[e];var i=n.vertexNormals;3===i.length?(i[0].copy(n.normal),i[1].copy(n.normal),i[2].copy(n.normal)):(i[0]=n.normal.clone(),i[1]=n.normal.clone(),i[2]=n.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var e,t,n,i,r;for(n=0,i=this.faces.length;n<i;n++)for(r=this.faces[n],r.__originalFaceNormal?r.__originalFaceNormal.copy(r.normal):r.__originalFaceNormal=r.normal.clone(),r.__originalVertexNormals||(r.__originalVertexNormals=[]),e=0,t=r.vertexNormals.length;e<t;e++)r.__originalVertexNormals[e]?r.__originalVertexNormals[e].copy(r.vertexNormals[e]):r.__originalVertexNormals[e]=r.vertexNormals[e].clone();var o=new fr;for(o.faces=this.faces,e=0,t=this.morphTargets.length;e<t;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];var s=this.morphNormals[e].faceNormals,a=this.morphNormals[e].vertexNormals;for(n=0,i=this.faces.length;n<i;n++)l=new Nt,u={a:new Nt,b:new Nt,c:new Nt},s.push(l),a.push(u)}var l,u,c=this.morphNormals[e];for(o.vertices=this.morphTargets[e].vertices,o.computeFaceNormals(),o.computeVertexNormals(),n=0,i=this.faces.length;n<i;n++)r=this.faces[n],l=c.faceNormals[n],u=c.vertexNormals[n],l.copy(r.normal),u.a.copy(r.vertexNormals[0]),u.b.copy(r.vertexNormals[1]),u.c.copy(r.vertexNormals[2])}for(n=0,i=this.faces.length;n<i;n++)r=this.faces[n],r.normal=r.__originalFaceNormal,r.vertexNormals=r.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new $t),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Ht),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,n){if(e&&e.isGeometry){var i,r=this.vertices.length,o=this.vertices,s=e.vertices,a=this.faces,l=e.faces,u=this.faceVertexUvs[0],c=e.faceVertexUvs[0],h=this.colors,d=e.colors;void 0===n&&(n=0),void 0!==t&&(i=(new kt).getNormalMatrix(t));for(var p=0,f=s.length;p<f;p++){var m=s[p],g=m.clone();void 0!==t&&g.applyMatrix4(t),o.push(g)}for(p=0,f=d.length;p<f;p++)h.push(d[p].clone());for(p=0,f=l.length;p<f;p++){var v,y,x,b=l[p],w=b.vertexNormals,_=b.vertexColors;v=new dr(b.a+r,b.b+r,b.c+r),v.normal.copy(b.normal),void 0!==i&&v.normal.applyMatrix3(i).normalize();for(var A=0,S=w.length;A<S;A++)y=w[A].clone(),void 0!==i&&y.applyMatrix3(i).normalize(),v.vertexNormals.push(y);v.color.copy(b.color);for(A=0,S=_.length;A<S;A++)x=_[A],v.vertexColors.push(x.clone());v.materialIndex=b.materialIndex+n,a.push(v)}for(p=0,f=c.length;p<f;p++){var E=c[p],M=[];if(void 0!==E){for(A=0,S=E.length;A<S;A++)M.push(E[A].clone());u.push(M)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e)},mergeMesh:function(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)},mergeVertices:function(){var e,t,n,i,r,o,s,a,l={},u=[],c=[],h=4,d=Math.pow(10,h);for(n=0,i=this.vertices.length;n<i;n++)e=this.vertices[n],t=Math.round(e.x*d)+"_"+Math.round(e.y*d)+"_"+Math.round(e.z*d),void 0===l[t]?(l[t]=n,u.push(this.vertices[n]),c[n]=u.length-1):c[n]=c[l[t]];var p=[];for(n=0,i=this.faces.length;n<i;n++){r=this.faces[n],r.a=c[r.a],r.b=c[r.b],r.c=c[r.c],o=[r.a,r.b,r.c];for(var f=0;f<3;f++)if(o[f]===o[(f+1)%3]){p.push(n);break}}for(n=p.length-1;n>=0;n--){var m=p[n];for(this.faces.splice(m,1),s=0,a=this.faceVertexUvs.length;s<a;s++)this.faceVertexUvs[s].splice(m,1)}var g=this.vertices.length-u.length;return this.vertices=u,g},setFromPoints:function(e){this.vertices=[];for(var t=0,n=e.length;t<n;t++){var i=e[t];this.vertices.push(new Nt(i.x,i.y,i.z||0))}return this},sortFacesByMaterialIndex:function(){for(var e=this.faces,t=e.length,n=0;n<t;n++)e[n]._id=n;function i(e,t){return e.materialIndex-t.materialIndex}e.sort(i);var r,o,s=this.faceVertexUvs[0],a=this.faceVertexUvs[1];s&&s.length===t&&(r=[]),a&&a.length===t&&(o=[]);for(n=0;n<t;n++){var l=e[n]._id;r&&r.push(s[l]),o&&o.push(a[l])}r&&(this.faceVertexUvs[0]=r),o&&(this.faceVertexUvs[1]=o)},toJSON:function(){var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var t=this.parameters;for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}for(var i=[],r=0;r<this.vertices.length;r++){var o=this.vertices[r];i.push(o.x,o.y,o.z)}var s=[],a=[],l={},u=[],c={},h=[],d={};for(r=0;r<this.faces.length;r++){var p=this.faces[r],f=!0,m=!1,g=void 0!==this.faceVertexUvs[0][r],v=p.normal.length()>0,y=p.vertexNormals.length>0,x=1!==p.color.r||1!==p.color.g||1!==p.color.b,b=p.vertexColors.length>0,w=0;if(w=E(w,0,0),w=E(w,1,f),w=E(w,2,m),w=E(w,3,g),w=E(w,4,v),w=E(w,5,y),w=E(w,6,x),w=E(w,7,b),s.push(w),s.push(p.a,p.b,p.c),s.push(p.materialIndex),g){var _=this.faceVertexUvs[0][r];s.push(C(_[0]),C(_[1]),C(_[2]))}if(v&&s.push(M(p.normal)),y){var A=p.vertexNormals;s.push(M(A[0]),M(A[1]),M(A[2]))}if(x&&s.push(T(p.color)),b){var S=p.vertexColors;s.push(T(S[0]),T(S[1]),T(S[2]))}}function E(e,t,n){return n?e|1<<t:e&~(1<<t)}function M(e){var t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==l[t]||(l[t]=a.length/3,a.push(e.x,e.y,e.z)),l[t]}function T(e){var t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==c[t]||(c[t]=u.length,u.push(e.getHex())),c[t]}function C(e){var t=e.x.toString()+e.y.toString();return void 0!==d[t]||(d[t]=h.length/2,h.push(e.x,e.y)),d[t]}return e.data={},e.data.vertices=i,e.data.normals=a,u.length>0&&(e.data.colors=u),h.length>0&&(e.data.uvs=[h]),e.data.faces=s,e},clone:function(){return(new fr).copy(this)},copy:function(e){var t,n,i,r,o,s;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var a=e.vertices;for(t=0,n=a.length;t<n;t++)this.vertices.push(a[t].clone());var l=e.colors;for(t=0,n=l.length;t<n;t++)this.colors.push(l[t].clone());var u=e.faces;for(t=0,n=u.length;t<n;t++)this.faces.push(u[t].clone());for(t=0,n=e.faceVertexUvs.length;t<n;t++){var c=e.faceVertexUvs[t];for(void 0===this.faceVertexUvs[t]&&(this.faceVertexUvs[t]=[]),i=0,r=c.length;i<r;i++){var h=c[i],d=[];for(o=0,s=h.length;o<s;o++){var p=h[o];d.push(p.clone())}this.faceVertexUvs[t].push(d)}}var f=e.morphTargets;for(t=0,n=f.length;t<n;t++){var m={};if(m.name=f[t].name,void 0!==f[t].vertices)for(m.vertices=[],i=0,r=f[t].vertices.length;i<r;i++)m.vertices.push(f[t].vertices[i].clone());if(void 0!==f[t].normals)for(m.normals=[],i=0,r=f[t].normals.length;i<r;i++)m.normals.push(f[t].normals[i].clone());this.morphTargets.push(m)}var g=e.morphNormals;for(t=0,n=g.length;t<n;t++){var v={};if(void 0!==g[t].vertexNormals)for(v.vertexNormals=[],i=0,r=g[t].vertexNormals.length;i<r;i++){var y=g[t].vertexNormals[i],x={};x.a=y.a.clone(),x.b=y.b.clone(),x.c=y.c.clone(),v.vertexNormals.push(x)}if(void 0!==g[t].faceNormals)for(v.faceNormals=[],i=0,r=g[t].faceNormals.length;i<r;i++)v.faceNormals.push(g[t].faceNormals[i].clone());this.morphNormals.push(v)}var b=e.skinWeights;for(t=0,n=b.length;t<n;t++)this.skinWeights.push(b[t].clone());var w=e.skinIndices;for(t=0,n=w.length;t<n;t++)this.skinIndices.push(w[t].clone());var _=e.lineDistances;for(t=0,n=_.length;t<n;t++)this.lineDistances.push(_[t]);var A=e.boundingBox;null!==A&&(this.boundingBox=A.clone());var S=e.boundingSphere;return null!==S&&(this.boundingSphere=S.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(mr.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(mr.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");return this.count=void 0!==e?e.length/this.itemSize:0,this.array=e,this},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.dynamic=e.dynamic,this},copyAt:function(e,t,n){e*=this.itemSize,n*=t.itemSize;for(var i=0,r=this.itemSize;i<r;i++)this.array[e+i]=t.array[n+i];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var t=this.array,n=0,i=0,r=e.length;i<r;i++){var o=e[i];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),o=new nr),t[n++]=o.r,t[n++]=o.g,t[n++]=o.b}return this},copyVector2sArray:function(e){for(var t=this.array,n=0,i=0,r=e.length;i<r;i++){var o=e[i];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),o=new Ot),t[n++]=o.x,t[n++]=o.y}return this},copyVector3sArray:function(e){for(var t=this.array,n=0,i=0,r=e.length;i<r;i++){var o=e[i];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),o=new Nt),t[n++]=o.x,t[n++]=o.y,t[n++]=o.z}return this},copyVector4sArray:function(e){for(var t=this.array,n=0,i=0,r=e.length;i<r;i++){var o=e[i];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),o=new Ft),t[n++]=o.x,t[n++]=o.y,t[n++]=o.z,t[n++]=o.w}return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this},setXYZ:function(e,t,n,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this},setXYZW:function(e,t,n,i,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this.array[e+3]=r,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),gr.prototype=Object.create(mr.prototype),gr.prototype.constructor=gr,vr.prototype=Object.create(mr.prototype),vr.prototype.constructor=vr,yr.prototype=Object.create(mr.prototype),yr.prototype.constructor=yr,xr.prototype=Object.create(mr.prototype),xr.prototype.constructor=xr,br.prototype=Object.create(mr.prototype),br.prototype.constructor=br,wr.prototype=Object.create(mr.prototype),wr.prototype.constructor=wr,_r.prototype=Object.create(mr.prototype),_r.prototype.constructor=_r,Ar.prototype=Object.create(mr.prototype),Ar.prototype.constructor=Ar,Sr.prototype=Object.create(mr.prototype),Sr.prototype.constructor=Sr,Object.assign(Er.prototype,{computeGroups:function(e){for(var t,n=[],i=void 0,r=e.faces,o=0;o<r.length;o++){var s=r[o];s.materialIndex!==i&&(i=s.materialIndex,void 0!==t&&(t.count=3*o-t.start,n.push(t)),t={start:3*o,materialIndex:i})}void 0!==t&&(t.count=3*o-t.start,n.push(t)),this.groups=n},fromGeometry:function(e){var t,n=e.faces,i=e.vertices,r=e.faceVertexUvs,o=r[0]&&r[0].length>0,s=r[1]&&r[1].length>0,a=e.morphTargets,l=a.length;if(l>0){t=[];for(var u=0;u<l;u++)t[u]=[];this.morphTargets.position=t}var c,h=e.morphNormals,d=h.length;if(d>0){c=[];for(u=0;u<d;u++)c[u]=[];this.morphTargets.normal=c}var p=e.skinIndices,f=e.skinWeights,m=p.length===i.length,g=f.length===i.length;for(u=0;u<n.length;u++){var v=n[u];this.vertices.push(i[v.a],i[v.b],i[v.c]);var y=v.vertexNormals;if(3===y.length)this.normals.push(y[0],y[1],y[2]);else{var x=v.normal;this.normals.push(x,x,x)}var b=v.vertexColors;if(3===b.length)this.colors.push(b[0],b[1],b[2]);else{var w=v.color;this.colors.push(w,w,w)}if(!0===o){var _=r[0][u];void 0!==_?this.uvs.push(_[0],_[1],_[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",u),this.uvs.push(new Ot,new Ot,new Ot))}if(!0===s){_=r[1][u];void 0!==_?this.uvs2.push(_[0],_[1],_[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",u),this.uvs2.push(new Ot,new Ot,new Ot))}for(var A=0;A<l;A++){var S=a[A].vertices;t[A].push(S[v.a],S[v.b],S[v.c])}for(A=0;A<d;A++){var E=h[A].vertexNormals[u];c[A].push(E.a,E.b,E.c)}m&&this.skinIndices.push(p[v.a],p[v.b],p[v.c]),g&&this.skinWeights.push(f[v.a],f[v.b],f[v.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this}});var Tr=1;function Cr(){Object.defineProperty(this,"id",{value:Tr+=2}),this.uuid=Lt.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0}}function Pr(e,t,n,i,r,o){fr.call(this),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:i,heightSegments:r,depthSegments:o},this.fromBufferGeometry(new Rr(e,t,n,i,r,o)),this.mergeVertices()}function Rr(e,t,n,i,r,o){Cr.call(this),this.type="BoxBufferGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:i,heightSegments:r,depthSegments:o};var s=this;e=e||1,t=t||1,n=n||1,i=Math.floor(i)||1,r=Math.floor(r)||1,o=Math.floor(o)||1;var a=[],l=[],u=[],c=[],h=0,d=0;function p(e,t,n,i,r,o,p,f,m,g,v){var y,x,b=o/m,w=p/g,_=o/2,A=p/2,S=f/2,E=m+1,M=g+1,T=0,C=0,P=new Nt;for(x=0;x<M;x++){var R=x*w-A;for(y=0;y<E;y++){var L=y*b-_;P[e]=L*i,P[t]=R*r,P[n]=S,l.push(P.x,P.y,P.z),P[e]=0,P[t]=0,P[n]=f>0?1:-1,u.push(P.x,P.y,P.z),c.push(y/m),c.push(1-x/g),T+=1}}for(x=0;x<g;x++)for(y=0;y<m;y++){var O=h+y+E*x,D=h+y+E*(x+1),I=h+(y+1)+E*(x+1),N=h+(y+1)+E*x;a.push(O,D,N),a.push(D,I,N),C+=6}s.addGroup(d,C,v),d+=C,h+=T}p("z","y","x",-1,-1,n,t,e,o,r,0),p("z","y","x",1,-1,n,t,-e,o,r,1),p("x","z","y",1,1,e,n,t,i,o,2),p("x","z","y",1,-1,e,n,-t,i,o,3),p("x","y","z",1,-1,e,t,n,i,r,4),p("x","y","z",-1,-1,e,t,-n,i,r,5),this.setIndex(a),this.addAttribute("position",new Ar(l,3)),this.addAttribute("normal",new Ar(u,3)),this.addAttribute("uv",new Ar(c,2))}function Lr(e,t,n,i){fr.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i},this.fromBufferGeometry(new Or(e,t,n,i)),this.mergeVertices()}function Or(e,t,n,i){Cr.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i},e=e||1,t=t||1;var r,o,s=e/2,a=t/2,l=Math.floor(n)||1,u=Math.floor(i)||1,c=l+1,h=u+1,d=e/l,p=t/u,f=[],m=[],g=[],v=[];for(o=0;o<h;o++){var y=o*p-a;for(r=0;r<c;r++){var x=r*d-s;m.push(x,-y,0),g.push(0,0,1),v.push(r/l),v.push(1-o/u)}}for(o=0;o<u;o++)for(r=0;r<l;r++){var b=r+c*o,w=r+c*(o+1),_=r+1+c*(o+1),A=r+1+c*o;f.push(b,w,A),f.push(w,_,A)}this.setIndex(f),this.addAttribute("position",new Ar(m,3)),this.addAttribute("normal",new Ar(g,3)),this.addAttribute("uv",new Ar(v,2))}Cr.prototype=Object.assign(Object.create(a.prototype),{constructor:Cr,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){Array.isArray(e)?this.index=new(Mr(e)>65535?_r:br)(e,1):this.index=e},addAttribute:function(e,t){return t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),void this.setIndex(t)):(this.attributes[e]=t,this):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),void this.addAttribute(e,new mr(arguments[1],arguments[2])))},getAttribute:function(e){return this.attributes[e]},removeAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,t,n){this.groups.push({start:e,count:t,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix:function(e){var t=this.attributes.position;void 0!==t&&(e.applyToBufferAttribute(t),t.needsUpdate=!0);var n=this.attributes.normal;if(void 0!==n){var i=(new kt).getNormalMatrix(e);i.applyToBufferAttribute(n),n.needsUpdate=!0}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var e=new Dt;return function(t){return e.makeRotationX(t),this.applyMatrix(e),this}}(),rotateY:function(){var e=new Dt;return function(t){return e.makeRotationY(t),this.applyMatrix(e),this}}(),rotateZ:function(){var e=new Dt;return function(t){return e.makeRotationZ(t),this.applyMatrix(e),this}}(),translate:function(){var e=new Dt;return function(t,n,i){return e.makeTranslation(t,n,i),this.applyMatrix(e),this}}(),scale:function(){var e=new Dt;return function(t,n,i){return e.makeScale(t,n,i),this.applyMatrix(e),this}}(),lookAt:function(){var e=new ur;return function(t){e.lookAt(t),e.updateMatrix(),this.applyMatrix(e.matrix)}}(),center:function(){var e=new Nt;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(e).negate(),this.translate(e.x,e.y,e.z),this}}(),setFromObject:function(e){var t=e.geometry;if(e.isPoints||e.isLine){var n=new Ar(3*t.vertices.length,3),i=new Ar(3*t.colors.length,3);if(this.addAttribute("position",n.copyVector3sArray(t.vertices)),this.addAttribute("color",i.copyColorsArray(t.colors)),t.lineDistances&&t.lineDistances.length===t.vertices.length){var r=new Ar(t.lineDistances.length,1);this.addAttribute("lineDistance",r.copyArray(t.lineDistances))}null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone())}else e.isMesh&&t&&t.isGeometry&&this.fromGeometry(t);return this},setFromPoints:function(e){for(var t=[],n=0,i=e.length;n<i;n++){var r=e[n];t.push(r.x,r.y,r.z||0)}return this.addAttribute("position",new Ar(t,3)),this},updateFromObject:function(e){var t,n=e.geometry;if(e.isMesh){var i=n.__directGeometry;if(!0===n.elementsNeedUpdate&&(i=void 0,n.elementsNeedUpdate=!1),void 0===i)return this.fromGeometry(n);i.verticesNeedUpdate=n.verticesNeedUpdate,i.normalsNeedUpdate=n.normalsNeedUpdate,i.colorsNeedUpdate=n.colorsNeedUpdate,i.uvsNeedUpdate=n.uvsNeedUpdate,i.groupsNeedUpdate=n.groupsNeedUpdate,n.verticesNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.groupsNeedUpdate=!1,n=i}return!0===n.verticesNeedUpdate&&(t=this.attributes.position,void 0!==t&&(t.copyVector3sArray(n.vertices),t.needsUpdate=!0),n.verticesNeedUpdate=!1),!0===n.normalsNeedUpdate&&(t=this.attributes.normal,void 0!==t&&(t.copyVector3sArray(n.normals),t.needsUpdate=!0),n.normalsNeedUpdate=!1),!0===n.colorsNeedUpdate&&(t=this.attributes.color,void 0!==t&&(t.copyColorsArray(n.colors),t.needsUpdate=!0),n.colorsNeedUpdate=!1),n.uvsNeedUpdate&&(t=this.attributes.uv,void 0!==t&&(t.copyVector2sArray(n.uvs),t.needsUpdate=!0),n.uvsNeedUpdate=!1),n.lineDistancesNeedUpdate&&(t=this.attributes.lineDistance,void 0!==t&&(t.copyArray(n.lineDistances),t.needsUpdate=!0),n.lineDistancesNeedUpdate=!1),n.groupsNeedUpdate&&(n.computeGroups(e.geometry),this.groups=n.groups,n.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=(new Er).fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var t=new Float32Array(3*e.vertices.length);if(this.addAttribute("position",new mr(t,3).copyVector3sArray(e.vertices)),e.normals.length>0){var n=new Float32Array(3*e.normals.length);this.addAttribute("normal",new mr(n,3).copyVector3sArray(e.normals))}if(e.colors.length>0){var i=new Float32Array(3*e.colors.length);this.addAttribute("color",new mr(i,3).copyColorsArray(e.colors))}if(e.uvs.length>0){var r=new Float32Array(2*e.uvs.length);this.addAttribute("uv",new mr(r,2).copyVector2sArray(e.uvs))}if(e.uvs2.length>0){var o=new Float32Array(2*e.uvs2.length);this.addAttribute("uv2",new mr(o,2).copyVector2sArray(e.uvs2))}for(var s in this.groups=e.groups,e.morphTargets){for(var a=[],l=e.morphTargets[s],u=0,c=l.length;u<c;u++){var h=l[u],d=new Ar(3*h.length,3);a.push(d.copyVector3sArray(h))}this.morphAttributes[s]=a}if(e.skinIndices.length>0){var p=new Ar(4*e.skinIndices.length,4);this.addAttribute("skinIndex",p.copyVector4sArray(e.skinIndices))}if(e.skinWeights.length>0){var f=new Ar(4*e.skinWeights.length,4);this.addAttribute("skinWeight",f.copyVector4sArray(e.skinWeights))}return null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new $t);var e=this.attributes.position;void 0!==e?this.boundingBox.setFromBufferAttribute(e):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var e=new $t,t=new Nt;return function(){null===this.boundingSphere&&(this.boundingSphere=new Ht);var n=this.attributes.position;if(n){var i=this.boundingSphere.center;e.setFromBufferAttribute(n),e.getCenter(i);for(var r=0,o=0,s=n.count;o<s;o++)t.x=n.getX(o),t.y=n.getY(o),t.z=n.getZ(o),r=Math.max(r,i.distanceToSquared(t));this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,t=this.attributes,n=this.groups;if(t.position){var i=t.position.array;if(void 0===t.normal)this.addAttribute("normal",new mr(new Float32Array(i.length),3));else for(var r=t.normal.array,o=0,s=r.length;o<s;o++)r[o]=0;var a,l,u,c=t.normal.array,h=new Nt,d=new Nt,p=new Nt,f=new Nt,m=new Nt;if(e){var g=e.array;0===n.length&&this.addGroup(0,g.length);for(var v=0,y=n.length;v<y;++v){var x=n[v],b=x.start,w=x.count;for(o=b,s=b+w;o<s;o+=3)a=3*g[o+0],l=3*g[o+1],u=3*g[o+2],h.fromArray(i,a),d.fromArray(i,l),p.fromArray(i,u),f.subVectors(p,d),m.subVectors(h,d),f.cross(m),c[a]+=f.x,c[a+1]+=f.y,c[a+2]+=f.z,c[l]+=f.x,c[l+1]+=f.y,c[l+2]+=f.z,c[u]+=f.x,c[u+1]+=f.y,c[u+2]+=f.z}}else for(o=0,s=i.length;o<s;o+=9)h.fromArray(i,o),d.fromArray(i,o+3),p.fromArray(i,o+6),f.subVectors(p,d),m.subVectors(h,d),f.cross(m),c[o]=f.x,c[o+1]=f.y,c[o+2]=f.z,c[o+3]=f.x,c[o+4]=f.y,c[o+5]=f.z,c[o+6]=f.x,c[o+7]=f.y,c[o+8]=f.z;this.normalizeNormals(),t.normal.needsUpdate=!0}},merge:function(e,t){if(e&&e.isBufferGeometry){void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var n=this.attributes;for(var i in n)if(void 0!==e.attributes[i])for(var r=n[i],o=r.array,s=e.attributes[i],a=s.array,l=s.itemSize,u=0,c=l*t;u<a.length;u++,c++)o[c]=a[u];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)},normalizeNormals:function(){var e=new Nt;return function(){for(var t=this.attributes.normal,n=0,i=t.count;n<i;n++)e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.normalize(),t.setXYZ(n,e.x,e.y,e.z)}}(),toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var e=new Cr,t=this.index.array,n=this.attributes;for(var i in n){for(var r=n[i],o=r.array,s=r.itemSize,a=new o.constructor(t.length*s),l=0,u=0,c=0,h=t.length;c<h;c++){l=t[c]*s;for(var d=0;d<s;d++)a[u++]=o[l++]}e.addAttribute(i,new mr(a,s))}var p=this.groups;for(c=0,h=p.length;c<h;c++){var f=p[c];e.addGroup(f.start,f.count,f.materialIndex)}return e},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var t=this.parameters;for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};var i=this.index;if(null!==i){var r=Array.prototype.slice.call(i.array);e.data.index={type:i.array.constructor.name,array:r}}var o=this.attributes;for(var n in o){var s=o[n];r=Array.prototype.slice.call(s.array);e.data.attributes[n]={itemSize:s.itemSize,type:s.array.constructor.name,array:r,normalized:s.normalized}}var a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));var l=this.boundingSphere;return null!==l&&(e.data.boundingSphere={center:l.center.toArray(),radius:l.radius}),e},clone:function(){return(new Cr).copy(this)},copy:function(e){var t,n,i;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var r=e.index;null!==r&&this.setIndex(r.clone());var o=e.attributes;for(t in o){var s=o[t];this.addAttribute(t,s.clone())}var a=e.morphAttributes;for(t in a){var l=[],u=a[t];for(n=0,i=u.length;n<i;n++)l.push(u[n].clone());this.morphAttributes[t]=l}var c=e.groups;for(n=0,i=c.length;n<i;n++){var h=c[n];this.addGroup(h.start,h.count,h.materialIndex)}var d=e.boundingBox;null!==d&&(this.boundingBox=d.clone());var p=e.boundingSphere;return null!==p&&(this.boundingSphere=p.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Pr.prototype=Object.create(fr.prototype),Pr.prototype.constructor=Pr,Rr.prototype=Object.create(Cr.prototype),Rr.prototype.constructor=Rr,Lr.prototype=Object.create(fr.prototype),Lr.prototype.constructor=Lr,Or.prototype=Object.create(Cr.prototype),Or.prototype.constructor=Or;var Dr=0;function Ir(){Object.defineProperty(this,"id",{value:Dr++}),this.uuid=Lt.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=_,this.side=f,this.flatShading=!1,this.vertexColors=y,this.opacity=1,this.transparent=!1,this.blendSrc=k,this.blendDst=V,this.blendEquation=T,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=W,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this.userData={},this.needsUpdate=!0}function Nr(e){Ir.call(this),this.type="MeshBasicMaterial",this.color=new nr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=J,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(e)}function kr(e){Ir.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function Vr(e,t){this.origin=void 0!==e?e:new Nt,this.direction=void 0!==t?t:new Nt}function Ur(e,t){this.start=void 0!==e?e:new Nt,this.end=void 0!==t?t:new Nt}function Fr(e,t,n){this.a=void 0!==e?e:new Nt,this.b=void 0!==t?t:new Nt,this.c=void 0!==n?n:new Nt}function zr(e,t){ur.call(this),this.type="Mesh",this.geometry=void 0!==e?e:new Cr,this.material=void 0!==t?t:new Nr({color:16777215*Math.random()}),this.drawMode=xt,this.updateMorphTargets()}function jr(e,t,n,i){var r,o,s,a=new nr(0),l=0;function u(t,i,u,h){var d=i.background;null===d?c(a,l):d&&d.isColor&&(c(d,1),h=!0),(e.autoClear||h)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),d&&d.isCubeTexture?(void 0===s&&(s=new zr(new Rr(1,1,1),new kr({uniforms:rr.cube.uniforms,vertexShader:rr.cube.vertexShader,fragmentShader:rr.cube.fragmentShader,side:m,depthTest:!0,depthWrite:!1,fog:!1})),s.geometry.removeAttribute("normal"),s.geometry.removeAttribute("uv"),s.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},n.update(s.geometry)),s.material.uniforms.tCube.value=d,t.push(s,s.geometry,s.material,0,null)):d&&d.isTexture&&(void 0===r&&(r=new hr(-1,1,1,-1,0,1),o=new zr(new Or(2,2),new Nr({depthTest:!1,depthWrite:!1,fog:!1})),n.update(o.geometry)),o.material.map=d,e.renderBufferDirect(r,null,o.geometry,o.material,o,null))}function c(e,n){t.buffers.color.setClear(e.r,e.g,e.b,n,i)}return{getClearColor:function(){return a},setClearColor:function(e,t){a.set(e),l=void 0!==t?t:1,c(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(e){l=e,c(a,l)},render:u}}function Br(e,t,n){var i;function r(e){i=e}function o(t,r){e.drawArrays(i,t,r),n.update(r,i)}function s(e,r,o){var s=t.get("ANGLE_instanced_arrays");if(null!==s){var a=e.attributes.position;a.isInterleavedBufferAttribute?(o=a.data.count,s.drawArraysInstancedANGLE(i,0,o,e.maxInstancedCount)):s.drawArraysInstancedANGLE(i,r,o,e.maxInstancedCount),n.update(o,i,e.maxInstancedCount)}else console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")}this.setMode=r,this.render=o,this.renderInstances=s}function $r(e,t,n){var i;function r(){if(void 0!==i)return i;var n=t.get("EXT_texture_filter_anisotropic");return i=null!==n?e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,i}function o(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var s=void 0!==n.precision?n.precision:"highp",a=o(s);a!==s&&(console.warn("THREE.WebGLRenderer:",s,"not supported, using",a,"instead."),s=a);var l=!0===n.logarithmicDepthBuffer,u=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),c=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),h=e.getParameter(e.MAX_TEXTURE_SIZE),d=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),p=e.getParameter(e.MAX_VERTEX_ATTRIBS),f=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),m=e.getParameter(e.MAX_VARYING_VECTORS),g=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),v=c>0,y=!!t.get("OES_texture_float"),x=v&&y;return{getMaxAnisotropy:r,getMaxPrecision:o,precision:s,logarithmicDepthBuffer:l,maxTextures:u,maxVertexTextures:c,maxTextureSize:h,maxCubemapSize:d,maxAttributes:p,maxVertexUniforms:f,maxVaryings:m,maxFragmentUniforms:g,vertexTextures:v,floatFragmentTextures:y,floatVertexTextures:x}}function Hr(){var e=this,t=null,n=0,i=!1,r=!1,o=new Gt,s=new kt,a={value:null,needsUpdate:!1};function l(){a.value!==t&&(a.value=t,a.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function u(t,n,i,r){var l=null!==t?t.length:0,u=null;if(0!==l){if(u=a.value,!0!==r||null===u){var c=i+4*l,h=n.matrixWorldInverse;s.getNormalMatrix(h),(null===u||u.length<c)&&(u=new Float32Array(c));for(var d=0,p=i;d!==l;++d,p+=4)o.copy(t[d]).applyMatrix4(h,s),o.normal.toArray(u,p),u[p+3]=o.constant}a.value=u,a.needsUpdate=!0}return e.numPlanes=l,u}this.uniform=a,this.numPlanes=0,this.numIntersection=0,this.init=function(e,r,o){var s=0!==e.length||r||0!==n||i;return i=r,t=u(e,o,0),n=e.length,s},this.beginShadows=function(){r=!0,u(null)},this.endShadows=function(){r=!1,l()},this.setState=function(e,o,s,c,h,d){if(!i||null===e||0===e.length||r&&!s)r?u(null):l();else{var p=r?0:n,f=4*p,m=h.clippingState||null;a.value=m,m=u(e,c,f,d);for(var g=0;g!==f;++g)m[g]=t[g];h.clippingState=m,this.numIntersection=o?this.numPlanes:0,this.numPlanes+=p}}}function Gr(e){var t={};return{get:function(n){if(void 0!==t[n])return t[n];var i;switch(n){case"WEBGL_depth_texture":i=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=e.getExtension(n)}return null===i&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),t[n]=i,i}}}function Wr(e,t,n){var i={},r={};function o(e){var s=e.target,a=i[s.id];for(var l in null!==a.index&&t.remove(a.index),a.attributes)t.remove(a.attributes[l]);s.removeEventListener("dispose",o),delete i[s.id];var u=r[s.id];u&&(t.remove(u),delete r[s.id]),u=r[a.id],u&&(t.remove(u),delete r[a.id]),n.memory.geometries--}function s(e,t){var r=i[t.id];return r||(t.addEventListener("dispose",o),t.isBufferGeometry?r=t:t.isGeometry&&(void 0===t._bufferGeometry&&(t._bufferGeometry=(new Cr).setFromObject(e)),r=t._bufferGeometry),i[t.id]=r,n.memory.geometries++,r)}function a(n){var i=n.index,r=n.attributes;for(var o in null!==i&&t.update(i,e.ELEMENT_ARRAY_BUFFER),r)t.update(r[o],e.ARRAY_BUFFER);var s=n.morphAttributes;for(var o in s)for(var a=s[o],l=0,u=a.length;l<u;l++)t.update(a[l],e.ARRAY_BUFFER)}function l(n){var i=r[n.id];if(i)return i;var o=[],s=n.index,a=n.attributes;if(null!==s)for(var l=s.array,u=0,c=l.length;u<c;u+=3){var h=l[u+0],d=l[u+1],p=l[u+2];o.push(h,d,d,p,p,h)}else for(l=a.position.array,u=0,c=l.length/3-1;u<c;u+=3){h=u+0,d=u+1,p=u+2;o.push(h,d,d,p,p,h)}return i=new(Mr(o)>65535?_r:br)(o,1),t.update(i,e.ELEMENT_ARRAY_BUFFER),r[n.id]=i,i}return{get:s,update:a,getWireframeAttribute:l}}function qr(e,t,n){var i,r,o;function s(e){i=e}function a(e){r=e.type,o=e.bytesPerElement}function l(t,s){e.drawElements(i,s,r,t*o),n.update(s,i)}function u(e,s,a){var l=t.get("ANGLE_instanced_arrays");null!==l?(l.drawElementsInstancedANGLE(i,a,r,s*o,e.maxInstancedCount),n.update(a,i,e.maxInstancedCount)):console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")}this.setMode=s,this.setIndex=a,this.render=l,this.renderInstances=u}function Yr(e){var t={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function i(t,i,r){switch(r=r||1,n.calls++,i){case e.TRIANGLES:n.triangles+=r*(t/3);break;case e.TRIANGLE_STRIP:case e.TRIANGLE_FAN:n.triangles+=r*(t-2);break;case e.LINES:n.lines+=r*(t/2);break;case e.LINE_STRIP:n.lines+=r*(t-1);break;case e.LINE_LOOP:n.lines+=r*t;break;case e.POINTS:n.points+=r*t;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",i);break}}function r(){n.frame++,n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:t,render:n,programs:null,autoReset:!0,reset:r,update:i}}function Xr(e,t){return Math.abs(t[1])-Math.abs(e[1])}function Zr(e){var t={},n=new Float32Array(8);function i(i,r,o,s){var a=i.morphTargetInfluences,l=a.length,u=t[r.id];if(void 0===u){u=[];for(var c=0;c<l;c++)u[c]=[c,0];t[r.id]=u}var h=o.morphTargets&&r.morphAttributes.position,d=o.morphNormals&&r.morphAttributes.normal;for(c=0;c<l;c++){var p=u[c];0!==p[1]&&(h&&r.removeAttribute("morphTarget"+c),d&&r.removeAttribute("morphNormal"+c))}for(c=0;c<l;c++){p=u[c];p[0]=c,p[1]=a[c]}u.sort(Xr);for(c=0;c<8;c++){p=u[c];if(p){var f=p[0],m=p[1];if(m){h&&r.addAttribute("morphTarget"+c,h[f]),d&&r.addAttribute("morphNormal"+c,d[f]),n[c]=m;continue}}n[c]=0}s.getUniforms().setValue(e,"morphTargetInfluences",n)}return{update:i}}function Jr(e,t){var n={};function i(i){var r=t.render.frame,o=i.geometry,s=e.get(i,o);return n[s.id]!==r&&(o.isGeometry&&s.updateFromObject(i),e.update(s),n[s.id]=r),s}function r(){n={}}return{update:i,dispose:r}}function Kr(e,t,n,i,r,o,s,a,l,u){e=void 0!==e?e:[],t=void 0!==t?t:se,Ut.call(this,e,t,n,i,r,o,s,a,l,u),this.flipY=!1}Ir.prototype=Object.assign(Object.create(a.prototype),{constructor:Ir,isMaterial:!0,onBeforeCompile:function(){},setValues:function(e){if(void 0!==e)for(var t in e){var n=e[t];if(void 0!==n)if("shading"!==t){var i=this[t];void 0!==i?i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[t]="overdraw"===t?Number(n):n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===v;else console.warn("THREE.Material: '"+t+"' parameter is undefined.")}},toJSON:function(e){var t=void 0===e||"string"===typeof e;t&&(e={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function i(e){var t=[];for(var n in e){var i=e[n];delete i.metadata,t.push(i)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearCoat&&(n.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(n.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,n.reflectivity=this.reflectivity),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==_&&(n.blending=this.blending),!0===this.flatShading&&(n.flatShading=this.flatShading),this.side!==f&&(n.side=this.side),this.vertexColors!==y&&(n.vertexColors=this.vertexColors),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,0!==this.rotation&&(n.rotation=this.rotation),1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.skinning&&(n.skinning=!0),!1===this.visible&&(n.visible=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t){var r=i(e.textures),o=i(e.images);r.length>0&&(n.textures=r),o.length>0&&(n.images=o)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.lights=e.lights,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.overdraw=e.overdraw,this.visible=e.visible,this.userData=JSON.parse(JSON.stringify(e.userData)),this.clipShadows=e.clipShadows,this.clipIntersection=e.clipIntersection;var t=e.clippingPlanes,n=null;if(null!==t){var i=t.length;n=new Array(i);for(var r=0;r!==i;++r)n[r]=t[r].clone()}return this.clippingPlanes=n,this.shadowSide=e.shadowSide,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Nr.prototype=Object.create(Ir.prototype),Nr.prototype.constructor=Nr,Nr.prototype.isMeshBasicMaterial=!0,Nr.prototype.copy=function(e){return Ir.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this},kr.prototype=Object.create(Ir.prototype),kr.prototype.constructor=kr,kr.prototype.isShaderMaterial=!0,kr.prototype.copy=function(e){return Ir.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=er.clone(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=e.extensions,this},kr.prototype.toJSON=function(e){var t=Ir.prototype.toJSON.call(this,e);return t.uniforms=this.uniforms,t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t},Object.assign(Vr.prototype,{set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){return void 0===t&&(console.warn("THREE.Ray: .at() target is now required"),t=new Nt),t.copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:function(){var e=new Nt;return function(t){return this.origin.copy(this.at(t,e)),this}}(),closestPointToPoint:function(e,t){void 0===t&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),t=new Nt),t.subVectors(e,this.origin);var n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:function(){var e=new Nt;return function(t){var n=e.subVectors(t,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(t):(e.copy(this.direction).multiplyScalar(n).add(this.origin),e.distanceToSquared(t))}}(),distanceSqToSegment:function(){var e=new Nt,t=new Nt,n=new Nt;return function(i,r,o,s){e.copy(i).add(r).multiplyScalar(.5),t.copy(r).sub(i).normalize(),n.copy(this.origin).sub(e);var a,l,u,c,h=.5*i.distanceTo(r),d=-this.direction.dot(t),p=n.dot(this.direction),f=-n.dot(t),m=n.lengthSq(),g=Math.abs(1-d*d);if(g>0)if(a=d*f-p,l=d*p-f,c=h*g,a>=0)if(l>=-c)if(l<=c){var v=1/g;a*=v,l*=v,u=a*(a+d*l+2*p)+l*(d*a+l+2*f)+m}else l=h,a=Math.max(0,-(d*l+p)),u=-a*a+l*(l+2*f)+m;else l=-h,a=Math.max(0,-(d*l+p)),u=-a*a+l*(l+2*f)+m;else l<=-c?(a=Math.max(0,-(-d*h+p)),l=a>0?-h:Math.min(Math.max(-h,-f),h),u=-a*a+l*(l+2*f)+m):l<=c?(a=0,l=Math.min(Math.max(-h,-f),h),u=l*(l+2*f)+m):(a=Math.max(0,-(d*h+p)),l=a>0?h:Math.min(Math.max(-h,-f),h),u=-a*a+l*(l+2*f)+m);else l=d>0?-h:h,a=Math.max(0,-(d*l+p)),u=-a*a+l*(l+2*f)+m;return o&&o.copy(this.direction).multiplyScalar(a).add(this.origin),s&&s.copy(t).multiplyScalar(l).add(e),u}}(),intersectSphere:function(){var e=new Nt;return function(t,n){e.subVectors(t.center,this.origin);var i=e.dot(this.direction),r=e.dot(e)-i*i,o=t.radius*t.radius;if(r>o)return null;var s=Math.sqrt(o-r),a=i-s,l=i+s;return a<0&&l<0?null:a<0?this.at(l,n):this.at(a,n)}}(),intersectsSphere:function(e){return this.distanceToPoint(e.center)<=e.radius},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null},intersectPlane:function(e,t){var n=this.distanceToPlane(e);return null===n?null:this.at(n,t)},intersectsPlane:function(e){var t=e.distanceToPoint(this.origin);if(0===t)return!0;var n=e.normal.dot(this.direction);return n*t<0},intersectBox:function(e,t){var n,i,r,o,s,a,l=1/this.direction.x,u=1/this.direction.y,c=1/this.direction.z,h=this.origin;return l>=0?(n=(e.min.x-h.x)*l,i=(e.max.x-h.x)*l):(n=(e.max.x-h.x)*l,i=(e.min.x-h.x)*l),u>=0?(r=(e.min.y-h.y)*u,o=(e.max.y-h.y)*u):(r=(e.max.y-h.y)*u,o=(e.min.y-h.y)*u),n>o||r>i?null:((r>n||n!==n)&&(n=r),(o<i||i!==i)&&(i=o),c>=0?(s=(e.min.z-h.z)*c,a=(e.max.z-h.z)*c):(s=(e.max.z-h.z)*c,a=(e.min.z-h.z)*c),n>a||s>i?null:((s>n||n!==n)&&(n=s),(a<i||i!==i)&&(i=a),i<0?null:this.at(n>=0?n:i,t)))},intersectsBox:function(){var e=new Nt;return function(t){return null!==this.intersectBox(t,e)}}(),intersectTriangle:function(){var e=new Nt,t=new Nt,n=new Nt,i=new Nt;return function(r,o,s,a,l){t.subVectors(o,r),n.subVectors(s,r),i.crossVectors(t,n);var u,c=this.direction.dot(i);if(c>0){if(a)return null;u=1}else{if(!(c<0))return null;u=-1,c=-c}e.subVectors(this.origin,r);var h=u*this.direction.dot(n.crossVectors(e,n));if(h<0)return null;var d=u*this.direction.dot(t.cross(e));if(d<0)return null;if(h+d>c)return null;var p=-u*e.dot(i);return p<0?null:this.at(p/c,l)}}(),applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}}),Object.assign(Ur.prototype,{set:function(e,t){return this.start.copy(e),this.end.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){return void 0===e&&(console.warn("THREE.Line3: .getCenter() target is now required"),e=new Nt),e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return void 0===e&&(console.warn("THREE.Line3: .delta() target is now required"),e=new Nt),e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){return void 0===t&&(console.warn("THREE.Line3: .at() target is now required"),t=new Nt),this.delta(t).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(){var e=new Nt,t=new Nt;return function(n,i){e.subVectors(n,this.start),t.subVectors(this.end,this.start);var r=t.dot(t),o=t.dot(e),s=o/r;return i&&(s=Lt.clamp(s,0,1)),s}}(),closestPointToPoint:function(e,t,n){var i=this.closestPointToPointParameter(e,t);return void 0===n&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),n=new Nt),this.delta(n).multiplyScalar(i).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}}),Object.assign(Fr,{getNormal:function(){var e=new Nt;return function(t,n,i,r){void 0===r&&(console.warn("THREE.Triangle: .getNormal() target is now required"),r=new Nt),r.subVectors(i,n),e.subVectors(t,n),r.cross(e);var o=r.lengthSq();return o>0?r.multiplyScalar(1/Math.sqrt(o)):r.set(0,0,0)}}(),getBarycoord:function(){var e=new Nt,t=new Nt,n=new Nt;return function(i,r,o,s,a){e.subVectors(s,r),t.subVectors(o,r),n.subVectors(i,r);var l=e.dot(e),u=e.dot(t),c=e.dot(n),h=t.dot(t),d=t.dot(n),p=l*h-u*u;if(void 0===a&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),a=new Nt),0===p)return a.set(-2,-1,-1);var f=1/p,m=(h*c-u*d)*f,g=(l*d-u*c)*f;return a.set(1-m-g,g,m)}}(),containsPoint:function(){var e=new Nt;return function(t,n,i,r){return Fr.getBarycoord(t,n,i,r,e),e.x>=0&&e.y>=0&&e.x+e.y<=1}}()}),Object.assign(Fr.prototype,{set:function(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this},setFromPointsAndIndices:function(e,t,n,i){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[i]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},getArea:function(){var e=new Nt,t=new Nt;return function(){return e.subVectors(this.c,this.b),t.subVectors(this.a,this.b),.5*e.cross(t).length()}}(),getMidpoint:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new Nt),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(e){return Fr.getNormal(this.a,this.b,this.c,e)},getPlane:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new Nt),e.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(e,t){return Fr.getBarycoord(e,this.a,this.b,this.c,t)},containsPoint:function(e){return Fr.containsPoint(e,this.a,this.b,this.c)},intersectsBox:function(e){return e.intersectsTriangle(this)},closestPointToPoint:function(){var e=new Gt,t=[new Ur,new Ur,new Ur],n=new Nt,i=new Nt;return function(r,o){void 0===o&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),o=new Nt);var s=1/0;if(e.setFromCoplanarPoints(this.a,this.b,this.c),e.projectPoint(r,n),!0===this.containsPoint(n))o.copy(n);else{t[0].set(this.a,this.b),t[1].set(this.b,this.c),t[2].set(this.c,this.a);for(var a=0;a<t.length;a++){t[a].closestPointToPoint(n,!0,i);var l=n.distanceToSquared(i);l<s&&(s=l,o.copy(i))}}return o}}(),equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}),zr.prototype=Object.assign(Object.create(ur.prototype),{constructor:zr,isMesh:!0,setDrawMode:function(e){this.drawMode=e},copy:function(e){return ur.prototype.copy.call(this,e),this.drawMode=e.drawMode,void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this},updateMorphTargets:function(){var e,t,n,i=this.geometry;if(i.isBufferGeometry){var r=i.morphAttributes,o=Object.keys(r);if(o.length>0){var s=r[o[0]];if(void 0!==s)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=s.length;e<t;e++)n=s[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}else{var a=i.morphTargets;if(void 0!==a&&a.length>0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=a.length;e<t;e++)n=a[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}},raycast:function(){var e=new Dt,t=new Vr,n=new Ht,i=new Nt,r=new Nt,o=new Nt,s=new Nt,a=new Nt,l=new Nt,u=new Ot,c=new Ot,h=new Ot,d=new Nt,p=new Nt,f=new Nt;function v(e,t,n,i,r,o,s){return Fr.getBarycoord(e,t,n,i,d),r.multiplyScalar(d.x),o.multiplyScalar(d.y),s.multiplyScalar(d.z),r.add(o).add(s),r.clone()}function y(e,t,n,i,r,o,s,a){var l;if(l=t.side===m?i.intersectTriangle(s,o,r,!0,a):i.intersectTriangle(r,o,s,t.side!==g,a),null===l)return null;f.copy(a),f.applyMatrix4(e.matrixWorld);var u=n.ray.origin.distanceTo(f);return u<n.near||u>n.far?null:{distance:u,point:f.clone(),object:e}}function x(e,t,n,s,a,l,d,f){i.fromBufferAttribute(s,l),r.fromBufferAttribute(s,d),o.fromBufferAttribute(s,f);var m=y(e,e.material,t,n,i,r,o,p);if(m){a&&(u.fromBufferAttribute(a,l),c.fromBufferAttribute(a,d),h.fromBufferAttribute(a,f),m.uv=v(p,i,r,o,u,c,h));var g=new dr(l,d,f);Fr.getNormal(i,r,o,g.normal),m.face=g,m.faceIndex=l}return m}return function(d,f){var m,g=this.geometry,b=this.material,w=this.matrixWorld;if(void 0!==b&&(null===g.boundingSphere&&g.computeBoundingSphere(),n.copy(g.boundingSphere),n.applyMatrix4(w),!1!==d.ray.intersectsSphere(n)&&(e.getInverse(w),t.copy(d.ray).applyMatrix4(e),null===g.boundingBox||!1!==t.intersectsBox(g.boundingBox))))if(g.isBufferGeometry){var _,A,S,E,M,T=g.index,C=g.attributes.position,P=g.attributes.uv;if(null!==T)for(E=0,M=T.count;E<M;E+=3)_=T.getX(E),A=T.getX(E+1),S=T.getX(E+2),m=x(this,d,t,C,P,_,A,S),m&&(m.faceIndex=Math.floor(E/3),f.push(m));else if(void 0!==C)for(E=0,M=C.count;E<M;E+=3)_=E,A=E+1,S=E+2,m=x(this,d,t,C,P,_,A,S),m&&f.push(m)}else if(g.isGeometry){var R,L,O,D,I=Array.isArray(b),N=g.vertices,k=g.faces,V=g.faceVertexUvs[0];V.length>0&&(D=V);for(var U=0,F=k.length;U<F;U++){var z=k[U],j=I?b[z.materialIndex]:b;if(void 0!==j){if(R=N[z.a],L=N[z.b],O=N[z.c],!0===j.morphTargets){var B=g.morphTargets,$=this.morphTargetInfluences;i.set(0,0,0),r.set(0,0,0),o.set(0,0,0);for(var H=0,G=B.length;H<G;H++){var W=$[H];if(0!==W){var q=B[H].vertices;i.addScaledVector(s.subVectors(q[z.a],R),W),r.addScaledVector(a.subVectors(q[z.b],L),W),o.addScaledVector(l.subVectors(q[z.c],O),W)}}i.add(R),r.add(L),o.add(O),R=i,L=r,O=o}if(m=y(this,j,d,t,R,L,O,p),m){if(D&&D[U]){var Y=D[U];u.copy(Y[0]),c.copy(Y[1]),h.copy(Y[2]),m.uv=v(p,R,L,O,u,c,h)}m.face=z,m.faceIndex=U,f.push(m)}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Kr.prototype=Object.create(Ut.prototype),Kr.prototype.constructor=Kr,Kr.prototype.isCubeTexture=!0,Object.defineProperty(Kr.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}});var Qr=new Ut,eo=new Kr;function to(){this.seq=[],this.map={}}var no=[],io=[],ro=new Float32Array(16),oo=new Float32Array(9);function so(e,t,n){var i=e[0];if(i<=0||i>0)return e;var r=t*n,o=no[r];if(void 0===o&&(o=new Float32Array(r),no[r]=o),0!==t){i.toArray(o,0);for(var s=1,a=0;s!==t;++s)a+=n,e[s].toArray(o,a)}return o}function ao(e,t){var n=io[t];void 0===n&&(n=new Int32Array(t),io[t]=n);for(var i=0;i!==t;++i)n[i]=e.allocTextureUnit();return n}function lo(e,t){e.uniform1f(this.addr,t)}function uo(e,t){e.uniform1i(this.addr,t)}function co(e,t){void 0===t.x?e.uniform2fv(this.addr,t):e.uniform2f(this.addr,t.x,t.y)}function ho(e,t){void 0!==t.x?e.uniform3f(this.addr,t.x,t.y,t.z):void 0!==t.r?e.uniform3f(this.addr,t.r,t.g,t.b):e.uniform3fv(this.addr,t)}function po(e,t){void 0===t.x?e.uniform4fv(this.addr,t):e.uniform4f(this.addr,t.x,t.y,t.z,t.w)}function fo(e,t){e.uniformMatrix2fv(this.addr,!1,t.elements||t)}function mo(e,t){void 0===t.elements?e.uniformMatrix3fv(this.addr,!1,t):(oo.set(t.elements),e.uniformMatrix3fv(this.addr,!1,oo))}function go(e,t){void 0===t.elements?e.uniformMatrix4fv(this.addr,!1,t):(ro.set(t.elements),e.uniformMatrix4fv(this.addr,!1,ro))}function vo(e,t,n){var i=n.allocTextureUnit();e.uniform1i(this.addr,i),n.setTexture2D(t||Qr,i)}function yo(e,t,n){var i=n.allocTextureUnit();e.uniform1i(this.addr,i),n.setTextureCube(t||eo,i)}function xo(e,t){e.uniform2iv(this.addr,t)}function bo(e,t){e.uniform3iv(this.addr,t)}function wo(e,t){e.uniform4iv(this.addr,t)}function _o(e){switch(e){case 5126:return lo;case 35664:return co;case 35665:return ho;case 35666:return po;case 35674:return fo;case 35675:return mo;case 35676:return go;case 35678:case 36198:return vo;case 35680:return yo;case 5124:case 35670:return uo;case 35667:case 35671:return xo;case 35668:case 35672:return bo;case 35669:case 35673:return wo}}function Ao(e,t){e.uniform1fv(this.addr,t)}function So(e,t){e.uniform1iv(this.addr,t)}function Eo(e,t){e.uniform2fv(this.addr,so(t,this.size,2))}function Mo(e,t){e.uniform3fv(this.addr,so(t,this.size,3))}function To(e,t){e.uniform4fv(this.addr,so(t,this.size,4))}function Co(e,t){e.uniformMatrix2fv(this.addr,!1,so(t,this.size,4))}function Po(e,t){e.uniformMatrix3fv(this.addr,!1,so(t,this.size,9))}function Ro(e,t){e.uniformMatrix4fv(this.addr,!1,so(t,this.size,16))}function Lo(e,t,n){var i=t.length,r=ao(n,i);e.uniform1iv(this.addr,r);for(var o=0;o!==i;++o)n.setTexture2D(t[o]||Qr,r[o])}function Oo(e,t,n){var i=t.length,r=ao(n,i);e.uniform1iv(this.addr,r);for(var o=0;o!==i;++o)n.setTextureCube(t[o]||eo,r[o])}function Do(e){switch(e){case 5126:return Ao;case 35664:return Eo;case 35665:return Mo;case 35666:return To;case 35674:return Co;case 35675:return Po;case 35676:return Ro;case 35678:return Lo;case 35680:return Oo;case 5124:case 35670:return So;case 35667:case 35671:return xo;case 35668:case 35672:return bo;case 35669:case 35673:return wo}}function Io(e,t,n){this.id=e,this.addr=n,this.setValue=_o(t.type)}function No(e,t,n){this.id=e,this.addr=n,this.size=t.size,this.setValue=Do(t.type)}function ko(e){this.id=e,to.call(this)}ko.prototype.setValue=function(e,t){for(var n=this.seq,i=0,r=n.length;i!==r;++i){var o=n[i];o.setValue(e,t[o.id])}};var Vo=/([\w\d_]+)(\])?(\[|\.)?/g;function Uo(e,t){e.seq.push(t),e.map[t.id]=t}function Fo(e,t,n){var i=e.name,r=i.length;for(Vo.lastIndex=0;;){var o=Vo.exec(i),s=Vo.lastIndex,a=o[1],l="]"===o[2],u=o[3];if(l&&(a|=0),void 0===u||"["===u&&s+2===r){Uo(n,void 0===u?new Io(a,e,t):new No(a,e,t));break}var c=n.map,h=c[a];void 0===h&&(h=new ko(a),Uo(n,h)),n=h}}function zo(e,t,n){to.call(this),this.renderer=n;for(var i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),r=0;r<i;++r){var o=e.getActiveUniform(t,r),s=e.getUniformLocation(t,o.name);Fo(o,s,this)}}function jo(e){for(var t=e.split("\n"),n=0;n<t.length;n++)t[n]=n+1+": "+t[n];return t.join("\n")}function Bo(e,t,n){var i=e.createShader(t);return e.shaderSource(i,n),e.compileShader(i),!1===e.getShaderParameter(i,e.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==e.getShaderInfoLog(i)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",t===e.VERTEX_SHADER?"vertex":"fragment",e.getShaderInfoLog(i),jo(n)),i}zo.prototype.setValue=function(e,t,n){var i=this.map[t];void 0!==i&&i.setValue(e,n,this.renderer)},zo.prototype.setOptional=function(e,t,n){var i=t[n];void 0!==i&&this.setValue(e,n,i)},zo.upload=function(e,t,n,i){for(var r=0,o=t.length;r!==o;++r){var s=t[r],a=n[s.id];!1!==a.needsUpdate&&s.setValue(e,a.value,i)}},zo.seqWithValue=function(e,t){for(var n=[],i=0,r=e.length;i!==r;++i){var o=e[i];o.id in t&&n.push(o)}return n};var $o=0;function Ho(e){switch(e){case _t:return["Linear","( value )"];case At:return["sRGB","( value )"];case Et:return["RGBE","( value )"];case Mt:return["RGBM","( value, 7.0 )"];case Tt:return["RGBM","( value, 16.0 )"];case Ct:return["RGBD","( value, 256.0 )"];case St:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+e)}}function Go(e,t){var n=Ho(t);return"vec4 "+e+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function Wo(e,t){var n=Ho(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function qo(e,t){var n;switch(t){case te:n="Linear";break;case ne:n="Reinhard";break;case ie:n="Uncharted2";break;case re:n="OptimizedCineon";break;default:throw new Error("unsupported toneMapping: "+t)}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function Yo(e,t,n){e=e||{};var i=[e.derivatives||t.envMapCubeUV||t.bumpMap||t.normalMap||t.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(e.fragDepth||t.logarithmicDepthBuffer)&&n.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",e.drawBuffers&&n.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(e.shaderTextureLOD||t.envMap)&&n.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""];return i.filter(Jo).join("\n")}function Xo(e){var t=[];for(var n in e){var i=e[n];!1!==i&&t.push("#define "+n+" "+i)}return t.join("\n")}function Zo(e,t){for(var n={},i=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),r=0;r<i;r++){var o=e.getActiveAttrib(t,r),s=o.name;n[s]=e.getAttribLocation(t,s)}return n}function Jo(e){return""!==e}function Ko(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights)}function Qo(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}function es(e){var t=/^[ \t]*#include +<([\w\d.]+)>/gm;function n(e,t){var n=Qi[t];if(void 0===n)throw new Error("Can not resolve #include <"+t+">");return es(n)}return e.replace(t,n)}function ts(e){var t=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g;function n(e,t,n,i){for(var r="",o=parseInt(t);o<parseInt(n);o++)r+=i.replace(/\[ i \]/g,"[ "+o+" ]");return r}return e.replace(t,n)}function ns(e,t,n,i,r,o){var s=e.context,a=i.defines,l=r.vertexShader,u=r.fragmentShader,c="SHADOWMAP_TYPE_BASIC";o.shadowMapType===d?c="SHADOWMAP_TYPE_PCF":o.shadowMapType===p&&(c="SHADOWMAP_TYPE_PCF_SOFT");var h="ENVMAP_TYPE_CUBE",f="ENVMAP_MODE_REFLECTION",m="ENVMAP_BLENDING_MULTIPLY";if(o.envMap){switch(i.envMap.mapping){case se:case ae:h="ENVMAP_TYPE_CUBE";break;case he:case de:h="ENVMAP_TYPE_CUBE_UV";break;case le:case ue:h="ENVMAP_TYPE_EQUIREC";break;case ce:h="ENVMAP_TYPE_SPHERE";break}switch(i.envMap.mapping){case ae:case ue:f="ENVMAP_MODE_REFRACTION";break}switch(i.combine){case J:m="ENVMAP_BLENDING_MULTIPLY";break;case K:m="ENVMAP_BLENDING_MIX";break;case Q:m="ENVMAP_BLENDING_ADD";break}}var g,v,y=e.gammaFactor>0?e.gammaFactor:1,x=Yo(i.extensions,o,t),b=Xo(a),w=s.createProgram();i.isRawShaderMaterial?(g=[b].filter(Jo).join("\n"),g.length>0&&(g+="\n"),v=[x,b].filter(Jo).join("\n"),v.length>0&&(v+="\n")):(g=["precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+r.name,b,o.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+y,"#define MAX_BONES "+o.maxBones,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+f:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.displacementMap&&o.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexColors?"#define USE_COLOR":"",o.flatShading?"#define FLAT_SHADED":"",o.skinning?"#define USE_SKINNING":"",o.useVertexTexture?"#define BONE_TEXTURE":"",o.morphTargets?"#define USE_MORPHTARGETS":"",o.morphNormals&&!1===o.flatShading?"#define USE_MORPHNORMALS":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+c:"",o.sizeAttenuation?"#define USE_SIZEATTENUATION":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&t.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Jo).join("\n"),v=[x,"precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+r.name,b,o.alphaTest?"#define ALPHATEST "+o.alphaTest:"","#define GAMMA_FACTOR "+y,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+h:"",o.envMap?"#define "+f:"",o.envMap?"#define "+m:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexColors?"#define USE_COLOR":"",o.gradientMap?"#define USE_GRADIENTMAP":"",o.flatShading?"#define FLAT_SHADED":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+c:"",o.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",o.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&t.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",o.envMap&&t.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",o.toneMapping!==ee?"#define TONE_MAPPING":"",o.toneMapping!==ee?Qi["tonemapping_pars_fragment"]:"",o.toneMapping!==ee?qo("toneMapping",o.toneMapping):"",o.dithering?"#define DITHERING":"",o.outputEncoding||o.mapEncoding||o.envMapEncoding||o.emissiveMapEncoding?Qi["encodings_pars_fragment"]:"",o.mapEncoding?Go("mapTexelToLinear",o.mapEncoding):"",o.envMapEncoding?Go("envMapTexelToLinear",o.envMapEncoding):"",o.emissiveMapEncoding?Go("emissiveMapTexelToLinear",o.emissiveMapEncoding):"",o.outputEncoding?Wo("linearToOutputTexel",o.outputEncoding):"",o.depthPacking?"#define DEPTH_PACKING "+i.depthPacking:"","\n"].filter(Jo).join("\n")),l=es(l),l=Ko(l,o),l=Qo(l,o),u=es(u),u=Ko(u,o),u=Qo(u,o),l=ts(l),u=ts(u);var _=g+l,A=v+u,S=Bo(s,s.VERTEX_SHADER,_),E=Bo(s,s.FRAGMENT_SHADER,A);s.attachShader(w,S),s.attachShader(w,E),void 0!==i.index0AttributeName?s.bindAttribLocation(w,0,i.index0AttributeName):!0===o.morphTargets&&s.bindAttribLocation(w,0,"position"),s.linkProgram(w);var M,T,C=s.getProgramInfoLog(w).trim(),P=s.getShaderInfoLog(S).trim(),R=s.getShaderInfoLog(E).trim(),L=!0,O=!0;return!1===s.getProgramParameter(w,s.LINK_STATUS)?(L=!1,console.error("THREE.WebGLProgram: shader error: ",s.getError(),"gl.VALIDATE_STATUS",s.getProgramParameter(w,s.VALIDATE_STATUS),"gl.getProgramInfoLog",C,P,R)):""!==C?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",C):""!==P&&""!==R||(O=!1),O&&(this.diagnostics={runnable:L,material:i,programLog:C,vertexShader:{log:P,prefix:g},fragmentShader:{log:R,prefix:v}}),s.deleteShader(S),s.deleteShader(E),this.getUniforms=function(){return void 0===M&&(M=new zo(s,w,e)),M},this.getAttributes=function(){return void 0===T&&(T=Zo(s,w)),T},this.destroy=function(){s.deleteProgram(w),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.name=r.name,this.id=$o++,this.code=n,this.usedTimes=1,this.program=w,this.vertexShader=S,this.fragmentShader=E,this}function is(e,t,n){var i=[],r={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow"},o=["precision","supportsVertexTextures","map","mapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering"];function s(e){var t=e.skeleton,i=t.bones;if(n.floatVertexTextures)return 1024;var r=n.maxVertexUniforms,o=Math.floor((r-20)/4),s=Math.min(o,i.length);return s<i.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+i.length+" bones. This GPU supports "+s+"."),0):s}function a(e,t){var n;return e?e.isTexture?n=e.encoding:e.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),n=e.texture.encoding):n=_t,n===_t&&t&&(n=St),n}this.getParameters=function(t,i,o,l,u,c,h){var d=r[t.type],p=h.isSkinnedMesh?s(h):0,f=n.precision;null!==t.precision&&(f=n.getMaxPrecision(t.precision),f!==t.precision&&console.warn("THREE.WebGLProgram.getParameters:",t.precision,"not supported, using",f,"instead."));var v=e.getRenderTarget(),y={shaderID:d,precision:f,supportsVertexTextures:n.vertexTextures,outputEncoding:a(v?v.texture:null,e.gammaOutput),map:!!t.map,mapEncoding:a(t.map,e.gammaInput),envMap:!!t.envMap,envMapMode:t.envMap&&t.envMap.mapping,envMapEncoding:a(t.envMap,e.gammaInput),envMapCubeUV:!!t.envMap&&(t.envMap.mapping===he||t.envMap.mapping===de),lightMap:!!t.lightMap,aoMap:!!t.aoMap,emissiveMap:!!t.emissiveMap,emissiveMapEncoding:a(t.emissiveMap,e.gammaInput),bumpMap:!!t.bumpMap,normalMap:!!t.normalMap,displacementMap:!!t.displacementMap,roughnessMap:!!t.roughnessMap,metalnessMap:!!t.metalnessMap,specularMap:!!t.specularMap,alphaMap:!!t.alphaMap,gradientMap:!!t.gradientMap,combine:t.combine,vertexColors:t.vertexColors,fog:!!l,useFog:t.fog,fogExp:l&&l.isFogExp2,flatShading:t.flatShading,sizeAttenuation:t.sizeAttenuation,logarithmicDepthBuffer:n.logarithmicDepthBuffer,skinning:t.skinning&&p>0,maxBones:p,useVertexTexture:n.floatVertexTextures,morphTargets:t.morphTargets,morphNormals:t.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:i.directional.length,numPointLights:i.point.length,numSpotLights:i.spot.length,numRectAreaLights:i.rectArea.length,numHemiLights:i.hemi.length,numClippingPlanes:u,numClipIntersection:c,dithering:t.dithering,shadowMapEnabled:e.shadowMap.enabled&&h.receiveShadow&&o.length>0,shadowMapType:e.shadowMap.type,toneMapping:e.toneMapping,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:t.premultipliedAlpha,alphaTest:t.alphaTest,doubleSided:t.side===g,flipSided:t.side===m,depthPacking:void 0!==t.depthPacking&&t.depthPacking};return y},this.getProgramCode=function(t,n){var i=[];if(n.shaderID?i.push(n.shaderID):(i.push(t.fragmentShader),i.push(t.vertexShader)),void 0!==t.defines)for(var r in t.defines)i.push(r),i.push(t.defines[r]);for(var s=0;s<o.length;s++)i.push(n[o[s]]);return i.push(t.onBeforeCompile.toString()),i.push(e.gammaOutput),i.join()},this.acquireProgram=function(n,r,o,s){for(var a,l=0,u=i.length;l<u;l++){var c=i[l];if(c.code===s){a=c,++a.usedTimes;break}}return void 0===a&&(a=new ns(e,t,s,n,r,o),i.push(a)),a},this.releaseProgram=function(e){if(0===--e.usedTimes){var t=i.indexOf(e);i[t]=i[i.length-1],i.pop(),e.destroy()}},this.programs=i}function rs(){var e=new WeakMap;function t(t){var n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n}function n(t){e.delete(t)}function i(t,n,i){e.get(t)[n]=i}function r(){e=new WeakMap}return{get:t,remove:n,update:i,dispose:r}}function os(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program&&t.program&&e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function ss(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function as(){var e=[],t=0,n=[],i=[];function r(){t=0,n.length=0,i.length=0}function o(r,o,s,a,l){var u=e[t];void 0===u?(u={id:r.id,object:r,geometry:o,material:s,program:s.program,renderOrder:r.renderOrder,z:a,group:l},e[t]=u):(u.id=r.id,u.object=r,u.geometry=o,u.material=s,u.program=s.program,u.renderOrder=r.renderOrder,u.z=a,u.group=l),(!0===s.transparent?i:n).push(u),t++}function s(){n.length>1&&n.sort(os),i.length>1&&i.sort(ss)}return{opaque:n,transparent:i,init:r,push:o,sort:s}}function ls(){var e={};function t(t,n){var i=t.id+","+n.id,r=e[i];return void 0===r&&(r=new as,e[i]=r),r}function n(){e={}}return{get:t,dispose:n}}function us(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var n;switch(t.type){case"DirectionalLight":n={direction:new Nt,color:new nr,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Ot};break;case"SpotLight":n={position:new Nt,direction:new Nt,color:new nr,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Ot};break;case"PointLight":n={position:new Nt,color:new nr,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Ot,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":n={direction:new Nt,skyColor:new nr,groundColor:new nr};break;case"RectAreaLight":n={color:new nr,position:new Nt,halfWidth:new Nt,halfHeight:new Nt};break}return e[t.id]=n,n}}}var cs=0;function hs(){var e=new us,t={id:cs++,hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},n=new Nt,i=new Dt,r=new Dt;function o(o,s,a){for(var l=0,u=0,c=0,h=0,d=0,p=0,f=0,m=0,g=a.matrixWorldInverse,v=0,y=o.length;v<y;v++){var x=o[v],b=x.color,w=x.intensity,_=x.distance,A=x.shadow&&x.shadow.map?x.shadow.map.texture:null;if(x.isAmbientLight)l+=b.r*w,u+=b.g*w,c+=b.b*w;else if(x.isDirectionalLight){var S=e.get(x);if(S.color.copy(x.color).multiplyScalar(x.intensity),S.direction.setFromMatrixPosition(x.matrixWorld),n.setFromMatrixPosition(x.target.matrixWorld),S.direction.sub(n),S.direction.transformDirection(g),S.shadow=x.castShadow,x.castShadow){var E=x.shadow;S.shadowBias=E.bias,S.shadowRadius=E.radius,S.shadowMapSize=E.mapSize}t.directionalShadowMap[h]=A,t.directionalShadowMatrix[h]=x.shadow.matrix,t.directional[h]=S,h++}else if(x.isSpotLight){S=e.get(x);if(S.position.setFromMatrixPosition(x.matrixWorld),S.position.applyMatrix4(g),S.color.copy(b).multiplyScalar(w),S.distance=_,S.direction.setFromMatrixPosition(x.matrixWorld),n.setFromMatrixPosition(x.target.matrixWorld),S.direction.sub(n),S.direction.transformDirection(g),S.coneCos=Math.cos(x.angle),S.penumbraCos=Math.cos(x.angle*(1-x.penumbra)),S.decay=0===x.distance?0:x.decay,S.shadow=x.castShadow,x.castShadow){E=x.shadow;S.shadowBias=E.bias,S.shadowRadius=E.radius,S.shadowMapSize=E.mapSize}t.spotShadowMap[p]=A,t.spotShadowMatrix[p]=x.shadow.matrix,t.spot[p]=S,p++}else if(x.isRectAreaLight){S=e.get(x);S.color.copy(b).multiplyScalar(w),S.position.setFromMatrixPosition(x.matrixWorld),S.position.applyMatrix4(g),r.identity(),i.copy(x.matrixWorld),i.premultiply(g),r.extractRotation(i),S.halfWidth.set(.5*x.width,0,0),S.halfHeight.set(0,.5*x.height,0),S.halfWidth.applyMatrix4(r),S.halfHeight.applyMatrix4(r),t.rectArea[f]=S,f++}else if(x.isPointLight){S=e.get(x);if(S.position.setFromMatrixPosition(x.matrixWorld),S.position.applyMatrix4(g),S.color.copy(x.color).multiplyScalar(x.intensity),S.distance=x.distance,S.decay=0===x.distance?0:x.decay,S.shadow=x.castShadow,x.castShadow){E=x.shadow;S.shadowBias=E.bias,S.shadowRadius=E.radius,S.shadowMapSize=E.mapSize,S.shadowCameraNear=E.camera.near,S.shadowCameraFar=E.camera.far}t.pointShadowMap[d]=A,t.pointShadowMatrix[d]=x.shadow.matrix,t.point[d]=S,d++}else if(x.isHemisphereLight){S=e.get(x);S.direction.setFromMatrixPosition(x.matrixWorld),S.direction.transformDirection(g),S.direction.normalize(),S.skyColor.copy(x.color).multiplyScalar(w),S.groundColor.copy(x.groundColor).multiplyScalar(w),t.hemi[m]=S,m++}}t.ambient[0]=l,t.ambient[1]=u,t.ambient[2]=c,t.directional.length=h,t.spot.length=p,t.rectArea.length=f,t.point.length=d,t.hemi.length=m,t.hash=t.id+","+h+","+d+","+p+","+f+","+m+","+s.length}return{setup:o,state:t}}function ds(){var e=new hs,t=[],n=[],i=[];function r(){t.length=0,n.length=0,i.length=0}function o(e){t.push(e)}function s(e){n.push(e)}function a(e){i.push(e)}function l(i){e.setup(t,n,i)}var u={lightsArray:t,shadowsArray:n,spritesArray:i,lights:e};return{init:r,state:u,setupLights:l,pushLight:o,pushShadow:s,pushSprite:a}}function ps(){var e={};function t(t,n){var i=t.id+","+n.id,r=e[i];return void 0===r&&(r=new ds,e[i]=r),r}function n(){e={}}return{get:t,dispose:n}}function fs(e){Ir.call(this),this.type="MeshDepthMaterial",this.depthPacking=Pt,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(e)}function ms(e){Ir.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new Nt,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.lights=!1,this.setValues(e)}function gs(e,t,n){for(var i=new Wt,r=new Dt,o=new Ot,s=new Ot(n,n),a=new Nt,l=new Nt,u=1,c=2,h=1+(u|c),p=new Array(h),v=new Array(h),y={},x={0:m,1:f,2:g},b=[new Nt(1,0,0),new Nt(-1,0,0),new Nt(0,0,1),new Nt(0,0,-1),new Nt(0,1,0),new Nt(0,-1,0)],w=[new Nt(0,1,0),new Nt(0,1,0),new Nt(0,1,0),new Nt(0,1,0),new Nt(0,0,1),new Nt(0,0,-1)],_=[new Ft,new Ft,new Ft,new Ft,new Ft,new Ft],A=0;A!==h;++A){var S=0!==(A&u),E=0!==(A&c),M=new fs({depthPacking:Rt,morphTargets:S,skinning:E});p[A]=M;var T=new ms({morphTargets:S,skinning:E});v[A]=T}var C=this;function P(t,n,i,r,o,s){var a=t.geometry,l=null,h=p,d=t.customDepthMaterial;if(i&&(h=v,d=t.customDistanceMaterial),d)l=d;else{var f=!1;n.morphTargets&&(a&&a.isBufferGeometry?f=a.morphAttributes&&a.morphAttributes.position&&a.morphAttributes.position.length>0:a&&a.isGeometry&&(f=a.morphTargets&&a.morphTargets.length>0)),t.isSkinnedMesh&&!1===n.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",t);var m=t.isSkinnedMesh&&n.skinning,g=0;f&&(g|=u),m&&(g|=c),l=h[g]}if(e.localClippingEnabled&&!0===n.clipShadows&&0!==n.clippingPlanes.length){var b=l.uuid,w=n.uuid,_=y[b];void 0===_&&(_={},y[b]=_);var A=_[w];void 0===A&&(A=l.clone(),_[w]=A),l=A}return l.visible=n.visible,l.wireframe=n.wireframe,l.side=null!=n.shadowSide?n.shadowSide:x[n.side],l.clipShadows=n.clipShadows,l.clippingPlanes=n.clippingPlanes,l.clipIntersection=n.clipIntersection,l.wireframeLinewidth=n.wireframeLinewidth,l.linewidth=n.linewidth,i&&l.isMeshDistanceMaterial&&(l.referencePosition.copy(r),l.nearDistance=o,l.farDistance=s),l}function R(n,r,o,s){if(!1!==n.visible){var a=n.layers.test(r.layers);if(a&&(n.isMesh||n.isLine||n.isPoints)&&n.castShadow&&(!n.frustumCulled||i.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,n.matrixWorld);var u=t.update(n),c=n.material;if(Array.isArray(c))for(var h=u.groups,d=0,p=h.length;d<p;d++){var f=h[d],m=c[f.materialIndex];if(m&&m.visible){var g=P(n,m,s,l,o.near,o.far);e.renderBufferDirect(o,null,u,g,n,f)}}else if(c.visible){g=P(n,c,s,l,o.near,o.far);e.renderBufferDirect(o,null,u,g,n,null)}}for(var v=n.children,y=0,x=v.length;y<x;y++)R(v[y],r,o,s)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=d,this.render=function(t,n,u){if(!1!==C.enabled&&(!1!==C.autoUpdate||!1!==C.needsUpdate)&&0!==t.length){var c,h=e.context,d=e.state;d.disable(h.BLEND),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);for(var p=0,f=t.length;p<f;p++){var m=t[p],g=m.shadow,v=m&&m.isPointLight;if(void 0!==g){var y=g.camera;if(o.copy(g.mapSize),o.min(s),v){var x=o.x,A=o.y;_[0].set(2*x,A,x,A),_[1].set(0,A,x,A),_[2].set(3*x,A,x,A),_[3].set(x,A,x,A),_[4].set(3*x,0,x,A),_[5].set(x,0,x,A),o.x*=4,o.y*=2}if(null===g.map){var S={minFilter:ge,magFilter:ge,format:ke};g.map=new zt(o.x,o.y,S),g.map.texture.name=m.name+".shadowMap",y.updateProjectionMatrix()}g.isSpotLightShadow&&g.update(m);var E=g.map,M=g.matrix;l.setFromMatrixPosition(m.matrixWorld),y.position.copy(l),v?(c=6,M.makeTranslation(-l.x,-l.y,-l.z)):(c=1,a.setFromMatrixPosition(m.target.matrixWorld),y.lookAt(a),y.updateMatrixWorld(),M.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),M.multiply(y.projectionMatrix),M.multiply(y.matrixWorldInverse)),e.setRenderTarget(E),e.clear();for(var T=0;T<c;T++){if(v){a.copy(y.position),a.add(b[T]),y.up.copy(w[T]),y.lookAt(a),y.updateMatrixWorld();var P=_[T];d.viewport(P)}r.multiplyMatrices(y.projectionMatrix,y.matrixWorldInverse),i.setFromMatrix(r),R(n,u,y,v)}}else console.warn("THREE.WebGLShadowMap:",m,"has no shadow.")}C.needsUpdate=!1}}}function vs(e,t,n,i,r,o,s,a,l){Ut.call(this,e,t,n,i,r,o,s,a,l),this.needsUpdate=!0}function ys(e,t,n,i,r){var o,s,a,l,u,c,h=new Nt,d=new It,p=new Nt;function f(){var e=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),n=new Uint16Array([0,1,2,0,2,3]);o=t.createBuffer(),s=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,o),t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,s),t.bufferData(t.ELEMENT_ARRAY_BUFFER,n,t.STATIC_DRAW),a=m(),l={position:t.getAttribLocation(a,"position"),uv:t.getAttribLocation(a,"uv")},u={uvOffset:t.getUniformLocation(a,"uvOffset"),uvScale:t.getUniformLocation(a,"uvScale"),rotation:t.getUniformLocation(a,"rotation"),center:t.getUniformLocation(a,"center"),scale:t.getUniformLocation(a,"scale"),color:t.getUniformLocation(a,"color"),map:t.getUniformLocation(a,"map"),opacity:t.getUniformLocation(a,"opacity"),modelViewMatrix:t.getUniformLocation(a,"modelViewMatrix"),projectionMatrix:t.getUniformLocation(a,"projectionMatrix"),fogType:t.getUniformLocation(a,"fogType"),fogDensity:t.getUniformLocation(a,"fogDensity"),fogNear:t.getUniformLocation(a,"fogNear"),fogFar:t.getUniformLocation(a,"fogFar"),fogColor:t.getUniformLocation(a,"fogColor"),fogDepth:t.getUniformLocation(a,"fogDepth"),alphaTest:t.getUniformLocation(a,"alphaTest")};var i=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");i.width=8,i.height=8;var r=i.getContext("2d");r.fillStyle="white",r.fillRect(0,0,8,8),c=new vs(i)}function m(){var e=t.createProgram(),n=t.createShader(t.VERTEX_SHADER),i=t.createShader(t.FRAGMENT_SHADER);return t.shaderSource(n,["precision "+r.precision+" float;","#define SHADER_NAME SpriteMaterial","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 center;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float fogDepth;","void main() {","\tvUV = uvOffset + uv * uvScale;","\tvec2 alignedPosition = ( position - center ) * scale;","\tvec2 rotatedPosition;","\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","\tvec4 mvPosition;","\tmvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","\tmvPosition.xy += rotatedPosition;","\tgl_Position = projectionMatrix * mvPosition;","\tfogDepth = - mvPosition.z;","}"].join("\n")),t.shaderSource(i,["precision "+r.precision+" float;","#define SHADER_NAME SpriteMaterial","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","varying float fogDepth;","void main() {","\tvec4 texture = texture2D( map, vUV );","\tgl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","\tif ( gl_FragColor.a < alphaTest ) discard;","\tif ( fogType > 0 ) {","\t\tfloat fogFactor = 0.0;","\t\tif ( fogType == 1 ) {","\t\t\tfogFactor = smoothstep( fogNear, fogFar, fogDepth );","\t\t} else {","\t\t\tconst float LOG2 = 1.442695;","\t\t\tfogFactor = exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 );","\t\t\tfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","\t\t}","\t\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );","\t}","}"].join("\n")),t.compileShader(n),t.compileShader(i),t.attachShader(e,n),t.attachShader(e,i),t.linkProgram(e),e}function g(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:t.id-e.id}this.render=function(r,m,v){if(0!==r.length){void 0===a&&f(),n.useProgram(a),n.initAttributes(),n.enableAttribute(l.position),n.enableAttribute(l.uv),n.disableUnusedAttributes(),n.disable(t.CULL_FACE),n.enable(t.BLEND),t.bindBuffer(t.ARRAY_BUFFER,o),t.vertexAttribPointer(l.position,2,t.FLOAT,!1,16,0),t.vertexAttribPointer(l.uv,2,t.FLOAT,!1,16,8),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,s),t.uniformMatrix4fv(u.projectionMatrix,!1,v.projectionMatrix.elements),n.activeTexture(t.TEXTURE0),t.uniform1i(u.map,0);var y=0,x=0,b=m.fog;b?(t.uniform3f(u.fogColor,b.color.r,b.color.g,b.color.b),b.isFog?(t.uniform1f(u.fogNear,b.near),t.uniform1f(u.fogFar,b.far),t.uniform1i(u.fogType,1),y=1,x=1):b.isFogExp2&&(t.uniform1f(u.fogDensity,b.density),t.uniform1i(u.fogType,2),y=2,x=2)):(t.uniform1i(u.fogType,0),y=0,x=0);for(var w=0,_=r.length;w<_;w++){var A=r[w];A.modelViewMatrix.multiplyMatrices(v.matrixWorldInverse,A.matrixWorld),A.z=-A.modelViewMatrix.elements[14]}r.sort(g);var S=[],E=[];for(w=0,_=r.length;w<_;w++){A=r[w];var M=A.material;if(!1!==M.visible){A.onBeforeRender(e,m,v,void 0,M,void 0),t.uniform1f(u.alphaTest,M.alphaTest),t.uniformMatrix4fv(u.modelViewMatrix,!1,A.modelViewMatrix.elements),A.matrixWorld.decompose(h,d,p),S[0]=p.x,S[1]=p.y,E[0]=A.center.x-.5,E[1]=A.center.y-.5;var T=0;m.fog&&M.fog&&(T=x),y!==T&&(t.uniform1i(u.fogType,T),y=T),null!==M.map?(t.uniform2f(u.uvOffset,M.map.offset.x,M.map.offset.y),t.uniform2f(u.uvScale,M.map.repeat.x,M.map.repeat.y)):(t.uniform2f(u.uvOffset,0,0),t.uniform2f(u.uvScale,1,1)),t.uniform1f(u.opacity,M.opacity),t.uniform3f(u.color,M.color.r,M.color.g,M.color.b),t.uniform1f(u.rotation,M.rotation),t.uniform2fv(u.center,E),t.uniform2fv(u.scale,S),n.setBlending(M.blending,M.blendEquation,M.blendSrc,M.blendDst,M.blendEquationAlpha,M.blendSrcAlpha,M.blendDstAlpha,M.premultipliedAlpha),n.buffers.depth.setTest(M.depthTest),n.buffers.depth.setMask(M.depthWrite),n.buffers.color.setMask(M.colorWrite),i.setTexture2D(M.map||c,0),t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0),A.onAfterRender(e,m,v,void 0,M,void 0)}}n.enable(t.CULL_FACE),n.reset()}}}function xs(e,t,n){function i(){var t=!1,n=new Ft,i=null,r=new Ft(0,0,0,0);return{setMask:function(n){i===n||t||(e.colorMask(n,n,n,n),i=n)},setLocked:function(e){t=e},setClear:function(t,i,o,s,a){!0===a&&(t*=s,i*=s,o*=s),n.set(t,i,o,s),!1===r.equals(n)&&(e.clearColor(t,i,o,s),r.copy(n))},reset:function(){t=!1,i=null,r.set(-1,0,0,0)}}}function r(){var t=!1,n=null,i=null,r=null;return{setTest:function(t){t?le(e.DEPTH_TEST):ue(e.DEPTH_TEST)},setMask:function(i){n===i||t||(e.depthMask(i),n=i)},setFunc:function(t){if(i!==t){if(t)switch(t){case $:e.depthFunc(e.NEVER);break;case H:e.depthFunc(e.ALWAYS);break;case G:e.depthFunc(e.LESS);break;case W:e.depthFunc(e.LEQUAL);break;case q:e.depthFunc(e.EQUAL);break;case Y:e.depthFunc(e.GEQUAL);break;case X:e.depthFunc(e.GREATER);break;case Z:e.depthFunc(e.NOTEQUAL);break;default:e.depthFunc(e.LEQUAL)}else e.depthFunc(e.LEQUAL);i=t}},setLocked:function(e){t=e},setClear:function(t){r!==t&&(e.clearDepth(t),r=t)},reset:function(){t=!1,n=null,i=null,r=null}}}function o(){var t=!1,n=null,i=null,r=null,o=null,s=null,a=null,l=null,u=null;return{setTest:function(t){t?le(e.STENCIL_TEST):ue(e.STENCIL_TEST)},setMask:function(i){n===i||t||(e.stencilMask(i),n=i)},setFunc:function(t,n,s){i===t&&r===n&&o===s||(e.stencilFunc(t,n,s),i=t,r=n,o=s)},setOp:function(t,n,i){s===t&&a===n&&l===i||(e.stencilOp(t,n,i),s=t,a=n,l=i)},setLocked:function(e){t=e},setClear:function(t){u!==t&&(e.clearStencil(t),u=t)},reset:function(){t=!1,n=null,i=null,r=null,o=null,s=null,a=null,l=null,u=null}}}var s=new i,a=new r,l=new o,d=e.getParameter(e.MAX_VERTEX_ATTRIBS),p=new Uint8Array(d),f=new Uint8Array(d),v=new Uint8Array(d),y={},x=null,b=null,T=null,C=null,P=null,R=null,L=null,O=null,D=null,I=!1,N=null,k=null,V=null,U=null,F=null,z=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS),j=!1,B=0,J=e.getParameter(e.VERSION);-1!==J.indexOf("WebGL")?(B=parseFloat(/^WebGL\ ([0-9])/.exec(J)[1]),j=B>=1):-1!==J.indexOf("OpenGL ES")&&(B=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(J)[1]),j=B>=2);var K=null,Q={},ee=new Ft,te=new Ft;function ne(t,n,i){var r=new Uint8Array(4),o=e.createTexture();e.bindTexture(t,o),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(var s=0;s<i;s++)e.texImage2D(n+s,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,r);return o}var ie={};function re(){for(var e=0,t=p.length;e<t;e++)p[e]=0}function oe(n){if(p[n]=1,0===f[n]&&(e.enableVertexAttribArray(n),f[n]=1),0!==v[n]){var i=t.get("ANGLE_instanced_arrays");i.vertexAttribDivisorANGLE(n,0),v[n]=0}}function se(n,i){if(p[n]=1,0===f[n]&&(e.enableVertexAttribArray(n),f[n]=1),v[n]!==i){var r=t.get("ANGLE_instanced_arrays");r.vertexAttribDivisorANGLE(n,i),v[n]=i}}function ae(){for(var t=0,n=f.length;t!==n;++t)f[t]!==p[t]&&(e.disableVertexAttribArray(t),f[t]=0)}function le(t){!0!==y[t]&&(e.enable(t),y[t]=!0)}function ue(t){!1!==y[t]&&(e.disable(t),y[t]=!1)}function ce(){if(null===x&&(x=[],t.get("WEBGL_compressed_texture_pvrtc")||t.get("WEBGL_compressed_texture_s3tc")||t.get("WEBGL_compressed_texture_etc1")||t.get("WEBGL_compressed_texture_astc")))for(var n=e.getParameter(e.COMPRESSED_TEXTURE_FORMATS),i=0;i<n.length;i++)x.push(n[i]);return x}function he(t){return b!==t&&(e.useProgram(t),b=t,!0)}function de(t,i,r,o,s,a,l,u){if(t!==w?le(e.BLEND):ue(e.BLEND),t!==M){if(t!==T||u!==I)switch(t){case A:u?(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ONE,e.ONE,e.ONE,e.ONE)):(e.blendEquation(e.FUNC_ADD),e.blendFunc(e.SRC_ALPHA,e.ONE));break;case S:u?(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ZERO,e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ONE_MINUS_SRC_ALPHA)):(e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ZERO,e.ONE_MINUS_SRC_COLOR));break;case E:u?(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA)):(e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ZERO,e.SRC_COLOR));break;default:u?(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA)):(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA))}C=null,P=null,R=null,L=null,O=null,D=null}else s=s||i,a=a||r,l=l||o,i===C&&s===L||(e.blendEquationSeparate(n.convert(i),n.convert(s)),C=i,L=s),r===P&&o===R&&a===O&&l===D||(e.blendFuncSeparate(n.convert(r),n.convert(o),n.convert(a),n.convert(l)),P=r,R=o,O=a,D=l);T=t,I=u}function pe(t,n){t.side===g?ue(e.CULL_FACE):le(e.CULL_FACE);var i=t.side===m;n&&(i=!i),fe(i),!0===t.transparent?de(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha):de(w),a.setFunc(t.depthFunc),a.setTest(t.depthTest),a.setMask(t.depthWrite),s.setMask(t.colorWrite),ve(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)}function fe(t){N!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),N=t)}function me(t){t!==u?(le(e.CULL_FACE),t!==k&&(t===c?e.cullFace(e.BACK):t===h?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):ue(e.CULL_FACE),k=t}function ge(t){t!==V&&(j&&e.lineWidth(t),V=t)}function ve(t,n,i){t?(le(e.POLYGON_OFFSET_FILL),U===n&&F===i||(e.polygonOffset(n,i),U=n,F=i)):ue(e.POLYGON_OFFSET_FILL)}function ye(t){t?le(e.SCISSOR_TEST):ue(e.SCISSOR_TEST)}function xe(t){void 0===t&&(t=e.TEXTURE0+z-1),K!==t&&(e.activeTexture(t),K=t)}function be(t,n){null===K&&xe();var i=Q[K];void 0===i&&(i={type:void 0,texture:void 0},Q[K]=i),i.type===t&&i.texture===n||(e.bindTexture(t,n||ie[t]),i.type=t,i.texture=n)}function we(){try{e.compressedTexImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}}function _e(){try{e.texImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}}function Ae(t){!1===ee.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),ee.copy(t))}function Se(t){!1===te.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),te.copy(t))}function Ee(){for(var t=0;t<f.length;t++)1===f[t]&&(e.disableVertexAttribArray(t),f[t]=0);y={},x=null,K=null,Q={},b=null,T=null,N=null,k=null,s.reset(),a.reset(),l.reset()}return ie[e.TEXTURE_2D]=ne(e.TEXTURE_2D,e.TEXTURE_2D,1),ie[e.TEXTURE_CUBE_MAP]=ne(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),s.setClear(0,0,0,1),a.setClear(1),l.setClear(0),le(e.DEPTH_TEST),a.setFunc(W),fe(!1),me(c),le(e.CULL_FACE),le(e.BLEND),de(_),{buffers:{color:s,depth:a,stencil:l},initAttributes:re,enableAttribute:oe,enableAttributeAndDivisor:se,disableUnusedAttributes:ae,enable:le,disable:ue,getCompressedTextureFormats:ce,useProgram:he,setBlending:de,setMaterial:pe,setFlipSided:fe,setCullFace:me,setLineWidth:ge,setPolygonOffset:ve,setScissorTest:ye,activeTexture:xe,bindTexture:be,compressedTexImage2D:we,texImage2D:_e,scissor:Ae,viewport:Se,reset:Ee}}function bs(e,t,n,i,r,o,s){var a,l="undefined"!==typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext,u={};function c(e,t){if(e.width>t||e.height>t){if("data"in e)return void console.warn("THREE.WebGLRenderer: image in DataTexture is too big ("+e.width+"x"+e.height+").");var n=t/Math.max(e.width,e.height),i=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");i.width=Math.floor(e.width*n),i.height=Math.floor(e.height*n);var r=i.getContext("2d");return r.drawImage(e,0,0,e.width,e.height,0,0,i.width,i.height),console.warn("THREE.WebGLRenderer: image is too big ("+e.width+"x"+e.height+"). Resized to "+i.width+"x"+i.height,e),i}return e}function h(e){return Lt.isPowerOfTwo(e.width)&&Lt.isPowerOfTwo(e.height)}function d(e){if(e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof ImageBitmap){void 0===a&&(a=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),a.width=Lt.floorPowerOfTwo(e.width),a.height=Lt.floorPowerOfTwo(e.height);var t=a.getContext("2d");return t.drawImage(e,0,0,a.width,a.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+e.width+"x"+e.height+"). Resized to "+a.width+"x"+a.height,e),a}return e}function p(e){return e.wrapS!==fe||e.wrapT!==fe||e.minFilter!==ge&&e.minFilter!==xe}function f(e,t){return e.generateMipmaps&&t&&e.minFilter!==ge&&e.minFilter!==xe}function m(t,n,r,o){e.generateMipmap(t);var s=i.get(n);s.__maxMipLevel=Math.log(Math.max(r,o))*Math.LOG2E}function g(t){return t===ge||t===ve||t===ye?e.NEAREST:e.LINEAR}function v(e){var t=e.target;t.removeEventListener("dispose",v),x(t),t.isVideoTexture&&delete u[t.id],s.memory.textures--}function y(e){var t=e.target;t.removeEventListener("dispose",y),b(t),s.memory.textures--}function x(t){var n=i.get(t);if(t.image&&n.__image__webglTextureCube)e.deleteTexture(n.__image__webglTextureCube);else{if(void 0===n.__webglInit)return;e.deleteTexture(n.__webglTexture)}i.remove(t)}function b(t){var n=i.get(t),r=i.get(t.texture);if(t){if(void 0!==r.__webglTexture&&e.deleteTexture(r.__webglTexture),t.depthTexture&&t.depthTexture.dispose(),t.isWebGLRenderTargetCube)for(var o=0;o<6;o++)e.deleteFramebuffer(n.__webglFramebuffer[o]),n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer[o]);else e.deleteFramebuffer(n.__webglFramebuffer),n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer);i.remove(t.texture),i.remove(t)}}function w(t,r){var o=i.get(t);if(t.isVideoTexture&&O(t),t.version>0&&o.__version!==t.version){var s=t.image;if(void 0===s)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",t);else{if(!1!==s.complete)return void E(o,t,r);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",t)}}n.activeTexture(e.TEXTURE0+r),n.bindTexture(e.TEXTURE_2D,o.__webglTexture)}function _(t,a){var l=i.get(t);if(6===t.image.length)if(t.version>0&&l.__version!==t.version){l.__image__webglTextureCube||(t.addEventListener("dispose",v),l.__image__webglTextureCube=e.createTexture(),s.memory.textures++),n.activeTexture(e.TEXTURE0+a),n.bindTexture(e.TEXTURE_CUBE_MAP,l.__image__webglTextureCube),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t.flipY);for(var u=t&&t.isCompressedTexture,d=t.image[0]&&t.image[0].isDataTexture,p=[],g=0;g<6;g++)p[g]=u||d?d?t.image[g].image:t.image[g]:c(t.image[g],r.maxCubemapSize);var y=p[0],x=h(y),b=o.convert(t.format),w=o.convert(t.type);S(e.TEXTURE_CUBE_MAP,t,x);for(g=0;g<6;g++)if(u)for(var _,A=p[g].mipmaps,E=0,M=A.length;E<M;E++)_=A[E],t.format!==ke&&t.format!==Ne?n.getCompressedTextureFormats().indexOf(b)>-1?n.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+g,E,b,_.width,_.height,0,_.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+g,E,b,_.width,_.height,0,b,w,_.data);else d?n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+g,0,b,p[g].width,p[g].height,0,b,w,p[g].data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+g,0,b,b,w,p[g]);l.__maxMipLevel=u?A.length-1:0,f(t,x)&&m(e.TEXTURE_CUBE_MAP,t,y.width,y.height),l.__version=t.version,t.onUpdate&&t.onUpdate(t)}else n.activeTexture(e.TEXTURE0+a),n.bindTexture(e.TEXTURE_CUBE_MAP,l.__image__webglTextureCube)}function A(t,r){n.activeTexture(e.TEXTURE0+r),n.bindTexture(e.TEXTURE_CUBE_MAP,i.get(t).__webglTexture)}function S(n,s,a){var l;if(a?(e.texParameteri(n,e.TEXTURE_WRAP_S,o.convert(s.wrapS)),e.texParameteri(n,e.TEXTURE_WRAP_T,o.convert(s.wrapT)),e.texParameteri(n,e.TEXTURE_MAG_FILTER,o.convert(s.magFilter)),e.texParameteri(n,e.TEXTURE_MIN_FILTER,o.convert(s.minFilter))):(e.texParameteri(n,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(n,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),s.wrapS===fe&&s.wrapT===fe||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",s),e.texParameteri(n,e.TEXTURE_MAG_FILTER,g(s.magFilter)),e.texParameteri(n,e.TEXTURE_MIN_FILTER,g(s.minFilter)),s.minFilter!==ge&&s.minFilter!==xe&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",s)),l=t.get("EXT_texture_filter_anisotropic"),l){if(s.type===Ce&&null===t.get("OES_texture_float_linear"))return;if(s.type===Pe&&null===t.get("OES_texture_half_float_linear"))return;(s.anisotropy>1||i.get(s).__currentAnisotropy)&&(e.texParameterf(n,l.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(s.anisotropy,r.getMaxAnisotropy())),i.get(s).__currentAnisotropy=s.anisotropy)}}function E(t,i,a){void 0===t.__webglInit&&(t.__webglInit=!0,i.addEventListener("dispose",v),t.__webglTexture=e.createTexture(),s.memory.textures++),n.activeTexture(e.TEXTURE0+a),n.bindTexture(e.TEXTURE_2D,t.__webglTexture),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,i.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,i.unpackAlignment);var u=c(i.image,r.maxTextureSize);p(i)&&!1===h(u)&&(u=d(u));var g=h(u),y=o.convert(i.format),x=o.convert(i.type);S(e.TEXTURE_2D,i,g);var b,w=i.mipmaps;if(i.isDepthTexture){var _=e.DEPTH_COMPONENT;if(i.type===Ce){if(!l)throw new Error("Float Depth Texture only supported in WebGL2.0");_=e.DEPTH_COMPONENT32F}else l&&(_=e.DEPTH_COMPONENT16);i.format===Fe&&_===e.DEPTH_COMPONENT&&i.type!==Ee&&i.type!==Te&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),i.type=Ee,x=o.convert(i.type)),i.format===ze&&(_=e.DEPTH_STENCIL,i.type!==De&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),i.type=De,x=o.convert(i.type))),n.texImage2D(e.TEXTURE_2D,0,_,u.width,u.height,0,y,x,null)}else if(i.isDataTexture)if(w.length>0&&g){for(var A=0,E=w.length;A<E;A++)b=w[A],n.texImage2D(e.TEXTURE_2D,A,y,b.width,b.height,0,y,x,b.data);i.generateMipmaps=!1,t.__maxMipLevel=w.length-1}else n.texImage2D(e.TEXTURE_2D,0,y,u.width,u.height,0,y,x,u.data),t.__maxMipLevel=0;else if(i.isCompressedTexture){for(A=0,E=w.length;A<E;A++)b=w[A],i.format!==ke&&i.format!==Ne?n.getCompressedTextureFormats().indexOf(y)>-1?n.compressedTexImage2D(e.TEXTURE_2D,A,y,b.width,b.height,0,b.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(e.TEXTURE_2D,A,y,b.width,b.height,0,y,x,b.data);t.__maxMipLevel=w.length-1}else if(w.length>0&&g){for(A=0,E=w.length;A<E;A++)b=w[A],n.texImage2D(e.TEXTURE_2D,A,y,y,x,b);i.generateMipmaps=!1,t.__maxMipLevel=w.length-1}else n.texImage2D(e.TEXTURE_2D,0,y,y,x,u),t.__maxMipLevel=0;f(i,g)&&m(e.TEXTURE_2D,i,u.width,u.height),t.__version=i.version,i.onUpdate&&i.onUpdate(i)}function M(t,r,s,a){var l=o.convert(r.texture.format),u=o.convert(r.texture.type);n.texImage2D(a,0,l,r.width,r.height,0,l,u,null),e.bindFramebuffer(e.FRAMEBUFFER,t),e.framebufferTexture2D(e.FRAMEBUFFER,s,a,i.get(r.texture).__webglTexture,0),e.bindFramebuffer(e.FRAMEBUFFER,null)}function T(t,n){e.bindRenderbuffer(e.RENDERBUFFER,t),n.depthBuffer&&!n.stencilBuffer?(e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,n.width,n.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t)):n.depthBuffer&&n.stencilBuffer?(e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,n.width,n.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t)):e.renderbufferStorage(e.RENDERBUFFER,e.RGBA4,n.width,n.height),e.bindRenderbuffer(e.RENDERBUFFER,null)}function C(t,n){var r=n&&n.isWebGLRenderTargetCube;if(r)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(e.FRAMEBUFFER,t),!n.depthTexture||!n.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");i.get(n.depthTexture).__webglTexture&&n.depthTexture.image.width===n.width&&n.depthTexture.image.height===n.height||(n.depthTexture.image.width=n.width,n.depthTexture.image.height=n.height,n.depthTexture.needsUpdate=!0),w(n.depthTexture,0);var o=i.get(n.depthTexture).__webglTexture;if(n.depthTexture.format===Fe)e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,o,0);else{if(n.depthTexture.format!==ze)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,o,0)}}function P(t){var n=i.get(t),r=!0===t.isWebGLRenderTargetCube;if(t.depthTexture){if(r)throw new Error("target.depthTexture not supported in Cube render targets");C(n.__webglFramebuffer,t)}else if(r){n.__webglDepthbuffer=[];for(var o=0;o<6;o++)e.bindFramebuffer(e.FRAMEBUFFER,n.__webglFramebuffer[o]),n.__webglDepthbuffer[o]=e.createRenderbuffer(),T(n.__webglDepthbuffer[o],t)}else e.bindFramebuffer(e.FRAMEBUFFER,n.__webglFramebuffer),n.__webglDepthbuffer=e.createRenderbuffer(),T(n.__webglDepthbuffer,t);e.bindFramebuffer(e.FRAMEBUFFER,null)}function R(t){var r=i.get(t),o=i.get(t.texture);t.addEventListener("dispose",y),o.__webglTexture=e.createTexture(),s.memory.textures++;var a=!0===t.isWebGLRenderTargetCube,l=h(t);if(a){r.__webglFramebuffer=[];for(var u=0;u<6;u++)r.__webglFramebuffer[u]=e.createFramebuffer()}else r.__webglFramebuffer=e.createFramebuffer();if(a){n.bindTexture(e.TEXTURE_CUBE_MAP,o.__webglTexture),S(e.TEXTURE_CUBE_MAP,t.texture,l);for(u=0;u<6;u++)M(r.__webglFramebuffer[u],t,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+u);f(t.texture,l)&&m(e.TEXTURE_CUBE_MAP,t.texture,t.width,t.height),n.bindTexture(e.TEXTURE_CUBE_MAP,null)}else n.bindTexture(e.TEXTURE_2D,o.__webglTexture),S(e.TEXTURE_2D,t.texture,l),M(r.__webglFramebuffer,t,e.COLOR_ATTACHMENT0,e.TEXTURE_2D),f(t.texture,l)&&m(e.TEXTURE_2D,t.texture,t.width,t.height),n.bindTexture(e.TEXTURE_2D,null);t.depthBuffer&&P(t)}function L(t){var r=t.texture,o=h(t);if(f(r,o)){var s=t.isWebGLRenderTargetCube?e.TEXTURE_CUBE_MAP:e.TEXTURE_2D,a=i.get(r).__webglTexture;n.bindTexture(s,a),m(s,r,t.width,t.height),n.bindTexture(s,null)}}function O(e){var t=e.id,n=s.render.frame;u[t]!==n&&(u[t]=n,e.update())}this.setTexture2D=w,this.setTextureCube=_,this.setTextureCubeDynamic=A,this.setupRenderTarget=R,this.updateRenderTargetMipmap=L}function ws(e,t){function n(n){var i;if(n===pe)return e.REPEAT;if(n===fe)return e.CLAMP_TO_EDGE;if(n===me)return e.MIRRORED_REPEAT;if(n===ge)return e.NEAREST;if(n===ve)return e.NEAREST_MIPMAP_NEAREST;if(n===ye)return e.NEAREST_MIPMAP_LINEAR;if(n===xe)return e.LINEAR;if(n===be)return e.LINEAR_MIPMAP_NEAREST;if(n===we)return e.LINEAR_MIPMAP_LINEAR;if(n===_e)return e.UNSIGNED_BYTE;if(n===Re)return e.UNSIGNED_SHORT_4_4_4_4;if(n===Le)return e.UNSIGNED_SHORT_5_5_5_1;if(n===Oe)return e.UNSIGNED_SHORT_5_6_5;if(n===Ae)return e.BYTE;if(n===Se)return e.SHORT;if(n===Ee)return e.UNSIGNED_SHORT;if(n===Me)return e.INT;if(n===Te)return e.UNSIGNED_INT;if(n===Ce)return e.FLOAT;if(n===Pe&&(i=t.get("OES_texture_half_float"),null!==i))return i.HALF_FLOAT_OES;if(n===Ie)return e.ALPHA;if(n===Ne)return e.RGB;if(n===ke)return e.RGBA;if(n===Ve)return e.LUMINANCE;if(n===Ue)return e.LUMINANCE_ALPHA;if(n===Fe)return e.DEPTH_COMPONENT;if(n===ze)return e.DEPTH_STENCIL;if(n===T)return e.FUNC_ADD;if(n===C)return e.FUNC_SUBTRACT;if(n===P)return e.FUNC_REVERSE_SUBTRACT;if(n===O)return e.ZERO;if(n===D)return e.ONE;if(n===I)return e.SRC_COLOR;if(n===N)return e.ONE_MINUS_SRC_COLOR;if(n===k)return e.SRC_ALPHA;if(n===V)return e.ONE_MINUS_SRC_ALPHA;if(n===U)return e.DST_ALPHA;if(n===F)return e.ONE_MINUS_DST_ALPHA;if(n===z)return e.DST_COLOR;if(n===j)return e.ONE_MINUS_DST_COLOR;if(n===B)return e.SRC_ALPHA_SATURATE;if((n===je||n===Be||n===$e||n===He)&&(i=t.get("WEBGL_compressed_texture_s3tc"),null!==i)){if(n===je)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===Be)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===$e)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===He)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((n===Ge||n===We||n===qe||n===Ye)&&(i=t.get("WEBGL_compressed_texture_pvrtc"),null!==i)){if(n===Ge)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===We)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===qe)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===Ye)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(n===Xe&&(i=t.get("WEBGL_compressed_texture_etc1"),null!==i))return i.COMPRESSED_RGB_ETC1_WEBGL;if((n===Ze||n===Je||n===Ke||n===Qe||n===et||n===tt||n===nt||n===it||n===rt||n===ot||n===st||n===at||n===lt||n===ut)&&(i=t.get("WEBGL_compressed_texture_astc"),null!==i))return n;if((n===R||n===L)&&(i=t.get("EXT_blend_minmax"),null!==i)){if(n===R)return i.MIN_EXT;if(n===L)return i.MAX_EXT}return n===De&&(i=t.get("WEBGL_depth_texture"),null!==i)?i.UNSIGNED_INT_24_8_WEBGL:0}return{convert:n}}function _s(e,t,n,i){cr.call(this),this.type="PerspectiveCamera",this.fov=void 0!==e?e:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==i?i:2e3,this.focus=10,this.aspect=void 0!==t?t:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function As(e){_s.call(this),this.cameras=e||[]}function Ss(e){var t=this,n=null,i=null,r=null,o=new Dt,s=new Dt;"undefined"!==typeof window&&"VRFrameData"in window&&(i=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",g,!1));var a=new Dt,l=new It,u=new Nt,c=new _s;c.bounds=new Ft(0,0,.5,1),c.layers.enable(1);var h=new _s;h.bounds=new Ft(.5,0,.5,1),h.layers.enable(2);var d,p,f=new As([c,h]);function m(){return null!==n&&!0===n.isPresenting}function g(){if(m()){var i=n.getEyeParameters("left"),r=i.renderWidth,o=i.renderHeight;p=e.getPixelRatio(),d=e.getSize(),e.setDrawingBufferSize(2*r,o,1)}else t.enabled&&e.setDrawingBufferSize(d.width,d.height,p)}f.layers.enable(1),f.layers.enable(2),this.enabled=!1,this.userHeight=1.6,this.getDevice=function(){return n},this.setDevice=function(e){void 0!==e&&(n=e)},this.setPoseTarget=function(e){void 0!==e&&(r=e)},this.getCamera=function(e){if(null===n)return e;n.depthNear=e.near,n.depthFar=e.far,n.getFrameData(i);var d=n.stageParameters;d?o.fromArray(d.sittingToStandingTransform):o.makeTranslation(0,t.userHeight,0);var p=i.pose,m=null!==r?r:e;if(m.matrix.copy(o),m.matrix.decompose(m.position,m.quaternion,m.scale),null!==p.orientation&&(l.fromArray(p.orientation),m.quaternion.multiply(l)),null!==p.position&&(l.setFromRotationMatrix(o),u.fromArray(p.position),u.applyQuaternion(l),m.position.add(u)),m.updateMatrixWorld(),!1===n.isPresenting)return e;c.near=e.near,h.near=e.near,c.far=e.far,h.far=e.far,f.matrixWorld.copy(e.matrixWorld),f.matrixWorldInverse.copy(e.matrixWorldInverse),c.matrixWorldInverse.fromArray(i.leftViewMatrix),h.matrixWorldInverse.fromArray(i.rightViewMatrix),s.getInverse(o),c.matrixWorldInverse.multiply(s),h.matrixWorldInverse.multiply(s);var g=m.parent;null!==g&&(a.getInverse(g.matrixWorld),c.matrixWorldInverse.multiply(a),h.matrixWorldInverse.multiply(a)),c.matrixWorld.getInverse(c.matrixWorldInverse),h.matrixWorld.getInverse(h.matrixWorldInverse),c.projectionMatrix.fromArray(i.leftProjectionMatrix),h.projectionMatrix.fromArray(i.rightProjectionMatrix),f.projectionMatrix.copy(c.projectionMatrix);var v=n.getLayers();if(v.length){var y=v[0];null!==y.leftBounds&&4===y.leftBounds.length&&c.bounds.fromArray(y.leftBounds),null!==y.rightBounds&&4===y.rightBounds.length&&h.bounds.fromArray(y.rightBounds)}return f},this.getStandingMatrix=function(){return o},this.submitFrame=function(){m()&&n.submitFrame()},this.dispose=function(){"undefined"!==typeof window&&window.removeEventListener("vrdisplaypresentchange",g)}}function Es(e){console.log("THREE.WebGLRenderer",l),e=e||{};var t=void 0!==e.canvas?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),n=void 0!==e.context?e.context:null,i=void 0!==e.alpha&&e.alpha,r=void 0===e.depth||e.depth,o=void 0===e.stencil||e.stencil,s=void 0!==e.antialias&&e.antialias,a=void 0===e.premultipliedAlpha||e.premultipliedAlpha,u=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,c=void 0!==e.powerPreference?e.powerPreference:"default",h=null,d=null;this.domElement=t,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=te,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var p,f,m,g,v,x,b,w,_,A,S,E,M,T,C,P,R,L,O,D=this,I=!1,N=null,k=null,V=-1,U="",F=null,z=null,j=new Ft,B=new Ft,$=null,H=0,G=t.width,W=t.height,q=1,Y=new Ft(0,0,G,W),X=new Ft(0,0,G,W),Z=!1,J=new Wt,K=new Hr,Q=!1,ee=!1,ne=new Dt,ie=new Nt;function re(){return null===N?q:1}try{var oe={alpha:i,depth:r,stencil:o,antialias:s,premultipliedAlpha:a,preserveDrawingBuffer:u,powerPreference:c};if(t.addEventListener("webglcontextlost",ue,!1),t.addEventListener("webglcontextrestored",ce,!1),p=n||t.getContext("webgl",oe)||t.getContext("experimental-webgl",oe),null===p)throw null!==t.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===p.getShaderPrecisionFormat&&(p.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(We){console.error("THREE.WebGLRenderer: "+We.message)}function se(){f=new Gr(p),f.get("WEBGL_depth_texture"),f.get("OES_texture_float"),f.get("OES_texture_float_linear"),f.get("OES_texture_half_float"),f.get("OES_texture_half_float_linear"),f.get("OES_standard_derivatives"),f.get("OES_element_index_uint"),f.get("ANGLE_instanced_arrays"),O=new ws(p,f),m=new $r(p,f,e),g=new xs(p,f,O),g.scissor(B.copy(X).multiplyScalar(q)),g.viewport(j.copy(Y).multiplyScalar(q)),v=new Yr(p),x=new rs,b=new bs(p,f,g,x,m,O,v),w=new or(p),_=new Wr(p,w,v),A=new Jr(_,v),C=new Zr(p),S=new is(D,f,m),E=new ls,M=new ps,T=new jr(D,g,_,a),P=new Br(p,f,v),R=new qr(p,f,v),L=new ys(D,p,g,b,m),v.programs=S.programs,D.context=p,D.capabilities=m,D.extensions=f,D.properties=x,D.renderLists=E,D.state=g,D.info=v}se();var ae=new Ss(D);this.vr=ae;var le=new gs(D,A,m.maxTextureSize);function ue(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),I=!0}function ce(){console.log("THREE.WebGLRenderer: Context Restored."),I=!1,se()}function he(e){var t=e.target;t.removeEventListener("dispose",he),de(t)}function de(e){pe(e),x.remove(e)}function pe(e){var t=x.get(e).program;e.program=void 0,void 0!==t&&S.releaseProgram(t)}function fe(e,t,n){e.render((function(e){D.renderBufferImmediate(e,t,n)}))}function me(e,t,n){if(n&&n.isInstancedBufferGeometry&&null===f.get("ANGLE_instanced_arrays"))console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{g.initAttributes();var i=n.attributes,r=t.getAttributes(),o=e.defaultAttributeValues;for(var s in r){var a=r[s];if(a>=0){var l=i[s];if(void 0!==l){var u=l.normalized,c=l.itemSize,h=w.get(l);if(void 0===h)continue;var d=h.buffer,m=h.type,v=h.bytesPerElement;if(l.isInterleavedBufferAttribute){var y=l.data,x=y.stride,b=l.offset;y&&y.isInstancedInterleavedBuffer?(g.enableAttributeAndDivisor(a,y.meshPerAttribute),void 0===n.maxInstancedCount&&(n.maxInstancedCount=y.meshPerAttribute*y.count)):g.enableAttribute(a),p.bindBuffer(p.ARRAY_BUFFER,d),p.vertexAttribPointer(a,c,m,u,x*v,b*v)}else l.isInstancedBufferAttribute?(g.enableAttributeAndDivisor(a,l.meshPerAttribute),void 0===n.maxInstancedCount&&(n.maxInstancedCount=l.meshPerAttribute*l.count)):g.enableAttribute(a),p.bindBuffer(p.ARRAY_BUFFER,d),p.vertexAttribPointer(a,c,m,u,0,0)}else if(void 0!==o){var _=o[s];if(void 0!==_)switch(_.length){case 2:p.vertexAttrib2fv(a,_);break;case 3:p.vertexAttrib3fv(a,_);break;case 4:p.vertexAttrib4fv(a,_);break;default:p.vertexAttrib1fv(a,_)}}}}g.disableUnusedAttributes()}}this.shadowMap=le,this.getContext=function(){return p},this.getContextAttributes=function(){return p.getContextAttributes()},this.forceContextLoss=function(){var e=f.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=f.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return q},this.setPixelRatio=function(e){void 0!==e&&(q=e,this.setSize(G,W,!1))},this.getSize=function(){return{width:G,height:W}},this.setSize=function(e,n,i){var r=ae.getDevice();r&&r.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(G=e,W=n,t.width=e*q,t.height=n*q,!1!==i&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(){return{width:G*q,height:W*q}},this.setDrawingBufferSize=function(e,n,i){G=e,W=n,q=i,t.width=e*i,t.height=n*i,this.setViewport(0,0,e,n)},this.getCurrentViewport=function(){return j},this.setViewport=function(e,t,n,i){Y.set(e,W-t-i,n,i),g.viewport(j.copy(Y).multiplyScalar(q))},this.setScissor=function(e,t,n,i){X.set(e,W-t-i,n,i),g.scissor(B.copy(X).multiplyScalar(q))},this.setScissorTest=function(e){g.setScissorTest(Z=e)},this.getClearColor=function(){return T.getClearColor()},this.setClearColor=function(){T.setClearColor.apply(T,arguments)},this.getClearAlpha=function(){return T.getClearAlpha()},this.setClearAlpha=function(){T.setClearAlpha.apply(T,arguments)},this.clear=function(e,t,n){var i=0;(void 0===e||e)&&(i|=p.COLOR_BUFFER_BIT),(void 0===t||t)&&(i|=p.DEPTH_BUFFER_BIT),(void 0===n||n)&&(i|=p.STENCIL_BUFFER_BIT),p.clear(i)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(e,t,n,i){this.setRenderTarget(e),this.clear(t,n,i)},this.dispose=function(){t.removeEventListener("webglcontextlost",ue,!1),t.removeEventListener("webglcontextrestored",ce,!1),E.dispose(),M.dispose(),x.dispose(),A.dispose(),ae.dispose(),xe()},this.renderBufferImmediate=function(e,t,n){g.initAttributes();var i=x.get(e);e.hasPositions&&!i.position&&(i.position=p.createBuffer()),e.hasNormals&&!i.normal&&(i.normal=p.createBuffer()),e.hasUvs&&!i.uv&&(i.uv=p.createBuffer()),e.hasColors&&!i.color&&(i.color=p.createBuffer());var r=t.getAttributes();if(e.hasPositions&&(p.bindBuffer(p.ARRAY_BUFFER,i.position),p.bufferData(p.ARRAY_BUFFER,e.positionArray,p.DYNAMIC_DRAW),g.enableAttribute(r.position),p.vertexAttribPointer(r.position,3,p.FLOAT,!1,0,0)),e.hasNormals){if(p.bindBuffer(p.ARRAY_BUFFER,i.normal),!n.isMeshPhongMaterial&&!n.isMeshStandardMaterial&&!n.isMeshNormalMaterial&&!0===n.flatShading)for(var o=0,s=3*e.count;o<s;o+=9){var a=e.normalArray,l=(a[o+0]+a[o+3]+a[o+6])/3,u=(a[o+1]+a[o+4]+a[o+7])/3,c=(a[o+2]+a[o+5]+a[o+8])/3;a[o+0]=l,a[o+1]=u,a[o+2]=c,a[o+3]=l,a[o+4]=u,a[o+5]=c,a[o+6]=l,a[o+7]=u,a[o+8]=c}p.bufferData(p.ARRAY_BUFFER,e.normalArray,p.DYNAMIC_DRAW),g.enableAttribute(r.normal),p.vertexAttribPointer(r.normal,3,p.FLOAT,!1,0,0)}e.hasUvs&&n.map&&(p.bindBuffer(p.ARRAY_BUFFER,i.uv),p.bufferData(p.ARRAY_BUFFER,e.uvArray,p.DYNAMIC_DRAW),g.enableAttribute(r.uv),p.vertexAttribPointer(r.uv,2,p.FLOAT,!1,0,0)),e.hasColors&&n.vertexColors!==y&&(p.bindBuffer(p.ARRAY_BUFFER,i.color),p.bufferData(p.ARRAY_BUFFER,e.colorArray,p.DYNAMIC_DRAW),g.enableAttribute(r.color),p.vertexAttribPointer(r.color,3,p.FLOAT,!1,0,0)),g.disableUnusedAttributes(),p.drawArrays(p.TRIANGLES,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,n,i,r,o){var s=r.isMesh&&r.matrixWorld.determinant()<0;g.setMaterial(i,s);var a=Te(e,t,i,r),l=n.id+"_"+a.id+"_"+(!0===i.wireframe),u=!1;l!==U&&(U=l,u=!0),r.morphTargetInfluences&&(C.update(r,n,i,a),u=!0);var c,h=n.index,d=n.attributes.position,f=1;!0===i.wireframe&&(h=_.getWireframeAttribute(n),f=2);var m=P;null!==h&&(c=w.get(h),m=R,m.setIndex(c)),u&&(me(i,a,n),null!==h&&p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,c.buffer));var v=1/0;null!==h?v=h.count:void 0!==d&&(v=d.count);var y=n.drawRange.start*f,x=n.drawRange.count*f,b=null!==o?o.start*f:0,A=null!==o?o.count*f:1/0,S=Math.max(y,b),E=Math.min(v,y+x,b+A)-1,M=Math.max(0,E-S+1);if(0!==M){if(r.isMesh)if(!0===i.wireframe)g.setLineWidth(i.wireframeLinewidth*re()),m.setMode(p.LINES);else switch(r.drawMode){case xt:m.setMode(p.TRIANGLES);break;case bt:m.setMode(p.TRIANGLE_STRIP);break;case wt:m.setMode(p.TRIANGLE_FAN);break}else if(r.isLine){var T=i.linewidth;void 0===T&&(T=1),g.setLineWidth(T*re()),r.isLineSegments?m.setMode(p.LINES):r.isLineLoop?m.setMode(p.LINE_LOOP):m.setMode(p.LINE_STRIP)}else r.isPoints&&m.setMode(p.POINTS);n&&n.isInstancedBufferGeometry?n.maxInstancedCount>0&&m.renderInstances(n,S,M):m.render(S,M)}},this.compile=function(e,t){d=M.get(e,t),d.init(),e.traverse((function(e){e.isLight&&(d.pushLight(e),e.castShadow&&d.pushShadow(e))})),d.setupLights(t),e.traverse((function(t){if(t.material)if(Array.isArray(t.material))for(var n=0;n<t.material.length;n++)Me(t.material[n],e.fog,t);else Me(t.material,e.fog,t)}))};var ge=!1,ve=null;function ye(){ge||(be(),ge=!0)}function xe(){ge=!1}function be(){var e=ae.getDevice();e&&e.isPresenting?e.requestAnimationFrame(we):window.requestAnimationFrame(we)}function we(e){!1!==ge&&(ve(e),be())}function Ae(e,t,n){if(!1!==e.visible){var i=e.layers.test(t.layers);if(i)if(e.isLight)d.pushLight(e),e.castShadow&&d.pushShadow(e);else if(e.isSprite)e.frustumCulled&&!J.intersectsSprite(e)||d.pushSprite(e);else if(e.isImmediateRenderObject)n&&ie.setFromMatrixPosition(e.matrixWorld).applyMatrix4(ne),h.push(e,null,e.material,ie.z,null);else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.update(),!e.frustumCulled||J.intersectsObject(e))){n&&ie.setFromMatrixPosition(e.matrixWorld).applyMatrix4(ne);var r=A.update(e),o=e.material;if(Array.isArray(o))for(var s=r.groups,a=0,l=s.length;a<l;a++){var u=s[a],c=o[u.materialIndex];c&&c.visible&&h.push(e,r,c,ie.z,u)}else o.visible&&h.push(e,r,o,ie.z,null)}var p=e.children;for(a=0,l=p.length;a<l;a++)Ae(p[a],t,n)}}function Se(e,t,n,i){for(var r=0,o=e.length;r<o;r++){var s=e[r],a=s.object,l=s.geometry,u=void 0===i?s.material:i,c=s.group;if(n.isArrayCamera){z=n;for(var h=n.cameras,d=0,p=h.length;d<p;d++){var f=h[d];if(a.layers.test(f.layers)){var m=f.bounds,v=m.x*G,y=m.y*W,x=m.z*G,b=m.w*W;g.viewport(j.set(v,y,x,b).multiplyScalar(q)),Ee(a,t,f,l,u,c)}}}else z=null,Ee(a,t,n,l,u,c)}}function Ee(e,t,n,i,r,o){if(e.onBeforeRender(D,t,n,i,r,o),d=M.get(t,z||n),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.isImmediateRenderObject){var s=e.isMesh&&e.matrixWorld.determinant()<0;g.setMaterial(r,s);var a=Te(n,t.fog,r,e);U="",fe(e,a,r)}else D.renderBufferDirect(n,t.fog,i,r,e,o);e.onAfterRender(D,t,n,i,r,o),d=M.get(t,z||n)}function Me(e,t,n){var i=x.get(e),r=d.state.lights,o=d.state.shadowsArray,s=S.getParameters(e,r.state,o,t,K.numPlanes,K.numIntersection,n),a=S.getProgramCode(e,s),l=i.program,u=!0;if(void 0===l)e.addEventListener("dispose",he);else if(l.code!==a)pe(e);else if(i.lightsHash!==r.state.hash)x.update(e,"lightsHash",r.state.hash),u=!1;else{if(void 0!==s.shaderID)return;u=!1}if(u){if(s.shaderID){var c=rr[s.shaderID];i.shader={name:e.type,uniforms:er.clone(c.uniforms),vertexShader:c.vertexShader,fragmentShader:c.fragmentShader}}else i.shader={name:e.type,uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};e.onBeforeCompile(i.shader,D),l=S.acquireProgram(e,i.shader,s,a),i.program=l,e.program=l}var h=l.getAttributes();if(e.morphTargets){e.numSupportedMorphTargets=0;for(var p=0;p<D.maxMorphTargets;p++)h["morphTarget"+p]>=0&&e.numSupportedMorphTargets++}if(e.morphNormals){e.numSupportedMorphNormals=0;for(p=0;p<D.maxMorphNormals;p++)h["morphNormal"+p]>=0&&e.numSupportedMorphNormals++}var f=i.shader.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(i.numClippingPlanes=K.numPlanes,i.numIntersection=K.numIntersection,f.clippingPlanes=K.uniform),i.fog=t,i.lightsHash=r.state.hash,e.lights&&(f.ambientLightColor.value=r.state.ambient,f.directionalLights.value=r.state.directional,f.spotLights.value=r.state.spot,f.rectAreaLights.value=r.state.rectArea,f.pointLights.value=r.state.point,f.hemisphereLights.value=r.state.hemi,f.directionalShadowMap.value=r.state.directionalShadowMap,f.directionalShadowMatrix.value=r.state.directionalShadowMatrix,f.spotShadowMap.value=r.state.spotShadowMap,f.spotShadowMatrix.value=r.state.spotShadowMatrix,f.pointShadowMap.value=r.state.pointShadowMap,f.pointShadowMatrix.value=r.state.pointShadowMatrix);var m=i.program.getUniforms(),g=zo.seqWithValue(m.seq,f);i.uniformsList=g}function Te(e,t,n,i){H=0;var r=x.get(n),o=d.state.lights;if(Q&&(ee||e!==F)){var s=e===F&&n.id===V;K.setState(n.clippingPlanes,n.clipIntersection,n.clipShadows,e,r,s)}!1===n.needsUpdate&&(void 0===r.program||n.fog&&r.fog!==t||n.lights&&r.lightsHash!==o.state.hash?n.needsUpdate=!0:void 0===r.numClippingPlanes||r.numClippingPlanes===K.numPlanes&&r.numIntersection===K.numIntersection||(n.needsUpdate=!0)),n.needsUpdate&&(Me(n,t,i),n.needsUpdate=!1);var a=!1,l=!1,u=!1,c=r.program,h=c.getUniforms(),f=r.shader.uniforms;if(g.useProgram(c.program)&&(a=!0,l=!0,u=!0),n.id!==V&&(V=n.id,l=!0),a||e!==F){if(h.setValue(p,"projectionMatrix",e.projectionMatrix),m.logarithmicDepthBuffer&&h.setValue(p,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),F!==(z||e)&&(F=z||e,l=!0,u=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshStandardMaterial||n.envMap){var v=h.map.cameraPosition;void 0!==v&&v.setValue(p,ie.setFromMatrixPosition(e.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.skinning)&&h.setValue(p,"viewMatrix",e.matrixWorldInverse)}if(n.skinning){h.setOptional(p,i,"bindMatrix"),h.setOptional(p,i,"bindMatrixInverse");var y=i.skeleton;if(y){var b=y.bones;if(m.floatVertexTextures){if(void 0===y.boneTexture){var w=Math.sqrt(4*b.length);w=Lt.ceilPowerOfTwo(w),w=Math.max(w,4);var _=new Float32Array(w*w*4);_.set(y.boneMatrices);var A=new Bt(_,w,w,ke,Ce);A.needsUpdate=!0,y.boneMatrices=_,y.boneTexture=A,y.boneTextureSize=w}h.setValue(p,"boneTexture",y.boneTexture),h.setValue(p,"boneTextureSize",y.boneTextureSize)}else h.setOptional(p,y,"boneMatrices")}}return l&&(h.setValue(p,"toneMappingExposure",D.toneMappingExposure),h.setValue(p,"toneMappingWhitePoint",D.toneMappingWhitePoint),n.lights&&He(f,u),t&&n.fog&&Ie(f,t),n.isMeshBasicMaterial?Re(f,n):n.isMeshLambertMaterial?(Re(f,n),Ne(f,n)):n.isMeshPhongMaterial?(Re(f,n),n.isMeshToonMaterial?Ue(f,n):Ve(f,n)):n.isMeshStandardMaterial?(Re(f,n),n.isMeshPhysicalMaterial?ze(f,n):Fe(f,n)):n.isMeshDepthMaterial?(Re(f,n),je(f,n)):n.isMeshDistanceMaterial?(Re(f,n),Be(f,n)):n.isMeshNormalMaterial?(Re(f,n),$e(f,n)):n.isLineBasicMaterial?(Le(f,n),n.isLineDashedMaterial&&Oe(f,n)):n.isPointsMaterial?De(f,n):n.isShadowMaterial&&(f.color.value=n.color,f.opacity.value=n.opacity),void 0!==f.ltc_1&&(f.ltc_1.value=ir.LTC_1),void 0!==f.ltc_2&&(f.ltc_2.value=ir.LTC_2),zo.upload(p,r.uniformsList,f,D)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(zo.upload(p,r.uniformsList,f,D),n.uniformsNeedUpdate=!1),h.setValue(p,"modelViewMatrix",i.modelViewMatrix),h.setValue(p,"normalMatrix",i.normalMatrix),h.setValue(p,"modelMatrix",i.matrixWorld),c}function Re(e,t){var n;e.opacity.value=t.opacity,t.color&&(e.diffuse.value=t.color),t.emissive&&e.emissive.value.copy(t.emissive).multiplyScalar(t.emissiveIntensity),t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.specularMap&&(e.specularMap.value=t.specularMap),t.envMap&&(e.envMap.value=t.envMap,e.flipEnvMap.value=t.envMap&&t.envMap.isCubeTexture?-1:1,e.reflectivity.value=t.reflectivity,e.refractionRatio.value=t.refractionRatio,e.maxMipLevel.value=x.get(t.envMap).__maxMipLevel),t.lightMap&&(e.lightMap.value=t.lightMap,e.lightMapIntensity.value=t.lightMapIntensity),t.aoMap&&(e.aoMap.value=t.aoMap,e.aoMapIntensity.value=t.aoMapIntensity),t.map?n=t.map:t.specularMap?n=t.specularMap:t.displacementMap?n=t.displacementMap:t.normalMap?n=t.normalMap:t.bumpMap?n=t.bumpMap:t.roughnessMap?n=t.roughnessMap:t.metalnessMap?n=t.metalnessMap:t.alphaMap?n=t.alphaMap:t.emissiveMap&&(n=t.emissiveMap),void 0!==n&&(n.isWebGLRenderTarget&&(n=n.texture),!0===n.matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix))}function Le(e,t){e.diffuse.value=t.color,e.opacity.value=t.opacity}function Oe(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}function De(e,t){e.diffuse.value=t.color,e.opacity.value=t.opacity,e.size.value=t.size*q,e.scale.value=.5*W,e.map.value=t.map,null!==t.map&&(!0===t.map.matrixAutoUpdate&&t.map.updateMatrix(),e.uvTransform.value.copy(t.map.matrix))}function Ie(e,t){e.fogColor.value=t.color,t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)}function Ne(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}function Ve(e,t){e.specular.value=t.specular,e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale)),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}function Ue(e,t){Ve(e,t),t.gradientMap&&(e.gradientMap.value=t.gradientMap)}function Fe(e,t){e.roughness.value=t.roughness,e.metalness.value=t.metalness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap),t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale)),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}function ze(e,t){e.clearCoat.value=t.clearCoat,e.clearCoatRoughness.value=t.clearCoatRoughness,Fe(e,t)}function je(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}function Be(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}function $e(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale)),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}function He(e,t){e.ambientLightColor.needsUpdate=t,e.directionalLights.needsUpdate=t,e.pointLights.needsUpdate=t,e.spotLights.needsUpdate=t,e.rectAreaLights.needsUpdate=t,e.hemisphereLights.needsUpdate=t}function Ge(){var e=H;return e>=m.maxTextures&&console.warn("THREE.WebGLRenderer: Trying to use "+e+" texture units while this GPU supports only "+m.maxTextures),H+=1,e}this.animate=function(e){ve=e,null!==ve?ye():xe()},this.render=function(e,t,n,i){if(t&&t.isCamera){if(!I){U="",V=-1,F=null,!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),ae.enabled&&(t=ae.getCamera(t)),d=M.get(e,t),d.init(),e.onBeforeRender(D,e,t,n),ne.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),J.setFromMatrix(ne),ee=this.localClippingEnabled,Q=K.init(this.clippingPlanes,ee,t),h=E.get(e,t),h.init(),Ae(e,t,D.sortObjects),!0===D.sortObjects&&h.sort(),Q&&K.beginShadows();var r=d.state.shadowsArray;le.render(r,e,t),d.setupLights(t),Q&&K.endShadows(),this.info.autoReset&&this.info.reset(),void 0===n&&(n=null),this.setRenderTarget(n),T.render(h,e,t,i);var o=h.opaque,s=h.transparent;if(e.overrideMaterial){var a=e.overrideMaterial;o.length&&Se(o,e,t,a),s.length&&Se(s,e,t,a)}else o.length&&Se(o,e,t),s.length&&Se(s,e,t);var l=d.state.spritesArray;L.render(l,e,t),n&&b.updateRenderTargetMipmap(n),g.buffers.depth.setTest(!0),g.buffers.depth.setMask(!0),g.buffers.color.setMask(!0),g.setPolygonOffset(!1),e.onAfterRender(D,e,t),ae.enabled&&ae.submitFrame(),h=null,d=null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.allocTextureUnit=Ge,this.setTexture2D=function(){var e=!1;return function(t,n){t&&t.isWebGLRenderTarget&&(e||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),e=!0),t=t.texture),b.setTexture2D(t,n)}}(),this.setTexture=function(){var e=!1;return function(t,n){e||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),e=!0),b.setTexture2D(t,n)}}(),this.setTextureCube=function(){var e=!1;return function(t,n){t&&t.isWebGLRenderTargetCube&&(e||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),e=!0),t=t.texture),t&&t.isCubeTexture||Array.isArray(t.image)&&6===t.image.length?b.setTextureCube(t,n):b.setTextureCubeDynamic(t,n)}}(),this.getRenderTarget=function(){return N},this.setRenderTarget=function(e){N=e,e&&void 0===x.get(e).__webglFramebuffer&&b.setupRenderTarget(e);var t=null,n=!1;if(e){var i=x.get(e).__webglFramebuffer;e.isWebGLRenderTargetCube?(t=i[e.activeCubeFace],n=!0):t=i,j.copy(e.viewport),B.copy(e.scissor),$=e.scissorTest}else j.copy(Y).multiplyScalar(q),B.copy(X).multiplyScalar(q),$=Z;if(k!==t&&(p.bindFramebuffer(p.FRAMEBUFFER,t),k=t),g.viewport(j),g.scissor(B),g.setScissorTest($),n){var r=x.get(e.texture);p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_CUBE_MAP_POSITIVE_X+e.activeCubeFace,r.__webglTexture,e.activeMipMapLevel)}},this.readRenderTargetPixels=function(e,t,n,i,r,o){if(e&&e.isWebGLRenderTarget){var s=x.get(e).__webglFramebuffer;if(s){var a=!1;s!==k&&(p.bindFramebuffer(p.FRAMEBUFFER,s),a=!0);try{var l=e.texture,u=l.format,c=l.type;if(u!==ke&&O.convert(u)!==p.getParameter(p.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(c!==_e&&O.convert(c)!==p.getParameter(p.IMPLEMENTATION_COLOR_READ_TYPE)&&(c!==Ce||!f.get("OES_texture_float")&&!f.get("WEBGL_color_buffer_float"))&&(c!==Pe||!f.get("EXT_color_buffer_half_float")))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");p.checkFramebufferStatus(p.FRAMEBUFFER)===p.FRAMEBUFFER_COMPLETE?t>=0&&t<=e.width-i&&n>=0&&n<=e.height-r&&p.readPixels(t,n,i,r,O.convert(u),O.convert(c),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{a&&p.bindFramebuffer(p.FRAMEBUFFER,k)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(e,t,n){var i=t.image.width,r=t.image.height,o=O.convert(t.format);this.setTexture2D(t,0),p.copyTexImage2D(p.TEXTURE_2D,n||0,o,e.x,e.y,i,r,0)},this.copyTextureToTexture=function(e,t,n,i){var r=t.image.width,o=t.image.height,s=O.convert(n.format),a=O.convert(n.type),l=t.isDataTexture?t.image.data:t.image;this.setTexture2D(n,0),p.texSubImage2D(p.TEXTURE_2D,i||0,e.x,e.y,r,o,s,a,l)}}function Ms(e,t){this.name="",this.color=new nr(e),this.density=void 0!==t?t:25e-5}function Ts(e,t,n){this.name="",this.color=new nr(e),this.near=void 0!==t?t:1,this.far=void 0!==n?n:1e3}function Cs(){ur.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}function Ps(e){Ir.call(this),this.type="SpriteMaterial",this.color=new nr(16777215),this.map=null,this.rotation=0,this.fog=!1,this.lights=!1,this.setValues(e)}function Rs(e){ur.call(this),this.type="Sprite",this.material=void 0!==e?e:new Ps,this.center=new Ot(.5,.5)}function Ls(){ur.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function Os(e,t){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var n=0,i=this.bones.length;n<i;n++)this.boneInverses.push(new Dt)}}function Ds(){ur.call(this),this.type="Bone"}function Is(e,t){zr.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Dt,this.bindMatrixInverse=new Dt;var n=this.initBones(),i=new Os(n);this.bind(i,this.matrixWorld),this.normalizeSkinWeights()}function Ns(e){Ir.call(this),this.type="LineBasicMaterial",this.color=new nr(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(e)}function ks(e,t,n){if(1===n)return console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new Vs(e,t);ur.call(this),this.type="Line",this.geometry=void 0!==e?e:new Cr,this.material=void 0!==t?t:new Ns({color:16777215*Math.random()})}function Vs(e,t){ks.call(this,e,t),this.type="LineSegments"}function Us(e,t){ks.call(this,e,t),this.type="LineLoop"}function Fs(e){Ir.call(this),this.type="PointsMaterial",this.color=new nr(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.lights=!1,this.setValues(e)}function zs(e,t){ur.call(this),this.type="Points",this.geometry=void 0!==e?e:new Cr,this.material=void 0!==t?t:new Fs({color:16777215*Math.random()})}function js(){ur.call(this),this.type="Group"}function Bs(e,t,n,i,r,o,s,a,l){Ut.call(this,e,t,n,i,r,o,s,a,l),this.generateMipmaps=!1}function $s(e,t,n,i,r,o,s,a,l,u,c,h){Ut.call(this,null,o,s,a,l,u,i,r,c,h),this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}function Hs(e,t,n,i,r,o,s,a,l,u){if(u=void 0!==u?u:Fe,u!==Fe&&u!==ze)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&u===Fe&&(n=Ee),void 0===n&&u===ze&&(n=De),Ut.call(this,null,i,r,o,s,a,u,n,l),this.image={width:e,height:t},this.magFilter=void 0!==s?s:ge,this.minFilter=void 0!==a?a:ge,this.flipY=!1,this.generateMipmaps=!1}function Gs(e){Cr.call(this),this.type="WireframeGeometry";var t,n,i,r,o,s,a,l,u,c,h=[],d=[0,0],p={},f=["a","b","c"];if(e&&e.isGeometry){var m=e.faces;for(t=0,i=m.length;t<i;t++){var g=m[t];for(n=0;n<3;n++)a=g[f[n]],l=g[f[(n+1)%3]],d[0]=Math.min(a,l),d[1]=Math.max(a,l),u=d[0]+","+d[1],void 0===p[u]&&(p[u]={index1:d[0],index2:d[1]})}for(u in p)s=p[u],c=e.vertices[s.index1],h.push(c.x,c.y,c.z),c=e.vertices[s.index2],h.push(c.x,c.y,c.z)}else if(e&&e.isBufferGeometry){var v,y,x,b,w,_,A,S;if(c=new Nt,null!==e.index){for(v=e.attributes.position,y=e.index,x=e.groups,0===x.length&&(x=[{start:0,count:y.count,materialIndex:0}]),r=0,o=x.length;r<o;++r)for(b=x[r],w=b.start,_=b.count,t=w,i=w+_;t<i;t+=3)for(n=0;n<3;n++)a=y.getX(t+n),l=y.getX(t+(n+1)%3),d[0]=Math.min(a,l),d[1]=Math.max(a,l),u=d[0]+","+d[1],void 0===p[u]&&(p[u]={index1:d[0],index2:d[1]});for(u in p)s=p[u],c.fromBufferAttribute(v,s.index1),h.push(c.x,c.y,c.z),c.fromBufferAttribute(v,s.index2),h.push(c.x,c.y,c.z)}else for(v=e.attributes.position,t=0,i=v.count/3;t<i;t++)for(n=0;n<3;n++)A=3*t+n,c.fromBufferAttribute(v,A),h.push(c.x,c.y,c.z),S=3*t+(n+1)%3,c.fromBufferAttribute(v,S),h.push(c.x,c.y,c.z)}this.addAttribute("position",new Ar(h,3))}function Ws(e,t,n){fr.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:n},this.fromBufferGeometry(new qs(e,t,n)),this.mergeVertices()}function qs(e,t,n){Cr.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:t,stacks:n};var i,r,o=[],s=[],a=[],l=[],u=1e-5,c=new Nt,h=new Nt,d=new Nt,p=new Nt,f=new Nt,m=t+1;for(i=0;i<=n;i++){var g=i/n;for(r=0;r<=t;r++){var v=r/t;e(v,g,h),s.push(h.x,h.y,h.z),v-u>=0?(e(v-u,g,d),p.subVectors(h,d)):(e(v+u,g,d),p.subVectors(d,h)),g-u>=0?(e(v,g-u,d),f.subVectors(h,d)):(e(v,g+u,d),f.subVectors(d,h)),c.crossVectors(p,f).normalize(),a.push(c.x,c.y,c.z),l.push(v,g)}}for(i=0;i<n;i++)for(r=0;r<t;r++){var y=i*m+r,x=i*m+r+1,b=(i+1)*m+r+1,w=(i+1)*m+r;o.push(y,x,w),o.push(x,b,w)}this.setIndex(o),this.addAttribute("position",new Ar(s,3)),this.addAttribute("normal",new Ar(a,3)),this.addAttribute("uv",new Ar(l,2))}function Ys(e,t,n,i){fr.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:i},this.fromBufferGeometry(new Xs(e,t,n,i)),this.mergeVertices()}function Xs(e,t,n,i){Cr.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:i},n=n||1,i=i||0;var r=[],o=[];function s(e){for(var n=new Nt,i=new Nt,r=new Nt,o=0;o<t.length;o+=3)d(t[o+0],n),d(t[o+1],i),d(t[o+2],r),a(n,i,r,e)}function a(e,t,n,i){var r,o,s=Math.pow(2,i),a=[];for(r=0;r<=s;r++){a[r]=[];var l=e.clone().lerp(n,r/s),u=t.clone().lerp(n,r/s),c=s-r;for(o=0;o<=c;o++)a[r][o]=0===o&&r===s?l:l.clone().lerp(u,o/c)}for(r=0;r<s;r++)for(o=0;o<2*(s-r)-1;o++){var d=Math.floor(o/2);o%2===0?(h(a[r][d+1]),h(a[r+1][d]),h(a[r][d])):(h(a[r][d+1]),h(a[r+1][d+1]),h(a[r+1][d]))}}function l(e){for(var t=new Nt,n=0;n<r.length;n+=3)t.x=r[n+0],t.y=r[n+1],t.z=r[n+2],t.normalize().multiplyScalar(e),r[n+0]=t.x,r[n+1]=t.y,r[n+2]=t.z}function u(){for(var e=new Nt,t=0;t<r.length;t+=3){e.x=r[t+0],e.y=r[t+1],e.z=r[t+2];var n=m(e)/2/Math.PI+.5,i=g(e)/Math.PI+.5;o.push(n,1-i)}p(),c()}function c(){for(var e=0;e<o.length;e+=6){var t=o[e+0],n=o[e+2],i=o[e+4],r=Math.max(t,n,i),s=Math.min(t,n,i);r>.9&&s<.1&&(t<.2&&(o[e+0]+=1),n<.2&&(o[e+2]+=1),i<.2&&(o[e+4]+=1))}}function h(e){r.push(e.x,e.y,e.z)}function d(t,n){var i=3*t;n.x=e[i+0],n.y=e[i+1],n.z=e[i+2]}function p(){for(var e=new Nt,t=new Nt,n=new Nt,i=new Nt,s=new Ot,a=new Ot,l=new Ot,u=0,c=0;u<r.length;u+=9,c+=6){e.set(r[u+0],r[u+1],r[u+2]),t.set(r[u+3],r[u+4],r[u+5]),n.set(r[u+6],r[u+7],r[u+8]),s.set(o[c+0],o[c+1]),a.set(o[c+2],o[c+3]),l.set(o[c+4],o[c+5]),i.copy(e).add(t).add(n).divideScalar(3);var h=m(i);f(s,c+0,e,h),f(a,c+2,t,h),f(l,c+4,n,h)}}function f(e,t,n,i){i<0&&1===e.x&&(o[t]=e.x-1),0===n.x&&0===n.z&&(o[t]=i/2/Math.PI+.5)}function m(e){return Math.atan2(e.z,-e.x)}function g(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}s(i),l(n),u(),this.addAttribute("position",new Ar(r,3)),this.addAttribute("normal",new Ar(r.slice(),3)),this.addAttribute("uv",new Ar(o,2)),0===i?this.computeVertexNormals():this.normalizeNormals()}function Zs(e,t){fr.call(this),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Js(e,t)),this.mergeVertices()}function Js(e,t){var n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],i=[2,1,0,0,3,2,1,3,0,2,3,1];Xs.call(this,n,i,e,t),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Ks(e,t){fr.call(this),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Qs(e,t)),this.mergeVertices()}function Qs(e,t){var n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],i=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];Xs.call(this,n,i,e,t),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:t}}function ea(e,t){fr.call(this),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new ta(e,t)),this.mergeVertices()}function ta(e,t){var n=(1+Math.sqrt(5))/2,i=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],r=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];Xs.call(this,i,r,e,t),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:t}}function na(e,t){fr.call(this),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new ia(e,t)),this.mergeVertices()}function ia(e,t){var n=(1+Math.sqrt(5))/2,i=1/n,r=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];Xs.call(this,r,o,e,t),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:t}}function ra(e,t,n,i,r,o){fr.call(this),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:i,closed:r},void 0!==o&&console.warn("THREE.TubeGeometry: taper has been removed.");var s=new oa(e,t,n,i,r);this.tangents=s.tangents,this.normals=s.normals,this.binormals=s.binormals,this.fromBufferGeometry(s),this.mergeVertices()}function oa(e,t,n,i,r){Cr.call(this),this.type="TubeBufferGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:i,closed:r},t=t||64,n=n||1,i=i||8,r=r||!1;var o=e.computeFrenetFrames(t,r);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;var s,a,l=new Nt,u=new Nt,c=new Ot,h=new Nt,d=[],p=[],f=[],m=[];function g(){for(s=0;s<t;s++)v(s);v(!1===r?t:0),x(),y()}function v(r){h=e.getPointAt(r/t,h);var s=o.normals[r],c=o.binormals[r];for(a=0;a<=i;a++){var f=a/i*Math.PI*2,m=Math.sin(f),g=-Math.cos(f);u.x=g*s.x+m*c.x,u.y=g*s.y+m*c.y,u.z=g*s.z+m*c.z,u.normalize(),p.push(u.x,u.y,u.z),l.x=h.x+n*u.x,l.y=h.y+n*u.y,l.z=h.z+n*u.z,d.push(l.x,l.y,l.z)}}function y(){for(a=1;a<=t;a++)for(s=1;s<=i;s++){var e=(i+1)*(a-1)+(s-1),n=(i+1)*a+(s-1),r=(i+1)*a+s,o=(i+1)*(a-1)+s;m.push(e,n,o),m.push(n,r,o)}}function x(){for(s=0;s<=t;s++)for(a=0;a<=i;a++)c.x=s/t,c.y=a/i,f.push(c.x,c.y)}g(),this.setIndex(m),this.addAttribute("position",new Ar(d,3)),this.addAttribute("normal",new Ar(p,3)),this.addAttribute("uv",new Ar(f,2))}function sa(e,t,n,i,r,o,s){fr.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:i,p:r,q:o},void 0!==s&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new aa(e,t,n,i,r,o)),this.mergeVertices()}function aa(e,t,n,i,r,o){Cr.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:i,p:r,q:o},e=e||1,t=t||.4,n=Math.floor(n)||64,i=Math.floor(i)||8,r=r||2,o=o||3;var s,a,l=[],u=[],c=[],h=[],d=new Nt,p=new Nt,f=new Nt,m=new Nt,g=new Nt,v=new Nt,y=new Nt;for(s=0;s<=n;++s){var x=s/n*r*Math.PI*2;for(T(x,r,o,e,f),T(x+.01,r,o,e,m),v.subVectors(m,f),y.addVectors(m,f),g.crossVectors(v,y),y.crossVectors(g,v),g.normalize(),y.normalize(),a=0;a<=i;++a){var b=a/i*Math.PI*2,w=-t*Math.cos(b),_=t*Math.sin(b);d.x=f.x+(w*y.x+_*g.x),d.y=f.y+(w*y.y+_*g.y),d.z=f.z+(w*y.z+_*g.z),u.push(d.x,d.y,d.z),p.subVectors(d,f).normalize(),c.push(p.x,p.y,p.z),h.push(s/n),h.push(a/i)}}for(a=1;a<=n;a++)for(s=1;s<=i;s++){var A=(i+1)*(a-1)+(s-1),S=(i+1)*a+(s-1),E=(i+1)*a+s,M=(i+1)*(a-1)+s;l.push(A,S,M),l.push(S,E,M)}function T(e,t,n,i,r){var o=Math.cos(e),s=Math.sin(e),a=n/t*e,l=Math.cos(a);r.x=i*(2+l)*.5*o,r.y=i*(2+l)*s*.5,r.z=i*Math.sin(a)*.5}this.setIndex(l),this.addAttribute("position",new Ar(u,3)),this.addAttribute("normal",new Ar(c,3)),this.addAttribute("uv",new Ar(h,2))}function la(e,t,n,i,r){fr.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,arc:r},this.fromBufferGeometry(new ua(e,t,n,i,r)),this.mergeVertices()}function ua(e,t,n,i,r){Cr.call(this),this.type="TorusBufferGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,arc:r},e=e||1,t=t||.4,n=Math.floor(n)||8,i=Math.floor(i)||6,r=r||2*Math.PI;var o,s,a=[],l=[],u=[],c=[],h=new Nt,d=new Nt,p=new Nt;for(o=0;o<=n;o++)for(s=0;s<=i;s++){var f=s/i*r,m=o/n*Math.PI*2;d.x=(e+t*Math.cos(m))*Math.cos(f),d.y=(e+t*Math.cos(m))*Math.sin(f),d.z=t*Math.sin(m),l.push(d.x,d.y,d.z),h.x=e*Math.cos(f),h.y=e*Math.sin(f),p.subVectors(d,h).normalize(),u.push(p.x,p.y,p.z),c.push(s/i),c.push(o/n)}for(o=1;o<=n;o++)for(s=1;s<=i;s++){var g=(i+1)*o+s-1,v=(i+1)*(o-1)+s-1,y=(i+1)*(o-1)+s,x=(i+1)*o+s;a.push(g,v,x),a.push(v,y,x)}this.setIndex(a),this.addAttribute("position",new Ar(l,3)),this.addAttribute("normal",new Ar(u,3)),this.addAttribute("uv",new Ar(c,2))}fs.prototype=Object.create(Ir.prototype),fs.prototype.constructor=fs,fs.prototype.isMeshDepthMaterial=!0,fs.prototype.copy=function(e){return Ir.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},ms.prototype=Object.create(Ir.prototype),ms.prototype.constructor=ms,ms.prototype.isMeshDistanceMaterial=!0,ms.prototype.copy=function(e){return Ir.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this},vs.prototype=Object.create(Ut.prototype),vs.prototype.constructor=vs,_s.prototype=Object.assign(Object.create(cr.prototype),{constructor:_s,isPerspectiveCamera:!0,copy:function(e,t){return cr.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*Lt.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*Lt.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*Lt.RAD2DEG*Math.atan(Math.tan(.5*Lt.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,n,i,r,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,t=e*Math.tan(.5*Lt.DEG2RAD*this.fov)/this.zoom,n=2*t,i=this.aspect*n,r=-.5*i,o=this.view;if(null!==this.view&&this.view.enabled){var s=o.fullWidth,a=o.fullHeight;r+=o.offsetX*i/s,t-=o.offsetY*n/a,i*=o.width/s,n*=o.height/a}var l=this.filmOffset;0!==l&&(r+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+i,t,t-n,e,this.far)},toJSON:function(e){var t=ur.prototype.toJSON.call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}),As.prototype=Object.assign(Object.create(_s.prototype),{constructor:As,isArrayCamera:!0}),Ms.prototype.isFogExp2=!0,Ms.prototype.clone=function(){return new Ms(this.color.getHex(),this.density)},Ms.prototype.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},Ts.prototype.isFog=!0,Ts.prototype.clone=function(){return new Ts(this.color.getHex(),this.near,this.far)},Ts.prototype.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},Cs.prototype=Object.assign(Object.create(ur.prototype),{constructor:Cs,copy:function(e,t){return ur.prototype.copy.call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){var t=ur.prototype.toJSON.call(this,e);return null!==this.background&&(t.object.background=this.background.toJSON(e)),null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}),Ps.prototype=Object.create(Ir.prototype),Ps.prototype.constructor=Ps,Ps.prototype.isSpriteMaterial=!0,Ps.prototype.copy=function(e){return Ir.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.rotation=e.rotation,this},Rs.prototype=Object.assign(Object.create(ur.prototype),{constructor:Rs,isSprite:!0,raycast:function(){var e=new Nt,t=new Nt,n=new Nt;return function(i,r){t.setFromMatrixPosition(this.matrixWorld),i.ray.closestPointToPoint(t,e),n.setFromMatrixScale(this.matrixWorld);var o=n.x*n.y/4;if(!(t.distanceToSquared(e)>o)){var s=i.ray.origin.distanceTo(e);s<i.near||s>i.far||r.push({distance:s,point:e.clone(),face:null,object:this})}}}(),clone:function(){return new this.constructor(this.material).copy(this)},copy:function(e){return ur.prototype.copy.call(this,e),void 0!==e.center&&this.center.copy(e.center),this}}),Ls.prototype=Object.assign(Object.create(ur.prototype),{constructor:Ls,copy:function(e){ur.prototype.copy.call(this,e,!1);for(var t=e.levels,n=0,i=t.length;n<i;n++){var r=t[n];this.addLevel(r.object.clone(),r.distance)}return this},addLevel:function(e,t){void 0===t&&(t=0),t=Math.abs(t);for(var n=this.levels,i=0;i<n.length;i++)if(t<n[i].distance)break;n.splice(i,0,{distance:t,object:e}),this.add(e)},getObjectForDistance:function(e){for(var t=this.levels,n=1,i=t.length;n<i;n++)if(e<t[n].distance)break;return t[n-1].object},raycast:function(){var e=new Nt;return function(t,n){e.setFromMatrixPosition(this.matrixWorld);var i=t.ray.origin.distanceTo(e);this.getObjectForDistance(i).raycast(t,n)}}(),update:function(){var e=new Nt,t=new Nt;return function(n){var i=this.levels;if(i.length>1){e.setFromMatrixPosition(n.matrixWorld),t.setFromMatrixPosition(this.matrixWorld);var r=e.distanceTo(t);i[0].object.visible=!0;for(var o=1,s=i.length;o<s;o++){if(!(r>=i[o].distance))break;i[o-1].object.visible=!1,i[o].object.visible=!0}for(;o<s;o++)i[o].object.visible=!1}}}(),toJSON:function(e){var t=ur.prototype.toJSON.call(this,e);t.object.levels=[];for(var n=this.levels,i=0,r=n.length;i<r;i++){var o=n[i];t.object.levels.push({object:o.object.uuid,distance:o.distance})}return t}}),Object.assign(Os.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,t=this.bones.length;e<t;e++){var n=new Dt;this.bones[e]&&n.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(n)}},pose:function(){var e,t,n;for(t=0,n=this.bones.length;t<n;t++)e=this.bones[t],e&&e.matrixWorld.getInverse(this.boneInverses[t]);for(t=0,n=this.bones.length;t<n;t++)e=this.bones[t],e&&(e.parent&&e.parent.isBone?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},update:function(){var e=new Dt,t=new Dt;return function(){for(var n=this.bones,i=this.boneInverses,r=this.boneMatrices,o=this.boneTexture,s=0,a=n.length;s<a;s++){var l=n[s]?n[s].matrixWorld:t;e.multiplyMatrices(l,i[s]),e.toArray(r,16*s)}void 0!==o&&(o.needsUpdate=!0)}}(),clone:function(){return new Os(this.bones,this.boneInverses)},getBoneByName:function(e){for(var t=0,n=this.bones.length;t<n;t++){var i=this.bones[t];if(i.name===e)return i}}}),Ds.prototype=Object.assign(Object.create(ur.prototype),{constructor:Ds,isBone:!0}),Is.prototype=Object.assign(Object.create(zr.prototype),{constructor:Is,isSkinnedMesh:!0,initBones:function(){var e,t,n,i,r=[];if(this.geometry&&void 0!==this.geometry.bones){for(n=0,i=this.geometry.bones.length;n<i;n++)t=this.geometry.bones[n],e=new Ds,r.push(e),e.name=t.name,e.position.fromArray(t.pos),e.quaternion.fromArray(t.rotq),void 0!==t.scl&&e.scale.fromArray(t.scl);for(n=0,i=this.geometry.bones.length;n<i;n++)t=this.geometry.bones[n],-1!==t.parent&&null!==t.parent&&void 0!==r[t.parent]?r[t.parent].add(r[n]):this.add(r[n])}return this.updateMatrixWorld(!0),r},bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){var e,t;if(this.geometry&&this.geometry.isGeometry)for(t=0;t<this.geometry.skinWeights.length;t++){var n=this.geometry.skinWeights[t];e=1/n.manhattanLength(),e!==1/0?n.multiplyScalar(e):n.set(1,0,0,0)}else if(this.geometry&&this.geometry.isBufferGeometry){var i=new Ft,r=this.geometry.attributes.skinWeight;for(t=0;t<r.count;t++)i.x=r.getX(t),i.y=r.getY(t),i.z=r.getZ(t),i.w=r.getW(t),e=1/i.manhattanLength(),e!==1/0?i.multiplyScalar(e):i.set(1,0,0,0),r.setXYZW(t,i.x,i.y,i.z,i.w)}},updateMatrixWorld:function(e){zr.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Ns.prototype=Object.create(Ir.prototype),Ns.prototype.constructor=Ns,Ns.prototype.isLineBasicMaterial=!0,Ns.prototype.copy=function(e){return Ir.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this},ks.prototype=Object.assign(Object.create(ur.prototype),{constructor:ks,isLine:!0,computeLineDistances:function(){var e=new Nt,t=new Nt;return function(){var n=this.geometry;if(n.isBufferGeometry)if(null===n.index){for(var i=n.attributes.position,r=[0],o=1,s=i.count;o<s;o++)e.fromBufferAttribute(i,o-1),t.fromBufferAttribute(i,o),r[o]=r[o-1],r[o]+=e.distanceTo(t);n.addAttribute("lineDistance",new Ar(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(n.isGeometry){var a=n.vertices;r=n.lineDistances;r[0]=0;for(o=1,s=a.length;o<s;o++)r[o]=r[o-1],r[o]+=a[o-1].distanceTo(a[o])}return this}}(),raycast:function(){var e=new Dt,t=new Vr,n=new Ht;return function(i,r){var o=i.linePrecision,s=o*o,a=this.geometry,l=this.matrixWorld;if(null===a.boundingSphere&&a.computeBoundingSphere(),n.copy(a.boundingSphere),n.applyMatrix4(l),!1!==i.ray.intersectsSphere(n)){e.getInverse(l),t.copy(i.ray).applyMatrix4(e);var u=new Nt,c=new Nt,h=new Nt,d=new Nt,p=this&&this.isLineSegments?2:1;if(a.isBufferGeometry){var f=a.index,m=a.attributes,g=m.position.array;if(null!==f)for(var v=f.array,y=0,x=v.length-1;y<x;y+=p){var b=v[y],w=v[y+1];u.fromArray(g,3*b),c.fromArray(g,3*w);var _=t.distanceSqToSegment(u,c,d,h);if(!(_>s)){d.applyMatrix4(this.matrixWorld);var A=i.ray.origin.distanceTo(d);A<i.near||A>i.far||r.push({distance:A,point:h.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}else for(y=0,x=g.length/3-1;y<x;y+=p){u.fromArray(g,3*y),c.fromArray(g,3*y+3);_=t.distanceSqToSegment(u,c,d,h);if(!(_>s)){d.applyMatrix4(this.matrixWorld);A=i.ray.origin.distanceTo(d);A<i.near||A>i.far||r.push({distance:A,point:h.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}}else if(a.isGeometry){var S=a.vertices,E=S.length;for(y=0;y<E-1;y+=p){_=t.distanceSqToSegment(S[y],S[y+1],d,h);if(!(_>s)){d.applyMatrix4(this.matrixWorld);A=i.ray.origin.distanceTo(d);A<i.near||A>i.far||r.push({distance:A,point:h.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Vs.prototype=Object.assign(Object.create(ks.prototype),{constructor:Vs,isLineSegments:!0,computeLineDistances:function(){var e=new Nt,t=new Nt;return function(){var n=this.geometry;if(n.isBufferGeometry)if(null===n.index){for(var i=n.attributes.position,r=[],o=0,s=i.count;o<s;o+=2)e.fromBufferAttribute(i,o),t.fromBufferAttribute(i,o+1),r[o]=0===o?0:r[o-1],r[o+1]=r[o]+e.distanceTo(t);n.addAttribute("lineDistance",new Ar(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(n.isGeometry){var a=n.vertices;for(r=n.lineDistances,o=0,s=a.length;o<s;o+=2)e.copy(a[o]),t.copy(a[o+1]),r[o]=0===o?0:r[o-1],r[o+1]=r[o]+e.distanceTo(t)}return this}}()}),Us.prototype=Object.assign(Object.create(ks.prototype),{constructor:Us,isLineLoop:!0}),Fs.prototype=Object.create(Ir.prototype),Fs.prototype.constructor=Fs,Fs.prototype.isPointsMaterial=!0,Fs.prototype.copy=function(e){return Ir.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this},zs.prototype=Object.assign(Object.create(ur.prototype),{constructor:zs,isPoints:!0,raycast:function(){var e=new Dt,t=new Vr,n=new Ht;return function(i,r){var o=this,s=this.geometry,a=this.matrixWorld,l=i.params.Points.threshold;if(null===s.boundingSphere&&s.computeBoundingSphere(),n.copy(s.boundingSphere),n.applyMatrix4(a),n.radius+=l,!1!==i.ray.intersectsSphere(n)){e.getInverse(a),t.copy(i.ray).applyMatrix4(e);var u=l/((this.scale.x+this.scale.y+this.scale.z)/3),c=u*u,h=new Nt,d=new Nt;if(s.isBufferGeometry){var p=s.index,f=s.attributes,m=f.position.array;if(null!==p)for(var g=p.array,v=0,y=g.length;v<y;v++){var x=g[v];h.fromArray(m,3*x),_(h,x)}else{v=0;for(var b=m.length/3;v<b;v++)h.fromArray(m,3*v),_(h,v)}}else{var w=s.vertices;for(v=0,b=w.length;v<b;v++)_(w[v],v)}}function _(e,n){var s=t.distanceSqToPoint(e);if(s<c){t.closestPointToPoint(e,d),d.applyMatrix4(a);var l=i.ray.origin.distanceTo(d);if(l<i.near||l>i.far)return;r.push({distance:l,distanceToRay:Math.sqrt(s),point:d.clone(),index:n,face:null,object:o})}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),js.prototype=Object.assign(Object.create(ur.prototype),{constructor:js,isGroup:!0}),Bs.prototype=Object.assign(Object.create(Ut.prototype),{constructor:Bs,isVideoTexture:!0,update:function(){var e=this.image;e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),$s.prototype=Object.create(Ut.prototype),$s.prototype.constructor=$s,$s.prototype.isCompressedTexture=!0,Hs.prototype=Object.create(Ut.prototype),Hs.prototype.constructor=Hs,Hs.prototype.isDepthTexture=!0,Gs.prototype=Object.create(Cr.prototype),Gs.prototype.constructor=Gs,Ws.prototype=Object.create(fr.prototype),Ws.prototype.constructor=Ws,qs.prototype=Object.create(Cr.prototype),qs.prototype.constructor=qs,Ys.prototype=Object.create(fr.prototype),Ys.prototype.constructor=Ys,Xs.prototype=Object.create(Cr.prototype),Xs.prototype.constructor=Xs,Zs.prototype=Object.create(fr.prototype),Zs.prototype.constructor=Zs,Js.prototype=Object.create(Xs.prototype),Js.prototype.constructor=Js,Ks.prototype=Object.create(fr.prototype),Ks.prototype.constructor=Ks,Qs.prototype=Object.create(Xs.prototype),Qs.prototype.constructor=Qs,ea.prototype=Object.create(fr.prototype),ea.prototype.constructor=ea,ta.prototype=Object.create(Xs.prototype),ta.prototype.constructor=ta,na.prototype=Object.create(fr.prototype),na.prototype.constructor=na,ia.prototype=Object.create(Xs.prototype),ia.prototype.constructor=ia,ra.prototype=Object.create(fr.prototype),ra.prototype.constructor=ra,oa.prototype=Object.create(Cr.prototype),oa.prototype.constructor=oa,sa.prototype=Object.create(fr.prototype),sa.prototype.constructor=sa,aa.prototype=Object.create(Cr.prototype),aa.prototype.constructor=aa,la.prototype=Object.create(fr.prototype),la.prototype.constructor=la,ua.prototype=Object.create(Cr.prototype),ua.prototype.constructor=ua;var ca={triangulate:function(e,t,n){n=n||2;var i,r,o,s,a,l,u,c=t&&t.length,h=c?t[0]*n:e.length,d=ha(e,0,h,n,!0),p=[];if(!d)return p;if(c&&(d=ya(e,t,d,n)),e.length>80*n){i=o=e[0],r=s=e[1];for(var f=n;f<h;f+=n)a=e[f],l=e[f+1],a<i&&(i=a),l<r&&(r=l),a>o&&(o=a),l>s&&(s=l);u=Math.max(o-i,s-r),u=0!==u?1/u:0}return pa(d,p,n,i,r,u),p}};function ha(e,t,n,i,r){var o,s;if(r===Ua(e,t,n,i)>0)for(o=t;o<n;o+=i)s=Na(o,e[o],e[o+1],s);else for(o=n-i;o>=t;o-=i)s=Na(o,e[o],e[o+1],s);return s&&Pa(s,s.next)&&(ka(s),s=s.next),s}function da(e,t){if(!e)return e;t||(t=e);var n,i=e;do{if(n=!1,i.steiner||!Pa(i,i.next)&&0!==Ca(i.prev,i,i.next))i=i.next;else{if(ka(i),i=t=i.prev,i===i.next)break;n=!0}}while(n||i!==t);return t}function pa(e,t,n,i,r,o,s){if(e){!s&&o&&_a(e,i,r,o);var a,l,u=e;while(e.prev!==e.next)if(a=e.prev,l=e.next,o?ma(e,i,r,o):fa(e))t.push(a.i/n),t.push(e.i/n),t.push(l.i/n),ka(e),e=l.next,u=l.next;else if(e=l,e===u){s?1===s?(e=ga(e,t,n),pa(e,t,n,i,r,o,2)):2===s&&va(e,t,n,i,r,o):pa(da(e),t,n,i,r,o,1);break}}}function fa(e){var t=e.prev,n=e,i=e.next;if(Ca(t,n,i)>=0)return!1;var r=e.next.next;while(r!==e.prev){if(Ma(t.x,t.y,n.x,n.y,i.x,i.y,r.x,r.y)&&Ca(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function ma(e,t,n,i){var r=e.prev,o=e,s=e.next;if(Ca(r,o,s)>=0)return!1;var a=r.x<o.x?r.x<s.x?r.x:s.x:o.x<s.x?o.x:s.x,l=r.y<o.y?r.y<s.y?r.y:s.y:o.y<s.y?o.y:s.y,u=r.x>o.x?r.x>s.x?r.x:s.x:o.x>s.x?o.x:s.x,c=r.y>o.y?r.y>s.y?r.y:s.y:o.y>s.y?o.y:s.y,h=Sa(a,l,t,n,i),d=Sa(u,c,t,n,i),p=e.nextZ;while(p&&p.z<=d){if(p!==e.prev&&p!==e.next&&Ma(r.x,r.y,o.x,o.y,s.x,s.y,p.x,p.y)&&Ca(p.prev,p,p.next)>=0)return!1;p=p.nextZ}p=e.prevZ;while(p&&p.z>=h){if(p!==e.prev&&p!==e.next&&Ma(r.x,r.y,o.x,o.y,s.x,s.y,p.x,p.y)&&Ca(p.prev,p,p.next)>=0)return!1;p=p.prevZ}return!0}function ga(e,t,n){var i=e;do{var r=i.prev,o=i.next.next;!Pa(r,o)&&Ra(r,i,i.next,o)&&Oa(r,o)&&Oa(o,r)&&(t.push(r.i/n),t.push(i.i/n),t.push(o.i/n),ka(i),ka(i.next),i=e=o),i=i.next}while(i!==e);return i}function va(e,t,n,i,r,o){var s=e;do{var a=s.next.next;while(a!==s.prev){if(s.i!==a.i&&Ta(s,a)){var l=Ia(s,a);return s=da(s,s.next),l=da(l,l.next),pa(s,t,n,i,r,o),void pa(l,t,n,i,r,o)}a=a.next}s=s.next}while(s!==e)}function ya(e,t,n,i){var r,o,s,a,l,u=[];for(r=0,o=t.length;r<o;r++)s=t[r]*i,a=r<o-1?t[r+1]*i:e.length,l=ha(e,s,a,i,!1),l===l.next&&(l.steiner=!0),u.push(Ea(l));for(u.sort(xa),r=0;r<u.length;r++)ba(u[r],n),n=da(n,n.next);return n}function xa(e,t){return e.x-t.x}function ba(e,t){if(t=wa(e,t),t){var n=Ia(t,e);da(n,n.next)}}function wa(e,t){var n,i=t,r=e.x,o=e.y,s=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var a=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=r&&a>s){if(s=a,a===r){if(o===i.y)return i;if(o===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==t);if(!n)return null;if(r===s)return n.prev;var l,u=n,c=n.x,h=n.y,d=1/0;i=n.next;while(i!==u)r>=i.x&&i.x>=c&&r!==i.x&&Ma(o<h?r:s,o,c,h,o<h?s:r,o,i.x,i.y)&&(l=Math.abs(o-i.y)/(r-i.x),(l<d||l===d&&i.x>n.x)&&Oa(i,e)&&(n=i,d=l)),i=i.next;return n}function _a(e,t,n,i){var r=e;do{null===r.z&&(r.z=Sa(r.x,r.y,t,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,Aa(r)}function Aa(e){var t,n,i,r,o,s,a,l,u=1;do{n=e,e=null,o=null,s=0;while(n){for(s++,i=n,a=0,t=0;t<u;t++)if(a++,i=i.nextZ,!i)break;l=u;while(a>0||l>0&&i)0!==a&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,l--),o?o.nextZ=r:e=r,r.prevZ=o,o=r;n=i}o.nextZ=null,u*=2}while(s>1);return e}function Sa(e,t,n,i,r){return e=32767*(e-n)*r,t=32767*(t-i)*r,e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e|t<<1}function Ea(e){var t=e,n=e;do{t.x<n.x&&(n=t),t=t.next}while(t!==e);return n}function Ma(e,t,n,i,r,o,s,a){return(r-s)*(t-a)-(e-s)*(o-a)>=0&&(e-s)*(i-a)-(n-s)*(t-a)>=0&&(n-s)*(o-a)-(r-s)*(i-a)>=0}function Ta(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!La(e,t)&&Oa(e,t)&&Oa(t,e)&&Da(e,t)}function Ca(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function Pa(e,t){return e.x===t.x&&e.y===t.y}function Ra(e,t,n,i){return!!(Pa(e,t)&&Pa(n,i)||Pa(e,i)&&Pa(n,t))||Ca(e,t,n)>0!==Ca(e,t,i)>0&&Ca(n,i,e)>0!==Ca(n,i,t)>0}function La(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&Ra(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}function Oa(e,t){return Ca(e.prev,e,e.next)<0?Ca(e,t,e.next)>=0&&Ca(e,e.prev,t)>=0:Ca(e,t,e.prev)<0||Ca(e,e.next,t)<0}function Da(e,t){var n=e,i=!1,r=(e.x+t.x)/2,o=(e.y+t.y)/2;do{n.y>o!==n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==e);return i}function Ia(e,t){var n=new Va(e.i,e.x,e.y),i=new Va(t.i,t.x,t.y),r=e.next,o=t.prev;return e.next=t,t.prev=e,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function Na(e,t,n,i){var r=new Va(e,t,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function ka(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Va(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Ua(e,t,n,i){for(var r=0,o=t,s=n-i;o<n;o+=i)r+=(e[s]-e[o])*(e[o+1]+e[s+1]),s=o;return r}var Fa={area:function(e){for(var t=e.length,n=0,i=t-1,r=0;r<t;i=r++)n+=e[i].x*e[r].y-e[r].x*e[i].y;return.5*n},isClockWise:function(e){return Fa.area(e)<0},triangulateShape:function(e,t){var n=[],i=[],r=[];za(e),ja(n,e);var o=e.length;t.forEach(za);for(var s=0;s<t.length;s++)i.push(o),o+=t[s].length,ja(n,t[s]);var a=ca.triangulate(n,i);for(s=0;s<a.length;s+=3)r.push(a.slice(s,s+3));return r}};function za(e){var t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function ja(e,t){for(var n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}function Ba(e,t){fr.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},this.fromBufferGeometry(new $a(e,t)),this.mergeVertices()}function $a(e,t){Cr.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];for(var n=this,i=[],r=[],o=0,s=e.length;o<s;o++){var a=e[o];l(a,t)}function l(e){var o,s,a,l,u,c,h,d,p=[],f=void 0!==t.curveSegments?t.curveSegments:12,m=void 0!==t.steps?t.steps:1,g=void 0!==t.amount?t.amount:100,v=void 0===t.bevelEnabled||t.bevelEnabled,y=void 0!==t.bevelThickness?t.bevelThickness:6,x=void 0!==t.bevelSize?t.bevelSize:y-2,b=void 0!==t.bevelSegments?t.bevelSegments:3,w=t.extrudePath,_=void 0!==t.UVGenerator?t.UVGenerator:Ha,A=!1;w&&(o=w.getSpacedPoints(m),A=!0,v=!1,s=w.computeFrenetFrames(m,!1),a=new Nt,l=new Nt,u=new Nt),v||(b=0,y=0,x=0);var S=e.extractPoints(f),E=S.shape,M=S.holes,T=!Fa.isClockWise(E);if(T)for(E=E.reverse(),h=0,d=M.length;h<d;h++)c=M[h],Fa.isClockWise(c)&&(M[h]=c.reverse());var C=Fa.triangulateShape(E,M),P=E;for(h=0,d=M.length;h<d;h++)c=M[h],E=E.concat(c);function R(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(n).add(e)}var L,O,D,I,N,k,V=E.length,U=C.length;function F(e,t,n){var i,r,o,s=e.x-t.x,a=e.y-t.y,l=n.x-e.x,u=n.y-e.y,c=s*s+a*a,h=s*u-a*l;if(Math.abs(h)>Number.EPSILON){var d=Math.sqrt(c),p=Math.sqrt(l*l+u*u),f=t.x-a/d,m=t.y+s/d,g=n.x-u/p,v=n.y+l/p,y=((g-f)*u-(v-m)*l)/(s*u-a*l);i=f+s*y-e.x,r=m+a*y-e.y;var x=i*i+r*r;if(x<=2)return new Ot(i,r);o=Math.sqrt(x/2)}else{var b=!1;s>Number.EPSILON?l>Number.EPSILON&&(b=!0):s<-Number.EPSILON?l<-Number.EPSILON&&(b=!0):Math.sign(a)===Math.sign(u)&&(b=!0),b?(i=-a,r=s,o=Math.sqrt(c)):(i=s,r=a,o=Math.sqrt(c/2))}return new Ot(i/o,r/o)}for(var z=[],j=0,B=P.length,$=B-1,H=j+1;j<B;j++,$++,H++)$===B&&($=0),H===B&&(H=0),z[j]=F(P[j],P[$],P[H]);var G,W,q=[],Y=z.concat();for(h=0,d=M.length;h<d;h++){for(c=M[h],G=[],j=0,B=c.length,$=B-1,H=j+1;j<B;j++,$++,H++)$===B&&($=0),H===B&&(H=0),G[j]=F(c[j],c[$],c[H]);q.push(G),Y=Y.concat(G)}for(L=0;L<b;L++){for(D=L/b,I=y*Math.cos(D*Math.PI/2),O=x*Math.sin(D*Math.PI/2),j=0,B=P.length;j<B;j++)N=R(P[j],z[j],O),K(N.x,N.y,-I);for(h=0,d=M.length;h<d;h++)for(c=M[h],G=q[h],j=0,B=c.length;j<B;j++)N=R(c[j],G[j],O),K(N.x,N.y,-I)}for(O=x,j=0;j<V;j++)N=v?R(E[j],Y[j],O):E[j],A?(l.copy(s.normals[0]).multiplyScalar(N.x),a.copy(s.binormals[0]).multiplyScalar(N.y),u.copy(o[0]).add(l).add(a),K(u.x,u.y,u.z)):K(N.x,N.y,0);for(W=1;W<=m;W++)for(j=0;j<V;j++)N=v?R(E[j],Y[j],O):E[j],A?(l.copy(s.normals[W]).multiplyScalar(N.x),a.copy(s.binormals[W]).multiplyScalar(N.y),u.copy(o[W]).add(l).add(a),K(u.x,u.y,u.z)):K(N.x,N.y,g/m*W);for(L=b-1;L>=0;L--){for(D=L/b,I=y*Math.cos(D*Math.PI/2),O=x*Math.sin(D*Math.PI/2),j=0,B=P.length;j<B;j++)N=R(P[j],z[j],O),K(N.x,N.y,g+I);for(h=0,d=M.length;h<d;h++)for(c=M[h],G=q[h],j=0,B=c.length;j<B;j++)N=R(c[j],G[j],O),A?K(N.x,N.y+o[m-1].y,o[m-1].x+I):K(N.x,N.y,g+I)}function X(){var e=i.length/3;if(v){var t=0,r=V*t;for(j=0;j<U;j++)k=C[j],Q(k[2]+r,k[1]+r,k[0]+r);for(t=m+2*b,r=V*t,j=0;j<U;j++)k=C[j],Q(k[0]+r,k[1]+r,k[2]+r)}else{for(j=0;j<U;j++)k=C[j],Q(k[2],k[1],k[0]);for(j=0;j<U;j++)k=C[j],Q(k[0]+V*m,k[1]+V*m,k[2]+V*m)}n.addGroup(e,i.length/3-e,0)}function Z(){var e=i.length/3,t=0;for(J(P,t),t+=P.length,h=0,d=M.length;h<d;h++)c=M[h],J(c,t),t+=c.length;n.addGroup(e,i.length/3-e,1)}function J(e,t){var n,i;j=e.length;while(--j>=0){n=j,i=j-1,i<0&&(i=e.length-1);var r=0,o=m+2*b;for(r=0;r<o;r++){var s=V*r,a=V*(r+1),l=t+n+s,u=t+i+s,c=t+i+a,h=t+n+a;ee(l,u,c,h)}}}function K(e,t,n){p.push(e),p.push(t),p.push(n)}function Q(e,t,r){te(e),te(t),te(r);var o=i.length/3,s=_.generateTopUV(n,i,o-3,o-2,o-1);ne(s[0]),ne(s[1]),ne(s[2])}function ee(e,t,r,o){te(e),te(t),te(o),te(t),te(r),te(o);var s=i.length/3,a=_.generateSideWallUV(n,i,s-6,s-3,s-2,s-1);ne(a[0]),ne(a[1]),ne(a[3]),ne(a[1]),ne(a[2]),ne(a[3])}function te(e){i.push(p[3*e+0]),i.push(p[3*e+1]),i.push(p[3*e+2])}function ne(e){r.push(e.x),r.push(e.y)}X(),Z()}this.addAttribute("position",new Ar(i,3)),this.addAttribute("uv",new Ar(r,2)),this.computeVertexNormals()}Ba.prototype=Object.create(fr.prototype),Ba.prototype.constructor=Ba,$a.prototype=Object.create(Cr.prototype),$a.prototype.constructor=$a;var Ha={generateTopUV:function(e,t,n,i,r){var o=t[3*n],s=t[3*n+1],a=t[3*i],l=t[3*i+1],u=t[3*r],c=t[3*r+1];return[new Ot(o,s),new Ot(a,l),new Ot(u,c)]},generateSideWallUV:function(e,t,n,i,r,o){var s=t[3*n],a=t[3*n+1],l=t[3*n+2],u=t[3*i],c=t[3*i+1],h=t[3*i+2],d=t[3*r],p=t[3*r+1],f=t[3*r+2],m=t[3*o],g=t[3*o+1],v=t[3*o+2];return Math.abs(a-c)<.01?[new Ot(s,1-l),new Ot(u,1-h),new Ot(d,1-f),new Ot(m,1-v)]:[new Ot(a,1-l),new Ot(c,1-h),new Ot(p,1-f),new Ot(g,1-v)]}};function Ga(e,t){fr.call(this),this.type="TextGeometry",this.parameters={text:e,parameters:t},this.fromBufferGeometry(new Wa(e,t)),this.mergeVertices()}function Wa(e,t){t=t||{};var n=t.font;if(!n||!n.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new fr;var i=n.generateShapes(e,t.size,t.curveSegments);t.amount=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),$a.call(this,i,t),this.type="TextBufferGeometry"}function qa(e,t,n,i,r,o,s){fr.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:r,thetaStart:o,thetaLength:s},this.fromBufferGeometry(new Ya(e,t,n,i,r,o,s)),this.mergeVertices()}function Ya(e,t,n,i,r,o,s){Cr.call(this),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:r,thetaStart:o,thetaLength:s},e=e||1,t=Math.max(3,Math.floor(t)||8),n=Math.max(2,Math.floor(n)||6),i=void 0!==i?i:0,r=void 0!==r?r:2*Math.PI,o=void 0!==o?o:0,s=void 0!==s?s:Math.PI;var a,l,u=o+s,c=0,h=[],d=new Nt,p=new Nt,f=[],m=[],g=[],v=[];for(l=0;l<=n;l++){var y=[],x=l/n;for(a=0;a<=t;a++){var b=a/t;d.x=-e*Math.cos(i+b*r)*Math.sin(o+x*s),d.y=e*Math.cos(o+x*s),d.z=e*Math.sin(i+b*r)*Math.sin(o+x*s),m.push(d.x,d.y,d.z),p.set(d.x,d.y,d.z).normalize(),g.push(p.x,p.y,p.z),v.push(b,1-x),y.push(c++)}h.push(y)}for(l=0;l<n;l++)for(a=0;a<t;a++){var w=h[l][a+1],_=h[l][a],A=h[l+1][a],S=h[l+1][a+1];(0!==l||o>0)&&f.push(w,_,S),(l!==n-1||u<Math.PI)&&f.push(_,A,S)}this.setIndex(f),this.addAttribute("position",new Ar(m,3)),this.addAttribute("normal",new Ar(g,3)),this.addAttribute("uv",new Ar(v,2))}function Xa(e,t,n,i,r,o){fr.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:i,thetaStart:r,thetaLength:o},this.fromBufferGeometry(new Za(e,t,n,i,r,o)),this.mergeVertices()}function Za(e,t,n,i,r,o){Cr.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:i,thetaStart:r,thetaLength:o},e=e||.5,t=t||1,r=void 0!==r?r:0,o=void 0!==o?o:2*Math.PI,n=void 0!==n?Math.max(3,n):8,i=void 0!==i?Math.max(1,i):1;var s,a,l,u=[],c=[],h=[],d=[],p=e,f=(t-e)/i,m=new Nt,g=new Ot;for(a=0;a<=i;a++){for(l=0;l<=n;l++)s=r+l/n*o,m.x=p*Math.cos(s),m.y=p*Math.sin(s),c.push(m.x,m.y,m.z),h.push(0,0,1),g.x=(m.x/t+1)/2,g.y=(m.y/t+1)/2,d.push(g.x,g.y);p+=f}for(a=0;a<i;a++){var v=a*(n+1);for(l=0;l<n;l++){s=l+v;var y=s,x=s+n+1,b=s+n+2,w=s+1;u.push(y,x,w),u.push(x,b,w)}}this.setIndex(u),this.addAttribute("position",new Ar(c,3)),this.addAttribute("normal",new Ar(h,3)),this.addAttribute("uv",new Ar(d,2))}function Ja(e,t,n,i){fr.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:i},this.fromBufferGeometry(new Ka(e,t,n,i)),this.mergeVertices()}function Ka(e,t,n,i){Cr.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:i},t=Math.floor(t)||12,n=n||0,i=i||2*Math.PI,i=Lt.clamp(i,0,2*Math.PI);var r,o,s,a=[],l=[],u=[],c=1/t,h=new Nt,d=new Ot;for(o=0;o<=t;o++){var p=n+o*c*i,f=Math.sin(p),m=Math.cos(p);for(s=0;s<=e.length-1;s++)h.x=e[s].x*f,h.y=e[s].y,h.z=e[s].x*m,l.push(h.x,h.y,h.z),d.x=o/t,d.y=s/(e.length-1),u.push(d.x,d.y)}for(o=0;o<t;o++)for(s=0;s<e.length-1;s++){r=s+o*e.length;var g=r,v=r+e.length,y=r+e.length+1,x=r+1;a.push(g,v,x),a.push(v,y,x)}if(this.setIndex(a),this.addAttribute("position",new Ar(l,3)),this.addAttribute("uv",new Ar(u,2)),this.computeVertexNormals(),i===2*Math.PI){var b=this.attributes.normal.array,w=new Nt,_=new Nt,A=new Nt;for(r=t*e.length*3,o=0,s=0;o<e.length;o++,s+=3)w.x=b[s+0],w.y=b[s+1],w.z=b[s+2],_.x=b[r+s+0],_.y=b[r+s+1],_.z=b[r+s+2],A.addVectors(w,_).normalize(),b[s+0]=b[r+s+0]=A.x,b[s+1]=b[r+s+1]=A.y,b[s+2]=b[r+s+2]=A.z}}function Qa(e,t){fr.call(this),this.type="ShapeGeometry","object"===typeof t&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),t=t.curveSegments),this.parameters={shapes:e,curveSegments:t},this.fromBufferGeometry(new el(e,t)),this.mergeVertices()}function el(e,t){Cr.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:e,curveSegments:t},t=t||12;var n=[],i=[],r=[],o=[],s=0,a=0;if(!1===Array.isArray(e))u(e);else for(var l=0;l<e.length;l++)u(e[l]),this.addGroup(s,a,l),s+=a,a=0;function u(e){var s,l,u,c=i.length/3,h=e.extractPoints(t),d=h.shape,p=h.holes;if(!1===Fa.isClockWise(d))for(d=d.reverse(),s=0,l=p.length;s<l;s++)u=p[s],!0===Fa.isClockWise(u)&&(p[s]=u.reverse());var f=Fa.triangulateShape(d,p);for(s=0,l=p.length;s<l;s++)u=p[s],d=d.concat(u);for(s=0,l=d.length;s<l;s++){var m=d[s];i.push(m.x,m.y,0),r.push(0,0,1),o.push(m.x,m.y)}for(s=0,l=f.length;s<l;s++){var g=f[s],v=g[0]+c,y=g[1]+c,x=g[2]+c;n.push(v,y,x),a+=3}}this.setIndex(n),this.addAttribute("position",new Ar(i,3)),this.addAttribute("normal",new Ar(r,3)),this.addAttribute("uv",new Ar(o,2))}function tl(e,t){if(t.shapes=[],Array.isArray(e))for(var n=0,i=e.length;n<i;n++){var r=e[n];t.shapes.push(r.uuid)}else t.shapes.push(e.uuid);return t}function nl(e,t){Cr.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:t},t=void 0!==t?t:1;var n,i,r,o,s=[],a=Math.cos(Lt.DEG2RAD*t),l=[0,0],u={},c=["a","b","c"];e.isBufferGeometry?(o=new fr,o.fromBufferGeometry(e)):o=e.clone(),o.mergeVertices(),o.computeFaceNormals();for(var h=o.vertices,d=o.faces,p=0,f=d.length;p<f;p++)for(var m=d[p],g=0;g<3;g++)n=m[c[g]],i=m[c[(g+1)%3]],l[0]=Math.min(n,i),l[1]=Math.max(n,i),r=l[0]+","+l[1],void 0===u[r]?u[r]={index1:l[0],index2:l[1],face1:p,face2:void 0}:u[r].face2=p;for(r in u){var v=u[r];if(void 0===v.face2||d[v.face1].normal.dot(d[v.face2].normal)<=a){var y=h[v.index1];s.push(y.x,y.y,y.z),y=h[v.index2],s.push(y.x,y.y,y.z)}}this.addAttribute("position",new Ar(s,3))}function il(e,t,n,i,r,o,s,a){fr.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:i,heightSegments:r,openEnded:o,thetaStart:s,thetaLength:a},this.fromBufferGeometry(new rl(e,t,n,i,r,o,s,a)),this.mergeVertices()}function rl(e,t,n,i,r,o,s,a){Cr.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:i,heightSegments:r,openEnded:o,thetaStart:s,thetaLength:a};var l=this;e=void 0!==e?e:1,t=void 0!==t?t:1,n=n||1,i=Math.floor(i)||8,r=Math.floor(r)||1,o=void 0!==o&&o,s=void 0!==s?s:0,a=void 0!==a?a:2*Math.PI;var u=[],c=[],h=[],d=[],p=0,f=[],m=n/2,g=0;function v(){var o,v,y=new Nt,x=new Nt,b=0,w=(t-e)/n;for(v=0;v<=r;v++){var _=[],A=v/r,S=A*(t-e)+e;for(o=0;o<=i;o++){var E=o/i,M=E*a+s,T=Math.sin(M),C=Math.cos(M);x.x=S*T,x.y=-A*n+m,x.z=S*C,c.push(x.x,x.y,x.z),y.set(T,w,C).normalize(),h.push(y.x,y.y,y.z),d.push(E,1-A),_.push(p++)}f.push(_)}for(o=0;o<i;o++)for(v=0;v<r;v++){var P=f[v][o],R=f[v+1][o],L=f[v+1][o+1],O=f[v][o+1];u.push(P,R,O),u.push(R,L,O),b+=6}l.addGroup(g,b,0),g+=b}function y(n){var r,o,f,v=new Ot,y=new Nt,x=0,b=!0===n?e:t,w=!0===n?1:-1;for(o=p,r=1;r<=i;r++)c.push(0,m*w,0),h.push(0,w,0),d.push(.5,.5),p++;for(f=p,r=0;r<=i;r++){var _=r/i,A=_*a+s,S=Math.cos(A),E=Math.sin(A);y.x=b*E,y.y=m*w,y.z=b*S,c.push(y.x,y.y,y.z),h.push(0,w,0),v.x=.5*S+.5,v.y=.5*E*w+.5,d.push(v.x,v.y),p++}for(r=0;r<i;r++){var M=o+r,T=f+r;!0===n?u.push(T,T+1,M):u.push(T+1,T,M),x+=3}l.addGroup(g,x,!0===n?1:2),g+=x}v(),!1===o&&(e>0&&y(!0),t>0&&y(!1)),this.setIndex(u),this.addAttribute("position",new Ar(c,3)),this.addAttribute("normal",new Ar(h,3)),this.addAttribute("uv",new Ar(d,2))}function ol(e,t,n,i,r,o,s){il.call(this,0,e,t,n,i,r,o,s),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:i,openEnded:r,thetaStart:o,thetaLength:s}}function sl(e,t,n,i,r,o,s){rl.call(this,0,e,t,n,i,r,o,s),this.type="ConeBufferGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:i,openEnded:r,thetaStart:o,thetaLength:s}}function al(e,t,n,i){fr.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:i},this.fromBufferGeometry(new ll(e,t,n,i)),this.mergeVertices()}function ll(e,t,n,i){Cr.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:i},e=e||1,t=void 0!==t?Math.max(3,t):8,n=void 0!==n?n:0,i=void 0!==i?i:2*Math.PI;var r,o,s=[],a=[],l=[],u=[],c=new Nt,h=new Ot;for(a.push(0,0,0),l.push(0,0,1),u.push(.5,.5),o=0,r=3;o<=t;o++,r+=3){var d=n+o/t*i;c.x=e*Math.cos(d),c.y=e*Math.sin(d),a.push(c.x,c.y,c.z),l.push(0,0,1),h.x=(a[r]/e+1)/2,h.y=(a[r+1]/e+1)/2,u.push(h.x,h.y)}for(r=1;r<=t;r++)s.push(r,r+1,0);this.setIndex(s),this.addAttribute("position",new Ar(a,3)),this.addAttribute("normal",new Ar(l,3)),this.addAttribute("uv",new Ar(u,2))}Ga.prototype=Object.create(fr.prototype),Ga.prototype.constructor=Ga,Wa.prototype=Object.create($a.prototype),Wa.prototype.constructor=Wa,qa.prototype=Object.create(fr.prototype),qa.prototype.constructor=qa,Ya.prototype=Object.create(Cr.prototype),Ya.prototype.constructor=Ya,Xa.prototype=Object.create(fr.prototype),Xa.prototype.constructor=Xa,Za.prototype=Object.create(Cr.prototype),Za.prototype.constructor=Za,Ja.prototype=Object.create(fr.prototype),Ja.prototype.constructor=Ja,Ka.prototype=Object.create(Cr.prototype),Ka.prototype.constructor=Ka,Qa.prototype=Object.create(fr.prototype),Qa.prototype.constructor=Qa,Qa.prototype.toJSON=function(){var e=fr.prototype.toJSON.call(this),t=this.parameters.shapes;return tl(t,e)},el.prototype=Object.create(Cr.prototype),el.prototype.constructor=el,el.prototype.toJSON=function(){var e=Cr.prototype.toJSON.call(this),t=this.parameters.shapes;return tl(t,e)},nl.prototype=Object.create(Cr.prototype),nl.prototype.constructor=nl,il.prototype=Object.create(fr.prototype),il.prototype.constructor=il,rl.prototype=Object.create(Cr.prototype),rl.prototype.constructor=rl,ol.prototype=Object.create(il.prototype),ol.prototype.constructor=ol,sl.prototype=Object.create(rl.prototype),sl.prototype.constructor=sl,al.prototype=Object.create(fr.prototype),al.prototype.constructor=al,ll.prototype=Object.create(Cr.prototype),ll.prototype.constructor=ll;var ul=Object.freeze({WireframeGeometry:Gs,ParametricGeometry:Ws,ParametricBufferGeometry:qs,TetrahedronGeometry:Zs,TetrahedronBufferGeometry:Js,OctahedronGeometry:Ks,OctahedronBufferGeometry:Qs,IcosahedronGeometry:ea,IcosahedronBufferGeometry:ta,DodecahedronGeometry:na,DodecahedronBufferGeometry:ia,PolyhedronGeometry:Ys,PolyhedronBufferGeometry:Xs,TubeGeometry:ra,TubeBufferGeometry:oa,TorusKnotGeometry:sa,TorusKnotBufferGeometry:aa,TorusGeometry:la,TorusBufferGeometry:ua,TextGeometry:Ga,TextBufferGeometry:Wa,SphereGeometry:qa,SphereBufferGeometry:Ya,RingGeometry:Xa,RingBufferGeometry:Za,PlaneGeometry:Lr,PlaneBufferGeometry:Or,LatheGeometry:Ja,LatheBufferGeometry:Ka,ShapeGeometry:Qa,ShapeBufferGeometry:el,ExtrudeGeometry:Ba,ExtrudeBufferGeometry:$a,EdgesGeometry:nl,ConeGeometry:ol,ConeBufferGeometry:sl,CylinderGeometry:il,CylinderBufferGeometry:rl,CircleGeometry:al,CircleBufferGeometry:ll,BoxGeometry:Pr,BoxBufferGeometry:Rr});function cl(e){Ir.call(this),this.type="ShadowMaterial",this.color=new nr(0),this.transparent=!0,this.setValues(e)}function hl(e){kr.call(this,e),this.type="RawShaderMaterial"}function dl(e){Ir.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new nr(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new nr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new Ot(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function pl(e){dl.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(e)}function fl(e){Ir.call(this),this.type="MeshPhongMaterial",this.color=new nr(16777215),this.specular=new nr(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new nr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new Ot(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=J,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function ml(e){fl.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(e)}function gl(e){Ir.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new Ot(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function vl(e){Ir.call(this),this.type="MeshLambertMaterial",this.color=new nr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new nr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=J,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function yl(e){Ns.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}cl.prototype=Object.create(Ir.prototype),cl.prototype.constructor=cl,cl.prototype.isShadowMaterial=!0,cl.prototype.copy=function(e){return Ir.prototype.copy.call(this,e),this.color.copy(e.color),this},hl.prototype=Object.create(kr.prototype),hl.prototype.constructor=hl,hl.prototype.isRawShaderMaterial=!0,dl.prototype=Object.create(Ir.prototype),dl.prototype.constructor=dl,dl.prototype.isMeshStandardMaterial=!0,dl.prototype.copy=function(e){return Ir.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},pl.prototype=Object.create(dl.prototype),pl.prototype.constructor=pl,pl.prototype.isMeshPhysicalMaterial=!0,pl.prototype.copy=function(e){return dl.prototype.copy.call(this,e),this.defines={PHYSICAL:""},this.reflectivity=e.reflectivity,this.clearCoat=e.clearCoat,this.clearCoatRoughness=e.clearCoatRoughness,this},fl.prototype=Object.create(Ir.prototype),fl.prototype.constructor=fl,fl.prototype.isMeshPhongMaterial=!0,fl.prototype.copy=function(e){return Ir.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},ml.prototype=Object.create(fl.prototype),ml.prototype.constructor=ml,ml.prototype.isMeshToonMaterial=!0,ml.prototype.copy=function(e){return fl.prototype.copy.call(this,e),this.gradientMap=e.gradientMap,this},gl.prototype=Object.create(Ir.prototype),gl.prototype.constructor=gl,gl.prototype.isMeshNormalMaterial=!0,gl.prototype.copy=function(e){return Ir.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},vl.prototype=Object.create(Ir.prototype),vl.prototype.constructor=vl,vl.prototype.isMeshLambertMaterial=!0,vl.prototype.copy=function(e){return Ir.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},yl.prototype=Object.create(Ns.prototype),yl.prototype.constructor=yl,yl.prototype.isLineDashedMaterial=!0,yl.prototype.copy=function(e){return Ns.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var xl=Object.freeze({ShadowMaterial:cl,SpriteMaterial:Ps,RawShaderMaterial:hl,ShaderMaterial:kr,PointsMaterial:Fs,MeshPhysicalMaterial:pl,MeshStandardMaterial:dl,MeshPhongMaterial:fl,MeshToonMaterial:ml,MeshNormalMaterial:gl,MeshLambertMaterial:vl,MeshDepthMaterial:fs,MeshDistanceMaterial:ms,MeshBasicMaterial:Nr,LineDashedMaterial:yl,LineBasicMaterial:Ns,Material:Ir}),bl={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function wl(e,t,n){var i=this,r=!1,o=0,s=0,a=void 0;this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){s++,!1===r&&void 0!==i.onStart&&i.onStart(e,o,s),r=!0},this.itemEnd=function(e){o++,void 0!==i.onProgress&&i.onProgress(e,o,s),o===s&&(r=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(e){void 0!==i.onError&&i.onError(e)},this.resolveURL=function(e){return a?a(e):e},this.setURLModifier=function(e){return a=e,this}}var _l=new wl,Al={};function Sl(e){this.manager=void 0!==e?e:_l}function El(e){this.manager=void 0!==e?e:_l,this._parser=null}function Ml(e){this.manager=void 0!==e?e:_l,this._parser=null}function Tl(e){this.manager=void 0!==e?e:_l}function Cl(e){this.manager=void 0!==e?e:_l}function Pl(e){this.manager=void 0!==e?e:_l}function Rl(){this.type="Curve",this.arcLengthDivisions=200}function Ll(e,t,n,i,r,o,s,a){Rl.call(this),this.type="EllipseCurve",this.aX=e||0,this.aY=t||0,this.xRadius=n||1,this.yRadius=i||1,this.aStartAngle=r||0,this.aEndAngle=o||2*Math.PI,this.aClockwise=s||!1,this.aRotation=a||0}function Ol(e,t,n,i,r,o){Ll.call(this,e,t,n,n,i,r,o),this.type="ArcCurve"}function Dl(){var e=0,t=0,n=0,i=0;function r(r,o,s,a){e=r,t=s,n=-3*r+3*o-2*s-a,i=2*r-2*o+s+a}return{initCatmullRom:function(e,t,n,i,o){r(t,n,o*(n-e),o*(i-t))},initNonuniformCatmullRom:function(e,t,n,i,o,s,a){var l=(t-e)/o-(n-e)/(o+s)+(n-t)/s,u=(n-t)/s-(i-t)/(s+a)+(i-n)/a;l*=s,u*=s,r(t,n,l,u)},calc:function(r){var o=r*r,s=o*r;return e+t*r+n*o+i*s}}}Object.assign(Sl.prototype,{load:function(e,t,n,i){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var r=this,o=bl.get(e);if(void 0!==o)return r.manager.itemStart(e),setTimeout((function(){t&&t(o),r.manager.itemEnd(e)}),0),o;if(void 0===Al[e]){var s=/^data:(.*?)(;base64)?,(.*)$/,a=e.match(s);if(a){var l=a[1],u=!!a[2],c=a[3];c=window.decodeURIComponent(c),u&&(c=window.atob(c));try{var h,d=(this.responseType||"").toLowerCase();switch(d){case"arraybuffer":case"blob":for(var p=new Uint8Array(c.length),f=0;f<c.length;f++)p[f]=c.charCodeAt(f);h="blob"===d?new Blob([p.buffer],{type:l}):p.buffer;break;case"document":var m=new DOMParser;h=m.parseFromString(c,l);break;case"json":h=JSON.parse(c);break;default:h=c;break}window.setTimeout((function(){t&&t(h),r.manager.itemEnd(e)}),0)}catch(y){window.setTimeout((function(){i&&i(y),r.manager.itemEnd(e),r.manager.itemError(e)}),0)}}else{Al[e]=[],Al[e].push({onLoad:t,onProgress:n,onError:i});var g=new XMLHttpRequest;for(var v in g.open("GET",e,!0),g.addEventListener("load",(function(t){var n=this.response;bl.add(e,n);var i=Al[e];if(delete Al[e],200===this.status){for(var o=0,s=i.length;o<s;o++){var a=i[o];a.onLoad&&a.onLoad(n)}r.manager.itemEnd(e)}else if(0===this.status){console.warn("THREE.FileLoader: HTTP Status 0 received.");for(o=0,s=i.length;o<s;o++){a=i[o];a.onLoad&&a.onLoad(n)}r.manager.itemEnd(e)}else{for(o=0,s=i.length;o<s;o++){a=i[o];a.onError&&a.onError(t)}r.manager.itemEnd(e),r.manager.itemError(e)}}),!1),g.addEventListener("progress",(function(t){for(var n=Al[e],i=0,r=n.length;i<r;i++){var o=n[i];o.onProgress&&o.onProgress(t)}}),!1),g.addEventListener("error",(function(t){var n=Al[e];delete Al[e];for(var i=0,o=n.length;i<o;i++){var s=n[i];s.onError&&s.onError(t)}r.manager.itemEnd(e),r.manager.itemError(e)}),!1),void 0!==this.responseType&&(g.responseType=this.responseType),void 0!==this.withCredentials&&(g.withCredentials=this.withCredentials),g.overrideMimeType&&g.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)g.setRequestHeader(v,this.requestHeader[v]);g.send(null)}return r.manager.itemStart(e),g}Al[e].push({onLoad:t,onProgress:n,onError:i})},setPath:function(e){return this.path=e,this},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}}),Object.assign(El.prototype,{load:function(e,t,n,i){var r=this,o=[],s=new $s;s.image=o;var a=new Sl(this.manager);function l(l){a.load(e[l],(function(e){var n=r._parser(e,!0);o[l]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},u+=1,6===u&&(1===n.mipmapCount&&(s.minFilter=xe),s.format=n.format,s.needsUpdate=!0,t&&t(s))}),n,i)}if(a.setPath(this.path),a.setResponseType("arraybuffer"),Array.isArray(e))for(var u=0,c=0,h=e.length;c<h;++c)l(c);else a.load(e,(function(e){var n=r._parser(e,!0);if(n.isCubemap)for(var i=n.mipmaps.length/n.mipmapCount,a=0;a<i;a++){o[a]={mipmaps:[]};for(var l=0;l<n.mipmapCount;l++)o[a].mipmaps.push(n.mipmaps[a*n.mipmapCount+l]),o[a].format=n.format,o[a].width=n.width,o[a].height=n.height}else s.image.width=n.width,s.image.height=n.height,s.mipmaps=n.mipmaps;1===n.mipmapCount&&(s.minFilter=xe),s.format=n.format,s.needsUpdate=!0,t&&t(s)}),n,i);return s},setPath:function(e){return this.path=e,this}}),Object.assign(Ml.prototype,{load:function(e,t,n,i){var r=this,o=new Bt,s=new Sl(this.manager);return s.setResponseType("arraybuffer"),s.load(e,(function(e){var n=r._parser(e);n&&(void 0!==n.image?o.image=n.image:void 0!==n.data&&(o.image.width=n.width,o.image.height=n.height,o.image.data=n.data),o.wrapS=void 0!==n.wrapS?n.wrapS:fe,o.wrapT=void 0!==n.wrapT?n.wrapT:fe,o.magFilter=void 0!==n.magFilter?n.magFilter:xe,o.minFilter=void 0!==n.minFilter?n.minFilter:we,o.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.format&&(o.format=n.format),void 0!==n.type&&(o.type=n.type),void 0!==n.mipmaps&&(o.mipmaps=n.mipmaps),1===n.mipmapCount&&(o.minFilter=xe),o.needsUpdate=!0,t&&t(o,n))}),n,i),o}}),Object.assign(Tl.prototype,{crossOrigin:"Anonymous",load:function(e,t,n,i){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var r=this,o=bl.get(e);if(void 0!==o)return r.manager.itemStart(e),setTimeout((function(){t&&t(o),r.manager.itemEnd(e)}),0),o;var s=document.createElementNS("http://www.w3.org/1999/xhtml","img");return s.addEventListener("load",(function(){bl.add(e,this),t&&t(this),r.manager.itemEnd(e)}),!1),s.addEventListener("error",(function(t){i&&i(t),r.manager.itemEnd(e),r.manager.itemError(e)}),!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(s.crossOrigin=this.crossOrigin),r.manager.itemStart(e),s.src=e,s},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(Cl.prototype,{crossOrigin:"Anonymous",load:function(e,t,n,i){var r=new Kr,o=new Tl(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);var s=0;function a(n){o.load(e[n],(function(e){r.images[n]=e,s++,6===s&&(r.needsUpdate=!0,t&&t(r))}),void 0,i)}for(var l=0;l<e.length;++l)a(l);return r},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(Pl.prototype,{crossOrigin:"Anonymous",load:function(e,t,n,i){var r=new Ut,o=new Tl(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,(function(n){r.image=n;var i=e.search(/\.(jpg|jpeg)$/)>0||0===e.search(/^data\:image\/jpeg/);r.format=i?Ne:ke,r.needsUpdate=!0,void 0!==t&&t(r)}),n,i),r},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(Rl.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,t){var n=this.getUtoTmapping(e);return this.getPoint(n,t)},getPoints:function(e){void 0===e&&(e=5);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return t},getSpacedPoints:function(e){void 0===e&&(e=5);for(var t=[],n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,n,i=[],r=this.getPoint(0),o=0;for(i.push(0),n=1;n<=e;n++)t=this.getPoint(n/e),o+=t.distanceTo(r),i.push(o),r=t;return this.cacheArcLengths=i,i},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){var n,i=this.getLengths(),r=0,o=i.length;n=t||e*i[o-1];var s,a=0,l=o-1;while(a<=l)if(r=Math.floor(a+(l-a)/2),s=i[r]-n,s<0)a=r+1;else{if(!(s>0)){l=r;break}l=r-1}if(r=l,i[r]===n)return r/(o-1);var u=i[r],c=i[r+1],h=c-u,d=(n-u)/h,p=(r+d)/(o-1);return p},getTangent:function(e){var t=1e-4,n=e-t,i=e+t;n<0&&(n=0),i>1&&(i=1);var r=this.getPoint(n),o=this.getPoint(i),s=o.clone().sub(r);return s.normalize()},getTangentAt:function(e){var t=this.getUtoTmapping(e);return this.getTangent(t)},computeFrenetFrames:function(e,t){var n,i,r,o=new Nt,s=[],a=[],l=[],u=new Nt,c=new Dt;for(n=0;n<=e;n++)i=n/e,s[n]=this.getTangentAt(i),s[n].normalize();a[0]=new Nt,l[0]=new Nt;var h=Number.MAX_VALUE,d=Math.abs(s[0].x),p=Math.abs(s[0].y),f=Math.abs(s[0].z);for(d<=h&&(h=d,o.set(1,0,0)),p<=h&&(h=p,o.set(0,1,0)),f<=h&&o.set(0,0,1),u.crossVectors(s[0],o).normalize(),a[0].crossVectors(s[0],u),l[0].crossVectors(s[0],a[0]),n=1;n<=e;n++)a[n]=a[n-1].clone(),l[n]=l[n-1].clone(),u.crossVectors(s[n-1],s[n]),u.length()>Number.EPSILON&&(u.normalize(),r=Math.acos(Lt.clamp(s[n-1].dot(s[n]),-1,1)),a[n].applyMatrix4(c.makeRotationAxis(u,r))),l[n].crossVectors(s[n],a[n]);if(!0===t)for(r=Math.acos(Lt.clamp(a[0].dot(a[e]),-1,1)),r/=e,s[0].dot(u.crossVectors(a[0],a[e]))>0&&(r=-r),n=1;n<=e;n++)a[n].applyMatrix4(c.makeRotationAxis(s[n],r*n)),l[n].crossVectors(s[n],a[n]);return{tangents:s,normals:a,binormals:l}},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}),Ll.prototype=Object.create(Rl.prototype),Ll.prototype.constructor=Ll,Ll.prototype.isEllipseCurve=!0,Ll.prototype.getPoint=function(e,t){var n=t||new Ot,i=2*Math.PI,r=this.aEndAngle-this.aStartAngle,o=Math.abs(r)<Number.EPSILON;while(r<0)r+=i;while(r>i)r-=i;r<Number.EPSILON&&(r=o?0:i),!0!==this.aClockwise||o||(r===i?r=-i:r-=i);var s=this.aStartAngle+e*r,a=this.aX+this.xRadius*Math.cos(s),l=this.aY+this.yRadius*Math.sin(s);if(0!==this.aRotation){var u=Math.cos(this.aRotation),c=Math.sin(this.aRotation),h=a-this.aX,d=l-this.aY;a=h*u-d*c+this.aX,l=h*c+d*u+this.aY}return n.set(a,l)},Ll.prototype.copy=function(e){return Rl.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},Ll.prototype.toJSON=function(){var e=Rl.prototype.toJSON.call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e},Ll.prototype.fromJSON=function(e){return Rl.prototype.fromJSON.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},Ol.prototype=Object.create(Ll.prototype),Ol.prototype.constructor=Ol,Ol.prototype.isArcCurve=!0;var Il=new Nt,Nl=new Dl,kl=new Dl,Vl=new Dl;function Ul(e,t,n,i){Rl.call(this),this.type="CatmullRomCurve3",this.points=e||[],this.closed=t||!1,this.curveType=n||"centripetal",this.tension=i||.5}function Fl(e,t,n,i,r){var o=.5*(i-t),s=.5*(r-n),a=e*e,l=e*a;return(2*n-2*i+o+s)*l+(-3*n+3*i-2*o-s)*a+o*e+n}function zl(e,t){var n=1-e;return n*n*t}function jl(e,t){return 2*(1-e)*e*t}function Bl(e,t){return e*e*t}function $l(e,t,n,i){return zl(e,t)+jl(e,n)+Bl(e,i)}function Hl(e,t){var n=1-e;return n*n*n*t}function Gl(e,t){var n=1-e;return 3*n*n*e*t}function Wl(e,t){return 3*(1-e)*e*e*t}function ql(e,t){return e*e*e*t}function Yl(e,t,n,i,r){return Hl(e,t)+Gl(e,n)+Wl(e,i)+ql(e,r)}function Xl(e,t,n,i){Rl.call(this),this.type="CubicBezierCurve",this.v0=e||new Ot,this.v1=t||new Ot,this.v2=n||new Ot,this.v3=i||new Ot}function Zl(e,t,n,i){Rl.call(this),this.type="CubicBezierCurve3",this.v0=e||new Nt,this.v1=t||new Nt,this.v2=n||new Nt,this.v3=i||new Nt}function Jl(e,t){Rl.call(this),this.type="LineCurve",this.v1=e||new Ot,this.v2=t||new Ot}function Kl(e,t){Rl.call(this),this.type="LineCurve3",this.v1=e||new Nt,this.v2=t||new Nt}function Ql(e,t,n){Rl.call(this),this.type="QuadraticBezierCurve",this.v0=e||new Ot,this.v1=t||new Ot,this.v2=n||new Ot}function eu(e,t,n){Rl.call(this),this.type="QuadraticBezierCurve3",this.v0=e||new Nt,this.v1=t||new Nt,this.v2=n||new Nt}function tu(e){Rl.call(this),this.type="SplineCurve",this.points=e||[]}Ul.prototype=Object.create(Rl.prototype),Ul.prototype.constructor=Ul,Ul.prototype.isCatmullRomCurve3=!0,Ul.prototype.getPoint=function(e,t){var n,i,r,o,s=t||new Nt,a=this.points,l=a.length,u=(l-(this.closed?0:1))*e,c=Math.floor(u),h=u-c;if(this.closed?c+=c>0?0:(Math.floor(Math.abs(c)/l)+1)*l:0===h&&c===l-1&&(c=l-2,h=1),this.closed||c>0?n=a[(c-1)%l]:(Il.subVectors(a[0],a[1]).add(a[0]),n=Il),i=a[c%l],r=a[(c+1)%l],this.closed||c+2<l?o=a[(c+2)%l]:(Il.subVectors(a[l-1],a[l-2]).add(a[l-1]),o=Il),"centripetal"===this.curveType||"chordal"===this.curveType){var d="chordal"===this.curveType?.5:.25,p=Math.pow(n.distanceToSquared(i),d),f=Math.pow(i.distanceToSquared(r),d),m=Math.pow(r.distanceToSquared(o),d);f<1e-4&&(f=1),p<1e-4&&(p=f),m<1e-4&&(m=f),Nl.initNonuniformCatmullRom(n.x,i.x,r.x,o.x,p,f,m),kl.initNonuniformCatmullRom(n.y,i.y,r.y,o.y,p,f,m),Vl.initNonuniformCatmullRom(n.z,i.z,r.z,o.z,p,f,m)}else"catmullrom"===this.curveType&&(Nl.initCatmullRom(n.x,i.x,r.x,o.x,this.tension),kl.initCatmullRom(n.y,i.y,r.y,o.y,this.tension),Vl.initCatmullRom(n.z,i.z,r.z,o.z,this.tension));return s.set(Nl.calc(h),kl.calc(h),Vl.calc(h)),s},Ul.prototype.copy=function(e){Rl.prototype.copy.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},Ul.prototype.toJSON=function(){var e=Rl.prototype.toJSON.call(this);e.points=[];for(var t=0,n=this.points.length;t<n;t++){var i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e},Ul.prototype.fromJSON=function(e){Rl.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var i=e.points[t];this.points.push((new Nt).fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},Xl.prototype=Object.create(Rl.prototype),Xl.prototype.constructor=Xl,Xl.prototype.isCubicBezierCurve=!0,Xl.prototype.getPoint=function(e,t){var n=t||new Ot,i=this.v0,r=this.v1,o=this.v2,s=this.v3;return n.set(Yl(e,i.x,r.x,o.x,s.x),Yl(e,i.y,r.y,o.y,s.y)),n},Xl.prototype.copy=function(e){return Rl.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},Xl.prototype.toJSON=function(){var e=Rl.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},Xl.prototype.fromJSON=function(e){return Rl.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},Zl.prototype=Object.create(Rl.prototype),Zl.prototype.constructor=Zl,Zl.prototype.isCubicBezierCurve3=!0,Zl.prototype.getPoint=function(e,t){var n=t||new Nt,i=this.v0,r=this.v1,o=this.v2,s=this.v3;return n.set(Yl(e,i.x,r.x,o.x,s.x),Yl(e,i.y,r.y,o.y,s.y),Yl(e,i.z,r.z,o.z,s.z)),n},Zl.prototype.copy=function(e){return Rl.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},Zl.prototype.toJSON=function(){var e=Rl.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},Zl.prototype.fromJSON=function(e){return Rl.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},Jl.prototype=Object.create(Rl.prototype),Jl.prototype.constructor=Jl,Jl.prototype.isLineCurve=!0,Jl.prototype.getPoint=function(e,t){var n=t||new Ot;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n},Jl.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},Jl.prototype.getTangent=function(){var e=this.v2.clone().sub(this.v1);return e.normalize()},Jl.prototype.copy=function(e){return Rl.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Jl.prototype.toJSON=function(){var e=Rl.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Jl.prototype.fromJSON=function(e){return Rl.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Kl.prototype=Object.create(Rl.prototype),Kl.prototype.constructor=Kl,Kl.prototype.isLineCurve3=!0,Kl.prototype.getPoint=function(e,t){var n=t||new Nt;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n},Kl.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},Kl.prototype.copy=function(e){return Rl.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Kl.prototype.toJSON=function(){var e=Rl.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Kl.prototype.fromJSON=function(e){return Rl.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Ql.prototype=Object.create(Rl.prototype),Ql.prototype.constructor=Ql,Ql.prototype.isQuadraticBezierCurve=!0,Ql.prototype.getPoint=function(e,t){var n=t||new Ot,i=this.v0,r=this.v1,o=this.v2;return n.set($l(e,i.x,r.x,o.x),$l(e,i.y,r.y,o.y)),n},Ql.prototype.copy=function(e){return Rl.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Ql.prototype.toJSON=function(){var e=Rl.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Ql.prototype.fromJSON=function(e){return Rl.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},eu.prototype=Object.create(Rl.prototype),eu.prototype.constructor=eu,eu.prototype.isQuadraticBezierCurve3=!0,eu.prototype.getPoint=function(e,t){var n=t||new Nt,i=this.v0,r=this.v1,o=this.v2;return n.set($l(e,i.x,r.x,o.x),$l(e,i.y,r.y,o.y),$l(e,i.z,r.z,o.z)),n},eu.prototype.copy=function(e){return Rl.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},eu.prototype.toJSON=function(){var e=Rl.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},eu.prototype.fromJSON=function(e){return Rl.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},tu.prototype=Object.create(Rl.prototype),tu.prototype.constructor=tu,tu.prototype.isSplineCurve=!0,tu.prototype.getPoint=function(e,t){var n=t||new Ot,i=this.points,r=(i.length-1)*e,o=Math.floor(r),s=r-o,a=i[0===o?o:o-1],l=i[o],u=i[o>i.length-2?i.length-1:o+1],c=i[o>i.length-3?i.length-1:o+2];return n.set(Fl(s,a.x,l.x,u.x,c.x),Fl(s,a.y,l.y,u.y,c.y)),n},tu.prototype.copy=function(e){Rl.prototype.copy.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var i=e.points[t];this.points.push(i.clone())}return this},tu.prototype.toJSON=function(){var e=Rl.prototype.toJSON.call(this);e.points=[];for(var t=0,n=this.points.length;t<n;t++){var i=this.points[t];e.points.push(i.toArray())}return e},tu.prototype.fromJSON=function(e){Rl.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var i=e.points[t];this.points.push((new Ot).fromArray(i))}return this};var nu=Object.freeze({ArcCurve:Ol,CatmullRomCurve3:Ul,CubicBezierCurve:Xl,CubicBezierCurve3:Zl,EllipseCurve:Ll,LineCurve:Jl,LineCurve3:Kl,QuadraticBezierCurve:Ql,QuadraticBezierCurve3:eu,SplineCurve:tu});function iu(){Rl.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function ru(e){iu.call(this),this.type="Path",this.currentPoint=new Ot,e&&this.setFromPoints(e)}function ou(e){ru.call(this,e),this.uuid=Lt.generateUUID(),this.type="Shape",this.holes=[]}function su(e,t){ur.call(this),this.type="Light",this.color=new nr(e),this.intensity=void 0!==t?t:1,this.receiveShadow=void 0}function au(e,t,n){su.call(this,e,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(ur.DefaultUp),this.updateMatrix(),this.groundColor=new nr(t)}function lu(e){this.camera=e,this.bias=0,this.radius=1,this.mapSize=new Ot(512,512),this.map=null,this.matrix=new Dt}function uu(){lu.call(this,new _s(50,1,.5,500))}function cu(e,t,n,i,r,o){su.call(this,e,t),this.type="SpotLight",this.position.copy(ur.DefaultUp),this.updateMatrix(),this.target=new ur,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==i?i:Math.PI/3,this.penumbra=void 0!==r?r:0,this.decay=void 0!==o?o:1,this.shadow=new uu}function hu(e,t,n,i){su.call(this,e,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==i?i:1,this.shadow=new lu(new _s(90,1,.5,500))}function du(){lu.call(this,new hr(-5,5,5,-5,.5,500))}function pu(e,t){su.call(this,e,t),this.type="DirectionalLight",this.position.copy(ur.DefaultUp),this.updateMatrix(),this.target=new ur,this.shadow=new du}function fu(e,t){su.call(this,e,t),this.type="AmbientLight",this.castShadow=void 0}function mu(e,t,n,i){su.call(this,e,t),this.type="RectAreaLight",this.width=void 0!==n?n:10,this.height=void 0!==i?i:10}function gu(e,t,n,i){Tu.call(this,e,t,n,i)}function vu(e,t,n){Tu.call(this,e,t,n)}function yu(e,t,n,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new t.constructor(n),this.sampleValues=t,this.valueSize=n}function xu(e,t,n,i){yu.call(this,e,t,n,i)}function bu(e,t,n,i){Tu.call(this,e,t,n,i)}function wu(e,t,n,i){Tu.call(this,e,t,n,i)}function _u(e,t,n,i){Tu.call(this,e,t,n,i)}function Au(e,t,n,i){yu.call(this,e,t,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function Su(e,t,n,i){yu.call(this,e,t,n,i)}function Eu(e,t,n,i){yu.call(this,e,t,n,i)}iu.prototype=Object.assign(Object.create(Rl.prototype),{constructor:iu,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Jl(t,e))},getPoint:function(e){var t=e*this.getLength(),n=this.getCurveLengths(),i=0;while(i<n.length){if(n[i]>=t){var r=n[i]-t,o=this.curves[i],s=o.getLength(),a=0===s?0:1-r/s;return o.getPointAt(a)}i++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,n=0,i=this.curves.length;n<i;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e},getSpacedPoints:function(e){void 0===e&&(e=40);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t},getPoints:function(e){e=e||12;for(var t,n=[],i=0,r=this.curves;i<r.length;i++)for(var o=r[i],s=o&&o.isEllipseCurve?2*e:o&&o.isLineCurve?1:o&&o.isSplineCurve?e*o.points.length:e,a=o.getPoints(s),l=0;l<a.length;l++){var u=a[l];t&&t.equals(u)||(n.push(u),t=u)}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},copy:function(e){Rl.prototype.copy.call(this,e),this.curves=[];for(var t=0,n=e.curves.length;t<n;t++){var i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this},toJSON:function(){var e=Rl.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(var t=0,n=this.curves.length;t<n;t++){var i=this.curves[t];e.curves.push(i.toJSON())}return e},fromJSON:function(e){Rl.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var t=0,n=e.curves.length;t<n;t++){var i=e.curves[t];this.curves.push((new nu[i.type]).fromJSON(i))}return this}}),ru.prototype=Object.assign(Object.create(iu.prototype),{constructor:ru,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y)},moveTo:function(e,t){this.currentPoint.set(e,t)},lineTo:function(e,t){var n=new Jl(this.currentPoint.clone(),new Ot(e,t));this.curves.push(n),this.currentPoint.set(e,t)},quadraticCurveTo:function(e,t,n,i){var r=new Ql(this.currentPoint.clone(),new Ot(e,t),new Ot(n,i));this.curves.push(r),this.currentPoint.set(n,i)},bezierCurveTo:function(e,t,n,i,r,o){var s=new Xl(this.currentPoint.clone(),new Ot(e,t),new Ot(n,i),new Ot(r,o));this.curves.push(s),this.currentPoint.set(r,o)},splineThru:function(e){var t=[this.currentPoint.clone()].concat(e),n=new tu(t);this.curves.push(n),this.currentPoint.copy(e[e.length-1])},arc:function(e,t,n,i,r,o){var s=this.currentPoint.x,a=this.currentPoint.y;this.absarc(e+s,t+a,n,i,r,o)},absarc:function(e,t,n,i,r,o){this.absellipse(e,t,n,n,i,r,o)},ellipse:function(e,t,n,i,r,o,s,a){var l=this.currentPoint.x,u=this.currentPoint.y;this.absellipse(e+l,t+u,n,i,r,o,s,a)},absellipse:function(e,t,n,i,r,o,s,a){var l=new Ll(e,t,n,i,r,o,s,a);if(this.curves.length>0){var u=l.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(l);var c=l.getPoint(1);this.currentPoint.copy(c)},copy:function(e){return iu.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},toJSON:function(){var e=iu.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},fromJSON:function(e){return iu.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}),ou.prototype=Object.assign(Object.create(ru.prototype),{constructor:ou,getPointsHoles:function(e){for(var t=[],n=0,i=this.holes.length;n<i;n++)t[n]=this.holes[n].getPoints(e);return t},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){ru.prototype.copy.call(this,e),this.holes=[];for(var t=0,n=e.holes.length;t<n;t++){var i=e.holes[t];this.holes.push(i.clone())}return this},toJSON:function(){var e=ru.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(var t=0,n=this.holes.length;t<n;t++){var i=this.holes[t];e.holes.push(i.toJSON())}return e},fromJSON:function(e){ru.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(var t=0,n=e.holes.length;t<n;t++){var i=e.holes[t];this.holes.push((new ru).fromJSON(i))}return this}}),su.prototype=Object.assign(Object.create(ur.prototype),{constructor:su,isLight:!0,copy:function(e){return ur.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){var t=ur.prototype.toJSON.call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}),au.prototype=Object.assign(Object.create(su.prototype),{constructor:au,isHemisphereLight:!0,copy:function(e){return su.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}),Object.assign(lu.prototype,{copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),uu.prototype=Object.assign(Object.create(lu.prototype),{constructor:uu,isSpotLightShadow:!0,update:function(e){var t=this.camera,n=2*Lt.RAD2DEG*e.angle,i=this.mapSize.width/this.mapSize.height,r=e.distance||t.far;n===t.fov&&i===t.aspect&&r===t.far||(t.fov=n,t.aspect=i,t.far=r,t.updateProjectionMatrix())}}),cu.prototype=Object.assign(Object.create(su.prototype),{constructor:cu,isSpotLight:!0,copy:function(e){return su.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),hu.prototype=Object.assign(Object.create(su.prototype),{constructor:hu,isPointLight:!0,copy:function(e){return su.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),du.prototype=Object.assign(Object.create(lu.prototype),{constructor:du}),pu.prototype=Object.assign(Object.create(su.prototype),{constructor:pu,isDirectionalLight:!0,copy:function(e){return su.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),fu.prototype=Object.assign(Object.create(su.prototype),{constructor:fu,isAmbientLight:!0}),mu.prototype=Object.assign(Object.create(su.prototype),{constructor:mu,isRectAreaLight:!0,copy:function(e){return su.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){var t=su.prototype.toJSON.call(this,e);return t.object.width=this.width,t.object.height=this.height,t}}),gu.prototype=Object.assign(Object.create(Tu.prototype),{constructor:gu,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:pt,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),vu.prototype=Object.assign(Object.create(Tu.prototype),{constructor:vu,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:pt,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Object.assign(yu.prototype,{evaluate:function(e){var t=this.parameterPositions,n=this._cachedIndex,i=t[n],r=t[n-1];e:{t:{var o;n:{i:if(!(e<i)){for(var s=n+2;;){if(void 0===i){if(e<r)break i;return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,e,r)}if(n===s)break;if(r=i,i=t[++n],e<i)break t}o=t.length;break n}if(e>=r)break e;var a=t[1];e<a&&(n=2,r=a);for(s=n-2;;){if(void 0===r)return this._cachedIndex=0,this.beforeStart_(0,e,i);if(n===s)break;if(i=r,r=t[--n-1],e>=r)break t}o=n,n=0}while(n<o){var l=n+o>>>1;e<t[l]?o=l:n=l+1}if(i=t[n],r=t[n-1],void 0===r)return this._cachedIndex=0,this.beforeStart_(0,e,i);if(void 0===i)return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,r,e)}this._cachedIndex=n,this.intervalChanged_(n,r,i)}return this.interpolate_(n,r,e,i)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=e*i,o=0;o!==i;++o)t[o]=n[r+o];return t},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),
//!\ DECLARE ALIAS AFTER assign prototype !
Object.assign(yu.prototype,{beforeStart_:yu.prototype.copySampleValue_,afterEnd_:yu.prototype.copySampleValue_}),xu.prototype=Object.assign(Object.create(yu.prototype),{constructor:xu,interpolate_:function(e,t,n,i){for(var r=this.resultBuffer,o=this.sampleValues,s=this.valueSize,a=e*s,l=(n-t)/(i-t),u=a+s;a!==u;a+=4)It.slerpFlat(r,0,o,a-s,o,a,l);return r}}),bu.prototype=Object.assign(Object.create(Tu.prototype),{constructor:bu,ValueTypeName:"quaternion",DefaultInterpolation:ft,InterpolantFactoryMethodLinear:function(e){return new xu(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),wu.prototype=Object.assign(Object.create(Tu.prototype),{constructor:wu,ValueTypeName:"color"}),_u.prototype=Object.assign(Object.create(Tu.prototype),{constructor:_u,ValueTypeName:"number"}),Au.prototype=Object.assign(Object.create(yu.prototype),{constructor:Au,DefaultSettings_:{endingStart:gt,endingEnd:gt},intervalChanged_:function(e,t,n){var i=this.parameterPositions,r=e-2,o=e+1,s=i[r],a=i[o];if(void 0===s)switch(this.getSettings_().endingStart){case vt:r=e,s=2*t-n;break;case yt:r=i.length-2,s=t+i[r]-i[r+1];break;default:r=e,s=n}if(void 0===a)switch(this.getSettings_().endingEnd){case vt:o=e,a=2*n-t;break;case yt:o=1,a=n+i[1]-i[0];break;default:o=e-1,a=t}var l=.5*(n-t),u=this.valueSize;this._weightPrev=l/(t-s),this._weightNext=l/(a-n),this._offsetPrev=r*u,this._offsetNext=o*u},interpolate_:function(e,t,n,i){for(var r=this.resultBuffer,o=this.sampleValues,s=this.valueSize,a=e*s,l=a-s,u=this._offsetPrev,c=this._offsetNext,h=this._weightPrev,d=this._weightNext,p=(n-t)/(i-t),f=p*p,m=f*p,g=-h*m+2*h*f-h*p,v=(1+h)*m+(-1.5-2*h)*f+(-.5+h)*p+1,y=(-1-d)*m+(1.5+d)*f+.5*p,x=d*m-d*f,b=0;b!==s;++b)r[b]=g*o[u+b]+v*o[l+b]+y*o[a+b]+x*o[c+b];return r}}),Su.prototype=Object.assign(Object.create(yu.prototype),{constructor:Su,interpolate_:function(e,t,n,i){for(var r=this.resultBuffer,o=this.sampleValues,s=this.valueSize,a=e*s,l=a-s,u=(n-t)/(i-t),c=1-u,h=0;h!==s;++h)r[h]=o[l+h]*c+o[a+h]*u;return r}}),Eu.prototype=Object.assign(Object.create(yu.prototype),{constructor:Eu,interpolate_:function(e){return this.copySampleValue_(e-1)}});var Mu={arraySlice:function(e,t,n){return Mu.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==n?n:e.length)):e.slice(t,n)},convertArray:function(e,t,n){return!e||!n&&e.constructor===t?e:"number"===typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){function t(t,n){return e[t]-e[n]}for(var n=e.length,i=new Array(n),r=0;r!==n;++r)i[r]=r;return i.sort(t),i},sortedArray:function(e,t,n){for(var i=e.length,r=new e.constructor(i),o=0,s=0;s!==i;++o)for(var a=n[o]*t,l=0;l!==t;++l)r[s++]=e[a+l];return r},flattenJSON:function(e,t,n,i){var r=1,o=e[0];while(void 0!==o&&void 0===o[i])o=e[r++];if(void 0!==o){var s=o[i];if(void 0!==s)if(Array.isArray(s))do{s=o[i],void 0!==s&&(t.push(o.time),n.push.apply(n,s)),o=e[r++]}while(void 0!==o);else if(void 0!==s.toArray)do{s=o[i],void 0!==s&&(t.push(o.time),s.toArray(n,n.length)),o=e[r++]}while(void 0!==o);else do{s=o[i],void 0!==s&&(t.push(o.time),n.push(s)),o=e[r++]}while(void 0!==o)}}};function Tu(e,t,n,i){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Mu.convertArray(t,this.TimeBufferType),this.values=Mu.convertArray(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation),this.validate(),this.optimize()}function Cu(e,t,n,i){Tu.call(this,e,t,n,i)}function Pu(e,t,n){this.name=e,this.tracks=n,this.duration=void 0!==t?t:-1,this.uuid=Lt.generateUUID(),this.duration<0&&this.resetDuration(),this.optimize()}function Ru(e){this.manager=void 0!==e?e:_l,this.textures={}}function Lu(e){this.manager=void 0!==e?e:_l}Object.assign(Tu,{parse:function(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var t=Tu._getTrackTypeForValueTypeName(e.type);if(void 0===e.times){var n=[],i=[];Mu.flattenJSON(e.keys,n,i,"value"),e.times=n,e.values=i}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)},toJSON:function(e){var t,n=e.constructor;if(void 0!==n.toJSON)t=n.toJSON(e);else{t={name:e.name,times:Mu.convertArray(e.times,Array),values:Mu.convertArray(e.values,Array)};var i=e.getInterpolation();i!==e.DefaultInterpolation&&(t.interpolation=i)}return t.type=e.ValueTypeName,t},_getTrackTypeForValueTypeName:function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return _u;case"vector":case"vector2":case"vector3":case"vector4":return Cu;case"color":return wu;case"quaternion":return bu;case"bool":case"boolean":return vu;case"string":return gu}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}}),Object.assign(Tu.prototype,{constructor:Tu,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:ft,InterpolantFactoryMethodDiscrete:function(e){return new Eu(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new Su(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new Au(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var t;switch(e){case pt:t=this.InterpolantFactoryMethodDiscrete;break;case ft:t=this.InterpolantFactoryMethodLinear;break;case mt:t=this.InterpolantFactoryMethodSmooth;break}if(void 0!==t)this.createInterpolant=t;else{var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}console.warn("THREE.KeyframeTrack:",n)}},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return pt;case this.InterpolantFactoryMethodLinear:return ft;case this.InterpolantFactoryMethodSmooth:return mt}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(0!==e)for(var t=this.times,n=0,i=t.length;n!==i;++n)t[n]+=e;return this},scale:function(e){if(1!==e)for(var t=this.times,n=0,i=t.length;n!==i;++n)t[n]*=e;return this},trim:function(e,t){var n=this.times,i=n.length,r=0,o=i-1;while(r!==i&&n[r]<e)++r;while(-1!==o&&n[o]>t)--o;if(++o,0!==r||o!==i){r>=o&&(o=Math.max(o,1),r=o-1);var s=this.getValueSize();this.times=Mu.arraySlice(n,r,o),this.values=Mu.arraySlice(this.values,r*s,o*s)}return this},validate:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var n=this.times,i=this.values,r=n.length;0===r&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var o=null,s=0;s!==r;s++){var a=n[s];if("number"===typeof a&&isNaN(a)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,s,a),e=!1;break}if(null!==o&&o>a){console.error("THREE.KeyframeTrack: Out of order keys.",this,s,a,o),e=!1;break}o=a}if(void 0!==i&&Mu.isTypedArray(i)){s=0;for(var l=i.length;s!==l;++s){var u=i[s];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,s,u),e=!1;break}}}return e},optimize:function(){for(var e=this.times,t=this.values,n=this.getValueSize(),i=this.getInterpolation()===mt,r=1,o=e.length-1,s=1;s<o;++s){var a=!1,l=e[s],u=e[s+1];if(l!==u&&(1!==s||l!==l[0]))if(i)a=!0;else for(var c=s*n,h=c-n,d=c+n,p=0;p!==n;++p){var f=t[c+p];if(f!==t[h+p]||f!==t[d+p]){a=!0;break}}if(a){if(s!==r){e[r]=e[s];var m=s*n,g=r*n;for(p=0;p!==n;++p)t[g+p]=t[m+p]}++r}}if(o>0){e[r]=e[o];for(m=o*n,g=r*n,p=0;p!==n;++p)t[g+p]=t[m+p];++r}return r!==e.length&&(this.times=Mu.arraySlice(e,0,r),this.values=Mu.arraySlice(t,0,r*n)),this}}),Cu.prototype=Object.assign(Object.create(Tu.prototype),{constructor:Cu,ValueTypeName:"vector"}),Object.assign(Pu,{parse:function(e){for(var t=[],n=e.tracks,i=1/(e.fps||1),r=0,o=n.length;r!==o;++r)t.push(Tu.parse(n[r]).scale(i));return new Pu(e.name,e.duration,t)},toJSON:function(e){for(var t=[],n=e.tracks,i={name:e.name,duration:e.duration,tracks:t},r=0,o=n.length;r!==o;++r)t.push(Tu.toJSON(n[r]));return i},CreateFromMorphTargetSequence:function(e,t,n,i){for(var r=t.length,o=[],s=0;s<r;s++){var a=[],l=[];a.push((s+r-1)%r,s,(s+1)%r),l.push(0,1,0);var u=Mu.getKeyframeOrder(a);a=Mu.sortedArray(a,1,u),l=Mu.sortedArray(l,1,u),i||0!==a[0]||(a.push(r),l.push(l[0])),o.push(new _u(".morphTargetInfluences["+t[s].name+"]",a,l).scale(1/n))}return new Pu(e,-1,o)},findByName:function(e,t){var n=e;if(!Array.isArray(e)){var i=e;n=i.geometry&&i.geometry.animations||i.animations}for(var r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null},CreateClipsFromMorphTargetSequences:function(e,t,n){for(var i={},r=/^([\w-]*?)([\d]+)$/,o=0,s=e.length;o<s;o++){var a=e[o],l=a.name.match(r);if(l&&l.length>1){var u=l[1],c=i[u];c||(i[u]=c=[]),c.push(a)}}var h=[];for(var u in i)h.push(Pu.CreateFromMorphTargetSequence(u,i[u],t,n));return h},parseAnimation:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(e,t,n,i,r){if(0!==n.length){var o=[],s=[];Mu.flattenJSON(n,o,s,i),0!==o.length&&r.push(new e(t,o,s))}},i=[],r=e.name||"default",o=e.length||-1,s=e.fps||30,a=e.hierarchy||[],l=0;l<a.length;l++){var u=a[l].keys;if(u&&0!==u.length)if(u[0].morphTargets){for(var c={},h=0;h<u.length;h++)if(u[h].morphTargets)for(var d=0;d<u[h].morphTargets.length;d++)c[u[h].morphTargets[d]]=-1;for(var p in c){var f=[],m=[];for(d=0;d!==u[h].morphTargets.length;++d){var g=u[h];f.push(g.time),m.push(g.morphTarget===p?1:0)}i.push(new _u(".morphTargetInfluence["+p+"]",f,m))}o=c.length*(s||1)}else{var v=".bones["+t[l].name+"]";n(Cu,v+".position",u,"pos",i),n(bu,v+".quaternion",u,"rot",i),n(Cu,v+".scale",u,"scl",i)}}if(0===i.length)return null;var y=new Pu(r,o,i);return y}}),Object.assign(Pu.prototype,{resetDuration:function(){for(var e=this.tracks,t=0,n=0,i=e.length;n!==i;++n){var r=this.tracks[n];t=Math.max(t,r.times[r.times.length-1])}this.duration=t},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}}),Object.assign(Ru.prototype,{load:function(e,t,n,i){var r=this,o=new Sl(r.manager);o.load(e,(function(e){t(r.parse(JSON.parse(e)))}),n,i)},setTextures:function(e){this.textures=e},parse:function(e){var t=this.textures;function n(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}var i=new xl[e.type];if(void 0!==e.uuid&&(i.uuid=e.uuid),void 0!==e.name&&(i.name=e.name),void 0!==e.color&&i.color.setHex(e.color),void 0!==e.roughness&&(i.roughness=e.roughness),void 0!==e.metalness&&(i.metalness=e.metalness),void 0!==e.emissive&&i.emissive.setHex(e.emissive),void 0!==e.specular&&i.specular.setHex(e.specular),void 0!==e.shininess&&(i.shininess=e.shininess),void 0!==e.clearCoat&&(i.clearCoat=e.clearCoat),void 0!==e.clearCoatRoughness&&(i.clearCoatRoughness=e.clearCoatRoughness),void 0!==e.uniforms&&(i.uniforms=e.uniforms),void 0!==e.vertexShader&&(i.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(i.fragmentShader=e.fragmentShader),void 0!==e.vertexColors&&(i.vertexColors=e.vertexColors),void 0!==e.fog&&(i.fog=e.fog),void 0!==e.flatShading&&(i.flatShading=e.flatShading),void 0!==e.blending&&(i.blending=e.blending),void 0!==e.side&&(i.side=e.side),void 0!==e.opacity&&(i.opacity=e.opacity),void 0!==e.transparent&&(i.transparent=e.transparent),void 0!==e.alphaTest&&(i.alphaTest=e.alphaTest),void 0!==e.depthTest&&(i.depthTest=e.depthTest),void 0!==e.depthWrite&&(i.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(i.colorWrite=e.colorWrite),void 0!==e.wireframe&&(i.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(i.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(i.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(i.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(i.rotation=e.rotation),1!==e.linewidth&&(i.linewidth=e.linewidth),void 0!==e.dashSize&&(i.dashSize=e.dashSize),void 0!==e.gapSize&&(i.gapSize=e.gapSize),void 0!==e.scale&&(i.scale=e.scale),void 0!==e.polygonOffset&&(i.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(i.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(i.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.skinning&&(i.skinning=e.skinning),void 0!==e.morphTargets&&(i.morphTargets=e.morphTargets),void 0!==e.dithering&&(i.dithering=e.dithering),void 0!==e.visible&&(i.visible=e.visible),void 0!==e.userData&&(i.userData=e.userData),void 0!==e.shading&&(i.flatShading=1===e.shading),void 0!==e.size&&(i.size=e.size),void 0!==e.sizeAttenuation&&(i.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(i.map=n(e.map)),void 0!==e.alphaMap&&(i.alphaMap=n(e.alphaMap),i.transparent=!0),void 0!==e.bumpMap&&(i.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(i.bumpScale=e.bumpScale),void 0!==e.normalMap&&(i.normalMap=n(e.normalMap)),void 0!==e.normalScale){var r=e.normalScale;!1===Array.isArray(r)&&(r=[r,r]),i.normalScale=(new Ot).fromArray(r)}return void 0!==e.displacementMap&&(i.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(i.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(i.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(i.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(i.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(i.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(i.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(i.specularMap=n(e.specularMap)),void 0!==e.envMap&&(i.envMap=n(e.envMap)),void 0!==e.reflectivity&&(i.reflectivity=e.reflectivity),void 0!==e.lightMap&&(i.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(i.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(i.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(i.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(i.gradientMap=n(e.gradientMap)),i}}),Object.assign(Lu.prototype,{load:function(e,t,n,i){var r=this,o=new Sl(r.manager);o.load(e,(function(e){t(r.parse(JSON.parse(e)))}),n,i)},parse:function(e){var t=new Cr,n=e.data.index;if(void 0!==n){var i=new Ou[n.type](n.array);t.setIndex(new mr(i,1))}var r=e.data.attributes;for(var o in r){var s=r[o];i=new Ou[s.type](s.array);t.addAttribute(o,new mr(i,s.itemSize,s.normalized))}var a=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==a)for(var l=0,u=a.length;l!==u;++l){var c=a[l];t.addGroup(c.start,c.count,c.materialIndex)}var h=e.data.boundingSphere;if(void 0!==h){var d=new Nt;void 0!==h.center&&d.fromArray(h.center),t.boundingSphere=new Ht(d,h.radius)}return t}});var Ou={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!==typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function Du(){}Du.Handlers={handlers:[],add:function(e,t){this.handlers.push(e,t)},get:function(e){for(var t=this.handlers,n=0,i=t.length;n<i;n+=2){var r=t[n],o=t[n+1];if(r.test(e))return o}return null}},Object.assign(Du.prototype,{crossOrigin:void 0,onLoadStart:function(){},onLoadProgress:function(){},onLoadComplete:function(){},initMaterials:function(e,t,n){for(var i=[],r=0;r<e.length;++r)i[r]=this.createMaterial(e[r],t,n);return i},createMaterial:function(){var e={NoBlending:w,NormalBlending:_,AdditiveBlending:A,SubtractiveBlending:S,MultiplyBlending:E,CustomBlending:M},t=new nr,n=new Pl,i=new Ru;return function(r,o,s){var a={};function l(e,t,i,r,l){var u,c=o+e,h=Du.Handlers.get(c);null!==h?u=h.load(c):(n.setCrossOrigin(s),u=n.load(c)),void 0!==t&&(u.repeat.fromArray(t),1!==t[0]&&(u.wrapS=pe),1!==t[1]&&(u.wrapT=pe)),void 0!==i&&u.offset.fromArray(i),void 0!==r&&("repeat"===r[0]&&(u.wrapS=pe),"mirror"===r[0]&&(u.wrapS=me),"repeat"===r[1]&&(u.wrapT=pe),"mirror"===r[1]&&(u.wrapT=me)),void 0!==l&&(u.anisotropy=l);var d=Lt.generateUUID();return a[d]=u,d}var u={uuid:Lt.generateUUID(),type:"MeshLambertMaterial"};for(var c in r){var h=r[c];switch(c){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":u.name=h;break;case"blending":u.blending=e[h];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",c,"is no longer supported.");break;case"colorDiffuse":u.color=t.fromArray(h).getHex();break;case"colorSpecular":u.specular=t.fromArray(h).getHex();break;case"colorEmissive":u.emissive=t.fromArray(h).getHex();break;case"specularCoef":u.shininess=h;break;case"shading":"basic"===h.toLowerCase()&&(u.type="MeshBasicMaterial"),"phong"===h.toLowerCase()&&(u.type="MeshPhongMaterial"),"standard"===h.toLowerCase()&&(u.type="MeshStandardMaterial");break;case"mapDiffuse":u.map=l(h,r.mapDiffuseRepeat,r.mapDiffuseOffset,r.mapDiffuseWrap,r.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":u.emissiveMap=l(h,r.mapEmissiveRepeat,r.mapEmissiveOffset,r.mapEmissiveWrap,r.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":u.lightMap=l(h,r.mapLightRepeat,r.mapLightOffset,r.mapLightWrap,r.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":u.aoMap=l(h,r.mapAORepeat,r.mapAOOffset,r.mapAOWrap,r.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":u.bumpMap=l(h,r.mapBumpRepeat,r.mapBumpOffset,r.mapBumpWrap,r.mapBumpAnisotropy);break;case"mapBumpScale":u.bumpScale=h;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":u.normalMap=l(h,r.mapNormalRepeat,r.mapNormalOffset,r.mapNormalWrap,r.mapNormalAnisotropy);break;case"mapNormalFactor":u.normalScale=h;break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":u.specularMap=l(h,r.mapSpecularRepeat,r.mapSpecularOffset,r.mapSpecularWrap,r.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":u.metalnessMap=l(h,r.mapMetalnessRepeat,r.mapMetalnessOffset,r.mapMetalnessWrap,r.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":u.roughnessMap=l(h,r.mapRoughnessRepeat,r.mapRoughnessOffset,r.mapRoughnessWrap,r.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":u.alphaMap=l(h,r.mapAlphaRepeat,r.mapAlphaOffset,r.mapAlphaWrap,r.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":u.side=m;break;case"doubleSided":u.side=g;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),u.opacity=h;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":u[c]=h;break;case"vertexColors":!0===h&&(u.vertexColors=b),"face"===h&&(u.vertexColors=x);break;default:console.error("THREE.Loader.createMaterial: Unsupported",c,h);break}}return"MeshBasicMaterial"===u.type&&delete u.emissive,"MeshPhongMaterial"!==u.type&&delete u.specular,u.opacity<1&&(u.transparent=!0),i.setTextures(a),i.parse(u)}}()});var Iu={decodeText:function(e){if("undefined"!==typeof TextDecoder)return(new TextDecoder).decode(e);for(var t="",n=0,i=e.length;n<i;n++)t+=String.fromCharCode(e[n]);return decodeURIComponent(escape(t))},extractUrlBase:function(e){var t=e.lastIndexOf("/");return-1===t?"./":e.substr(0,t+1)}};function Nu(e){"boolean"===typeof e&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),e=void 0),this.manager=void 0!==e?e:_l,this.withCredentials=!1}function ku(e){this.manager=void 0!==e?e:_l,this.texturePath=""}Object.assign(Nu.prototype,{load:function(e,t,n,i){var r=this,o=this.texturePath&&"string"===typeof this.texturePath?this.texturePath:Iu.extractUrlBase(e),s=new Sl(this.manager);s.setWithCredentials(this.withCredentials),s.load(e,(function(n){var i=JSON.parse(n),s=i.metadata;if(void 0!==s){var a=s.type;if(void 0!==a&&"object"===a.toLowerCase())return void console.error("THREE.JSONLoader: "+e+" should be loaded with THREE.ObjectLoader instead.")}var l=r.parse(i,o);t(l.geometry,l.materials)}),n,i)},setTexturePath:function(e){this.texturePath=e},parse:function(){function e(e,t){function n(e,t){return e&1<<t}var i,r,o,s,a,l,u,c,h,d,p,f,m,g,v,y,x,b,w,_,A,S,E,M,T,C,P,R=e.faces,L=e.vertices,O=e.normals,D=e.colors,I=e.scale,N=0;if(void 0!==e.uvs){for(i=0;i<e.uvs.length;i++)e.uvs[i].length&&N++;for(i=0;i<N;i++)t.faceVertexUvs[i]=[]}s=0,a=L.length;while(s<a)b=new Nt,b.x=L[s++]*I,b.y=L[s++]*I,b.z=L[s++]*I,t.vertices.push(b);s=0,a=R.length;while(s<a)if(d=R[s++],p=n(d,0),f=n(d,1),m=n(d,3),g=n(d,4),v=n(d,5),y=n(d,6),x=n(d,7),p){if(_=new dr,_.a=R[s],_.b=R[s+1],_.c=R[s+3],A=new dr,A.a=R[s+1],A.b=R[s+2],A.c=R[s+3],s+=4,f&&(h=R[s++],_.materialIndex=h,A.materialIndex=h),o=t.faces.length,m)for(i=0;i<N;i++)for(M=e.uvs[i],t.faceVertexUvs[i][o]=[],t.faceVertexUvs[i][o+1]=[],r=0;r<4;r++)c=R[s++],C=M[2*c],P=M[2*c+1],T=new Ot(C,P),2!==r&&t.faceVertexUvs[i][o].push(T),0!==r&&t.faceVertexUvs[i][o+1].push(T);if(g&&(u=3*R[s++],_.normal.set(O[u++],O[u++],O[u]),A.normal.copy(_.normal)),v)for(i=0;i<4;i++)u=3*R[s++],E=new Nt(O[u++],O[u++],O[u]),2!==i&&_.vertexNormals.push(E),0!==i&&A.vertexNormals.push(E);if(y&&(l=R[s++],S=D[l],_.color.setHex(S),A.color.setHex(S)),x)for(i=0;i<4;i++)l=R[s++],S=D[l],2!==i&&_.vertexColors.push(new nr(S)),0!==i&&A.vertexColors.push(new nr(S));t.faces.push(_),t.faces.push(A)}else{if(w=new dr,w.a=R[s++],w.b=R[s++],w.c=R[s++],f&&(h=R[s++],w.materialIndex=h),o=t.faces.length,m)for(i=0;i<N;i++)for(M=e.uvs[i],t.faceVertexUvs[i][o]=[],r=0;r<3;r++)c=R[s++],C=M[2*c],P=M[2*c+1],T=new Ot(C,P),t.faceVertexUvs[i][o].push(T);if(g&&(u=3*R[s++],w.normal.set(O[u++],O[u++],O[u])),v)for(i=0;i<3;i++)u=3*R[s++],E=new Nt(O[u++],O[u++],O[u]),w.vertexNormals.push(E);if(y&&(l=R[s++],w.color.setHex(D[l])),x)for(i=0;i<3;i++)l=R[s++],w.vertexColors.push(new nr(D[l]));t.faces.push(w)}}function t(e,t){var n=void 0!==e.influencesPerVertex?e.influencesPerVertex:2;if(e.skinWeights)for(var i=0,r=e.skinWeights.length;i<r;i+=n){var o=e.skinWeights[i],s=n>1?e.skinWeights[i+1]:0,a=n>2?e.skinWeights[i+2]:0,l=n>3?e.skinWeights[i+3]:0;t.skinWeights.push(new Ft(o,s,a,l))}if(e.skinIndices)for(i=0,r=e.skinIndices.length;i<r;i+=n){var u=e.skinIndices[i],c=n>1?e.skinIndices[i+1]:0,h=n>2?e.skinIndices[i+2]:0,d=n>3?e.skinIndices[i+3]:0;t.skinIndices.push(new Ft(u,c,h,d))}t.bones=e.bones,t.bones&&t.bones.length>0&&(t.skinWeights.length!==t.skinIndices.length||t.skinIndices.length!==t.vertices.length)&&console.warn("When skinning, number of vertices ("+t.vertices.length+"), skinIndices ("+t.skinIndices.length+"), and skinWeights ("+t.skinWeights.length+") should match.")}function n(e,t){var n=e.scale;if(void 0!==e.morphTargets)for(var i=0,r=e.morphTargets.length;i<r;i++){t.morphTargets[i]={},t.morphTargets[i].name=e.morphTargets[i].name,t.morphTargets[i].vertices=[];for(var o=t.morphTargets[i].vertices,s=e.morphTargets[i].vertices,a=0,l=s.length;a<l;a+=3){var u=new Nt;u.x=s[a]*n,u.y=s[a+1]*n,u.z=s[a+2]*n,o.push(u)}}if(void 0!==e.morphColors&&e.morphColors.length>0){console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.');var c=t.faces,h=e.morphColors[0].colors;for(i=0,r=c.length;i<r;i++)c[i].color.fromArray(h,3*i)}}function i(e,t){var n=[],i=[];void 0!==e.animation&&i.push(e.animation),void 0!==e.animations&&(e.animations.length?i=i.concat(e.animations):i.push(e.animations));for(var r=0;r<i.length;r++){var o=Pu.parseAnimation(i[r],t.bones);o&&n.push(o)}if(t.morphTargets){var s=Pu.CreateClipsFromMorphTargetSequences(t.morphTargets,10);n=n.concat(s)}n.length>0&&(t.animations=n)}return function(r,o){void 0!==r.data&&(r=r.data),void 0!==r.scale?r.scale=1/r.scale:r.scale=1;var s=new fr;if(e(r,s),t(r,s),n(r,s),i(r,s),s.computeFaceNormals(),s.computeBoundingSphere(),void 0===r.materials||0===r.materials.length)return{geometry:s};var a=Du.prototype.initMaterials(r.materials,o,this.crossOrigin);return{geometry:s,materials:a}}}()}),Object.assign(ku.prototype,{load:function(e,t,n,i){""===this.texturePath&&(this.texturePath=e.substring(0,e.lastIndexOf("/")+1));var r=this,o=new Sl(r.manager);o.load(e,(function(n){var o=null;try{o=JSON.parse(n)}catch(a){return void 0!==i&&i(a),void console.error("THREE:ObjectLoader: Can't parse "+e+".",a.message)}var s=o.metadata;void 0!==s&&void 0!==s.type&&"geometry"!==s.type.toLowerCase()?r.parse(o,t):console.error("THREE.ObjectLoader: Can't load "+e+". Use THREE.JSONLoader instead.")}),n,i)},setTexturePath:function(e){this.texturePath=e},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e,t){var n=this.parseShape(e.shapes),i=this.parseGeometries(e.geometries,n),r=this.parseImages(e.images,(function(){void 0!==t&&t(a)})),o=this.parseTextures(e.textures,r),s=this.parseMaterials(e.materials,o),a=this.parseObject(e.object,i,s);return e.animations&&(a.animations=this.parseAnimations(e.animations)),void 0!==e.images&&0!==e.images.length||void 0!==t&&t(a),a},parseShape:function(e){var t={};if(void 0!==e)for(var n=0,i=e.length;n<i;n++){var r=(new ou).fromJSON(e[n]);t[r.uuid]=r}return t},parseGeometries:function(e,t){var n={};if(void 0!==e)for(var i=new Nu,r=new Lu,o=0,s=e.length;o<s;o++){var a,l=e[o];switch(l.type){case"PlaneGeometry":case"PlaneBufferGeometry":a=new ul[l.type](l.width,l.height,l.widthSegments,l.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":a=new ul[l.type](l.width,l.height,l.depth,l.widthSegments,l.heightSegments,l.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":a=new ul[l.type](l.radius,l.segments,l.thetaStart,l.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":a=new ul[l.type](l.radiusTop,l.radiusBottom,l.height,l.radialSegments,l.heightSegments,l.openEnded,l.thetaStart,l.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":a=new ul[l.type](l.radius,l.height,l.radialSegments,l.heightSegments,l.openEnded,l.thetaStart,l.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":a=new ul[l.type](l.radius,l.widthSegments,l.heightSegments,l.phiStart,l.phiLength,l.thetaStart,l.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":a=new ul[l.type](l.radius,l.detail);break;case"RingGeometry":case"RingBufferGeometry":a=new ul[l.type](l.innerRadius,l.outerRadius,l.thetaSegments,l.phiSegments,l.thetaStart,l.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":a=new ul[l.type](l.radius,l.tube,l.radialSegments,l.tubularSegments,l.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":a=new ul[l.type](l.radius,l.tube,l.tubularSegments,l.radialSegments,l.p,l.q);break;case"LatheGeometry":case"LatheBufferGeometry":a=new ul[l.type](l.points,l.segments,l.phiStart,l.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":a=new ul[l.type](l.vertices,l.indices,l.radius,l.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var u=[],c=0,h=l.shapes.length;c<h;c++){var d=t[l.shapes[c]];u.push(d)}a=new ul[l.type](u,l.curveSegments);break;case"BufferGeometry":a=r.parse(l);break;case"Geometry":a=i.parse(l,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+l.type+'"');continue}a.uuid=l.uuid,void 0!==l.name&&(a.name=l.name),n[l.uuid]=a}return n},parseMaterials:function(e,t){var n={};if(void 0!==e){var i=new Ru;i.setTextures(t);for(var r=0,o=e.length;r<o;r++){var s=e[r];if("MultiMaterial"===s.type){for(var a=[],l=0;l<s.materials.length;l++)a.push(i.parse(s.materials[l]));n[s.uuid]=a}else n[s.uuid]=i.parse(s)}}return n},parseAnimations:function(e){for(var t=[],n=0;n<e.length;n++){var i=Pu.parse(e[n]);t.push(i)}return t},parseImages:function(e,t){var n=this,i={};function r(e){return n.manager.itemStart(e),s.load(e,(function(){n.manager.itemEnd(e)}),void 0,(function(){n.manager.itemEnd(e),n.manager.itemError(e)}))}if(void 0!==e&&e.length>0){var o=new wl(t),s=new Tl(o);s.setCrossOrigin(this.crossOrigin);for(var a=0,l=e.length;a<l;a++){var u=e[a],c=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u.url)?u.url:n.texturePath+u.url;i[u.uuid]=r(c)}}return i},parseTextures:function(e,t){function n(e,t){return"number"===typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var i={};if(void 0!==e)for(var r=0,o=e.length;r<o;r++){var s=e[r];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===t[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image);var a=new Ut(t[s.image]);a.needsUpdate=!0,a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),void 0!==s.mapping&&(a.mapping=n(s.mapping,Uu)),void 0!==s.offset&&a.offset.fromArray(s.offset),void 0!==s.repeat&&a.repeat.fromArray(s.repeat),void 0!==s.center&&a.center.fromArray(s.center),void 0!==s.rotation&&(a.rotation=s.rotation),void 0!==s.wrap&&(a.wrapS=n(s.wrap[0],Fu),a.wrapT=n(s.wrap[1],Fu)),void 0!==s.format&&(a.format=s.format),void 0!==s.minFilter&&(a.minFilter=n(s.minFilter,zu)),void 0!==s.magFilter&&(a.magFilter=n(s.magFilter,zu)),void 0!==s.anisotropy&&(a.anisotropy=s.anisotropy),void 0!==s.flipY&&(a.flipY=s.flipY),i[s.uuid]=a}return i},parseObject:function(e,t,n){var i;function r(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function o(e){if(void 0!==e){if(Array.isArray(e)){for(var t=[],i=0,r=e.length;i<r;i++){var o=e[i];void 0===n[o]&&console.warn("THREE.ObjectLoader: Undefined material",o),t.push(n[o])}return t}return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),n[e]}}switch(e.type){case"Scene":i=new Cs,void 0!==e.background&&Number.isInteger(e.background)&&(i.background=new nr(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?i.fog=new Ts(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(i.fog=new Ms(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":i=new _s(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(i.focus=e.focus),void 0!==e.zoom&&(i.zoom=e.zoom),void 0!==e.filmGauge&&(i.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(i.filmOffset=e.filmOffset),void 0!==e.view&&(i.view=Object.assign({},e.view));break;case"OrthographicCamera":i=new hr(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(i.zoom=e.zoom),void 0!==e.view&&(i.view=Object.assign({},e.view));break;case"AmbientLight":i=new fu(e.color,e.intensity);break;case"DirectionalLight":i=new pu(e.color,e.intensity);break;case"PointLight":i=new hu(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":i=new mu(e.color,e.intensity,e.width,e.height);break;case"SpotLight":i=new cu(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":i=new au(e.color,e.groundColor,e.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var s=r(e.geometry),a=o(e.material);i=s.bones&&s.bones.length>0?new Is(s,a):new zr(s,a);break;case"LOD":i=new Ls;break;case"Line":i=new ks(r(e.geometry),o(e.material),e.mode);break;case"LineLoop":i=new Us(r(e.geometry),o(e.material));break;case"LineSegments":i=new Vs(r(e.geometry),o(e.material));break;case"PointCloud":case"Points":i=new zs(r(e.geometry),o(e.material));break;case"Sprite":i=new Rs(o(e.material));break;case"Group":i=new js;break;default:i=new ur}if(i.uuid=e.uuid,void 0!==e.name&&(i.name=e.name),void 0!==e.matrix?(i.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(i.matrixAutoUpdate=e.matrixAutoUpdate),i.matrixAutoUpdate&&i.matrix.decompose(i.position,i.quaternion,i.scale)):(void 0!==e.position&&i.position.fromArray(e.position),void 0!==e.rotation&&i.rotation.fromArray(e.rotation),void 0!==e.quaternion&&i.quaternion.fromArray(e.quaternion),void 0!==e.scale&&i.scale.fromArray(e.scale)),void 0!==e.castShadow&&(i.castShadow=e.castShadow),void 0!==e.receiveShadow&&(i.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(i.shadow.bias=e.shadow.bias),void 0!==e.shadow.radius&&(i.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&i.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(i.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(i.visible=e.visible),void 0!==e.frustumCulled&&(i.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(i.renderOrder=e.renderOrder),void 0!==e.userData&&(i.userData=e.userData),void 0!==e.children)for(var l=e.children,u=0;u<l.length;u++)i.add(this.parseObject(l[u],t,n));if("LOD"===e.type)for(var c=e.levels,h=0;h<c.length;h++){var d=c[h],p=i.getObjectByProperty("uuid",d.object);void 0!==p&&i.addLevel(p,d.distance)}return i}});var Vu,Uu={UVMapping:oe,CubeReflectionMapping:se,CubeRefractionMapping:ae,EquirectangularReflectionMapping:le,EquirectangularRefractionMapping:ue,SphericalReflectionMapping:ce,CubeUVReflectionMapping:he,CubeUVRefractionMapping:de},Fu={RepeatWrapping:pe,ClampToEdgeWrapping:fe,MirroredRepeatWrapping:me},zu={NearestFilter:ge,NearestMipMapNearestFilter:ve,NearestMipMapLinearFilter:ye,LinearFilter:xe,LinearMipMapNearestFilter:be,LinearMipMapLinearFilter:we};function ju(e){"undefined"===typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"===typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.manager=void 0!==e?e:_l,this.options=void 0}function Bu(){this.type="ShapePath",this.color=new nr,this.subPaths=[],this.currentPath=null}function $u(e){this.type="Font",this.data=e}function Hu(e,t,n,i){for(var r=String(e).split(""),o=t/i.resolution,s=(i.boundingBox.yMax-i.boundingBox.yMin+i.underlineThickness)*o,a=[],l=0,u=0,c=0;c<r.length;c++){var h=r[c];if("\n"===h)l=0,u-=s;else{var d=Gu(h,n,o,l,u,i);l+=d.offsetX,a.push(d.path)}}return a}function Gu(e,t,n,i,r,o){var s=o.glyphs[e]||o.glyphs["?"];if(s){var a,l,u,c,h,d,p,f,m=new Bu;if(s.o)for(var g=s._cachedOutline||(s._cachedOutline=s.o.split(" ")),v=0,y=g.length;v<y;){var x=g[v++];switch(x){case"m":a=g[v++]*n+i,l=g[v++]*n+r,m.moveTo(a,l);break;case"l":a=g[v++]*n+i,l=g[v++]*n+r,m.lineTo(a,l);break;case"q":u=g[v++]*n+i,c=g[v++]*n+r,h=g[v++]*n+i,d=g[v++]*n+r,m.quadraticCurveTo(h,d,u,c);break;case"b":u=g[v++]*n+i,c=g[v++]*n+r,h=g[v++]*n+i,d=g[v++]*n+r,p=g[v++]*n+i,f=g[v++]*n+r,m.bezierCurveTo(h,d,p,f,u,c);break}}return{offsetX:s.ha*n,path:m}}}function Wu(e){this.manager=void 0!==e?e:_l}ju.prototype={constructor:ju,setOptions:function(e){return this.options=e,this},load:function(e,t,n,i){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e);var r=this,o=bl.get(e);if(void 0!==o)return r.manager.itemStart(e),setTimeout((function(){t&&t(o),r.manager.itemEnd(e)}),0),o;fetch(e).then((function(e){return e.blob()})).then((function(e){return createImageBitmap(e,r.options)})).then((function(n){bl.add(e,n),t&&t(n),r.manager.itemEnd(e)})).catch((function(t){i&&i(t),r.manager.itemEnd(e),r.manager.itemError(e)}))},setCrossOrigin:function(){return this},setPath:function(e){return this.path=e,this}},Object.assign(Bu.prototype,{moveTo:function(e,t){this.currentPath=new ru,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t)},lineTo:function(e,t){this.currentPath.lineTo(e,t)},quadraticCurveTo:function(e,t,n,i){this.currentPath.quadraticCurveTo(e,t,n,i)},bezierCurveTo:function(e,t,n,i,r,o){this.currentPath.bezierCurveTo(e,t,n,i,r,o)},splineThru:function(e){this.currentPath.splineThru(e)},toShapes:function(e,t){function n(e){for(var t=[],n=0,i=e.length;n<i;n++){var r=e[n],o=new ou;o.curves=r.curves,t.push(o)}return t}function i(e,t){for(var n=t.length,i=!1,r=n-1,o=0;o<n;r=o++){var s=t[r],a=t[o],l=a.x-s.x,u=a.y-s.y;if(Math.abs(u)>Number.EPSILON){if(u<0&&(s=t[o],l=-l,a=t[r],u=-u),e.y<s.y||e.y>a.y)continue;if(e.y===s.y){if(e.x===s.x)return!0}else{var c=u*(e.x-s.x)-l*(e.y-s.y);if(0===c)return!0;if(c<0)continue;i=!i}}else{if(e.y!==s.y)continue;if(a.x<=e.x&&e.x<=s.x||s.x<=e.x&&e.x<=a.x)return!0}}return i}var r=Fa.isClockWise,o=this.subPaths;if(0===o.length)return[];if(!0===t)return n(o);var s,a,l,u=[];if(1===o.length)return a=o[0],l=new ou,l.curves=a.curves,u.push(l),u;var c=!r(o[0].getPoints());c=e?!c:c;var h,d,p=[],f=[],m=[],g=0;f[g]=void 0,m[g]=[];for(var v=0,y=o.length;v<y;v++)a=o[v],h=a.getPoints(),s=r(h),s=e?!s:s,s?(!c&&f[g]&&g++,f[g]={s:new ou,p:h},f[g].s.curves=a.curves,c&&g++,m[g]=[]):m[g].push({h:a,p:h[0]});if(!f[0])return n(o);if(f.length>1){for(var x=!1,b=[],w=0,_=f.length;w<_;w++)p[w]=[];for(w=0,_=f.length;w<_;w++)for(var A=m[w],S=0;S<A.length;S++){for(var E=A[S],M=!0,T=0;T<f.length;T++)i(E.p,f[T].p)&&(w!==T&&b.push({froms:w,tos:T,hole:S}),M?(M=!1,p[T].push(E)):x=!0);M&&p[w].push(E)}b.length>0&&(x||(m=p))}v=0;for(var C=f.length;v<C;v++){l=f[v].s,u.push(l),d=m[v];for(var P=0,R=d.length;P<R;P++)l.holes.push(d[P].h)}return u}}),Object.assign($u.prototype,{isFont:!0,generateShapes:function(e,t,n){void 0===t&&(t=100),void 0===n&&(n=4);for(var i=[],r=Hu(e,t,n,this.data),o=0,s=r.length;o<s;o++)Array.prototype.push.apply(i,r[o].toShapes());return i}}),Object.assign(Wu.prototype,{load:function(e,t,n,i){var r=this,o=new Sl(this.manager);o.setPath(this.path),o.load(e,(function(e){var n;try{n=JSON.parse(e)}catch(o){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(e.substring(65,e.length-2))}var i=r.parse(n);t&&t(i)}),n,i)},parse:function(e){return new $u(e)},setPath:function(e){return this.path=e,this}});var qu={getContext:function(){return void 0===Vu&&(Vu=new(window.AudioContext||window.webkitAudioContext)),Vu},setContext:function(e){Vu=e}};function Yu(e){this.manager=void 0!==e?e:_l}function Xu(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new _s,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new _s,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function Zu(e,t,n){ur.call(this),this.type="CubeCamera";var i=90,r=1,o=new _s(i,r,e,t);o.up.set(0,-1,0),o.lookAt(new Nt(1,0,0)),this.add(o);var s=new _s(i,r,e,t);s.up.set(0,-1,0),s.lookAt(new Nt(-1,0,0)),this.add(s);var a=new _s(i,r,e,t);a.up.set(0,0,1),a.lookAt(new Nt(0,1,0)),this.add(a);var l=new _s(i,r,e,t);l.up.set(0,0,-1),l.lookAt(new Nt(0,-1,0)),this.add(l);var u=new _s(i,r,e,t);u.up.set(0,-1,0),u.lookAt(new Nt(0,0,1)),this.add(u);var c=new _s(i,r,e,t);c.up.set(0,-1,0),c.lookAt(new Nt(0,0,-1)),this.add(c);var h={format:Ne,magFilter:xe,minFilter:xe};this.renderTarget=new jt(n,n,h),this.renderTarget.texture.name="CubeCamera",this.update=function(e,t){null===this.parent&&this.updateMatrixWorld();var n=this.renderTarget,i=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,n.activeCubeFace=0,e.render(t,o,n),n.activeCubeFace=1,e.render(t,s,n),n.activeCubeFace=2,e.render(t,a,n),n.activeCubeFace=3,e.render(t,l,n),n.activeCubeFace=4,e.render(t,u,n),n.texture.generateMipmaps=i,n.activeCubeFace=5,e.render(t,c,n),e.setRenderTarget(null)},this.clear=function(e,t,n,i){for(var r=this.renderTarget,o=0;o<6;o++)r.activeCubeFace=o,e.setRenderTarget(r),e.clear(t,n,i);e.setRenderTarget(null)}}function Ju(){ur.call(this),this.type="AudioListener",this.context=qu.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null}function Ku(e){ur.call(this),this.type="Audio",this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.loop=!1,this.startTime=0,this.offset=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function Qu(e){Ku.call(this,e),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function ec(e,t){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=void 0!==t?t:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}function tc(e,t,n){this.binding=e,this.valueSize=n;var i,r=Float64Array;switch(t){case"quaternion":i=this._slerp;break;case"string":case"bool":r=Array,i=this._select;break;default:i=this._lerp}this.buffer=new r(4*n),this._mixBufferRegion=i,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}Object.assign(Yu.prototype,{load:function(e,t,n,i){var r=new Sl(this.manager);r.setResponseType("arraybuffer"),r.load(e,(function(e){var n=qu.getContext();n.decodeAudioData(e,(function(e){t(e)}))}),n,i)}}),Object.assign(Xu.prototype,{update:function(){var e,t,n,i,r,o,s,a,l=new Dt,u=new Dt;return function(c){var h=e!==this||t!==c.focus||n!==c.fov||i!==c.aspect*this.aspect||r!==c.near||o!==c.far||s!==c.zoom||a!==this.eyeSep;if(h){e=this,t=c.focus,n=c.fov,i=c.aspect*this.aspect,r=c.near,o=c.far,s=c.zoom;var d=c.projectionMatrix.clone();a=this.eyeSep/2;var p,f,m=a*r/t,g=r*Math.tan(Lt.DEG2RAD*n*.5)/s;u.elements[12]=-a,l.elements[12]=a,p=-g*i+m,f=g*i+m,d.elements[0]=2*r/(f-p),d.elements[8]=(f+p)/(f-p),this.cameraL.projectionMatrix.copy(d),p=-g*i-m,f=g*i-m,d.elements[0]=2*r/(f-p),d.elements[8]=(f+p)/(f-p),this.cameraR.projectionMatrix.copy(d)}this.cameraL.matrixWorld.copy(c.matrixWorld).multiply(u),this.cameraR.matrixWorld.copy(c.matrixWorld).multiply(l)}}()}),Zu.prototype=Object.create(ur.prototype),Zu.prototype.constructor=Zu,Ju.prototype=Object.assign(Object.create(ur.prototype),{constructor:Ju,getInput:function(){return this.gain},removeFilter:function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},getFilter:function(){return this.filter},setFilter:function(e){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01)},updateMatrixWorld:function(){var e=new Nt,t=new It,n=new Nt,i=new Nt;return function(r){ur.prototype.updateMatrixWorld.call(this,r);var o=this.context.listener,s=this.up;this.matrixWorld.decompose(e,t,n),i.set(0,0,-1).applyQuaternion(t),o.positionX?(o.positionX.setValueAtTime(e.x,this.context.currentTime),o.positionY.setValueAtTime(e.y,this.context.currentTime),o.positionZ.setValueAtTime(e.z,this.context.currentTime),o.forwardX.setValueAtTime(i.x,this.context.currentTime),o.forwardY.setValueAtTime(i.y,this.context.currentTime),o.forwardZ.setValueAtTime(i.z,this.context.currentTime),o.upX.setValueAtTime(s.x,this.context.currentTime),o.upY.setValueAtTime(s.y,this.context.currentTime),o.upZ.setValueAtTime(s.z,this.context.currentTime)):(o.setPosition(e.x,e.y,e.z),o.setOrientation(i.x,i.y,i.z,s.x,s.y,s.z))}}()}),Ku.prototype=Object.assign(Object.create(ur.prototype),{constructor:Ku,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){var e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.onended=this.onEnded.bind(this),e.playbackRate.setValueAtTime(this.playbackRate,this.startTime),this.startTime=this.context.currentTime,e.start(this.startTime,this.offset),this.isPlaying=!0,this.source=e,this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this.source.stop(),this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.offset=0,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e||(e=[]),!0===this.isPlaying?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}),Qu.prototype=Object.assign(Object.create(Ku.prototype),{constructor:Qu,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){this.panner.refDistance=e},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){this.panner.rolloffFactor=e},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){this.panner.distanceModel=e},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){this.panner.maxDistance=e},updateMatrixWorld:function(){var e=new Nt;return function(t){ur.prototype.updateMatrixWorld.call(this,t),e.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(e.x,e.y,e.z)}}()}),Object.assign(ec.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var e=0,t=this.getFrequencyData(),n=0;n<t.length;n++)e+=t[n];return e/t.length}}),Object.assign(tc.prototype,{accumulate:function(e,t){var n=this.buffer,i=this.valueSize,r=e*i+i,o=this.cumulativeWeight;if(0===o){for(var s=0;s!==i;++s)n[r+s]=n[s];o=t}else{o+=t;var a=t/o;this._mixBufferRegion(n,r,0,a,i)}this.cumulativeWeight=o},apply:function(e){var t=this.valueSize,n=this.buffer,i=e*t+t,r=this.cumulativeWeight,o=this.binding;if(this.cumulativeWeight=0,r<1){var s=3*t;this._mixBufferRegion(n,i,s,1-r,t)}for(var a=t,l=t+t;a!==l;++a)if(n[a]!==n[a+t]){o.setValue(n,i);break}},saveOriginalState:function(){var e=this.binding,t=this.buffer,n=this.valueSize,i=3*n;e.getValue(t,i);for(var r=n,o=i;r!==o;++r)t[r]=t[i+r%n];this.cumulativeWeight=0},restoreOriginalState:function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)},_select:function(e,t,n,i,r){if(i>=.5)for(var o=0;o!==r;++o)e[t+o]=e[n+o]},_slerp:function(e,t,n,i){It.slerpFlat(e,t,e,t,e,n,i)},_lerp:function(e,t,n,i,r){for(var o=1-i,s=0;s!==r;++s){var a=t+s;e[a]=e[a]*o+e[n+s]*i}}});var nc,ic,rc="\\[\\]\\.:\\/";function oc(e,t,n){var i=n||sc.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}function sc(e,t,n){this.path=t,this.parsedPath=n||sc.parseTrackName(t),this.node=sc.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}function ac(){this.uuid=Lt.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var t=0,n=arguments.length;t!==n;++t)e[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var i=this;this.stats={objects:{get total(){return i._objects.length},get inUse(){return this.total-i.nCachedObjects_}},get bindingsPerObject(){return i._bindings.length}}}function lc(e,t,n){this._mixer=e,this._clip=t,this._localRoot=n||null;for(var i=t.tracks,r=i.length,o=new Array(r),s={endingStart:gt,endingEnd:gt},a=0;a!==r;++a){var l=i[a].createInterpolant(null);o[a]=l,l.settings=s}this._interpolantSettings=s,this._interpolants=o,this._propertyBindings=new Array(r),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=ht,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function uc(e){this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function cc(e){"string"===typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}function hc(){Cr.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function dc(e,t,n,i){this.data=e,this.itemSize=t,this.offset=n,this.normalized=!0===i}function pc(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function fc(e,t,n){pc.call(this,e,t),this.meshPerAttribute=n||1}function mc(e,t,n){mr.call(this,e,t),this.meshPerAttribute=n||1}function gc(e,t,n,i){this.ray=new Vr(e,t),this.near=n||0,this.far=i||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function vc(e,t){return e.distance-t.distance}function yc(e,t,n,i){if(!1!==e.visible&&(e.raycast(t,n),!0===i))for(var r=e.children,o=0,s=r.length;o<s;o++)yc(r[o],t,n,!0)}function xc(e){this.autoStart=void 0===e||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function bc(e,t,n){return this.radius=void 0!==e?e:1,this.phi=void 0!==t?t:0,this.theta=void 0!==n?n:0,this}function wc(e,t,n){return this.radius=void 0!==e?e:1,this.theta=void 0!==t?t:0,this.y=void 0!==n?n:0,this}function _c(e,t){this.min=void 0!==e?e:new Ot(1/0,1/0),this.max=void 0!==t?t:new Ot(-1/0,-1/0)}function Ac(e){ur.call(this),this.material=e,this.render=function(){}}function Sc(e,t,n,i){this.object=e,this.size=void 0!==t?t:1;var r=void 0!==n?n:16711680,o=void 0!==i?i:1,s=0,a=this.object.geometry;a&&a.isGeometry?s=3*a.faces.length:a&&a.isBufferGeometry&&(s=a.attributes.normal.count);var l=new Cr,u=new Ar(2*s*3,3);l.addAttribute("position",u),Vs.call(this,l,new Ns({color:r,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function Ec(e,t){ur.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;for(var n=new Cr,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],r=0,o=1,s=32;r<s;r++,o++){var a=r/s*Math.PI*2,l=o/s*Math.PI*2;i.push(Math.cos(a),Math.sin(a),1,Math.cos(l),Math.sin(l),1)}n.addAttribute("position",new Ar(i,3));var u=new Ns({fog:!1});this.cone=new Vs(n,u),this.add(this.cone),this.update()}function Mc(e){var t=[];e&&e.isBone&&t.push(e);for(var n=0;n<e.children.length;n++)t.push.apply(t,Mc(e.children[n]));return t}function Tc(e){for(var t=Mc(e),n=new Cr,i=[],r=[],o=new nr(0,0,1),s=new nr(0,1,0),a=0;a<t.length;a++){var l=t[a];l.parent&&l.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),r.push(o.r,o.g,o.b),r.push(s.r,s.g,s.b))}n.addAttribute("position",new Ar(i,3)),n.addAttribute("color",new Ar(r,3));var u=new Ns({vertexColors:b,depthTest:!1,depthWrite:!1,transparent:!0});Vs.call(this,n,u),this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}function Cc(e,t,n){this.light=e,this.light.updateMatrixWorld(),this.color=n;var i=new Ya(t,4,2),r=new Nr({wireframe:!0,fog:!1});zr.call(this,i,r),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function Pc(e,t){ur.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;var n=new Ns({fog:!1}),i=new Cr;i.addAttribute("position",new mr(new Float32Array(15),3)),this.line=new ks(i,n),this.add(this.line),this.update()}function Rc(e,t,n){ur.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;var i=new Qs(t);i.rotateY(.5*Math.PI),this.material=new Nr({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=b);var r=i.getAttribute("position"),o=new Float32Array(3*r.count);i.addAttribute("color",new mr(o,3)),this.add(new zr(i,this.material)),this.update()}function Lc(e,t,n,i){e=e||10,t=t||10,n=new nr(void 0!==n?n:4473924),i=new nr(void 0!==i?i:8947848);for(var r=t/2,o=e/t,s=e/2,a=[],l=[],u=0,c=0,h=-s;u<=t;u++,h+=o){a.push(-s,0,h,s,0,h),a.push(h,0,-s,h,0,s);var d=u===r?n:i;d.toArray(l,c),c+=3,d.toArray(l,c),c+=3,d.toArray(l,c),c+=3,d.toArray(l,c),c+=3}var p=new Cr;p.addAttribute("position",new Ar(a,3)),p.addAttribute("color",new Ar(l,3));var f=new Ns({vertexColors:b});Vs.call(this,p,f)}function Oc(e,t,n,i,r,o){e=e||10,t=t||16,n=n||8,i=i||64,r=new nr(void 0!==r?r:4473924),o=new nr(void 0!==o?o:8947848);var s,a,l,u,c,h,d,p=[],f=[];for(u=0;u<=t;u++)l=u/t*(2*Math.PI),s=Math.sin(l)*e,a=Math.cos(l)*e,p.push(0,0,0),p.push(s,0,a),d=1&u?r:o,f.push(d.r,d.g,d.b),f.push(d.r,d.g,d.b);for(u=0;u<=n;u++)for(d=1&u?r:o,h=e-e/n*u,c=0;c<i;c++)l=c/i*(2*Math.PI),s=Math.sin(l)*h,a=Math.cos(l)*h,p.push(s,0,a),f.push(d.r,d.g,d.b),l=(c+1)/i*(2*Math.PI),s=Math.sin(l)*h,a=Math.cos(l)*h,p.push(s,0,a),f.push(d.r,d.g,d.b);var m=new Cr;m.addAttribute("position",new Ar(p,3)),m.addAttribute("color",new Ar(f,3));var g=new Ns({vertexColors:b});Vs.call(this,m,g)}function Dc(e,t,n,i){this.object=e,this.size=void 0!==t?t:1;var r=void 0!==n?n:16776960,o=void 0!==i?i:1,s=0,a=this.object.geometry;a&&a.isGeometry?s=a.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var l=new Cr,u=new Ar(2*s*3,3);l.addAttribute("position",u),Vs.call(this,l,new Ns({color:r,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function Ic(e,t,n){ur.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===t&&(t=1);var i=new Cr;i.addAttribute("position",new Ar([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));var r=new Ns({fog:!1});this.lightPlane=new ks(i,r),this.add(this.lightPlane),i=new Cr,i.addAttribute("position",new Ar([0,0,0,0,0,1],3)),this.targetLine=new ks(i,r),this.add(this.targetLine),this.update()}function Nc(e){var t=new Cr,n=new Ns({color:16777215,vertexColors:x}),i=[],r=[],o={},s=new nr(16755200),a=new nr(16711680),l=new nr(43775),u=new nr(16777215),c=new nr(3355443);function h(e,t,n){d(e,n),d(t,n)}function d(e,t){i.push(0,0,0),r.push(t.r,t.g,t.b),void 0===o[e]&&(o[e]=[]),o[e].push(i.length/3-1)}h("n1","n2",s),h("n2","n4",s),h("n4","n3",s),h("n3","n1",s),h("f1","f2",s),h("f2","f4",s),h("f4","f3",s),h("f3","f1",s),h("n1","f1",s),h("n2","f2",s),h("n3","f3",s),h("n4","f4",s),h("p","n1",a),h("p","n2",a),h("p","n3",a),h("p","n4",a),h("u1","u2",l),h("u2","u3",l),h("u3","u1",l),h("c","t",u),h("p","c",c),h("cn1","cn2",c),h("cn3","cn4",c),h("cf1","cf2",c),h("cf3","cf4",c),t.addAttribute("position",new Ar(i,3)),t.addAttribute("color",new Ar(r,3)),Vs.call(this,t,n),this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()}function kc(e,t){this.object=e,void 0===t&&(t=16776960);var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(24),r=new Cr;r.setIndex(new mr(n,1)),r.addAttribute("position",new mr(i,3)),Vs.call(this,r,new Ns({color:t})),this.matrixAutoUpdate=!1,this.update()}function Vc(e,t){this.type="Box3Helper",this.box=e;var n=void 0!==t?t:16776960,i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],o=new Cr;o.setIndex(new mr(i,1)),o.addAttribute("position",new Ar(r,3)),Vs.call(this,o,new Ns({color:n})),this.geometry.computeBoundingSphere()}function Uc(e,t,n){this.type="PlaneHelper",this.plane=e,this.size=void 0===t?1:t;var i=void 0!==n?n:16776960,r=[1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],o=new Cr;o.addAttribute("position",new Ar(r,3)),o.computeBoundingSphere(),ks.call(this,o,new Ns({color:i}));var s=[1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],a=new Cr;a.addAttribute("position",new Ar(s,3)),a.computeBoundingSphere(),this.add(new zr(a,new Nr({color:i,opacity:.2,transparent:!0,depthWrite:!1})))}function Fc(e,t,n,i,r,o){ur.call(this),void 0===i&&(i=16776960),void 0===n&&(n=1),void 0===r&&(r=.2*n),void 0===o&&(o=.2*r),void 0===nc&&(nc=new Cr,nc.addAttribute("position",new Ar([0,0,0,0,1,0],3)),ic=new rl(0,.5,1,5,1),ic.translate(0,-.5,0)),this.position.copy(t),this.line=new ks(nc,new Ns({color:i})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new zr(ic,new Nr({color:i})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,r,o)}function zc(e){e=e||1;var t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],i=new Cr;i.addAttribute("position",new Ar(t,3)),i.addAttribute("color",new Ar(n,3));var r=new Ns({vertexColors:b});Vs.call(this,i,r)}Object.assign(oc.prototype,{getValue:function(e,t){this.bind();var n=this._targetGroup.nCachedObjects_,i=this._bindings[n];void 0!==i&&i.getValue(e,t)},setValue:function(e,t){for(var n=this._bindings,i=this._targetGroup.nCachedObjects_,r=n.length;i!==r;++i)n[i].setValue(e,t)},bind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()},unbind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}),Object.assign(sc,{Composite:oc,create:function(e,t,n){return e&&e.isAnimationObjectGroup?new sc.Composite(e,t,n):new sc(e,t,n)},sanitizeNodeName:function(){var e=new RegExp("["+rc+"]","g");return function(t){return t.replace(/\s/g,"_").replace(e,"")}}(),parseTrackName:function(){var e="[^"+rc+"]",t="[^"+rc.replace("\\.","")+"]",n=/((?:WC+[\/:])*)/.source.replace("WC",e),i=/(WCOD+)?/.source.replace("WCOD",t),r=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",e),o=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",e),s=new RegExp("^"+n+i+r+o+"$"),a=["material","materials","bones"];return function(e){var t=s.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==i&&-1!==i){var r=n.nodeName.substring(i+1);-1!==a.indexOf(r)&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=r)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}}(),findNode:function(e,t){if(!t||""===t||"root"===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){var i=function(e){for(var n=0;n<e.length;n++){var r=e[n];if(r.name===t||r.uuid===t)return r;var o=i(r.children);if(o)return o}return null},r=i(e.children);if(r)return r}return null}}),Object.assign(sc.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)e[t++]=n[i]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.targetObject[this.propertyName]=e[t]},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)n[i]=e[t++]},function(e,t){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){var e=this.node,t=this.parsedPath,n=t.objectName,i=t.propertyName,r=t.propertyIndex;if(e||(e=sc.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(n){var o=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(var s=0;s<e.length;s++)if(e[s].name===o){o=s;break}break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==o){if(void 0===e[o])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[o]}}var a=e[i];if(void 0!==a){var l=this.Versioning.None;void 0!==e.needsUpdate?(l=this.Versioning.NeedsUpdate,this.targetObject=e):void 0!==e.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=e);var u=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===i){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(s=0;s<this.node.geometry.morphAttributes.position.length;s++)if(e.geometry.morphAttributes.position[s].name===r){r=s;break}}else{if(!e.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(s=0;s<this.node.geometry.morphTargets.length;s++)if(e.geometry.morphTargets[s].name===r){r=s;break}}}u=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=r}else void 0!==a.fromArray&&void 0!==a.toArray?(u=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(u=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=i;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][l]}else{var c=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+i+" but it wasn't found.",e)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),
//!\ DECLARE ALIAS AFTER assign prototype !
Object.assign(sc.prototype,{_getValue_unbound:sc.prototype.getValue,_setValue_unbound:sc.prototype.setValue}),Object.assign(ac.prototype,{isAnimationObjectGroup:!0,add:function(){for(var e=this._objects,t=e.length,n=this.nCachedObjects_,i=this._indicesByUUID,r=this._paths,o=this._parsedPaths,s=this._bindings,a=s.length,l=void 0,u=0,c=arguments.length;u!==c;++u){var h=arguments[u],d=h.uuid,p=i[d];if(void 0===p){p=t++,i[d]=p,e.push(h);for(var f=0,m=a;f!==m;++f)s[f].push(new sc(h,r[f],o[f]))}else if(p<n){l=e[p];var g=--n,v=e[g];i[v.uuid]=p,e[p]=v,i[d]=g,e[g]=h;for(f=0,m=a;f!==m;++f){var y=s[f],x=y[g],b=y[p];y[p]=x,void 0===b&&(b=new sc(h,r[f],o[f])),y[g]=b}}else e[p]!==l&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=n},remove:function(){for(var e=this._objects,t=this.nCachedObjects_,n=this._indicesByUUID,i=this._bindings,r=i.length,o=0,s=arguments.length;o!==s;++o){var a=arguments[o],l=a.uuid,u=n[l];if(void 0!==u&&u>=t){var c=t++,h=e[c];n[h.uuid]=u,e[u]=h,n[l]=c,e[c]=a;for(var d=0,p=r;d!==p;++d){var f=i[d],m=f[c],g=f[u];f[u]=m,f[c]=g}}}this.nCachedObjects_=t},uncache:function(){for(var e=this._objects,t=e.length,n=this.nCachedObjects_,i=this._indicesByUUID,r=this._bindings,o=r.length,s=0,a=arguments.length;s!==a;++s){var l=arguments[s],u=l.uuid,c=i[u];if(void 0!==c)if(delete i[u],c<n){var h=--n,d=e[h],p=--t,f=e[p];i[d.uuid]=c,e[c]=d,i[f.uuid]=h,e[h]=f,e.pop();for(var m=0,g=o;m!==g;++m){var v=r[m],y=v[h],x=v[p];v[c]=y,v[h]=x,v.pop()}}else{p=--t,f=e[p];i[f.uuid]=c,e[c]=f,e.pop();for(m=0,g=o;m!==g;++m){v=r[m];v[c]=v[p],v.pop()}}}this.nCachedObjects_=n},subscribe_:function(e,t){var n=this._bindingsIndicesByPath,i=n[e],r=this._bindings;if(void 0!==i)return r[i];var o=this._paths,s=this._parsedPaths,a=this._objects,l=a.length,u=this.nCachedObjects_,c=new Array(l);i=r.length,n[e]=i,o.push(e),s.push(t),r.push(c);for(var h=u,d=a.length;h!==d;++h){var p=a[h];c[h]=new sc(p,e,t)}return c},unsubscribe_:function(e){var t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){var i=this._paths,r=this._parsedPaths,o=this._bindings,s=o.length-1,a=o[s],l=e[s];t[l]=n,o[n]=a,o.pop(),r[n]=r[s],r.pop(),i[n]=i[s],i.pop()}}}),Object.assign(lc.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,t){return this.loop=e,this.repetitions=t,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){var i=this._clip.duration,r=e._clip.duration,o=r/i,s=i/r;e.warp(1,o,t),this.warp(s,1,t)}return this},crossFadeTo:function(e,t,n){return e.crossFadeFrom(this,t,n)},stopFading:function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,t,n){var i=this._mixer,r=i.time,o=this._timeScaleInterpolant,s=this.timeScale;null===o&&(o=i._lendControlInterpolant(),this._timeScaleInterpolant=o);var a=o.parameterPositions,l=o.sampleValues;return a[0]=r,a[1]=r+n,l[0]=e/s,l[1]=t/s,this},stopWarping:function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,t,n,i){if(this.enabled){var r=this._startTime;if(null!==r){var o=(e-r)*n;if(o<0||0===n)return;this._startTime=null,t=n*o}t*=this._updateTimeScale(e);var s=this._updateTime(t),a=this._updateWeight(e);if(a>0)for(var l=this._interpolants,u=this._propertyBindings,c=0,h=l.length;c!==h;++c)l[c].evaluate(s),u[c].accumulate(i,a)}else this._updateWeight(e)},_updateWeight:function(e){var t=0;if(this.enabled){t=this.weight;var n=this._weightInterpolant;if(null!==n){var i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopFading(),0===i&&(this.enabled=!1))}}return this._effectiveWeight=t,t},_updateTimeScale:function(e){var t=0;if(!this.paused){t=this.timeScale;var n=this._timeScaleInterpolant;if(null!==n){var i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t},_updateTime:function(e){var t=this.time+e;if(0===e)return t;var n=this._clip.duration,i=this.loop,r=this._loopCount;if(i===ct){-1===r&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(t>=n)t=n;else{if(!(t<0))break e;t=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{var o=i===dt;if(-1===r&&(e>=0?(r=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),t>=n||t<0){var s=Math.floor(t/n);t-=n*s,r+=Math.abs(s);var a=this.repetitions-r;if(a<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,t=e>0?n:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===a){var l=e<0;this._setEndings(l,!l,o)}else this._setEndings(!1,!1,o);this._loopCount=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:s})}}if(o&&1===(1&r))return this.time=t,n-t}return this.time=t,t},_setEndings:function(e,t,n){var i=this._interpolantSettings;n?(i.endingStart=vt,i.endingEnd=vt):(i.endingStart=e?this.zeroSlopeAtStart?vt:gt:yt,i.endingEnd=t?this.zeroSlopeAtEnd?vt:gt:yt)},_scheduleFading:function(e,t,n){var i=this._mixer,r=i.time,o=this._weightInterpolant;null===o&&(o=i._lendControlInterpolant(),this._weightInterpolant=o);var s=o.parameterPositions,a=o.sampleValues;return s[0]=r,a[0]=t,s[1]=r+e,a[1]=n,this}}),uc.prototype=Object.assign(Object.create(a.prototype),{constructor:uc,_bindAction:function(e,t){var n=e._localRoot||this._root,i=e._clip.tracks,r=i.length,o=e._propertyBindings,s=e._interpolants,a=n.uuid,l=this._bindingsByRootAndName,u=l[a];void 0===u&&(u={},l[a]=u);for(var c=0;c!==r;++c){var h=i[c],d=h.name,p=u[d];if(void 0!==p)o[c]=p;else{if(p=o[c],void 0!==p){null===p._cacheIndex&&(++p.referenceCount,this._addInactiveBinding(p,a,d));continue}var f=t&&t._propertyBindings[c].binding.parsedPath;p=new tc(sc.create(n,d,f),h.ValueTypeName,h.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,a,d),o[c]=p}s[c].resultBuffer=p.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var t=(e._localRoot||this._root).uuid,n=e._clip.uuid,i=this._actionsByClip[n];this._bindAction(e,i&&i.knownActions[0]),this._addInactiveAction(e,n,t)}for(var r=e._propertyBindings,o=0,s=r.length;o!==s;++o){var a=r[o];0===a.useCount++&&(this._lendBinding(a),a.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,n=0,i=t.length;n!==i;++n){var r=t[n];0===--r.useCount&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){var t=e._cacheIndex;return null!==t&&t<this._nActiveActions},_addInactiveAction:function(e,t,n){var i=this._actions,r=this._actionsByClip,o=r[t];if(void 0===o)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,r[t]=o;else{var s=o.knownActions;e._byClipCacheIndex=s.length,s.push(e)}e._cacheIndex=i.length,i.push(e),o.actionByRoot[n]=e},_removeInactiveAction:function(e){var t=this._actions,n=t[t.length-1],i=e._cacheIndex;n._cacheIndex=i,t[i]=n,t.pop(),e._cacheIndex=null;var r=e._clip.uuid,o=this._actionsByClip,s=o[r],a=s.knownActions,l=a[a.length-1],u=e._byClipCacheIndex;l._byClipCacheIndex=u,a[u]=l,a.pop(),e._byClipCacheIndex=null;var c=s.actionByRoot,h=(e._localRoot||this._root).uuid;delete c[h],0===a.length&&delete o[r],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){for(var t=e._propertyBindings,n=0,i=t.length;n!==i;++n){var r=t[n];0===--r.referenceCount&&this._removeInactiveBinding(r)}},_lendAction:function(e){var t=this._actions,n=e._cacheIndex,i=this._nActiveActions++,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r},_takeBackAction:function(e){var t=this._actions,n=e._cacheIndex,i=--this._nActiveActions,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r},_addInactiveBinding:function(e,t,n){var i=this._bindingsByRootAndName,r=i[t],o=this._bindings;void 0===r&&(r={},i[t]=r),r[n]=e,e._cacheIndex=o.length,o.push(e)},_removeInactiveBinding:function(e){var t=this._bindings,n=e.binding,i=n.rootNode.uuid,r=n.path,o=this._bindingsByRootAndName,s=o[i],a=t[t.length-1],l=e._cacheIndex;a._cacheIndex=l,t[l]=a,t.pop(),delete s[r];e:{for(var u in s)break e;delete o[i]}},_lendBinding:function(e){var t=this._bindings,n=e._cacheIndex,i=this._nActiveBindings++,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r},_takeBackBinding:function(e){var t=this._bindings,n=e._cacheIndex,i=--this._nActiveBindings,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r},_lendControlInterpolant:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,n=e[t];return void 0===n&&(n=new Su(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),n.__cacheIndex=t,e[t]=n),n},_takeBackControlInterpolant:function(e){var t=this._controlInterpolants,n=e.__cacheIndex,i=--this._nActiveControlInterpolants,r=t[i];e.__cacheIndex=i,t[i]=e,r.__cacheIndex=n,t[n]=r},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,t){var n=t||this._root,i=n.uuid,r="string"===typeof e?Pu.findByName(n,e):e,o=null!==r?r.uuid:e,s=this._actionsByClip[o],a=null;if(void 0!==s){var l=s.actionByRoot[i];if(void 0!==l)return l;a=s.knownActions[0],null===r&&(r=a._clip)}if(null===r)return null;var u=new lc(this,r,t);return this._bindAction(u,a),this._addInactiveAction(u,o,i),u},existingAction:function(e,t){var n=t||this._root,i=n.uuid,r="string"===typeof e?Pu.findByName(n,e):e,o=r?r.uuid:e,s=this._actionsByClip[o];return void 0!==s&&s.actionByRoot[i]||null},stopAllAction:function(){var e=this._actions,t=this._nActiveActions,n=this._bindings,i=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var r=0;r!==t;++r)e[r].reset();for(r=0;r!==i;++r)n[r].useCount=0;return this},update:function(e){e*=this.timeScale;for(var t=this._actions,n=this._nActiveActions,i=this.time+=e,r=Math.sign(e),o=this._accuIndex^=1,s=0;s!==n;++s){var a=t[s];a._update(i,e,r,o)}var l=this._bindings,u=this._nActiveBindings;for(s=0;s!==u;++s)l[s].apply(o);return this},getRoot:function(){return this._root},uncacheClip:function(e){var t=this._actions,n=e.uuid,i=this._actionsByClip,r=i[n];if(void 0!==r){for(var o=r.knownActions,s=0,a=o.length;s!==a;++s){var l=o[s];this._deactivateAction(l);var u=l._cacheIndex,c=t[t.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,c._cacheIndex=u,t[u]=c,t.pop(),this._removeInactiveBindingsForAction(l)}delete i[n]}},uncacheRoot:function(e){var t=e.uuid,n=this._actionsByClip;for(var i in n){var r=n[i].actionByRoot,o=r[t];void 0!==o&&(this._deactivateAction(o),this._removeInactiveAction(o))}var s=this._bindingsByRootAndName,a=s[t];if(void 0!==a)for(var l in a){var u=a[l];u.restoreOriginalState(),this._removeInactiveBinding(u)}},uncacheAction:function(e,t){var n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}),cc.prototype.clone=function(){return new cc(void 0===this.value.clone?this.value:this.value.clone())},hc.prototype=Object.assign(Object.create(Cr.prototype),{constructor:hc,isInstancedBufferGeometry:!0,copy:function(e){return Cr.prototype.copy.call(this,e),this.maxInstancedCount=e.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)}}),Object.defineProperties(dc.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(dc.prototype,{isInterleavedBufferAttribute:!0,setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this},setXYZ:function(e,t,n,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this},setXYZW:function(e,t,n,i,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this.data.array[e+3]=r,this}}),Object.defineProperty(pc.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(pc.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");return this.count=void 0!==e?e.length/this.stride:0,this.array=e,this},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.dynamic=e.dynamic,this},copyAt:function(e,t,n){e*=this.stride,n*=t.stride;for(var i=0,r=this.stride;i<r;i++)this.array[e+i]=t.array[n+i];return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(e){return this.onUploadCallback=e,this}}),fc.prototype=Object.assign(Object.create(pc.prototype),{constructor:fc,isInstancedInterleavedBuffer:!0,copy:function(e){return pc.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),mc.prototype=Object.assign(Object.create(mr.prototype),{constructor:mc,isInstancedBufferAttribute:!0,copy:function(e){return mr.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Object.assign(gc.prototype,{linePrecision:1,set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize()):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,t,n){var i=n||[];return yc(e,this,i,t),i.sort(vc),i},intersectObjects:function(e,t,n){var i=n||[];if(!1===Array.isArray(e))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),i;for(var r=0,o=e.length;r<o;r++)yc(e[r],this,i,t);return i.sort(vc),i}}),Object.assign(xc.prototype,{start:function(){this.startTime=("undefined"===typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=("undefined"===typeof performance?Date:performance).now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}),Object.assign(bc.prototype,{set:function(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},makeSafe:function(){var e=1e-6;return this.phi=Math.max(e,Math.min(Math.PI-e,this.phi)),this},setFromVector3:function(e){return this.radius=e.length(),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e.x,e.z),this.phi=Math.acos(Lt.clamp(e.y/this.radius,-1,1))),this}}),Object.assign(wc.prototype,{set:function(e,t,n){return this.radius=e,this.theta=t,this.y=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.radius=Math.sqrt(e.x*e.x+e.z*e.z),this.theta=Math.atan2(e.x,e.z),this.y=e.y,this}}),Object.assign(_c.prototype,{set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new Ot;return function(t,n){var i=e.copy(n).multiplyScalar(.5);return this.min.copy(t).sub(i),this.max.copy(t).add(i),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new Ot),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new Ot),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .getParameter() target is now required"),t=new Ot),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .clampPoint() target is now required"),t=new Ot),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new Ot;return function(t){var n=e.copy(t).clamp(this.min,this.max);return n.sub(t).length()}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),Ac.prototype=Object.create(ur.prototype),Ac.prototype.constructor=Ac,Ac.prototype.isImmediateRenderObject=!0,Sc.prototype=Object.create(Vs.prototype),Sc.prototype.constructor=Sc,Sc.prototype.update=function(){var e=new Nt,t=new Nt,n=new kt;return function(){var i=["a","b","c"];this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);var r=this.object.matrixWorld,o=this.geometry.attributes.position,s=this.object.geometry;if(s&&s.isGeometry)for(var a=s.vertices,l=s.faces,u=0,c=0,h=l.length;c<h;c++)for(var d=l[c],p=0,f=d.vertexNormals.length;p<f;p++){var m=a[d[i[p]]],g=d.vertexNormals[p];e.copy(m).applyMatrix4(r),t.copy(g).applyMatrix3(n).normalize().multiplyScalar(this.size).add(e),o.setXYZ(u,e.x,e.y,e.z),u+=1,o.setXYZ(u,t.x,t.y,t.z),u+=1}else if(s&&s.isBufferGeometry){var v=s.attributes.position,y=s.attributes.normal;for(u=0,p=0,f=v.count;p<f;p++)e.set(v.getX(p),v.getY(p),v.getZ(p)).applyMatrix4(r),t.set(y.getX(p),y.getY(p),y.getZ(p)),t.applyMatrix3(n).normalize().multiplyScalar(this.size).add(e),o.setXYZ(u,e.x,e.y,e.z),u+=1,o.setXYZ(u,t.x,t.y,t.z),u+=1}o.needsUpdate=!0}}(),Ec.prototype=Object.create(ur.prototype),Ec.prototype.constructor=Ec,Ec.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},Ec.prototype.update=function(){var e=new Nt,t=new Nt;return function(){this.light.updateMatrixWorld();var n=this.light.distance?this.light.distance:1e3,i=n*Math.tan(this.light.angle);this.cone.scale.set(i,i,n),e.setFromMatrixPosition(this.light.matrixWorld),t.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(t.sub(e)),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}(),Tc.prototype=Object.create(Vs.prototype),Tc.prototype.constructor=Tc,Tc.prototype.updateMatrixWorld=function(){var e=new Nt,t=new Dt,n=new Dt;return function(i){var r=this.bones,o=this.geometry,s=o.getAttribute("position");n.getInverse(this.root.matrixWorld);for(var a=0,l=0;a<r.length;a++){var u=r[a];u.parent&&u.parent.isBone&&(t.multiplyMatrices(n,u.matrixWorld),e.setFromMatrixPosition(t),s.setXYZ(l,e.x,e.y,e.z),t.multiplyMatrices(n,u.parent.matrixWorld),e.setFromMatrixPosition(t),s.setXYZ(l+1,e.x,e.y,e.z),l+=2)}o.getAttribute("position").needsUpdate=!0,ur.prototype.updateMatrixWorld.call(this,i)}}(),Cc.prototype=Object.create(zr.prototype),Cc.prototype.constructor=Cc,Cc.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Cc.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},Pc.prototype=Object.create(ur.prototype),Pc.prototype.constructor=Pc,Pc.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Pc.prototype.update=function(){var e=.5*this.light.width,t=.5*this.light.height,n=this.line.geometry.attributes.position,i=n.array;i[0]=e,i[1]=-t,i[2]=0,i[3]=e,i[4]=t,i[5]=0,i[6]=-e,i[7]=t,i[8]=0,i[9]=-e,i[10]=-t,i[11]=0,i[12]=e,i[13]=-t,i[14]=0,n.needsUpdate=!0,void 0!==this.color?this.line.material.color.set(this.color):this.line.material.color.copy(this.light.color)},Rc.prototype=Object.create(ur.prototype),Rc.prototype.constructor=Rc,Rc.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Rc.prototype.update=function(){var e=new Nt,t=new nr,n=new nr;return function(){var i=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var r=i.geometry.getAttribute("color");t.copy(this.light.color),n.copy(this.light.groundColor);for(var o=0,s=r.count;o<s;o++){var a=o<s/2?t:n;r.setXYZ(o,a.r,a.g,a.b)}r.needsUpdate=!0}i.lookAt(e.setFromMatrixPosition(this.light.matrixWorld).negate())}}(),Lc.prototype=Object.create(Vs.prototype),Lc.prototype.constructor=Lc,Oc.prototype=Object.create(Vs.prototype),Oc.prototype.constructor=Oc,Dc.prototype=Object.create(Vs.prototype),Dc.prototype.constructor=Dc,Dc.prototype.update=function(){var e=new Nt,t=new Nt,n=new kt;return function(){this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);for(var i=this.object.matrixWorld,r=this.geometry.attributes.position,o=this.object.geometry,s=o.vertices,a=o.faces,l=0,u=0,c=a.length;u<c;u++){var h=a[u],d=h.normal;e.copy(s[h.a]).add(s[h.b]).add(s[h.c]).divideScalar(3).applyMatrix4(i),t.copy(d).applyMatrix3(n).normalize().multiplyScalar(this.size).add(e),r.setXYZ(l,e.x,e.y,e.z),l+=1,r.setXYZ(l,t.x,t.y,t.z),l+=1}r.needsUpdate=!0}}(),Ic.prototype=Object.create(ur.prototype),Ic.prototype.constructor=Ic,Ic.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},Ic.prototype.update=function(){var e=new Nt,t=new Nt,n=new Nt;return function(){e.setFromMatrixPosition(this.light.matrixWorld),t.setFromMatrixPosition(this.light.target.matrixWorld),n.subVectors(t,e),this.lightPlane.lookAt(n),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(n),this.targetLine.scale.z=n.length()}}(),Nc.prototype=Object.create(Vs.prototype),Nc.prototype.constructor=Nc,Nc.prototype.update=function(){var e,t,n=new Nt,i=new cr;function r(r,o,s,a){n.set(o,s,a).unproject(i);var l=t[r];if(void 0!==l)for(var u=e.getAttribute("position"),c=0,h=l.length;c<h;c++)u.setXYZ(l[c],n.x,n.y,n.z)}return function(){e=this.geometry,t=this.pointMap;var n=1,o=1;i.projectionMatrix.copy(this.camera.projectionMatrix),r("c",0,0,-1),r("t",0,0,1),r("n1",-n,-o,-1),r("n2",n,-o,-1),r("n3",-n,o,-1),r("n4",n,o,-1),r("f1",-n,-o,1),r("f2",n,-o,1),r("f3",-n,o,1),r("f4",n,o,1),r("u1",.7*n,1.1*o,-1),r("u2",.7*-n,1.1*o,-1),r("u3",0,2*o,-1),r("cf1",-n,0,1),r("cf2",n,0,1),r("cf3",0,-o,1),r("cf4",0,o,1),r("cn1",-n,0,-1),r("cn2",n,0,-1),r("cn3",0,-o,-1),r("cn4",0,o,-1),e.getAttribute("position").needsUpdate=!0}}(),kc.prototype=Object.create(Vs.prototype),kc.prototype.constructor=kc,kc.prototype.update=function(){var e=new $t;return function(t){if(void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&e.setFromObject(this.object),!e.isEmpty()){var n=e.min,i=e.max,r=this.geometry.attributes.position,o=r.array;o[0]=i.x,o[1]=i.y,o[2]=i.z,o[3]=n.x,o[4]=i.y,o[5]=i.z,o[6]=n.x,o[7]=n.y,o[8]=i.z,o[9]=i.x,o[10]=n.y,o[11]=i.z,o[12]=i.x,o[13]=i.y,o[14]=n.z,o[15]=n.x,o[16]=i.y,o[17]=n.z,o[18]=n.x,o[19]=n.y,o[20]=n.z,o[21]=i.x,o[22]=n.y,o[23]=n.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),kc.prototype.setFromObject=function(e){return this.object=e,this.update(),this},Vc.prototype=Object.create(Vs.prototype),Vc.prototype.constructor=Vc,Vc.prototype.updateMatrixWorld=function(e){var t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),ur.prototype.updateMatrixWorld.call(this,e))},Uc.prototype=Object.create(ks.prototype),Uc.prototype.constructor=Uc,Uc.prototype.updateMatrixWorld=function(e){var t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.lookAt(this.plane.normal),ur.prototype.updateMatrixWorld.call(this,e)},Fc.prototype=Object.create(ur.prototype),Fc.prototype.constructor=Fc,Fc.prototype.setDirection=function(){var e,t=new Nt;return function(n){n.y>.99999?this.quaternion.set(0,0,0,1):n.y<-.99999?this.quaternion.set(1,0,0,0):(t.set(n.z,0,-n.x).normalize(),e=Math.acos(n.y),this.quaternion.setFromAxisAngle(t,e))}}(),Fc.prototype.setLength=function(e,t,n){void 0===t&&(t=.2*e),void 0===n&&(n=.2*t),this.line.scale.set(1,Math.max(0,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()},Fc.prototype.setColor=function(e){this.line.material.color.copy(e),this.cone.material.color.copy(e)},zc.prototype=Object.create(Vs.prototype),zc.prototype.constructor=zc;function jc(e){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Ul.call(this,e),this.type="catmullrom",this.closed=!0}function Bc(e){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Ul.call(this,e),this.type="catmullrom"}function $c(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),Ul.call(this,e),this.type="catmullrom"}Rl.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(Rl.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},Object.assign(iu.prototype,{createPointsGeometry:function(e){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getPoints(e);return this.createGeometry(t)},createSpacedPointsGeometry:function(e){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getSpacedPoints(e);return this.createGeometry(t)},createGeometry:function(e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var t=new fr,n=0,i=e.length;n<i;n++){var r=e[n];t.vertices.push(new Nt(r.x,r.y,r.z||0))}return t}}),Object.assign(ru.prototype,{fromPoints:function(e){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)}}),jc.prototype=Object.create(Ul.prototype),Bc.prototype=Object.create(Ul.prototype),$c.prototype=Object.create(Ul.prototype),Object.assign($c.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),Lc.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Tc.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(Du.prototype,{extractUrlBase:function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Iu.extractUrlBase(e)}}),Object.assign(_c.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign($t.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),Ur.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Object.assign(Lt,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),Lt.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),Lt.ceilPowerOfTwo(e)}}),Object.assign(kt.prototype,{flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(e){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(Dt.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},getPosition:function(){var e;return function(){return void 0===e&&(e=new Nt),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),e.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(e){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,t,n,i,r,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,i,n,r,o)}}),Gt.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},It.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Object.assign(Vr.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(Fr.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},midpoint:function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},normal:function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},plane:function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)}}),Object.assign(Fr,{barycoordFromPoint:function(e,t,n,i,r){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Fr.getBarycoord(e,t,n,i,r)},normal:function(e,t,n,i){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Fr.getNormal(e,t,n,i)}}),Object.assign(ou.prototype,{extractAllPoints:function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Ba(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Qa(this,e)}}),Object.assign(Ot.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Nt.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,t,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Ft.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(fr.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}}),Object.assign(ur.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")}}),Object.defineProperties(ur.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(Ls.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Os.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Object.defineProperty(Rl.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),_s.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(su.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(mr.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")}}),Object.assign(Cr.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addDrawCall:function(e,t,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(Cr.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.assign($a.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(cc.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(Ir.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new nr}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=e===v}}}),Object.defineProperties(fl.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(kr.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Object.assign(Es.prototype,{getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")}}),Object.defineProperties(Es.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(gs.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(zt.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Object.defineProperties(Ss.prototype,{standing:{set:function(){console.warn("THREE.WebVRManager: .standing has been removed.")}}}),Ku.prototype.load=function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this,n=new Yu;return n.load(e,(function(e){t.setBuffer(e)})),this},ec.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Zu.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)};const Hc=1e-6;function Gc(e){return Math.abs(e)<Hc}function Wc(e,t,n){return new Nt(e,t,n)}function qc(e){return e.clone()}function Yc(e,t){let n=Wc(e.x,e.y,e.z);return n.multiplyScalar(t),n}function Xc(e){return Yc(e,1/e.length())}function Zc(e,t){return Wc(e.x-t.x,e.y-t.y,e.z-t.z)}function Jc(e,t){return Wc(t.x+e.x,t.y+e.y,t.z+e.z)}function Kc(e,t){let n,i=t.length();if(Gc(i))n=Wc(e.x,e.y,e.z);else{let r=th(e,t)/i/i;n=Yc(t,r)}return n}function Qc(e,t){return Zc(e,Kc(e,t))}function eh(e,t){return(new Nt).crossVectors(e,t)}function th(e,t){return e.x*t.x+e.y*t.y+e.z*t.z}function nh(e,t){return Zc(e,t).length()}function ih(e,t){let n=e.length(),i=t.length();if(Gc(n*i))return 0;let r=th(e,t)/n/i;return r>=1?0:r<-1?Math.PI:Math.acos(r)}function rh(e,t,n){let i=Qc(e,t),r=Qc(n,t),o=ih(i,r),s=eh(i,r);return th(s,t)>0&&(o=-o),o}function oh(e,t){let n=Jc(e,t);return Yc(n,.5)}function sh(){return Wc(Math.random(),Math.random(),Math.random())}function ah(e,t){return!!Gc(e.x-t.x)&&(!!Gc(e.y-t.y)&&!!Gc(e.y-t.y))}function lh(e,t){return Gc(ih(e,t))}let uh=Dt;function ch(e,t){let n=new uh;return n.multiplyMatrices(e,t),n}function hh(e,t){let n=e.clone().normalize();return(new uh).makeRotationAxis(n,t)}function dh(e){let t=new uh;return t.makeTranslation(e.x,e.y,e.z)}function ph(e){return e*Math.PI/180}var fh={SMALL:Hc,isNearZero:Gc,create:Wc,clone:qc,scaled:Yc,normalized:Xc,diff:Zc,sum:Jc,parallel:Kc,perpendicular:Qc,crossProduct:eh,dotProduct:th,distance:nh,angle:ih,dihedral:rh,midPoint:oh,random:sh,isEqual:ah,isAligned:lh,Matrix4:uh,matrixProduct:ch,rotation:hh,translation:dh,degToRad:ph};function mh(e){return!s.a.isNil(e)}function gh(e,t,n){return r()("<span>").html(e).addClass(t).on("click touch",(function(e){e.preventDefault(),n()}))}function vh(e,t,n,i){t.css({position:"absolute","z-index":"2"});let r=e.position().top,o=e.position().left;r=0,o=0;let s=e.outerWidth(),a=e.outerHeight();e.prepend(t);let l=t.outerWidth(),u=t.outerHeight();t.css({top:r+a/2-u/2-i,left:o+s/2-l/2-n})}function yh(e,t){return t.indexOf(e)>=0}function xh(e){let t="0123456789abcdefghiklmnopqrstuvwxyz",n="";for(let i=0;i<e;i++){let e=Math.floor(Math.random()*t.length);n+=t.substring(e,e+1)}return n}function bh(){return"view:"+xh(6)}function wh(e,t,n){function i(){h.remove(),window.keyboardLock=!1}function o(){n(u.val()),i(),window.keyboardLock=!1}function s(){i(),window.keyboardLock=!1}t||(t=""),window.keyboardLock=!0;let a=gh("okay","jolecule-small-button",o),l=gh("discard","jolecule-small-button",s),u=r()("<textarea>").css("width","100%").css("margin-bottom","0.5em").addClass("jolecule-view-text").keydown((function(e){if(27===e.keyCode)return s(),!0})),c=r()("<div>").css("width","100%").append(t).append(u).append(a).append(" ").append(l),h=r()("<div>").addClass("jolecule-dialog").css("display","block").css("z-index","2000").css("width",Math.min(400,e.width()-100)).append(c);vh(e,h,0,20),setTimeout(()=>{c.find("textarea").focus()},100)}function _h(e){return new Promise(t=>{setTimeout(t,e)})}function Ah(e){let t=document.createElement("textarea");t.style.position="fixed",t.style.top=0,t.style.left=0,t.style.width="2em",t.style.height="2em",t.style.padding=0,t.style.border="none",t.style.outline="none",t.style.boxShadow="none",t.style.background="transparent",t.value=e,document.body.appendChild(t),t.select();try{let e=document.execCommand("copy"),t=e?"successful":"unsuccessful";console.log("> copyTextToClipboard",t)}catch(n){console.log("> copyTextToClipboard failed")}document.body.removeChild(t)}function Sh(e,t,n,i,r){let o=.5*(i-t),s=.5*(r-n),a=e*e,l=e*a;return(2*n-2*i+o+s)*l+(-3*n+3*i-2*o-s)*a+o*e+n}function Eh(e,t,n,i,r){return fh.create(Sh(e,t.x,n.x,i.x,r.x),Sh(e,t.y,n.y,i.y,r.y),Sh(e,t.z,n.z,i.z,r.z))}class Mh{constructor(){this.points=[],this.normals=[],this.tangents=[],this.binormals=[],this.colors=[],this.indexColors=[],this.segmentTypes=[],this.refIndices=[]}slice(e,t){let n=new Mh;return n.points=this.points.slice(e,t),n.normals=this.normals.slice(e,t),n.tangents=this.tangents.slice(e,t),n.binormals=this.binormals.slice(e,t),n}}function Th(e,t,n,i){let r=new Mh;r.points.push(e.points[n]);for(let o=n;o<i-1;o+=1){let n=1,i=t+1;for(let s=n;s<i;s+=1){let n,i,a=s/t;n=o>0?e.points[o-1]:e.points[o].clone().sub(e.tangents[o]),i=o<e.points.length-2?e.points[o+2]:e.points[o+1].clone().add(e.tangents[o]),r.points.push(Eh(a,n,e.points[o],e.points[o+1],i))}}r.normals.push(e.normals[n]);for(let o=n;o<i-1;o+=1)for(let n=1;n<t+1;n+=1){let i,s,a=n/t;i=o>0?e.normals[o-1]:e.normals[o],s=o<e.normals.length-2?e.normals[o+2]:e.normals[o+1],r.normals.push(Eh(a,i,e.normals[o],e.normals[o+1],s).normalize())}for(let o=0;o<r.points.length;o+=1)0===o?r.tangents.push(e.tangents[0]):o===r.points.length-1?r.tangents.push(e.tangents[i-1]):r.tangents.push(r.points[o+1].clone().sub(r.points[o-1]).normalize());for(let o=0;o<r.points.length;o+=1)r.binormals.push(fh.create().crossVectors(r.tangents[o],r.normals[o]));return r}class Ch extends Mh{constructor(){super(),this.indices=[],this.detail=4}getReference(e){let t=this.indices[e];return this.referenceObjects[t]}calcTangents(){let e=0,t=this.points.length,n=t-1;if(t-e>2){this.tangents[e]=this.points[e+1].clone().sub(this.points[e]).normalize();for(let t=e+1;t<n;t+=1)this.tangents[t]=this.points[t+1].clone().sub(this.points[t-1]).normalize();this.tangents[n]=this.points[n].clone().sub(this.points[n-1]).normalize()}else{let t=this.points[n].clone().sub(this.points[e]).normalize();this.tangents[e]=t,this.tangents[n]=t}}calcNormals(){let e=0,t=this.points.length,n=t-1;if(t-e>2){for(let t=e+1;t<n;t+=1)if(null!==this.normals[t])this.normals[t]=Ih(this.tangents[t],this.normals[t]),this.normals[t].normalize();else{let e=this.points[t].clone().sub(this.points[t-1]);this.normals[t]=fh.create().crossVectors(e,this.tangents[t]).normalize();let n=this.normals[t-1];null!==n&&this.normals[t].dot(n)<0&&this.normals[t].negate()}this.normals[e]=this.normals[e+1],this.normals[n]=this.normals[n-1]}else for(let i=e;i<=n;i+=1)if(null!==this.normals[i])this.normals[i]=Ih(this.tangents[i],this.normals[i]),this.normals[i].normalize();else{let e=this.points[i];this.normals[i]=fh.create().crossVectors(e,this.tangents[i]).normalize()}}calcBinormals(){let e=0,t=this.points.length;for(let n=e;n<t;n+=1)this.binormals[n]=fh.create().crossVectors(this.tangents[n],this.normals[n])}expand(){this.detailedPath=Th(this,2*this.detail,0,this.points.length)}getGeometry(e,t,n,i,r){let o=this.detailedPath,s=0,a=this.points.length,l=2*s*this.detail-this.detail;l<0&&(l=0);let u=2*a*this.detail-this.detail+1;u>=o.points.length&&(u=o.points.length-1);let c=o.slice(l,u),h=new Ph(this,c,t,n,i,r);return h}}class Ph extends Cr{constructor(e,t,n=!1){super(),this.type="BufferRibbonGeometry",this.parameters={shape:t,traces:e,isIndexColor:n},this.shapePoints=t.extractPoints(4).shape,this.nShape=this.shapePoints.length,this.nVertex=0,this.nFace=0,this.countVertexAndFacesOfPath(),this.setAttributes(),this.build(),this.setColors()}countVertexAndFacesOfPath(){this.nVertex=0,this.nFace=0,this.paths=[];for(let e of this.parameters.traces){let t=e.detailedPath;this.paths.push(t);let n=t.points.length;this.nVertex+=(n+e.points.length-1)*this.nShape,this.nVertex+=this.nShape,this.nVertex+=this.nShape;let i=e.points.length;this.nFace+=2*(i-1)*this.nShape*(2*e.detail+1),this.nFace+=this.nShape-2,this.nFace+=this.nShape-2,this.nVertex=3*this.nFace}}build(){for(let i of s.a.range(this.paths.length)){let r=this.paths[i],o=this.parameters.traces[i],a=0,l=o.points.length;function e(e){return"C"===o.segmentTypes[e]?.7:8}let u=null,c=null,h=null,d=null,p=!0;for(let i=a;i<l;i+=1){let f=2*i*o.detail-o.detail;f<0&&(f=0);let m=2*(i+1)*o.detail-o.detail+1;m>=r.points.length&&(m=r.points.length);for(let g=f;g<m;g+=1){let v=e(i),y=.7;if(g===f&&g>0&&"C"===o.segmentTypes[i-1]&&"C"!==o.segmentTypes[i]&&(v=e(i-1)),g===m-1&&i<o.points.length-1){let t=i+1;"C"===o.segmentTypes[t]&&"C"!==o.segmentTypes[i]&&(v=e(t))}p="C"!==o.segmentTypes[i];let x=r.points[g],b=r.normals[g],w=r.binormals[g],_=s.a.cloneDeep(this.shapePoints);for(let e of _)e.x=e.x*v,e.y=e.y*y;u=[];for(let e of _){let t=b.clone().multiplyScalar(e.x),n=w.clone().multiplyScalar(e.y),i=x.clone().add(t).add(n);u.push(i)}let A=0===g&&i===a;if(A){let e=_.length,t=e-1,n=Nh([u[0],u[1],u[t]]);for(let i=0;i<e-2;i+=1)this.pushVerticesNormalsOfFace(u[i],u[i+1],u[t],n,n,n)}function t(e){let t,n,i=_.length,o=[],s=new Ot,a=new Ot,l=new Ot;for(let u=0;u<i;u+=1){let c=u>0?u-1:i-1,h=u+1<i?u+1:0,d=_[u];s.subVectors(d,_[c]).normalize(),a.subVectors(d,_[h]).normalize(),l.addVectors(s,a).normalize(),t=r.normals[e].clone().multiplyScalar(l.x),n=r.binormals[e].clone().multiplyScalar(l.y),o.push(t.add(n))}return o}function n(e){let t,n,i=_.length,o=[],s=new Ot;for(let a=0;a<i;a+=1){let l=a>0?a-1:i-1,u=_[a];s.subVectors(u,_[l]).normalize(),t=r.normals[e].clone().multiplyScalar(s.x),n=r.binormals[e].clone().multiplyScalar(s.y),o.push(t.add(n))}return o}if(h=p?n(g):t(g),0===g){d=h,c=u;continue}for(let e=0;e<this.nShape;e+=1){let t;t=0===e?this.nShape-1:e-1,p?(this.pushVerticesNormalsOfFace(c[t],u[t],u[e],d[t],h[t],h[t]),this.pushVerticesNormalsOfFace(c[e],c[t],u[e],d[t],d[t],h[t])):(this.pushVerticesNormalsOfFace(c[t],u[t],u[e],d[t],h[t],h[e]),this.pushVerticesNormalsOfFace(c[e],c[t],u[e],d[e],d[t],h[e]))}let S=g===m-1&&i===l-1;if(S){let e=_.length,t=e-1,n=Nh([u[2],u[1],u[0]]);for(let i=0;i<e-2;i+=1)this.pushVerticesNormalsOfFace(u[t],u[i+1],u[i],n,n,n)}d=h,c=u}}}}setColors(){let e=0;for(let t of s.a.range(this.paths.length)){let n=this.paths[t],i=this.parameters.traces[t],r=0,o=i.points.length;for(let t=r;t<o;t+=1){let s=2*t*i.detail-i.detail;s<0&&(s=0);let a=2*(t+1)*i.detail-i.detail+1;a>=n.points.length&&(a=n.points.length);for(let n=s;n<a;n+=1){let s,l=this.shapePoints.length;s=this.parameters.isIndexColor?i.indexColors[t]:i.colors[t].clone();let u=0===n&&t===r;if(u)for(let t=0;t<3*(l-2);t+=1)this.setColor(e,s),e+=1;if(n>0)for(let t=0;t<6*l;t+=1)this.setColor(e,s),e+=1;let c=n===a-1&&t===o-1;if(c)for(let t=0;t<3*(l-2);t+=1)this.setColor(e,s),e+=1}}}this.attributes.color.needsUpdate=!0}setAttributes(){let e=new Float32Array(3*this.nVertex),t=new Float32Array(3*this.nVertex),n=new Int32Array(3*this.nFace),i=new Float32Array(3*this.nVertex);this.addAttribute("position",new Ar(e,3)),this.addAttribute("normal",new Ar(t,3)),this.addAttribute("color",new Ar(i,3)),this.setIndex(new _r(n,1)),this.positions=this.attributes.position.array,this.normals=this.attributes.normal.array,this.indices=this.index.array,this.colors=this.attributes.color.array,this.positionCount=0,this.indexCount=0,this.vertexCount=0}setColor(e,t){let n=3*e;this.colors[n]=t.r,this.colors[n+1]=t.g,this.colors[n+2]=t.b}pushVertex(e){this.positions[this.positionCount]=e.x,this.positions[this.positionCount+1]=e.y,this.positions[this.positionCount+2]=e.z,this.positionCount+=3,this.vertexCount+=1}pushVerticesNormalsOfFace(e,t,n,i,r,o){this.pushVertex(e),this.pushVertex(t),this.pushVertex(n);let s=this.indexCount;this.indices[this.indexCount]=s,this.indices[this.indexCount+1]=s+1,this.indices[this.indexCount+2]=s+2,this.indexCount+=3;let a=s+1,l=s+2;this.normals[3*s]=i.x,this.normals[3*s+1]=i.y,this.normals[3*s+2]=i.z,this.normals[3*a]=r.x,this.normals[3*a+1]=r.y,this.normals[3*a+2]=r.z,this.normals[3*l]=o.x,this.normals[3*l+1]=o.y,this.normals[3*l+2]=o.z}getVertex(e){return fh.create(this.positions[3*e],this.positions[3*e+1],this.positions[3*e+2])}}class Rh extends Cr{constructor(e,t,n){super(),this.type="BufferRaisedShapesGeometry",this.parameters={verticesList:e,thickness:n,colorList:t},this.nVertex=0,this.nFace=0,this.countVertexAndFacesOfPath(),this.setAttributes(),this.setPath()}countVertexAndFacesOfPath(e,t){this.nVertex=0,this.nFace=0;for(let n of this.parameters.verticesList){let e=n.length;this.nFace+=e-2,this.nFace+=e-2,this.nFace+=2*e}this.nVertex=3*this.nFace}setPath(){for(let[e,t]of this.parameters.verticesList.entries()){let n=Nh(t.slice(0,3)),i=n.clone().multiplyScalar(this.parameters.thickness/2),r=this.parameters.colorList[e],o=t.length,s=o-1,a=[];for(let e=0;e<t.length;e+=1)a.push(t[e].clone().add(i));let l=[];for(let e=0;e<t.length;e+=1)l.push(t[e].clone().sub(i));for(let e=0;e<o-2;e+=1)this.pushVerticesOfFace(a[e],a[e+1],a[s],r);for(let e=0;e<o-2;e+=1)this.pushVerticesOfFace(l[e],l[s],l[e+1],r);for(let e=0;e<o;e+=1){let t=e===o-1?0:e+1;this.pushVerticesOfFace(a[e],l[e],l[t],r),this.pushVerticesOfFace(a[e],l[t],a[t],r)}}this.computeVertexNormals()}setColor(e,t){let n=3*e;this.colors[n]=t.r,this.colors[n+1]=t.g,this.colors[n+2]=t.b}recolor(e){this.parameters.colorList=e;let t=0;for(let[n,i]of this.parameters.verticesList.entries()){let e=this.parameters.colorList[n],r=i.length,o=6*(r-2)+6*r;for(let n=0;n<o;n+=1)this.setColor(t,e),t+=1}this.attributes.color.needsUpdate=!0}setAttributes(){let e=new Float32Array(3*this.nVertex),t=new Float32Array(3*this.nVertex),n=new Int32Array(3*this.nFace),i=new Float32Array(3*this.nVertex);this.addAttribute("position",new Ar(e,3)),this.addAttribute("normal",new Ar(t,3)),this.addAttribute("color",new Ar(i,3)),this.setIndex(new _r(n,1)),this.positions=this.attributes.position.array,this.normals=this.attributes.normal.array,this.indices=this.index.array,this.colors=this.attributes.color.array,this.positionCount=0,this.indexCount=0,this.vertexCount=0}pushVertex(e,t){this.positions[this.positionCount]=e.x,this.positions[this.positionCount+1]=e.y,this.positions[this.positionCount+2]=e.z,this.colors[this.positionCount]=t.r,this.colors[this.positionCount+1]=t.g,this.colors[this.positionCount+2]=t.b,this.positionCount+=3,this.vertexCount+=1}pushVerticesOfFace(e,t,n,i){this.pushVertex(e,i),this.pushVertex(t,i),this.pushVertex(n,i);let r=this.indexCount;this.indices[this.indexCount]=r,this.indices[this.indexCount+1]=r+1,this.indices[this.indexCount+2]=r+2,this.indexCount+=3}getVertex(e){return fh.create(this.positions[3*e],this.positions[3*e+1],this.positions[3*e+2])}}class Lh extends Ba{constructor(){let e=new ou([new Ot(-.25,-.5),new Ot(0,.5),new Ot(.25,-.5)]),t=new Ul([fh.create(0,-.2,0),fh.create(0,.2,0)]);super(e,{steps:2,bevelEnabled:!1,extrudePath:t}),this.type="BlockArrowGeometry",this.applyMatrix((new Dt).makeRotationFromEuler(new sr(0,Math.PI/2,0)))}}function Oh(e,t){s.a.isUndefined(e)||e.traverse((function(e){e.visible=t}))}function Dh(e){let t=e.children.length-1;for(let n=t;n>=0;n-=1){let t=e.children[n];s.a.isUndefined(t.dontDelete)&&(s.a.isUndefined(t.geometry)||t.geometry.dispose(),s.a.isUndefined(t.material)||t.material.dispose(),e.remove(t))}}function Ih(e,t){let n=e.clone().multiplyScalar(t.dot(e));return t.clone().sub(n)}function Nh(e){let t=new Nt,n=new Nt;return t.subVectors(e[2],e[1]),n.subVectors(e[0],e[1]),t.cross(n),t.normalize(),t}function kh(e,t){return(new It).setFromUnitVectors(e,t)}function Vh(e,t,n){return n*(t-e)+e}function Uh(e,t){let n=new It;return n.slerp(e,t)}function Fh(e,t){let n=new ur;return n.matrix.identity(),n.position.copy(e),n.scale.set(t,t,t),n.updateMatrix(),n.matrix}function zh(e,t){s.a.isUndefined(t)&&(t=4);let n=new rl(e,e,1,t,1,!1);return n.applyMatrix((new Dt).makeRotationFromEuler(new sr(Math.PI/2,Math.PI,0))),n}function jh(e,t,n){let i=new ur;return i.scale.set(n,n,e.distanceTo(t)),i.position.copy(e).add(t).multiplyScalar(.5),i.lookAt(t),i.updateMatrix(),i.matrix}function Bh(e,t,n,i){let r=e.elements;for(let o=n;o<i;o+=3){let e=t[o],n=t[o+1],i=t[o+2];t[o]=r[0]*e+r[4]*n+r[8]*i+r[12],t[o+1]=r[1]*e+r[5]*n+r[9]*i+r[13],t[o+2]=r[2]*e+r[6]*n+r[10]*i+r[14]}}function $h(e,t,n,i){let r=e.elements;for(let o=n;o<i;o+=3){let e=t[o],n=t[o+1],i=t[o+2];t[o]=r[0]*e+r[4]*n+r[8]*i,t[o+1]=r[1]*e+r[5]*n+r[9]*i,t[o+2]=r[2]*e+r[6]*n+r[10]*i}}function Hh(e,t){let n=e.length,i=new Float32Array(n*t);for(let r=0;r<t;r+=1){let t=r*n;for(let r=0;r<n;r+=1)i[t+r]=e[r]}return i}function Gh(e,t,n,i){for(let r=n;r<i;r+=3)t[r]=e.r,t[r+1]=e.g,t[r+2]=e.b}function Wh(e,t,n){let i=e.length,r=new Uint32Array(i*t);for(let o=0;o<t;o+=1){let t=o*i,s=o*n;for(let n=0;n<i;n+=1)r[t+n]=e[n]+s}return r}class qh extends Cr{constructor(e,t){super(),this.type="CopyBufferGeometry",this.parameters={nCopy:t},this.refBufferGeometry=e;let n=Hh(e.attributes.position.array,t);this.addAttribute("position",new Ar(n,3));let i=Hh(e.attributes.normal.array,t);this.addAttribute("normal",new Ar(i,3));let r=Hh(e.attributes.uv.array,t);this.addAttribute("uv",new Ar(r,2));let o=e.attributes.position.count;if("index"in e&&e.index){let n=Wh(e.index.array,t,o);this.setIndex(new _r(n,1))}let s=new Float32Array(3*o*t);this.addAttribute("color",new Ar(s,3))}applyMatrixToCopy(e,t){let n=this.refBufferGeometry.attributes.position.array.length,i=this.attributes.position.array,r=this.attributes.normal.array,o=t*n,s=o+n;Bh(e,i,o,s),$h(e,r,o,s)}applyColorToCopy(e,t){let n=this.refBufferGeometry.attributes.position.array.length,i=this.attributes.color.array,r=t*n,o=r+n;Gh(e,i,r,o)}}class Yh{constructor(){this.id="view:000000",this.iAtom=-1,this.order=1,this.cameraParams={focus:fh.create(0,0,0),position:fh.create(0,0,-1),up:fh.create(0,1,0),zFront:0,zBack:0,zoom:1},this.selected=[],this.labels=[],this.distances=[],this.selectedTraces=[],this.text="Default view of PDB file",this.userId="",this.pdbId="",this.show={sidechain:!0,peptide:!0,hydrogen:!1,water:!1,ligands:!0,trace:!0,backbone:!1,ribbon:!0,sphere:!1,transparent:!1},this.grid={isElem:{},bCutoff:null,isChanged:!1},this.lock=!1,this.creator="public"}setCamera(e){this.cameraParams=e}getViewTranslatedTo(e){let t=this.clone(),n=e.clone().sub(t.cameraParams.focus);return t.cameraParams.focus.copy(e),t.cameraParams.position.add(n),t}clone(){let e=new Yh;return e.id=this.id,e.pdbId=this.pdbId,e.iAtom=this.iAtom,e.selected=this.selected,e.selectedTraces=s.a.cloneDeep(this.selectedTraces),e.labels=s.a.cloneDeep(this.labels),e.distances=s.a.cloneDeep(this.distances),e.order=this.order,e.text=this.text,e.time=this.time,e.cameraParams=s.a.cloneDeep(this.cameraParams),e.show=s.a.cloneDeep(this.show),e.grid=s.a.cloneDeep(this.grid),e.lock=this.lock,e.creator=this.creator,e}getDict(){let e=this.cameraParams.focus.clone().sub(this.cameraParams.position),t=e.length();e.normalize();let n=this.cameraParams.focus,i=n.clone().add(e),r=n.clone().sub(this.cameraParams.up),o=s.a.clone(this.show);return o.all_atom=o.backbone,delete o.backbone,{version:2,view_id:this.id,user_id:this.userId,pdb_id:this.pdbId,order:this.order,show:o,grid:s.a.cloneDeep(this.grid),text:this.text,i_atom:this.iAtom,labels:this.labels,selected:this.selected,selected_traces:this.selectedTraces,distances:this.distances,camera:{slab:{z_front:this.cameraParams.zFront,z_back:this.cameraParams.zBack,zoom:t},pos:[n.x,n.y,n.z],up:[r.x,r.y,r.z],in:[i.x,i.y,i.z]},lock:this.lock,creator:this.creator}}setFromDict(e){this.id=e.view_id,this.pdbId=e.pdb_id,this.lock=e.lock,this.creator=e.creator,this.text=e.text,this.userId=e.user_id,this.order=e.order,this.resId=e.resId,this.iAtom=e.i_atom,this.labels=e.labels,this.selected=e.selected,this.distances=e.distances;for(let c of s.a.keys(e.show))c in this.show&&(this.show[c]=!!e.show[c]),"all_atom"===c&&(this.show.backbone=!!e.show.all_atom);this.show.backbone||this.show.trace||this.show.ribbon||(this.show.ribbon=!0),this.show.all_atom||this.show.trace||this.show.ribbon||(this.show.backbone=!0),"grid"in e&&(this.grid=e.grid),"selected_traces"in e&&(this.selectedTraces=s.a.cloneDeep(e["selected_traces"]));let t=fh.create(e.camera.pos[0],e.camera.pos[1],e.camera.pos[2]),n=fh.create(e.camera.up[0],e.camera.up[1],e.camera.up[2]),i=fh.create(e.camera.in[0],e.camera.in[1],e.camera.in[2]),r=e.camera.slab.zoom,o=fh.clone(t),a=fh.clone(i).sub(o).multiplyScalar(r).negate(),l=fh.clone(o).add(a),u=fh.clone(n).sub(o).negate();this.cameraParams={focus:o,position:l,up:u,zFront:e.camera.slab.z_front,zBack:e.camera.slab.z_back,zoom:r}}}function Xh(e,t,n){let i=e.position.clone().sub(e.focus),r=i.length();i.normalize();let o=t.position.clone().sub(t.focus),s=o.length();o.normalize();let a=kh(i,o),l=e.up.clone().applyQuaternion(a),u=kh(l,t.up).multiply(a),c=Uh(u,n),h=t.focus.clone().sub(e.focus).multiplyScalar(n),d=e.focus.clone().add(h),p=Vh(r,s,n),f=i.clone().applyQuaternion(c).multiplyScalar(p);return{focus:d,position:d.clone().add(f),up:e.up.clone().applyQuaternion(c),zFront:Vh(e.zFront,t.zFront,n),zBack:Vh(e.zBack,t.zBack,n),zoom:p}}class Zh{constructor(e){this.soup=e,this.isChanged=!0,this.isUpdateSidechain=!1,this.isUpdateColors=!1,this.isStartTargetAfterRender=!1,this.isUpdateObservers=!0,this.currentView=new Yh,this.savedViewsByViewId={},this.savedViews=[],this.iLastViewSelected=0,this.animateState="none",this.targetView=null,this.nUpdateStep=-1,this.maxUpdateStep=70,this.msPerStep=17,this.mode="normal"}build(){0!==this.savedViews.length||this.soup.isEmpty()||this.setCurrentViewToDefaultAndSave(),this.saveGridToCurrentView()}getMode(){return this.mode}setMode(e){this.mode=e}saveGridToCurrentView(){for(let e in this.soup.grid.isElem)e in this.soup.grid.isElem&&(this.currentView.grid.isElem[e]=this.soup.grid.isElem[e]);mh(this.soup.grid.bCutoff)&&(this.currentView.grid.bCutoff=this.soup.grid.bCutoff)}setCurrentViewToDefaultAndSave(){this.currentView.show.sidechain=!1,this.currentView.order=0,this.currentView.text=this.soup.title,this.currentView.pdbId=this.soup.structureIds[0],this.currentView=this.getZoomedOutViewOfCurrentView(),this.saveView(this.currentView),this.isChanged=!0}setTargetView(e){this.isStartTargetAfterRender=!0,this.saveTargetView=e.clone(),this.saveTargetView.iAtom=this.soup.getIAtomAtPosition(e.cameraParams.focus)}startTargetView(){this.targetView=this.saveTargetView,this.saveTargetView=null,this.isUpdateObservers=!0,this.isStartTargetAfterRender=!1,this.isChanged=!0}getICenteredAtom(){return this.currentView.iAtom}getIViewFromViewId(e){for(let t=0;t<this.savedViews.length;t+=1)if(this.savedViews[t].id===e)return t;return-1}insertView(e,t,n){this.savedViewsByViewId[t]=n,e>=this.savedViews.length?this.savedViews.push(n):this.savedViews.splice(e,0,n),this.iLastViewSelected=e;for(let i=0;i<this.savedViews.length;i++)this.savedViews[i].order=i}removeView(e){let t=this.getIViewFromViewId(e);if(!(t<0)){this.savedViews.splice(t,1),delete this.savedViewsByViewId[e];for(let e=0;e<this.savedViews.length;e++)this.savedViews[e].order=e;this.iLastViewSelected>=this.savedViews.length&&(this.iLastViewSelected=this.savedViews.length-1),this.isChanged=!0}}saveView(e){this.savedViewsByViewId[e.id]=e,this.savedViews.push(e)}getZoomedOutViewOf(e){let t=this.soup.calcMaxLength(),n=this.currentView.clone();if(0===t)return n;let i=n.cameraParams;i.zFront=-t/2,i.zBack=t/2,i.zoom=1.75*Math.abs(t);let r=this.soup.getCenter(e),o=i.position.clone().sub(i.focus).normalize();return i.focus.copy(r),i.position=i.focus.clone().add(o.multiplyScalar(i.zoom)),n.iAtom=this.soup.getIAtomAtPosition(r),n.selectedTraces.length=0,n}getZoomedOutViewOfCurrentView(){let e=s.a.range(this.soup.getAtomCount());return this.getZoomedOutViewOf(e)}setTargetViewByViewId(e){let t=this.savedViewsByViewId[e];this.iLastViewSelected=this.savedViewsByViewId[e].order,this.setTargetView(t)}getTracesOfChainContainingResidue(e){let t=[],n=this.soup.getResidueProxy(e),i=n.chain,r=n.iStructure;for(let[o,s]of this.soup.traces.entries())n.load(s.indices[0]),n.chain===i&&n.iStructure===r&&t.push(o);return t}setTargetViewByIAtom(e){let t=this.soup.getAtomProxy(e),n=this.currentView.getViewTranslatedTo(t.pos);n.iAtom=this.soup.getIAtomAtPosition(n.cameraParams.focus),n.selectedTraces=this.getTracesOfChainContainingResidue(t.iRes),this.setTargetView(n)}getZoomedOutViewOfSelection(){let e=this.currentView.clone(),t=[],n=this.soup.getResidueProxy();for(let l of s.a.range(this.soup.getResidueCount()))n.load(l),n.selected&&t.push(n.iAtom);let i=this.soup.getCenter(t),r=this.soup.calcMaxLength(t);if(0===r)return e;let o=e.cameraParams;o.zFront=-r/2,o.zBack=r/2,o.zoom=1.2*Math.abs(r);let a=o.position.clone().sub(o.focus).normalize();return o.focus.copy(i),o.position=o.focus.clone().add(a.multiplyScalar(o.zoom)),e.iAtom=this.soup.getIAtomAtPosition(i),e}saveCurrentView(){let e=this.currentView.clone();e.id=bh(),e.text="Click edit to change this text.",e.pdbId=this.soup.structureIds[0],e.selected=this.soup.makeSelectedResidueList(),e.selectedTraces=s.a.cloneDeep(this.soup.selectedTraces);let t=this.iLastViewSelected+1;return this.insertView(t,e.id,e),this.setTargetViewByViewId(e.id),this.isChanged=!0,this.isUpdateColors=!0,console.log("Soupview.saveCurrentView",e),e.id}setCurrentView(e){let t=this.currentView.selected;this.currentView=e.clone(),this.soup.selectedTraces=s.a.cloneDeep(e.selectedTraces),s.a.isEqual(t.sort(),e.selected.sort())||(this.soup.clearSidechainResidues(),this.soup.setSidechainOfResidues(e.selected,!0),this.isUpdateSidechain=!0);for(let n in e.grid.isElem)n in this.soup.grid.isElem&&e.grid.isElem[n]!==this.soup.grid.isElem[n]&&(this.soup.grid.isElem[n]=e.grid.isElem[n],this.isUpdateObservers=!0,this.soup.grid.isChanged=!0);s.a.isNil(e.grid.bCutoff)||this.soup.grid.bCutoff!==e.grid.bCutoff&&(this.soup.grid.bCutoff=e.grid.bCutoff,this.isUpdateObservers=!0,this.soup.grid.isChanged=!0),this.isChanged=!0}setTargetToPrevView(){if(0===this.savedViews.length)return"";this.iLastViewSelected-=1,this.iLastViewSelected<0&&(this.iLastViewSelected=this.savedViews.length-1);let e=this.savedViews[this.iLastViewSelected].id;return this.setTargetViewByViewId(e),e}setTargetToNextView(){if(0===this.savedViews.length)return"";this.iLastViewSelected+=1,this.iLastViewSelected>=this.savedViews.length&&(this.iLastViewSelected=0);let e=this.savedViews[this.iLastViewSelected].id;return this.setTargetViewByViewId(e),e}setTargetToPrevResidue(){let e=s.a.get(this.targetView,"iAtom");e=mh(e)?this.targetView.iAtom:this.currentView.iAtom,e<0&&(e=0);let t=this.soup.getAtomProxy(e).iRes;t<=0?t=this.soup.getResidueCount()-1:t-=1,e=this.soup.getResidueProxy(t).iAtom,this.setTargetViewByIAtom(e)}setTargetToNextResidue(){let e=s.a.get(this.targetView,"iAtom");e=mh(e)?this.targetView.iAtom:this.currentView.iAtom,e<0&&(e=0);let t=this.soup.getAtomProxy(e).iRes;t>=this.soup.getResidueCount()-1?t=0:t+=1,e=this.soup.getResidueProxy(t).iAtom,this.setTargetViewByIAtom(e)}adjustCamera(e,t,n,i){let r=this.currentView.cameraParams,o=r.up,s=r.position.clone().sub(r.focus).normalize(),a=fh.create().crossVectors(o,s).normalize(),l=(new It).setFromAxisAngle(s,n),u=(new It).setFromAxisAngle(o,-t),c=(new It).setFromAxisAngle(a,-e),h=(new It).multiply(l).multiply(u).multiply(c),d=i*r.zoom;d<2&&(d=2),d>1e3&&(d=1e3);let p=r.position.clone().sub(r.focus).applyQuaternion(h).normalize().multiplyScalar(d).add(r.focus),f=this.currentView.clone();f.cameraParams.focus=r.focus.clone(),f.cameraParams.position=p,f.cameraParams.up=r.up.clone().applyQuaternion(h),f.cameraParams.zoom=d,this.setCurrentView(f)}setCurrentViewToTargetView(){this.setCurrentView(this.targetView),"chain"===this.getMode()&&(this.currentView.show.transparent=!0),this.targetView=null,this.isUpdateColors=!0,this.isUpdateObservers=!0,this.isChanged=!0,this.targetView=null}scalingFunction(e,t,n,i){return(n-i)/2*(Math.sin(2*Math.PI/t*e-.5*Math.PI)+1)+i}animate(e){if(this.nUpdateStep-=e/this.msPerStep,this.nUpdateStep<0){if(null!==this.targetView)this.setCurrentViewToTargetView(),this.nUpdateStep=this.maxUpdateStep;else if(this.isStartTargetAfterRender)this.isChanged=!0;else if("loop"===this.animateState)this.nUpdateStep<-this.maxWaitStep&&this.setTargetToNextView();else if("rotate"===this.animateState)this.adjustCamera(0,.002,0,1);else if("rock"===this.animateState){let e=18,t=this.scalingFunction(-this.nUpdateStep-e,2*e,4,1),n=.001,i=n*t;this.nUpdateStep>-e?this.adjustCamera(0,i,0,1):this.nUpdateStep>-3*e?this.adjustCamera(0,-i,0,1):this.nUpdateStep>-4*e?this.adjustCamera(0,+i,0,1):this.nUpdateStep=0}}else if(this.nUpdateStep>0&&null!=this.targetView){let e=this.currentView.clone(),t=this.nUpdateStep,n=this.scalingFunction(t,this.maxUpdateStep,4,1),i=1/t*n;i>1&&(i=1),e.setCamera(Xh(this.currentView.cameraParams,this.targetView.cameraParams,i)),this.setCurrentView(e)}}}class Jh{constructor(e){this.soup=e.soup,this.soupView=e,this.iResLastSelected=null}deleteDistance(e){this.soupView.currentView.distances.splice(e,1),this.soupView.isChanged=!0}makeDistance(e,t){this.soupView.currentView.distances.push({i_atom1:e,i_atom2:t}),this.soupView.isChanged=!0}makeAtomLabel(e,t){this.soupView.currentView.labels.push({i_atom:e,text:t}),this.soupView.isChanged=!0}deleteAtomLabel(e){this.soupView.currentView.labels.splice(e,1),this.soupView.isChanged=!0}setTargetView(e){this.soupView.setTargetView(e)}setTargetViewByViewId(e){this.soupView.setTargetViewByViewId(e)}setTargetViewByIAtom(e){this.soupView.setTargetViewByIAtom(e)}setTargetToPrevResidue(){let e=null,t=this.soup.getResidueProxy();for(let n=0;n<this.soup.getResidueCount();n+=1)if(t.load(n).selected){e=n;break}null!==e?(e>0?e-=1:e=this.soup.getResidueCount-1,t.load(e),this.clearSelectedResidues(),this.setTargetViewByIAtom(t.iAtom)):this.soupView.setTargetToPrevResidue()}setTargetToNextResidue(){let e=null,t=this.soup.getResidueProxy(),n=this.soup.getResidueCount();for(let i=n-1;i>0;i-=1)if(t.load(i).selected){e=i;break}null!==e?(e<n-1?e+=1:e=0,t.load(e),this.clearSelectedResidues(),this.setTargetViewByIAtom(t.iAtom)):this.soupView.setTargetToNextResidue()}selectPrevResidue(e=!0){let t=null,n=this.soup.getResidueProxy();for(let i=0;i<this.soup.getResidueCount();i+=1)if(n.load(i).selected){t=i;break}if(null!==t)t>0?t-=1:t=this.soup.getResidueCount-1,e&&this.clearSelectedResidues(),this.selectResidue(t,!0);else{e&&this.clearSelectedResidues();let t=null;for(let e=this.soup.getResidueCount()-1;e>=0;e-=1)if(n.load(e).isPolymer){t=e;break}this.selectResidue(t,!0)}this.soupView.isUpdateSidechain=!0,this.soupView.isChanged=!0}selectNextResidue(e=!0){let t=null,n=this.soup.getResidueProxy(),i=this.soup.getResidueCount();for(let r=i-1;r>=0;r-=1)if(n.load(r).selected){t=r;break}if(console.log("Contreoller.selectNextResidue",t,e),null!==t)t<i-1?t+=1:t=0,e&&this.clearSelectedResidues(),this.selectResidue(t,!0);else{this.clearSelectedResidues();let e=null;for(let t=0;t<i-1;t+=1)if(n.load(t).isPolymer){e=t;break}this.selectResidue(e,!0)}this.soupView.isUpdateSidechain=!0,this.soupView.isChanged=!0}setTargetToPrevView(){return this.soupView.setTargetToPrevView()}setTargetToNextView(){return this.soupView.setTargetToNextView()}swapViews(e,t){this.soupView.savedViews[t].order=e,this.soupView.savedViews[e].order=t;let n=this.soupView.savedViews[t];this.soupView.savedViews[t]=this.soupView.savedViews[e],this.soupView.savedViews[e]=n}getViewDicts(){let e=[];for(let t=1;t<this.soupView.savedViews.length;t+=1)e.push(this.soupView.savedViews[t].getDict());return e}clearSidechainResidues(){this.soup.clearSidechainResidues(),this.soupView.currentView.selected=this.soup.makeSelectedResidueList(),this.soupView.isUpdateSidechain=!0,this.soupView.isChanged=!0}clearSelectedResidues(){this.soup.clearSelectedResidues(),this.soupView.currentView.selected=this.soup.makeSelectedResidueList(),this.soupView.isUpdateColors=!0,this.soupView.isChanged=!0}setResidueSelect(e,t){let n=this.soup.getResidueProxy(e);n.selected=t,this.soupView.isUpdateColors=!0,this.soupView.isChanged=!0}showAllSidechains(){let e=this.soup.getResidueProxy();for(let t of s.a.range(this.soup.getResidueCount()))e.load(t).sidechain=!0;this.soupView.isUpdateSidechain=!0,this.soupView.isChanged=!0}selectResidue(e,t){let n=this.soup.getResidueProxy(e);s.a.isUndefined(t)&&(t=!n.selected),this.setResidueSelect(e,t),this.iResLastSelected=t?e:null,this.soupView.isUpdateColors=!0,this.soupView.isChanged=!0}selectAllSidechains(e){for(let t=0;t<this.soup.getResidueCount();t+=1)this.setResidueSelect(t,e);this.iResLastSelected=null,this.soupView.isUpdateColors=!0,this.soupView.isChanged=!0}selectAdditionalResidue(e){let t=this.soup.getResidueProxy(e),n=!t.selected;this.setResidueSelect(e,n),this.iResLastSelected=n?e:null,this.soupView.isUpdateColors=!0,this.soupView.isChanged=!0}selectAdditionalRangeToResidue(e){let t=this.soup.getResidueProxy(e),n=!t.selected;if(null!==this.iResLastSelected){let n=this.soup.getResidueProxy(this.iResLastSelected);if(t.iStructure===n.iStructure){let t=Math.min(this.iResLastSelected,e),n=Math.max(this.iResLastSelected,e);for(let e=t;e<n+1;e+=1)this.setResidueSelect(e,!0)}}this.iResLastSelected=n?e:null,this.soupView.isUpdateColors=!0,this.soupView.isChanged=!0}getResListOfSs(e){let t=this.soup.getResidueProxy(e),n=t.ss,i=this.soup.getResidueCount(),r=[];for(let o=e;o>=0;o-=1){if(t.load(o),t.ss!==n)break;r.push(o)}for(let o=e+1;o<i;o+=1){if(t.load(o),t.ss!==n)break;r.push(o)}return r}selectSecondaryStructure(e,t=!0){this.clearSelectedResidues();let n=this.getResListOfSs(e),i=this.soup.getResidueProxy(e);for(let r of n)i.load(r).selected=t;this.soupView.isUpdateColors=!0,this.soupView.isChanged=!0}toggleSecondaryStructure(e){let t=this.getResListOfSs(e),n=this.soup.getResidueProxy(e),i=s.a.every(s.a.map(t,e=>!n.load(e).selected));i?this.selectSecondaryStructure(e,!0):this.selectSecondaryStructure(e,!1)}toggleSelectedSidechains(){let e=this.soup.getResidueProxy(),t=[],n=0,i=0,r=0;for(let o=0;o<this.soup.getResidueCount();o+=1)e.load(o),e.selected&&(n+=1,t.push(o),e.sidechain&&(i+=1)),e.sidechain&&(r+=1);if(0===n){let t=!0;r>0&&(t=!1);for(let n=0;n<this.soup.getResidueCount();n+=1)e.load(n),e.sidechain=t}else{let n=!0;i>0&&(n=!1);for(let i of t)e.load(i),e.sidechain=n}this.soupView.isUpdateSidechain=!0,this.soupView.isChanged=!0}toggleResidueNeighbors(){let e=[],t=0,n=this.soup.getResidueProxy();for(let o=0;o<this.soup.getResidueCount();o+=1)n.load(o),n.selected&&(e=s.a.concat(e,this.soup.getNeighbours(o)),t+=1);if(0===t){console.log("Controller.toggleResidueNeighbors none selected");let t=this.soupView.currentView.cameraParams.focus;e=this.soup.getNeighboursOfPoint(t)}if(0===e.length){let t=this.soupView.currentView.iAtom,n=this.soup.getAtomProxy(t).iRes;e=s.a.concat(e,this.soup.getNeighbours(n))}let i=0;for(let o of e)n.load(o).sidechain&&(i+=1);let r=i<e.length;this.soup.setSidechainOfResidues(e,r),this.soupView.currentView.selected=this.soup.makeSelectedResidueList(),this.soupView.isChanged=!0,this.soupView.isUpdateSidechain=!0}saveCurrentView(){return this.soupView.saveCurrentView()}deleteView(e){this.soupView.removeView(e)}sortViewsByOrder(){function e(e,t){return e.order-t.order}this.soupView.savedViews.sort(e);for(let t=0;t<this.soupView.savedViews.length;t+=1)this.soupView.savedViews[t].order=t}loadViewsFromViewDicts(e){for(let t=0;t<e.length;t+=1){let n=new Yh;n.setFromDict(e[t]),"view:000000"!==n.id&&this.soupView.saveView(n)}this.sortViewsByOrder()}async asyncLoadProteinData(e,t){await this.soup.asyncLoadProteinData(e,t),this.soupView.build(),this.soupView.isChanged=!0,this.soupView.isUpdateObservers=!0}selectChain(e,t){this.soup.selectedTraces.length=0,this.clearSelectedResidues();let n=null;for(let[i,r]of this.soup.traces.entries()){let o=r.indices[0],s=this.soup.getResidueProxy(o);s.iStructure===e&&s.chain===t&&(this.soup.selectedTraces.push(i),n=s.iAtom)}s.a.isNil(n)||this.zoomToChainContainingAtom(n)}setShowOption(e,t){console.log("Controller.setShowOption",e,t),this.soupView.currentView.show[e]=t,this.soupView.isUpdateObservers=!0,this.soupView.isChanged=!0}getShowOption(e){return this.soupView.currentView.show[e]}toggleShowOption(e){let t=this.getShowOption(e);this.setShowOption(e,!t)}setChangeFlag(){this.soupView.isChanged=!0}setZoom(e,t){let n=this.soupView.currentView.cameraParams;n.zBack=e,n.zFront=t,this.soupView.isUpdateObservers=!0,this.soupView.isChanged=!0}toggleGridElem(e){let t=this.soup.grid.isElem[e];this.soup.grid.isElem[e]=!t,this.soup.grid.isChanged=!0,this.soupView.currentView.grid.isElem=s.a.cloneDeep(this.soup.grid.isElem),this.soupView.isChanged=!0,this.soupView.isUpdateObservers=!0,this.soupView.isUpdateColors=!0}setGridCutoff(e){this.soup.grid.bCutoff=e,this.soup.grid.isChanged=!0,this.soupView.currentView.grid.bCutoff=e,mh(this.soupView.targetView)&&(this.soupView.targetView.grid.bCutoff=e),mh(this.soupView.saveTargetView)&&(this.soupView.saveTargetView.grid.bCutoff=e),this.soupView.isUpdateObservers=!0,this.soupView.isChanged=!0}clear(){let e=this.soupView.currentView.distances;for(let n of s.a.reverse(s.a.range(e.length)))this.deleteDistance(n);let t=this.soupView.currentView.labels;for(let n of s.a.reverse(s.a.range(t.length)))this.deleteAtomLabel(n);this.clearSidechainResidues(),this.clearSelectedResidues()}getAnimateState(){return this.soupView.animateState}setAnimateState(e){this.soupView.animateState=e,this.soupView.isUpdateObservers=!0,this.soupView.isChanged=!0}deleteStructure(e){let t=this.soup.getAtomProxy(),n=this.soup.getResidueProxy(),i=null,r=null,o=null,a=null,l=null,u=null;for(let s=0;s<this.soup.getAtomCount();s+=1)t.iAtom=s,n.iRes=t.iRes,n.iStructure===e&&(null===i&&(i=s),r=s+1,null===o&&(o=t.iRes),a=t.iRes+1);for(let w of s.a.range(this.soup.traces.length)){let e=this.soup.traces[w];for(let t of e.indices)c(t,o,a)&&(s.a.isNil(l)?(l=w,u=w+1):u=w+1)}function c(e,t,n){return e>=t&&e<n}function h(e,t,n){return e>=n?e-(n-t):e}function d(e){s.a.remove(e.selectedTraces,s.a.partial(c,l,u)),e.selectedTraces=s.a.map(e.selectedTraces,s.a.partial(h,l,u)),s.a.remove(e.distances,e=>c(e.i_atom1,i,r)||c(e.i_atom2,i,r));for(let t of e.distances)t.i_atom1=h(t.i_atom1,i,r),t.i_atom2=h(t.i_atom2,i,r);s.a.remove(e.selected,e=>c(e,o,a)),e.selected=s.a.map(e.selected,e=>h(e,o,a)),s.a.remove(e.labels,e=>c(e.iAtom,i,r));for(let t of e.labels)t.iAtom=h(t.iAtom,i,r)}s.a.remove(this.soup.selectedTraces,s.a.partial(c,l,u)),this.soup.selectedTraces=s.a.map(this.soup.selectedTraces,s.a.partial(h,l,u)),d(this.soupView.currentView);for(let s of this.soupView.savedViews)d(s);let p=r-i,f=this.soup.getAtomCount(),m=f-p,g=f-r,v=a-o,y=this.soup.getResidueCount(),x=y-v,b=y-a;this.soup.atomStore.copyWithin(i,r,g),this.soup.atomStore.count-=p;for(let s=0;s<m;s+=1)t.iAtom=s,t.iRes>=o&&(t.iRes-=v);for(let s=0;s<x;s+=1)if(s>=o){let e=s+v;e in this.soup.residueNormal&&(this.soup.residueNormal[s]=this.soup.residueNormal[e].clone())}for(let s=x;s<y;s+=1)delete this.soup.residueNormal[s];this.soup.residueStore.copyWithin(o,a,b),this.soup.residueStore.count-=v,this.soup.resIds.splice(o,v);for(let s=0;s<x;s+=1)n.iRes=s,n.iAtom>=i&&(n.iAtom-=p,t.iAtom=n.iAtom),this.soup.residueStore.atomOffset[s]>=i&&(this.soup.residueStore.atomOffset[s]-=p),n.iStructure>=e&&(n.iStructure-=1);if(this.soup.structureIds.splice(e,1),this.soup.iStructure-=1,this.soup.calcBondsStrategic(),this.soup.calculateTracesForRibbons(),this.soup.isEmpty()){this.soupView.savedViews.length=0;for(let e of s.a.keys(this.soupView.savedViewsByViewId))delete this.soupView.savedViewsByViewId[e];this.soupView.currentView=new Yh,this.soupView.targetView=null,this.soupView.isStartTargetAfterRender=!1,this.soupView.nUpdateStep=-1}else this.soupView.isUpdateSidechain=!0,this.soupView.isUpdateColors=!0;this.soupView.isUpdateObservers=!0,this.soupView.isChanged=!0}zoomOut(){this.soup.isEmpty()||(this.setTargetView(this.soupView.getZoomedOutViewOfCurrentView()),this.soupView.isChanged=!0)}zoomToChainContainingAtom(e){let t=this.soup.getAtomProxy(e),n=this.soup.getAtomsOfChainContainingResidue(t.iRes),i=this.soupView.getZoomedOutViewOf(n);i.selectedTraces=this.soupView.getTracesOfChainContainingResidue(t.iRes),this.setTargetView(i)}zoomToSelection(){this.soup.isEmpty()||(this.setTargetView(this.soupView.getZoomedOutViewOfSelection()),this.soupView.isChanged=!0)}adjustCamera(e,t,n,i){this.soupView.adjustCamera(e,t,n,i)}triggerAtom(e){if(s.a.isNil(e))this.clearSelectedResidues(),this.zoomOut();else{let t=this.soup.getAtomProxy(e),n=this.soup.getResidueProxy(t.iRes),i=n.chain,r=n.iStructure,o=!1;if("chain"===this.soupView.getMode()){if(this.soup.selectedTraces.length>0){let e=this.soup.selectedTraces[0],t=this.soup.traces[e].indices[0],n=this.soup.getResidueProxy(t);n.iStructure===r&&n.chain===i&&(o=!0)}if(!o)return this.clearSelectedResidues(),void this.zoomToChainContainingAtom(t.iAtom)}this.clearSelectedResidues(),this.selectResidue(t.iRes,!0),this.setTargetViewByIAtom(e)}this.soupView.isUpdateColors=!0,this.soupView.isUpdateObservers=!0}}class Kh{constructor(e){this.vertices=e,this.padding=.05,this.div=5,this.invDiv=1/this.div,this.maxima=[0,0,0],this.minima=[0,0,0],this.spans=[0,0,0],this.sizes=[0,0,0];for(let t=0;t<3;t++){for(let e=0;e<this.vertices.length;e+=1)this.minima[t]>this.vertices[e][t]&&(this.minima[t]=this.vertices[e][t]),this.maxima[t]<this.vertices[e][t]&&(this.maxima[t]=this.vertices[e][t]);this.minima[t]-=this.padding,this.maxima[t]+=this.padding,this.spans[t]=this.maxima[t]-this.minima[t],this.sizes[t]=Math.ceil(this.spans[t]*this.invDiv)}this.cells={},this.spaces=[];for(let t=0;t<this.vertices.length;t++){let e=this.vertices[t],n=this.getSpaceFromVertex(e);this.spaces.push(n);let i=this.getHashFromSpace(n);i in this.cells||(this.cells[i]=[]),this.cells[i].push(t)}}getSpaceFromVertex(e){let t=[];for(let n=0;n<3;n++)t.push(Math.round((e[n]-this.minima[n])*this.invDiv));return t}getHashFromSpace(e){return e[0]*this.sizes[1]*this.sizes[2]+e[1]*this.sizes[2]+e[2]}pushCellOfSpace(e,t,n){let i=this.getSpaceFromVertex(t),r=Math.max(0,i[0]-1),o=Math.min(this.sizes[0],i[0]+2),s=Math.max(0,i[1]-1),a=Math.min(this.sizes[1],i[1]+2),l=Math.max(0,i[2]-1),u=Math.min(this.sizes[2],i[2]+2);for(let c=r;c<o;c++)for(let t=s;t<a;t++)for(let i=l;i<u;i++){let r=this.getHashFromSpace([c,t,i]);if(r in this.cells){let t=this.cells[r];for(let i=0;i<t.length;i++){let r=t[i];e.push([n,r])}}}}getClosePairs(){let e=[];for(let t=0;t<this.vertices.length;t++)this.pushCellOfSpace(e,this.vertices[t],t);return e}getVerticesNearPoint(e,t){let n=[];return this.pushCellOfSpace(n,e,t),n}}function Qh(e,t){switch(e){case"int8":return new Int8Array(t);case"int16":return new Int16Array(t);case"int32":return new Int32Array(t);case"uint8":return new Uint8Array(t);case"uint16":return new Uint16Array(t);case"uint32":return new Uint32Array(t);case"float32":return new Float32Array(t);default:throw new Error("arrayType unknown: "+e)}}class ed{constructor(e,t){this.length=0,this.count=0,this._fields=e,Number.isInteger(t)?this._init(t):this._init(0)}_init(e){this.length=e,this.count=0;for(let t of this._fields)this._initField(...t)}_initField(e,t,n){this[e]=Qh(n,this.length*t)}addField(e,t,n){this._fields.push([e,t,n]),this._initField(e,t,n)}resize(e){this.length=Math.round(e||0),this.count=Math.min(this.count,this.length);for(let t=0,n=this._fields.length;t<n;++t){const e=this._fields[t][0],n=this._fields[t][1],i=this.length*n,r=new this[e].constructor(i);this[e].length>i?r.set(this[e].subarray(0,i)):r.set(this[e]),this[e]=r}}growIfFull(){if(this.count>=this.length){const e=Math.round(1.5*this.length);this.resize(Math.max(256,e))}}increment(){this.count+=1,this.growIfFull()}copyFrom(e,t,n,i){for(let r=0,o=this._fields.length;r<o;++r){const o=this._fields[r][0],s=this._fields[r][1],a=this[o],l=e[o];for(let e=0;e<i;++e){const i=s*(t+e),r=s*(n+e);for(let e=0;e<s;++e)a[i+e]=l[r+e]}}}copyWithin(e,t,n){for(let i=0,r=this._fields.length;i<r;++i){const r=this._fields[i][0],o=this._fields[i][1],s=this[r];for(let i=0;i<n;++i){const n=o*(e+i),r=o*(t+i);for(let e=0;e<o;++e)s[n+e]=s[r+e]}}}sort(e){const t=this,n=new this.constructor(this._fields,1);function i(e,i){e!==i&&(n.copyFrom(t,0,e,1),t.copyWithin(e,i,1),t.copyFrom(n,i,0,1))}function r(t,n){if(t<n){let o=Math.floor((t+n)/2),s=t,a=n;do{while(e(s,o)<0)s+=1;while(e(a,o)>0)a-=1;s<=a&&(s===o?o=a:a===o&&(o=s),i(s,a),s+=1,a-=1)}while(s<=a);r(t,a),r(s,n)}}r(0,this.count-1)}clear(){this.count=0}dispose(){delete this.length,delete this.count;for(let e=0,t=this._fields.length;e<t;++e){const t=this._fields[e][0];delete this[t]}}}var td=ed;const nd=["ALA","CYS","ASP","GLU","PHE","GLY","HIS","ILE","LYS","LEU","MET","ASN","PRO","GLN","ARG","SER","THR","TRP","VAL","TYR"],id=["DA","DT","DG","DC","A","T","G","C"],rd=["RA","RU","RC","RG","A","G","C","U"],od=new nr(7315026),sd=new nr(6590902),ad=new nr(16172569),ld=new nr(9795754),ud=new nr(12303291),cd=new nr(10040115),hd=new nr(10066329);let dd={H:13421772,C:11184810,O:13369344,N:204,S:11184640,P:6693580,F:52224,CL:52224,BR:8921600,I:6684842,FE:13395456,CA:8947882,He:8095426,Ne:10408676,Ar:6145214,Kr:11326326,Xe:16228220,Rn:14851781};for(let[Gp,Wp]of s.a.toPairs(dd))dd[Gp]=new nr(Wp);function pd(e){return"E"===e?ad:"H"===e?sd:"D"===e?ld:"C"===e?od:"W"===e?cd:ud}const fd={ALA:"A",CYS:"C",ASP:"D",GLU:"E",PHE:"F",GLY:"G",HIS:"H",ILE:"I",LYS:"K",LEU:"L",MET:"M",ASN:"N",PRO:"P",GLN:"Q",ARG:"R",SER:"S",THR:"T",VAL:"V",TRP:"W",TYR:"Y",DA:"A",DT:"T",DG:"G",DC:"C",A:"A",T:"T",G:"G",C:"C",RA:"A",RU:"U",RC:"C",RG:"G",U:"U"},md=["N","C","O","H","HA","CA","OXT","C3'","P","OP1","O5'","OP2","C5'","O5'","O3'","C4'","O4'","C1'","C2'","O2'","H2'","H2''","H3'","H4'","H5'","H5''","HO3'"],gd=new ou([new Ot(-.2,-.2),new Ot(-.2,.2),new Ot(.2,.2),new Ot(.2,-.2)]);function vd(e){let t=[];return"DA"===e||"A"===e||"DG"===e||"G"===e?t=["N9","C8","N7","C5","C6","N1","C2","N3","C4"]:"DT"===e||"U"===e?t=["C6","N1","C2","N3","C4","C5"]:"DC"!==e&&"C"!==e||(t=["C6","N1","C2","N3","C4","C5"]),t}function yd(e){let t=[];return"DA"===e||"A"===e||"DG"===e||"G"===e?t=[["C3'","C2'"],["C2'","C1'"],["C1'","N9"]]:"DT"===e||"U"===e?t=[["C3'","C2'"],["C2'","C1'"],["C1'","N1"]]:"DC"!==e&&"C"!==e||(t=[["C3'","C2'"],["C2'","C1'"],["C1'","N1"]]),t}function xd(e){return e.replace(/\d+/,"")}function bd(e,t,n){t in e||(e[t]=[]),e[t].push(n)}function wd(e,t,n=null){if(s.a.isNil(n))return s.a.includes(e,t)||e.push(t),e.indexOf(t);{let i=s.a.findIndex(e,e=>n(t,e));return i>=0?i:(e.push(t),e.length-1)}}function _d(e){return 1===e}function Ad(e){return e?1:0}function Sd(e){return e?String.fromCharCode(e):""}function Ed(e){return e.charCodeAt(0)}function Md(e){let t="",n=e.split(/\r?\n/);for(let i of n)"TITLE"===i.substring(0,5)&&(t+=i.substring(10));return t}function Td(e){return(new nr).setHex(e+1)}const Cd=[["x",1,"float32"],["y",1,"float32"],["z",1,"float32"],["bfactor",1,"float32"],["alt",1,"uint8"],["iAtomType",1,"uint16"],["iElem",1,"uint16"],["iRes",1,"uint32"],["iChain",1,"int32"],["bondOffset",1,"uint32"],["bondCount",1,"uint16"]];class Pd{constructor(e,t){this.soup=e,Number.isInteger(t)&&this.load(t),this._pos=fh.create()}load(e){return this.iAtom=e,this}get pos(){return this._pos.x=this.soup.atomStore.x[this.iAtom],this._pos.y=this.soup.atomStore.y[this.iAtom],this._pos.z=this.soup.atomStore.z[this.iAtom],this._pos}get resId(){return this.soup.resIds[this.iRes]}get elem(){let e=this.soup.atomStore.iElem[this.iAtom];return this.soup.elemTable[e]}get bfactor(){return this.soup.atomStore.bfactor[this.iAtom]}get atomType(){let e=this.soup.atomStore.iAtomType[this.iAtom];return this.soup.atomTypeTable[e]}get alt(){return Sd(this.soup.atomStore.alt[this.iAtom])}set alt(e){this.soup.atomStore.alt[this.iAtom]=Ed(e)}get iRes(){return this.soup.atomStore.iRes[this.iAtom]}set iRes(e){this.soup.atomStore.iRes[this.iAtom]=e}get resType(){let e=this.soup.residueStore.iResType[this.iRes];return this.soup.resTypeTable[e]}get label(){let e=this.soup.residueStore.iResType[this.iRes],t=this.soup.resTypeTable[e],n=this.soup.resIds[this.iRes]+":"+t+":"+this.atomType;return this.alt&&(n+=":"+this.alt),n}getBondIndices(){let e=this.soup.atomStore.bondOffset[this.iAtom],t=this.soup.atomStore.bondCount[this.iAtom],n=e+t;return s.a.range(e,n)}get color(){let e=this.soup.getResidueProxy(this.iRes);if(e.isPolymer){let t=e.activeColor;if("C"===this.elem||"H"===this.elem)return t;if(this.elem in dd){let e=dd[this.elem].clone().offsetHSL(0,-.3,-.3);return(new nr).addColors(t,e)}}return this.elem in dd?dd[this.elem]:hd}}const Rd=[["atomOffset",1,"uint32"],["atomCount",1,"uint16"],["iCentralAtom",1,"uint32"],["iResType",1,"uint16"],["iChain",1,"uint8"],["iStructure",1,"uint8"],["resNum",1,"int32"],["insCode",1,"uint8"],["sstruc",1,"uint8"],["iColor",1,"uint16"],["iCustomColor",1,"uint16"],["isPolymer",1,"uint8"],["selected",1,"uint8"],["sidechain",1,"uint8"],["iChain",1,"uint8"]];function Ld(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b}class Od{constructor(e,t){this.soup=e,Number.isInteger(t)&&this.load(t)}load(e){return this.iRes=e,this}get iAtom(){return this.soup.residueStore.iCentralAtom[this.iRes]}set iAtom(e){this.soup.residueStore.iCentralAtom[this.iRes]=e}get iChain(){return this.soup.residueStore.iChain[this.iRes]}get chain(){return this.soup.chains[this.iChain]}get iStructure(){return this.soup.residueStore.iStructure[this.iRes]}set iStructure(e){this.soup.residueStore.iStructure[this.iRes]=e}get resId(){return this.soup.resIds[this.iRes]}get resNum(){return this.soup.residueStore.resNum[this.iRes]}get insCode(){return Sd(this.soup.residueStore.insCode[this.iRes])}set insCode(e){this.soup.residueStore.insCode[this.iRes]=Ed(e)}get isPolymer(){return _d(this.soup.residueStore.isPolymer[this.iRes])}set isPolymer(e){this.soup.residueStore.isPolymer[this.iRes]=Ad(e)}get sidechain(){return _d(this.soup.residueStore.sidechain[this.iRes])}set sidechain(e){this.soup.residueStore.sidechain[this.iRes]=Ad(e)}get selected(){return _d(this.soup.residueStore.selected[this.iRes])}set selected(e){this.soup.residueStore.selected[this.iRes]=Ad(e)}get color(){let e=this.soup.residueStore.iColor[this.iRes];return this.soup.colorTable[e]}set color(e){let t=wd(this.soup.colorTable,new nr(e),Ld);this.soup.residueStore.iColor[this.iRes]=t}get customColor(){let e=this.soup.residueStore.iCustomColor[this.iRes];return this.soup.colorTable[e]}set customColor(e){let t=wd(this.soup.colorTable,new nr(e),Ld);this.soup.residueStore.iCustomColor[this.iRes]=t}get activeColor(){let e=this.soup.residueStore.iColor[this.iRes],t=this.soup.colorTable[e];return this.selected&&(t=t.clone().offsetHSL(0,0,.3)),t}get resType(){let e=this.soup.residueStore.iResType[this.iRes];return this.soup.resTypeTable[e]}get normal(){let e=this.iRes in this.soup.residueNormal;return e?this.soup.residueNormal[this.iRes].clone():null}get ss(){return Sd(this.soup.residueStore.sstruc[this.iRes])}set ss(e){this.soup.residueStore.sstruc[this.iRes]=Ed(e)}get label(){let e=this.soup.residueStore.iResType[this.iRes],t=this.soup.resTypeTable[e],n=this.soup.resIds[this.iRes]+":"+t;return n}getAtomIndices(){let e=this.soup.residueStore.atomOffset[this.iRes],t=this.soup.residueStore.atomCount[this.iRes],n=e+t;return s.a.range(e,n)}getAtomProxy(e){let t=this.soup.getAtomProxy();for(let n of this.getAtomIndices())if(t.iAtom=n,t.atomType===e)return t;return null}getIAtom(e){for(let t of this.getAtomIndices()){let n=this.soup.atomStore.iAtomType[t],i=this.soup.atomTypeTable[n];if(i===e)return t}return null}checkAtomTypes(e){for(let t of e)if(null===this.getIAtom(t))return!1;return!0}isProteinConnectedToPrev(){if(0===this.iRes)return!1;let e=this,t=new Od(this.soup,this.iRes-1);const n=["CA"];if(t.checkAtomTypes(n)&&e.checkAtomTypes(n)){let n=t.getAtomProxy("CA").pos,i=e.getAtomProxy("CA").pos;if(fh.distance(n,i)<5)return!0}return!1}isNucleotideConnectedToPrev(){if(0===this.iRes)return!1;let e=this,t=new Od(this.soup,this.iRes-1);const n=["C3'","O3'"];if(t.checkAtomTypes(n)&&e.checkAtomTypes(n)&&e.checkAtomTypes(["P"])){let n=t.getAtomProxy("O3'").pos,i=e.getAtomProxy("P").pos;if(fh.distance(n,i)<2.5)return!0}return!1}isConnectedToPrev(){return this.isProteinConnectedToPrev()||this.isNucleotideConnectedToPrev()}getNucleotideNormal(){let e=this.getAtomProxy("C3'").pos,t=this.getAtomProxy("C5'").pos,n=this.getAtomProxy("C1'").pos,i=fh.diff(e,t),r=fh.diff(n,e);return fh.crossProduct(i,r)}}const Dd=[["iAtom1",1,"int32"],["iAtom2",1,"int32"]];class Id{constructor(e,t){this.soup=e,Number.isInteger(t)&&this.load(t)}load(e){return this.iBond=e,this}get iAtom1(){return this.soup.bondStore.iAtom1[this.iBond]}get iAtom2(){return this.soup.bondStore.iAtom2[this.iBond]}}class Nd{constructor(){this.parsingError="",this.title="",this.structureIds=[],this.structureId=null,this.iStructure=-1,this.chains=[],this.maxLength=null,this.traces=[],this.selectedTraces=[],this.colorMode="secondary",this.atomStore=new td(Cd),this.residueStore=new td(Rd),this.bondStore=new td(Dd),this.resIds=[],this.residueNormal={},this.residueProxy=new Od(this),this.atomProxy=new Pd(this),this.elemTable=[],this.atomTypeTable=[],this.resTypeTable=[],this.colorTable=[],this.grid={bCutoff:.8,bMax:2,bMin:.4,changed:!0,isElem:{},convertB:e=>-e.toFixed(2)}}isEmpty(){return 0===this.getAtomCount()}parseAtomLines(e){let t,n,i,r,o,a,l,u,c,h,d;for(let f=0;f<e.length;f+=1){let m=e[f];if("ATOM"===m.substr(0,4)||"HETATM"===m.substr(0,6)){try{a=s.a.trim(m.substr(12,4)),c=s.a.trim(m.substr(16,1)),o=s.a.trim(m.substr(17,3)),r=m[21],h=parseInt(m.substr(22,4)),d=m.substr(26,1),t=parseFloat(m.substr(30,7)),n=parseFloat(m.substr(38,7)),i=parseFloat(m.substr(46,7)),l=parseFloat(m.substr(60,6)),u=xd(s.a.trim(m.substr(76,2)))}catch(p){this.parsingError="line "+f,console.log(`Error: "${m}"`);continue}""===u&&(u=xd(s.a.trim(a)).substr(0,1)),this.addAtom(t,n,i,l,c,a,u,o,h,d,r)}}}parseSecondaryStructureLines(e){this.assignResidueProperties(this.iStructure),this.parsedSecondaryStructure=!1;let t=this.getResidueProxy();for(let n=0;n<e.length;n+=1){let i=e[n];if("HELIX"===i.substr(0,5)){this.parsedSecondaryStructure=!0;let e=i.substr(19,1),n=parseInt(i.substr(21,4)),r=parseInt(i.substr(33,4));for(let i of this.findResidueIndices(this.iStructure,e,n)){t.iRes=i;while(t.resNum<=r&&e===t.chain)t.ss="H",t.iRes=t.iRes+1}}if("SHEET"===i.substr(0,5)){this.parsedSecondaryStructure=!0;let e=i.substr(21,1),n=parseInt(i.substr(22,4)),r=parseInt(i.substr(33,4));for(let i of this.findResidueIndices(this.iStructure,e,n)){t.iRes=i;while(t.resNum<=r&&e===t.chain)t.ss="E",t.iRes=t.iRes+1}}}}parsePdbData(e,t){this.structureId=t,this.structureIds.push(t),this.iStructure=this.structureIds.length-1;let n=Md(e),i=this.structureId.toUpperCase();this.title=`[<a href="http://www.rcsb.org/structure/${i}">${i}</a>] `+n;let r=e.split(/\r?\n/);if(0!==r.length){for(let e of s.a.range(r.length))if(s.a.includes(["END"],r[e].slice(0,3))){r=r.slice(0,e);break}this.parseAtomLines(r),this.parseSecondaryStructureLines(r)}else this.parsingError="No atom lines"}load(e){console.log(`Soup.load parse ${this.structureId}...`),this.parsePdbData(e.pdbText,this.structureId),console.log(`Soup.load processed ${this.getAtomCount()} atoms, `+this.getResidueCount()+" residues"),console.log("Soup.load finding bonds..."),this.calcBondsStrategic(),console.log(`Soup.load calculated ${this.getBondCount()} bonds`)}async asyncLoadProteinData(e,t){let n=e.pdbText,i=e.pdbId;if(0===e.pdbText.length)return void await t("Error: no soup data");if(await t(`Parsing '${i}'`),this.parsePdbData(n,i),this.parsingError){let e=this.soup.parsingError;return void await t("Error parsing soup: "+e)}let r=this.getAtomCount(),o=this.getResidueCount();await t(`Calculating bonds for ${r} atoms, ${o} residues...`),this.calcBondsStrategic(),this.parsedSecondaryStructure||(await t(`Calculated ${this.getBondCount()} bonds. Calculating secondary structure...`),this.findSecondaryStructure()),this.maxLength=this.calcMaxLength(),this.findGridLimits(),this.setSecondaryStructureColorResidues(),this.colorResidues(),this.calculateTracesForRibbons()}addAtom(e,t,n,i,r,o,s,a,l,u,c){let h=this.atomStore.count;this.atomStore.increment(),this.atomStore.x[h]=e,this.atomStore.y[h]=t,this.atomStore.z[h]=n,this.atomStore.bfactor[h]=i,this.atomStore.alt[h]=Ed(r),this.atomStore.bondCount[h]=0,this.atomStore.iAtomType[h]=wd(this.atomTypeTable,o),this.atomStore.iElem[h]=wd(this.elemTable,s);let d=this.getResidueCount(),p=!1;0===d?p=!0:(this.residueProxy.iRes=d-1,(this.residueProxy.resNum!==l||this.residueProxy.insCode!==u||this.chains[this.residueProxy.iChain]!==c)&&(p=!0)),p&&this.addResidue(h,l,u,c,a);let f=this.getResidueCount()-1;this.residueStore.atomCount[f]+=1,this.atomStore.iRes[h]=f}addResidue(e,t,n,i,r){let o=this.getResidueCount();this.residueStore.increment();let a=this.structureId+":";i&&(a+=i+":"),a+=t+s.a.trim(n),this.resIds.push(a);let l=wd(this.chains,i);this.residueStore.iChain[o]=l,this.residueStore.resNum[o]=t,this.residueStore.insCode[o]=Ed(n),this.residueStore.iResType[o]=wd(this.resTypeTable,r),this.residueStore.atomOffset[o]=e,this.residueStore.atomCount[o]=0,this.residueStore.iStructure[o]=this.iStructure}findFirstResidue(e,t){let n=this.getResidueProxy();for(let i of s.a.range(this.getResidueCount()))if(n.iRes=i,n.chain===e&&n.resNum===t)return n;return null}findResidueIndices(e,t,n){let i=[],r=this.getResidueProxy();for(let o of s.a.range(this.getResidueCount()))r.iRes=o,r.iStructure===e&&r.chain===t&&r.resNum===n&&i.push(o);return i}assignResidueProperties(e){let t=this.getResidueProxy();for(let n=0;n<this.getResidueCount();n+=1)if(t.iRes=n,t.iStructure===e)if(s.a.includes(nd,t.resType))t.iAtom=t.getIAtom("CA"),t.ss="C",t.isPolymer=!0;else if(s.a.includes(id,t.resType)||s.a.includes(rd,t.resType))t.iAtom=t.getIAtom("C3'"),t.ss="D",t.isPolymer=!0;else{t.isPolymer=!1,"HOH"===t.resType?t.ss="W":"XXX"===t.resType?t.ss="G":t.ss="-";let e=this.getCenter(t.getAtomIndices());t.iAtom=this.getIAtomClosest(e,t.getAtomIndices())}}getIAtomClosest(e,t){let n=null,i=1e6,r=this.getAtomProxy();for(let o of t)if(null===n)n=o;else{r.iAtom=o;let t=fh.distance(e,r.pos);t<i&&(n=o,i=t)}return n}getIAtomAtPosition(e){let t=s.a.range(this.getAtomCount()),n=null,i=1e6,r=this.getAtomProxy();for(let o of t)if(null===n)n=o;else{r.iAtom=o;let t=fh.distance(e,r.pos);t<i&&(n=o,i=t)}return i<.1?n:-1}getCenter(e){let t=fh.create(0,0,0),n=this.getAtomProxy();for(let i of e)t=fh.sum(t,n.load(i).pos);return t.divideScalar(e.length),t}calcMaxLength(e=null){let t=[0,0,0],n=[0,0,0],i=[0,0,0];function r(e,t){return 0===t?e.x:1===t?e.y:2===t?e.z:void 0}s.a.isNull(e)&&(e=s.a.range(this.getAtomCount()));let o=this.getAtomProxy();for(let s=0;s<3;s++){for(let i of e){let e=o.load(i).pos;n[s]>r(e,s)&&(n[s]=r(e,s)),t[s]<r(e,s)&&(t[s]=r(e,s))}i[s]=t[s]-n[s]}return Math.max(i[0],i[1],i[2])}calcBondsStrategic(){this.bondStore.count=0;const e=1.44,t=3.61,n=5.76,i=["C","H","O","N","P","S"];function r(r,o){if(null===r||null===o)return!1;if(""!==r.alt&&""!==o.alt&&r.alt!==o.alt)return!1;let s;s="H"===r.elem||"H"===o.elem?e:yh(r.elem,i)&&yh(o.elem,i)?t:n;let a=r.pos.x-o.pos.x,l=r.pos.y-o.pos.y,u=r.pos.z-o.pos.z,c=a*a+l*l+u*u;return c<=s}let o=(e,t)=>{let n=this.getBondCount();this.bondStore.increment(),this.bondStore.iAtom1[n]=e.iAtom,this.bondStore.iAtom2[n]=t.iAtom,n=this.getBondCount(),this.bondStore.increment(),this.bondStore.iAtom1[n]=t.iAtom,this.bondStore.iAtom2[n]=e.iAtom},s=this.getResidueProxy(),a=this.getResidueProxy(),l=this.getResidueCount(),u=this.getAtomProxy(),c=this.getAtomProxy();for(let f=0;f<l;f++){a.iRes=f;for(let e of a.getAtomIndices())for(let t of a.getAtomIndices())u.iAtom=e,c.iAtom=t,r(u,c)&&o(u,c)}for(let f=1;f<l;f++){if(s.iRes=f-1,a.iRes=f,a.isProteinConnectedToPrev())s.checkAtomTypes(["C"])&&a.checkAtomTypes(["N"])&&(u.iAtom=s.getIAtom("C"),c.iAtom=a.getIAtom("N"));else{if(!a.isNucleotideConnectedToPrev())continue;s.checkAtomTypes(["O3'"])&&a.checkAtomTypes(["P"])&&(u.iAtom=s.getIAtom("O3'"),c.iAtom=a.getIAtom("P"))}o(u,c)}let h=this.bondStore.iAtom1;this.bondStore.sort((e,t)=>h[e]-h[t]);for(let f=0;f<this.getAtomCount();f+=1)this.atomStore.bondCount[f]=0;let d=this.getBondProxy(),p=null;for(let f=0;f<this.getBondCount();f+=1)d.iBond=f,p!==d.iAtom1&&(p=d.iAtom1,this.atomStore.bondOffset[p]=f),this.atomStore.bondCount[p]+=1}findBackboneHbonds(){let e=this.getResidueProxy(),t=this.getAtomProxy(),n=this.getAtomProxy(),i=[],r=3.5;for(let o=0;o<this.structureIds.length;o+=1){let s=[],a=[];for(let n=0;n<this.getResidueCount();n+=1)if(e.iRes=n,e.iStructure===o&&e.isPolymer)for(let i of["O","N"]){let n=e.getIAtom(i);null!==n&&(t.iAtom=n,s.push([t.pos.x,t.pos.y,t.pos.z]),a.push(n))}let l=new Kh(s);for(let e of l.getClosePairs()){if(t.iAtom=a[e[0]],n.iAtom=a[e[1]],"O"===t.elem&&"N"===n.elem&&([t,n]=[n,t]),"N"!==t.elem||"O"!==n.elem)continue;let o=t.iRes,s=n.iRes;o!==s&&(fh.distance(t.pos,n.pos)<=r&&bd(i,o,s))}}this.conhPartners=i}findSecondaryStructure(){this.findBackboneHbonds();let e=this.conhPartners,t={},n=this.getResidueCount(),i=this.getResidueProxy(),r=this.getResidueProxy(),o=this.getAtomProxy(),a=this.getAtomProxy();function l(t,i){return!(i<0||i>=n||t<0||t>=n)&&s.a.includes(e[i],t)}function u(e,t){return o.iAtom=i.load(e).iAtom,a.iAtom=r.load(t).iAtom,fh.diff(o.pos,a.pos)}let c=[],h=[],d=[];for(let s=0;s<this.getResidueCount();s+=1)if(i.iRes=s,i.isPolymer&&"D"!==i.ss){let e=i.getIAtom("CA");null!==e&&(o.iAtom=e,c.push([o.pos.x,o.pos.y,o.pos.z]),h.push(e),d.push(s))}for(let s=0;s<n;s+=1)if(i.iRes=s,i.isPolymer)if("D"!==i.ss){if(l(s,s+4)&&l(s+1,s+5)){let e=u(s,s+4),n=u(s+1,s+5);for(let r=s+1;r<s+5;r+=1)i.load(r).ss="H",bd(t,r,e),bd(t,r,n)}if(l(s,s+3)&&l(s+1,s+4)){let e=u(s,s+3),n=u(s+1,s+4);for(let r=s+1;r<s+4;r+=1)i.load(r).ss="H",bd(t,r,e),bd(t,r,n)}}else bd(t,s,i.getNucleotideNormal());let p=[],f=new Kh(c);for(let s of f.getClosePairs()){let[e,n]=s,i=d[e],r=d[n];if(!(Math.abs(i-r)<=5)){if(l(i,r+1)&&l(r-1,i)&&(p=p.concat([i,r])),l(i-1,r)&&l(r,i+1)&&(p=p.concat([i,r])),l(i,r)&&l(r,i)){p=p.concat([i,r]);let e=u(i,r);bd(t,i,e),bd(t,r,fh.scaled(e,-1))}if(l(i-1,r+1)&&l(r-1,i+1)){p=p.concat([i,r]);let e=u(i,r);bd(t,i,fh.scaled(e,-1)),bd(t,r,e)}}}for(let s of p)i.load(s).ss="E";for(let s=0;s<n;s+=1)if(s in t&&t[s].length>0){let e=fh.create(0,0,0);for(let n of t[s])e=fh.sum(e,n);this.residueNormal[s]=fh.normalized(e)}for(let s=1;s<n;s+=1)i.iRes=s-1,r.iRes=s,"E"===i.ss&&i.normal&&"E"===r.ss&&r.normal&&r.normal.dot(i.normal)<0&&this.residueNormal[s].negate()}calculateTracesForRibbons(){let e;this.traces.length=0;let t=this.getResidueProxy(),n=this.getResidueProxy(),i=this.getAtomProxy(),r=this.getResidueCount();for(let o=0;o<r;o+=1)if(t.iRes=o,o<r-1&&(n.iRes=o+1,n.isConnectedToPrev()&&(t.isPolymer=!0,n.isPolymer=!0)),t.isPolymer){if(s.a.isUndefined(e)||0===o||!t.isConnectedToPrev()){let n=new Ch;n.getReference=e=>(t.iRes=n.indices[e],t),this.traces.push(n),e=n}e.indices.push(o),t.getIAtom("CA")?i.iAtom=t.getIAtom("CA"):t.getIAtom("C3'")?i.iAtom=t.getIAtom("C3'"):i.iAtom=t.iAtom,e.refIndices.push(t.iRes),e.points.push(i.pos.clone()),e.colors.push(t.activeColor),e.indexColors.push(Td(t.iAtom)),e.segmentTypes.push(t.ss),e.normals.push(t.normal)}for(let o of this.traces)o.calcTangents(),o.calcNormals(),o.calcBinormals(),o.expand()}getIStructureAndChain(){if(this.selectedTraces.length>0){let e=this.selectedTraces[0],t=this.traces[e];if(s.a.isNil(t))return null;let n=this.traces[e].indices[0],i=this.getResidueProxy(n),r=i.iStructure,o=i.chain;return{iStructure:r,chain:o}}return null}getAtomProxy(e){return new Pd(this,e)}getAtomCount(){return this.atomStore.count}getResidueProxy(e){return new Od(this,e)}getBondProxy(e){return new Id(this,e)}getBondCount(){return this.bondStore.count}getResidueCount(){return this.residueStore.count}areCloseResidues(e,t){let n=this.getAtomProxy(),i=this.getAtomProxy(),r=this.getResidueProxy(e),o=n.load(r.iAtom).pos.clone(),s=r.getAtomIndices(),a=this.getResidueProxy(t),l=i.load(a.iAtom).pos.clone(),u=a.getAtomIndices();if(fh.distance(o,l)>17)return!1;for(let c of s)for(let e of u)if(fh.distance(n.load(c).pos,i.load(e).pos)<4)return!0;return!1}clearSelectedResidues(){let e=this.getResidueProxy();for(let t=0;t<this.getResidueCount();t+=1)e.load(t).selected=!1}clearSidechainResidues(){let e=this.getResidueProxy();for(let t=0;t<this.getResidueCount();t+=1)e.load(t).sidechain=!1}setSidechainOfResidues(e,t){let n=this.getResidueProxy();for(let i of e)n.load(i).sidechain=t}getAtomsOfChainContainingResidue(e){let t=this.getResidueProxy(e),n=t.iStructure,i=t.chain,r=[];for(let o=0;o<this.getResidueCount();o+=1)t.iRes=o,t.iStructure===n&&t.chain===i&&r.push(t.iAtom);return r}getNeighbours(e){let t=[e];for(let n=0;n<this.getResidueCount();n+=1)this.areCloseResidues(n,e)&&t.push(n);return t}isResCloseToPoint(e,t){let n=this.getAtomProxy(),i=this.getResidueProxy(e),r=n.load(i.iAtom).pos.clone();if(fh.distance(r,t)>17)return!1;let o=i.getAtomIndices();for(let s of o)if(fh.distance(n.load(s).pos,t)<5)return!0;return!1}getNeighboursOfPoint(e){let t=[];for(let n=0;n<this.getResidueCount();n+=1)this.isResCloseToPoint(n,e)&&t.push(n);return t}setSecondaryStructureColorResidues(){let e=this.getResidueProxy();for(let t of s.a.range(this.getResidueCount()))e.iRes=t,e.customColor=pd(e.ss)}colorResidues(){let e=this.getResidueProxy(),t=s.a.some(s.a.values(this.grid.isElem));if(t)for(let n of s.a.range(this.getResidueCount()))e.iRes=n,e.color=hd;for(let n of s.a.range(this.getResidueCount()))e.iRes=n,e.color=t?hd:e.customColor}findGridLimits(){let e=this.getResidueProxy(),t=this.getAtomProxy();this.grid.isElem={};for(let n=0;n<this.getResidueCount();n+=1)e.iRes=n,"G"===e.ss&&(t.iAtom=e.iAtom,t.elem in this.grid.isElem||(this.grid.isElem[t.elem]=!0),null===this.grid.bMin?(this.grid.bMin=t.bfactor,this.grid.bMax=t.bfactor):(t.bfactor>this.grid.bMax&&(this.grid.bMax=t.bfactor),t.bfactor<this.grid.bMin&&(this.grid.bMin=t.bfactor)));null===this.grid.bMin&&(this.grid.bMin=0),null===this.grid.bMax&&(this.grid.bMin=0),s.a.isNil(this.grid)&&(this.grid.bCutoff=this.grid.bMin)}makeSelectedResidueList(){let e=[],t=this.getResidueProxy();for(let n=0;n<this.getResidueCount();n+=1)t.load(n).sidechain&&e.push(n);return e}}var kd=n("9e12"),Vd=n.n(kd);n("0e33"),n("4939");class Ud{constructor(e,t){this.color=t,this.div=r()("<canvas>").css({position:"absolute","z-index":"1",display:"none","pointer-events":"none"}),this.canvas=this.div[0],this.context2d=this.canvas.getContext("2d"),this.parentDiv=r()(e.divTag),this.parentDiv.append(this.div)}hide(){this.div.css("display","none")}move(e,t,n,i){this.parentDiv.position();let r=Math.abs(e-n),o=Math.abs(t-i),s=Math.min(e,n),a=Math.min(t,i);this.div.css("display","block").css("width",r).css("height",o).css("top",a).css("left",s),this.canvas.width=r,this.canvas.height=o,this.context2d.clearRect(0,0,r,o),this.context2d.beginPath(),this.context2d.moveTo(e-s,t-a),this.context2d.lineTo(n-s,i-a),this.context2d.lineWidth=2,this.context2d.strokeStyle=this.color,this.context2d.stroke()}}class Fd{constructor(e){this.parentDiv=r()(e),this.parentDivId=this.parentDiv.attr("id"),this.div=r()("<div>").css("user-select","none"),this.parentDiv.append(this.div),this.canvas=r()("<canvas>"),this.div.append(this.canvas),this.canvasDom=this.canvas[0],this.drawContext=this.canvasDom.getContext("2d"),this.mousePressed=!1,this.downTimer=null;const t=this.canvasDom,n=(e,n)=>{t.addEventListener(e,n)};n("mousedown",e=>this.mousedown(e)),n("mousemove",e=>this.mousemove(e)),n("mouseup",e=>this.mouseup(e)),n("mouseout",e=>this.mouseout(e)),n("touchstart",e=>this.mousedown(e)),n("touchmove",e=>this.mousemove(e)),n("touchend",e=>this.mouseup(e)),n("touchcancel",e=>this.mouseup(e))}width(){return this.parentDiv.width()}height(){return this.parentDiv.height()}x(){let e=this.parentDiv.position();return e.left}y(){let e=this.parentDiv.position();return e.top}inside(e,t){return e>=this.x()&&e<=this.x()+this.width()&&t>=this.y()&&t<=this.y()+this.height()}update(){}resize(){this.canvasDom.width=this.width(),this.canvasDom.height=this.height()}strokeRect(e,t,n,i,r){this.drawContext.strokeStyle=r,this.drawContext.strokeRect(e,t,n,i)}fillRect(e,t,n,i,r){this.drawContext.fillStyle=r,this.drawContext.strokeStyle="none",this.drawContext.fillRect(e,t,n,i)}line(e,t,n,i,r,o){this.drawContext.fillStyle=o,this.drawContext.strokeStyle=o,this.drawContext.beginPath(),this.drawContext.lineWidth=r,this.drawContext.moveTo(e,t),this.drawContext.lineTo(n,i),this.drawContext.stroke()}text(e,t,n,i,r,o){this.drawContext.fillStyle=r,this.drawContext.font=i,this.drawContext.textAlign=o,this.drawContext.textBaseline="middle",this.drawContext.fillText(e,t,n)}textWidth(e,t){return this.drawContext.font=t,this.drawContext.textAlign="center",this.drawContext.measureText(e).width}saveMouse(){this.saveMouseX=this.pointerX,this.saveMouseY=this.pointerY,this.saveMouseR=this.mouseR,this.saveMouseT=this.mouseT}click(e){}doubleclick(e){}mousedown(e){e.preventDefault(),this.getPointer(e),this.saveMouse(),this.mousePressed=!0,null===this.downTimer?this.downTimer=setTimeout(()=>this.click(e),250):(clearTimeout(this.downTimer),this.doubleclick(e),this.downTimer=null),this.mousemove(e)}mousemove(e){}mouseout(e){}mouseup(e){e.preventDefault(),this.mousePressed=!1}getPointer(e){mh(e.touches)&&e.touches.length>0?(this.eventX=e.touches[0].clientX,this.eventY=e.touches[0].clientY):(this.eventX=e.clientX,this.eventY=e.clientY);let t=e.target.getBoundingClientRect();this.pointerX=this.eventX-t.left,this.pointerY=this.eventY-t.top;let n=this.pointerX-this.width()/2,i=this.pointerY-this.height()/2;this.mouseR=Math.sqrt(n*n+i*i),this.mouseT=Math.atan(i/n),n<0&&(i>0?this.mouseT+=Math.PI:this.mouseT-=Math.PI)}}class zd{constructor(e,t){s.a.isUndefined(t)?this.heightArrow=30:this.heightArrow=t,this.div=r()("<div>").css({position:"absolute",top:0,left:0,background:"white","box-sizing":"border-box",font:"12px Helvetica",color:"#666",padding:"5",opacity:.8,display:"none","max-width":"300px","z-index":1,cursor:"pointer","user-select":"none","pointer-events":"none"}),this.arrow=r()("<div>").css({position:"absolute",top:0,left:0,width:0,height:0,"box-sizing":"border-box","border-left":"5px solid transparent","border-right":"5px solid transparent","border-top":this.heightArrow+"px solid white",opacity:.8,display:"none","z-index":1,"pointer-events":"none","user-select":"none"}),this.parentDiv=r()(e),this.parentDiv.append(this.div),this.parentDiv.append(this.arrow)}move(e,t){this.div.css({display:"block"});let n=this.div[0].getBoundingClientRect(),i=n.width,r=n.height;this.arrow.css({display:"block"}),e<0||e>this.parentDiv.width()||t<0||t>this.parentDiv.height()?this.hide():(this.arrow.css({top:t-this.heightArrow,left:e-5}),this.div.css({top:t-this.heightArrow-r,left:e-i/2}))}hide(){this.div.css("display","none"),this.arrow.css("display","none")}html(e){this.div.html(e)}remove(){this.div.remove(),this.arrow.remove()}}class jd{constructor(e){this.soupWidget=e,this.soupView=e.soupView,this.controller=e.controller,this.popups=[]}removePopup(e){this.controller.deleteAtomLabel(e),this.popups[e].remove(),this.popups.splice(e,1)}createPopup(e){let t=new zd(this.soupWidget.divTag);return t.i=e,t.div.css("pointer-events","auto"),t.div.click(()=>{this.removePopup(t.i)}),t}drawFrame(){let e=this.soupView.currentView.labels;if(e.length>this.popups.length)for(let n=this.popups.length;n<e.length;n+=1)this.popups.push(this.createPopup(n));if(this.popups.length>e.length)for(let n=this.popups.length-1;n>=e.length;n-=1)this.removePopup(n);let t=this.soupView.soup.getAtomProxy();for(let n=0;n<e.length;n+=1){this.popups[n].i=n,t.iAtom=e[n].i_atom,this.popups[n].html(e[n].text);let i=.7*this.soupWidget.opacity(t.pos)+.2;this.popups[n].div.css("opacity",i),this.popups[n].arrow.css("opacity",i);let r=this.soupWidget.getPosXY(t.pos);this.popups[n].move(r.x,r.y),this.soupWidget.inZlab(t.pos)||(this.popups[n].div.css("display","none"),this.popups[n].arrow.css("display","none"))}}}class Bd{constructor(e){this.distanceMeasures=[],this.scene=e.displayScene,this.soupView=e.soupView,this.controller=e.controller,this.soupWidget=e,this.parentDiv=r()(this.soupWidget.divTag),this.divs=[]}removeDistance(e){this.scene.remove(this.distanceMeasures[e].line),this.distanceMeasures[e].div.remove(),this.controller.deleteDistance(e),this.distanceMeasures.splice(e,1)}createDistanceMeasure(e){let t=r()("<div>").css({position:"absolute",top:0,left:0,"background-color":"#FFDDDD",padding:"5",opacity:.7,"font-family":"sans-serif"});t.i=e,t.click(()=>{this.removeDistance(t.i)}),this.parentDiv.append(t);let n=new fr;n.vertices.push(new Nt(0,0,0)),n.vertices.push(new Nt(1,1,1));let i=new yl({color:16742263,dashSize:3,gapSize:4,linewidth:1}),o=new ks(n,i);return o.dontDelete=!0,this.scene.add(o),{line:o,div:t}}drawFrame(){let e=this.soupView.currentView.distances;if(e.length>this.distanceMeasures.length)for(let i=this.distanceMeasures.length;i<e.length;i+=1)this.distanceMeasures.push(this.createDistanceMeasure(i));if(this.distanceMeasures.length>e.length)for(let i=this.distanceMeasures.length-1;i>=e.length;i-=1)this.removeDistance(i);this.parentDiv.position();let t=this.soupView.soup.getAtomProxy(),n=this.soupView.soup.getAtomProxy();for(let i=0;i<e.length;i+=1){let r=e[i];this.distanceMeasures[i].div.i=i;let o=this.distanceMeasures[i],s=t.load(r.i_atom1).pos,a=n.load(r.i_atom2).pos,l=s.distanceTo(a).toFixed(1);o.div.text(l);let u=s.clone().add(a).multiplyScalar(.5),c=.7*this.soupWidget.opacity(u)+.3,h=this.soupWidget.getPosXY(u),d=h.x,p=h.y;if(d<0||d>this.parentDiv.width()||p<0||p>this.parentDiv.height()){o.div.hide();continue}let f=o.div.innerHeight(),m=o.div.innerWidth();o.div.css({top:p-f/2,left:d-m/2,display:"block",cursor:"pointer",opacity:c}),o.line.geometry.vertices[0].copy(s),o.line.geometry.vertices[1].copy(a),this.soupWidget.inZlab(u)||o.div.css("display","none")}}}class $d extends Fd{constructor(e,t){super(e),this.soupWidget=t,this.soupView=t.soupView,this.soup=t.soup,this.controller=t.controller,this.soupWidget.addObserver(this),this.residue=this.soup.getResidueProxy(),this.charWidth=14,this.charHeight=15,this.offsetY=6,this.heightStructureBar=7,this.spacingY=12,this.yTopSequence=this.offsetY+this.heightStructureBar+2*this.spacingY,this.yBottom=parseInt(this.yTopSequence+2.7*+this.spacingY+this.charHeight),this.yMidSequence=this.yTopSequence+1.2*this.spacingY+this.charHeight/2,this.unclickableColor="#AAA",this.structBarBgroundColor="#CCC",this.seqBarBgroundColor="#FFF",this.highlightColor="red",this.borderColor="#999",this.div.attr("id",this.parentDivId+"-inner"),this.div.css({"background-color":"#CCC",position:"relative"}),this.isWaitForDoubleClick=!1,this.charEntries=[],this.nChar=null,this.iCharSeqStart=null,this.iCharSeqEnd=null,this.nCharSeq=null,this.iCharStructStart=null,this.iCharStructEnd=null,this.nCharStruct=null,this.nPadChar=0,this.hover=new zd(`#${this.parentDivId}-inner`,15),this.pressSection="none"}width(){return this.parentDiv.width()}height(){return this.yBottom}resize(){super.resize(),this.div.height(this.height()),this.parentDiv.height(this.height())}iCharFromXStruct(e){return parseInt(e*this.nCharStruct/this.textWidth())+this.iCharStructStart}xStructFromIChar(e){return parseInt((e-this.iCharStructStart)/this.nCharStruct*this.textWidth())}textWidth(){return this.width()}iCharFromXSeq(e){return parseInt(e*this.nCharSeq/this.textWidth())+this.iCharSeqStart}xSeqFromIChar(e){return parseInt((e-this.iCharSeqStart)/this.nCharSeq*this.textWidth())}calcNPad(){let e=[];for(let i of s.a.range(this.soup.structureIds.length))e.push(0);let t=this.soup.getResidueProxy();for(let i of s.a.range(this.soup.getResidueCount()))t.iRes=i,t.isPolymer&&(e[t.iStructure]+=1);e=s.a.filter(e,e=>e>0);let n=s.a.mean(e);this.nPadChar=parseInt(.02*n)}rebuild(){this.charEntries.length=0,this.calcNPad();let e=-1,t=0,n=this.soup.getResidueProxy();for(let i of s.a.range(this.soup.getResidueCount())){if(n.iRes=i,!n.isPolymer)continue;if(t!==n.iStructure||e!==n.iChain){e=n.iChain,t=n.iStructure;for(let i of s.a.range(this.nPadChar)){let r=null;0===i&&(r=this.soup.structureIds[t],r+=":"+this.soup.chains[e]),this.charEntries.push({chain:n.chain,iStructure:t,c:"",startLabel:r,iRes:null,ss:""})}}let r={iStructure:t,chain:n.chain,iRes:i,startLabel:null,ss:n.ss,label:n.resId+":"+n.resType,resNum:n.resNum},o=n.resType;r.c=o in fd?fd[o]:".",this.charEntries.push(r)}this.nChar=this.charEntries.length,this.iCharSeqStart=this.nPadChar,this.iCharStructStart=0,this.nCharStruct=this.nChar,this.iCharStructEnd=this.nChar}centerSeqOnIChar(e){this.iCharSeqStart=Math.max(e-.5*this.nCharSeq,0),this.iCharSeqStart=Math.min(this.iCharSeqStart,this.nChar-this.nCharSeq),this.iCharSeqStart=parseInt(this.iCharSeqStart),this.iCharSeqEnd=this.iCharSeqStart+this.nCharSeq}getColorStyle(e){if(e>=this.charEntries.length)return this.unclickableColor;let t=this.charEntries[e].iRes;return s.a.isNil(t)?this.unclickableColor:(this.residue.load(t),s.a.isNil(this.residue.activeColor)?this.unclickableColor:"#"+this.residue.activeColor.getHexString())}findFirstResidue(e){for(let t=e;t<this.nChar-1;t+=1){let e=this.charEntries[t+1];if(!s.a.isNil(e.iRes))return t}return null}checkChain(){this.nCharSeq=Math.ceil(this.width()/this.charWidth);let e=this.chain;if(this.iCharStructStart=0,this.nCharStruct=this.charEntries.length,this.iCharStructEnd=this.iCharStructStart+this.nCharStruct,"chain"===this.soupView.getMode()){let t=this.soup.getIStructureAndChain();if(s.a.isNil(t))this.chain=null;else{this.iCharStructStart=null;for(let e of s.a.range(this.charEntries.length)){let n=this.charEntries[e];n.iStructure===t.iStructure&&n.chain===t.chain&&(s.a.isNil(this.iCharStructStart)&&(this.iCharStructStart=e,this.chain=n.chain),this.iCharStructEnd=e+1)}if(this.nCharStruct=this.iCharStructEnd-this.iCharStructStart,s.a.isNil(e)&&!s.a.isNil(this.chain)){for(let e=this.iCharStructStart;e<this.iCharStructEnd;e+=1)if(s.a.has(this.charEntries[e],"iRes")){this.iCharSeqStart=e,this.iCharSeqEnd=this.iCharSeqStart+this.nCharSeq;break}}else if(this.iCharSeqStart<this.iCharStructStart||this.iCharSeqStart>=this.iCharStructEnd){let e=this.findFirstResidue(this.iCharStructStart);s.a.isNil(e)?this.iCharSeqStart=this.iCharStructStart:this.iCharSeqStart=e,this.iCharSeqEnd=this.iCharSeqStart+this.nCharSeq}}}this.iCharSeqStart+this.nCharSeq>this.charEntries.length&&(this.iCharSeqStart=this.iCharSeqEnd-this.nCharSeq),this.iCharSeqStart<0&&(this.iCharSeqStart=0),this.iCharSeqEnd=this.iCharSeqStart+this.nCharSeq}draw(){this.checkChain();let e=this.offsetY-2,t=this.offsetY+7,n=this.yTopSequence-e+2,i=e+n/2+2,r=this.yBottom-this.yTopSequence;if(this.fillRect(0,0,this.width(),this.height(),this.structBarBgroundColor),this.fillRect(0,this.yTopSequence,this.width(),r,this.seqBarBgroundColor),this.line(0,this.yTopSequence,this.width(),this.yTopSequence,1,this.borderColor),this.line(0,this.yBottom,this.width(),this.yBottom,1,this.borderColor),!mh(this.soupView))return;if(0===this.charEntries.length)return;let o,a=this.soupView.currentView.iAtom,l=this.soupView.soup.getAtomProxy(a).iRes,u=this.xStructFromIChar(this.iCharSeqStart),c=this.xStructFromIChar(this.iCharSeqEnd);this.fillRect(u,e,c-u,n,this.seqBarBgroundColor),this.line(0,i,this.width(),i,1,this.borderColor);let h,d=this.charEntries[0].ss,p=this.charEntries[0].c,f=this.getColorStyle(0),m=0,g=0;while(g<this.nChar){g+=1,h=this.getColorStyle(g);let e=this.charEntries[g],t=s.a.isNil(e)||g===this.nChar||e.ss!==d||h!==f;if(t){let t=this.xStructFromIChar(m),n=this.xStructFromIChar(g),r=this.heightStructureBar,o=i-r/2;""!==p&&("C"!==d&&"."!==d&&(o-=2,r+=4),this.fillRect(t,o,n-t,r,f)),g<=this.nChar-1&&(m=g,d=e.ss,p=e.c,f=h)}}this.line(0,this.yMidSequence,this.width(),this.yMidSequence,1,this.borderColor);for(let y=this.iCharSeqStart;y<this.iCharSeqEnd;y+=1){let e=this.charEntries[y];if(s.a.isUndefined(e)||""===e.c)continue;o=this.getColorStyle(y);let t=this.xSeqFromIChar(y),n=this.xSeqFromIChar(y+1),i=n-t,r=t+i/2,a=this.charHeight,u=this.yMidSequence-a/2;"C"!==e.ss&&"."!==e.ss&&(u-=4,a+=8),this.fillRect(t,u,i,a,o),this.text(e.c,r,this.yMidSequence,"7pt Helvetica","white","center"),this.soupWidget.isCrossHairs&&l>=0&&l===e.iRes&&this.strokeRect(t,u-5,i,a+10,this.highlightColor),e.resNum%20!==0&&1!==e.resNum||(this.line(t,this.yBottom,t,this.yBottom-6,1,this.borderColor),this.text(""+e.resNum,t+3,this.yBottom-6,"7pt Helvetica",this.borderColor,"left"))}this.line(u-1,e,c+1,e,1,this.borderColor),this.line(u-1,e,u-1,this.yTopSequence+1,1,this.borderColor),this.line(c+1,e,c+1,this.yTopSequence+1,1,this.borderColor);let v=0;while(v<this.nChar){if(this.charEntries[v].startLabel){let e=this.xStructFromIChar(v)+12;this.text(this.charEntries[v].startLabel,e,t,"7pt Helvetica","#666","left")}v+=1}}update(){let e=s.a.get(this.soupView,"targetView.iAtom"),t=this.soupView.soup.getAtomProxy(e).iRes;if(!s.a.isNil(t))for(let n in s.a.range(this.nChar))if(this.charEntries[n].iRes===t){(n<this.iCharSeqStart||n>=this.iCharSeqStart+this.nCharSeq)&&this.centerSeqOnIChar(n);break}this.draw()}mousemove(e){if(this.getPointer(e),this.pointerY<this.yTopSequence){this.hover.hide();let e=this.iCharFromXStruct(this.pointerX),t=this.charEntries[e];""!==s.a.get(t,"c","")&&(this.hover.html(t.label),this.hover.move(this.xStructFromIChar(e),25))}else{this.hover.hide();let e=this.iCharFromXSeq(this.pointerX),t=this.charEntries[e];if(""!==s.a.get(t,"c","")){this.hover.html(t.label);let n=this.xSeqFromIChar(e)+this.charWidth/2;this.hover.move(n,this.yMidSequence)}}if("top"===this.mousePressed)this.centerSeqOnIChar(this.iCharFromXStruct(this.pointerX)),this.draw();else if("bottom"===this.mousePressed){let e=this.iCharFromXSeq(this.pointerX),t=e-this.iCharPressed;this.iCharSeqStart-=t,this.draw()}}mouseout(){this.hover.hide(),this.mousePressed=""}mouseup(){this.isWaitForDoubleClick&&this.click(event),this.hover.hide(),this.mousePressed=""}doubleclick(e){console.log("SequenceWidget.doubleclick",this.pressSection,this.iCharPressed),this.getPointer(e);let t=null;t="bottom"===this.pressSection?this.iCharFromXSeq(this.pointerX):this.iCharFromXStruct(this.pointerX);let n=this.charEntries[t];if(!s.a.isNil(n.iRes)){"top"===this.pressSection?this.controller.selectSecondaryStructure(n.iRes):this.controller.setResidueSelect(n.iRes,!0);let e=this.soup.getResidueProxy(n.iRes);this.controller.triggerAtom(e.iAtom)}}click(e){let t=null;if(t="bottom"===this.pressSection?this.iCharFromXSeq(this.pointerX):this.iCharFromXStruct(this.pointerX),t===this.iCharPressed)if("top"===this.pressSection){let e=this.charEntries[this.iCharPressed];if(!s.a.isNil(e.iRes)){let t=e.iRes;this.controller.toggleSecondaryStructure(t)}}else if("bottom"===this.pressSection){let t=this.charEntries[this.iCharPressed];if(!s.a.isNil(t.iRes)){let n=t.iRes;e.metaKey||e.shiftKey?e.shiftKey?this.controller.selectAdditionalRangeToResidue(n):this.controller.selectAdditionalResidue(n):this.controller.selectResidue(n)}}}mousedown(e){e.preventDefault(),this.getPointer(e),this.saveMouse(),this.pointerY<this.yTopSequence?this.mousePressed="top":this.mousePressed="bottom";let t=(new Date).getTime(),n=this.timePressed?t-this.timePressed:0;n>600&&(this.isWaitForDoubleClick=!1),this.isWaitForDoubleClick?n<600&&(this.doubleclick(e),this.isWaitForDoubleClick=!1):(this.pressSection=this.mousePressed,"bottom"===this.pressSection?this.iCharPressed=this.iCharFromXSeq(this.pointerX):this.iCharPressed=this.iCharFromXStruct(this.pointerX),this.isWaitForDoubleClick=!0),this.timePressed=(new Date).getTime(),this.mousemove(e)}}class Hd extends Fd{constructor(e,t){super(t),this.div.css("position","relative"),this.soupView=e.soupView,this.controller=e.controller,e.addObserver(this),this.maxZLength=0,this.div.css("box-sizing","border-box"),this.zFrontColor="rgb(150, 90, 90)"}resize(){this.div.css({width:this.width(),height:this.height()}),super.resize(),this.update()}x(){return 0}y(){return 0}width(){let e=this.parentDiv[0].getBoundingClientRect();return e.width-20}height(){return this.parentDiv.height()}xToZ(e){let t=e/this.width();return(.5-t)*this.maxZLength}zToX(e){let t=e/this.maxZLength;return(.5-t)*this.width()}update(){let e=this.soupView.soup,t=this.soupView.currentView.cameraParams;this.maxZLength=2*e.maxLength;let n=this.zToX(t.zBack),i=this.zToX(t.zFront),r=this.zToX(0),o=this.height()/2,s="9pt Helvetica";this.fillRect(0,0,this.width(),this.height(),"#999"),this.fillRect(0,o-3,this.width(),6,"#AAB"),this.fillRect(r,o-3,n-r,6,this.zFrontColor);let a=this.textWidth("back",s);this.fillRect(n-6-a,0,a+6,this.height(),"#666"),this.text("back",n-3-a,o,s,"#AAA","left"),this.fillRect(i,o-3,r-i,6,this.zFrontColor);let l=this.textWidth("front",s);this.fillRect(i,0,l+6,this.height(),"#666"),this.text("front",i+3,o,s,"#AAA","left"),this.line(r,0,r,this.height(),1,"#995555")}getZ(e){this.getPointer(e),this.z=this.xToZ(this.pointerX)}mousedown(e){this.getZ(e),this.z>0?(this.back=!0,this.front=!1):(this.front=!0,this.back=!1),super.mousedown(e)}mousemove(e){if(e.preventDefault(),super.mousemove(e),!this.mousePressed)return;this.getZ(e);let t=this.soupView.currentView.cameraParams,n=t.zBack,i=t.zFront;this.back?this.controller.setZoom(Math.max(2,this.z),i):this.front&&this.controller.setZoom(n,Math.min(-2,this.z)),this.update()}}class Gd{constructor(e,t,n,i,o,s){this.soupView=e.soupView,this.controller=e.controller,this.elem=n,this.color=s,this.div=r()(t).text(n).addClass("jolecule-button").css("position","absolute").css("top",o+"px").css("left",i+"px").css("height","15px").css("width","20px").on("click touch",e=>{e.preventDefault(),this.toggle()}),this.update(),e.addObserver(this)}getToggle(){return this.soupView.soup.grid.isElem[this.elem]}toggle(){this.controller.toggleGridElem(this.elem),this.update()}update(){this.getToggle()?this.color?this.div.css("background-color",this.color):this.div.addClass("jolecule-button-toggle-on"):this.color?this.div.css("background-color",""):this.div.removeClass("jolecule-button-toggle-on")}}class Wd extends Fd{constructor(e){super(e.divTag),this.soupWidget=e,this.soupView=e.soupView,this.controller=e.controller,e.addObserver(this),this.backgroundColor="#999",this.buttonHeight=40,this.sliderHeight=6*this.buttonHeight-30,this.isGrid=e.isGrid,this.div.css("display","none"),this.div.attr("id","grid-control"),this.div.css("height",this.height()),this.div.addClass("jolecule-button"),this.buttonsDiv=r()('<div id="grid-control-buttons">'),this.div.append(this.buttonsDiv)}rebuild(){if(!this.isGrid)return;this.buttonsDiv.empty();let e=10;for(let t of s.a.keys(this.soupView.soup.grid.isElem))this.makeElemButton(t,e),e+=this.buttonHeight;0===s.a.keys(this.soupView.soup.grid.isElem).length?this.div.hide():this.div.show()}makeElemButton(e,t){let n=dd[e],i="#"+n.getHexString(),o="grid-button-"+e.toLowerCase(),s="#"+o;this.buttonsDiv.append(r()(`<div id="${o}">`)),new Gd(this.soupWidget,s,e,50,t,i)}resize(){this.isGrid&&(this.div.css({width:this.width(),height:this.height(),top:this.y(),left:this.x()}),this.canvasDom.width=this.width(),this.canvasDom.height=this.height())}width(){return 84}height(){return 6*this.buttonHeight+10}x(){let e=this.parentDiv.position();return e.left+5}y(){let e=this.parentDiv.position();return e.top+50}yToZ(e){let t=(e-20)/this.sliderHeight,n=this.soupView.soup.grid,i=n.bMax-n.bMin,r=t*i+n.bMin;return r<this.soupView.soup.grid.bMin&&(r=this.soupView.soup.grid.bMin),r>this.soupView.soup.grid.bMax&&(r=this.soupView.soup.grid.bMax),r}zToY(e){let t=this.soupView.soup.grid,n=t.bMax-t.bMin;return(e-t.bMin)/n*this.sliderHeight+20}update(){if(!this.isGrid)return;this.fillRect(0,0,this.width(),this.height(),this.backgroundColor);let e=20,t=this.zToY(this.soupView.soup.grid.bMin),n=this.zToY(this.soupView.soup.grid.bMax);this.fillRect(e-3,t,6,n-t,"#AAB");let i="10px sans-serif",r="#333",o=this.zToY(this.soupView.soup.grid.bCutoff),s=this.soupView.soup.grid.convertB(this.soupView.soup.grid.bCutoff).toFixed(2);this.fillRect(e-3,o,6,n-o,"rgb(150, 90, 90)"),this.fillRect(5,o,30,5,r),this.text(s,e,o-8,i,r,"center"),this.line(5,n,35,n,1,"#666"),s=this.soupView.soup.grid.convertB(this.soupView.soup.grid.bMax).toFixed(2),this.text(s,e,n+6,i,r,"center")}getZ(e){this.getPointer(e),this.z=this.yToZ(this.pointerY)}mousedown(e){e.preventDefault(),this.getZ(e),this.mousePressed=!0,this.mousemove(e)}mousemove(e){e.preventDefault(),this.mousePressed&&(this.getZ(e),this.controller.setGridCutoff(this.z),this.update())}mouseup(e){e.preventDefault(),this.mousePressed=!1}}class qd extends Fd{constructor(e){super(e.divTag),this.offset={x:5,y:5},this.canvas.hide(),this.default(),this.div.css("display","block"),this.div.attr("id","color-legend"),this.div.addClass("jolecule-button"),this.div.css({padding:"8px",position:"absolute",height:"auto",width:"auto"}),this.buttonsDiv=r()("<div>").attr("id","color-legend-buttons").css("text-align","left"),this.div.append(this.buttonsDiv),this.isShow=!0,e.addObserver(this),this.rebuild()}default(){let e=e=>"#"+pd(e).getHexString();this.title="Secondary Structure",this.colorEntries=[{color:e("E"),label:"Strand"},{color:e("H"),label:"Helix"},{color:e("C"),label:"Coil"},{color:e("D"),label:"DNA/RNA"}]}rebuild(){this.buttonsDiv.empty(),this.title&&this.buttonsDiv.append(r()("<div>").text(this.title).css({"font-size":"0.8em","font-style":"italic"}));for(let[e,t]of this.colorEntries.entries()){let n="color-legend-"+e,i=r()("<div>").attr("id",n).css({"font-size":"0.8em","line-height":"1.5em",display:"block"}),o=r()("<div>").html("&block;").css({color:t.color,display:"inline","font-size":"1em","margin-right":"0.7em"});i.append(o),i.append(t.label),this.buttonsDiv.append(i)}this.resize(),this.update()}resize(){this.div.css({bottom:this.offset.y,left:this.offset.x})}width(){return 80}height(){return this.buttonsDiv.height()}update(){this.isShow?this.div.show():this.div.hide()}}class Yd extends Fd{constructor(e){super(e.divTag),this.soupWidget=e,this.offset={x:5,y:5},this.canvas.hide(),this.div.css("display","block"),this.div.attr("id",e.webglDivId+"-selection"),this.div.addClass("jolecule-button"),this.div.css({padding:"8px",position:"absolute","max-width":"180px",height:"auto","font-size":"0.8em","text-align":"left"}),this.isShow=!1,e.addObserver(this)}resize(){this.div.css({bottom:this.offset.y,right:this.offset.x})}getText(){let e=this.soupWidget.soup,t=e.getResidueProxy(),n="",i=null,r=null,o=null,s=!1;for(let a=0;a<e.getResidueCount();a+=1)t.iRes=a,t.selected?(null!==o&&o===t.chain||(null!==o&&(n+="<br>"),o=t.chain,n+=e.structureIds[t.iStructure]+"-"+o+": ",s=!1),null===i?(i=t.resNum,r=t.resNum):r=t.resNum):null!==i&&(s?n+=", ":s=!0,n+=i===r?i:i+"-"+r,i=null,r=null);if(!n&&"chain"===this.soupWidget.soupView.getMode()&&e.selectedTraces.length>0){let t=e.selectedTraces[0],i=e.traces[t].indices[0],r=e.getResidueProxy(i),o=e.structureIds[r.iStructure];n+=`${o}-${r.chain}`}return n}async update(){let e=this.getText();e?(this.div.show(),this.div.html(e),this.resize()):this.div.hide()}}class Xd{constructor(e,t){this.controller=e.controller,this.soupView=e.soupView,this.soupWidget=e,this.soupWidget.addObserver(this),this.div=r()(t).css("z-index",2),this.divId=this.div.attr("id"),this.selectId=this.divId+"-residue-select",this.$select=r()("<select>").attr("id",this.selectId),this.div.append(this.$select),this.$select.change(()=>this.change()),this.$select.select2({width:"150px"})}change(){let e=parseInt(this.$select.val()),t=this.soupView.soup.getResidueProxy(e);this.controller.clearSelectedResidues(),this.controller.setResidueSelect(e,!0),this.controller.setTargetViewByIAtom(t.iAtom)}rebuild(){this.$select.empty(),this.soup=this.soupView.soup;let e=this.soup.getResidueProxy();for(let t of s.a.range(this.soup.getResidueCount())){if(e.iRes=t,"XXX"===e.resType)continue;let n=e.resId+"-"+e.resType;this.$select.append(new Option(n,""+t))}}update(){if(this.$select){let e=this.soupView.currentView.iAtom,t=this.soupView.soup.getAtomProxy(e).iRes,n=s.a.isNil(t)?null:""+t,i=this.$select.val();if(i!==n){let e=new Date;this.$select.val(n).trigger("change.select2");let t=(new Date-e)/1e3;console.log(`ResidueSelectorWidget.update ${i} -> ${n} in ${t.toFixed(3)}s`)}}}}class Zd{constructor(e,t,n=!0){this.soupWidget=e,this.controller=e.controller,this.isShowPanel=!1,this.isPopAbove=n,this.div=r()(t).html("Graphics").addClass("jolecule-button").on("click touch",e=>{this.isShowPanel=!this.isShowPanel,this.update(),e.preventDefault()}),this.divId=this.div.attr("id"),this.popOutPanelDiv=r()("<div>").addClass("jolecule-embed-view").css({position:"absolute","z-index":1,padding:"4px 5px"}),this.div.parent().append(this.popOutPanelDiv),this.widget={},this.popOutPanelDiv.append(r()(`<div id="${this.divId}-transparent">`)),this.widget.transparent=new Kd(e,`#${this.divId}-transparent`,"transparent"),this.popOutPanelDiv.append(r()(`<div id="${this.divId}-sphere">`)),this.widget.sphere=new Kd(e,`#${this.divId}-sphere`,"sphere"),this.popOutPanelDiv.append(r()(`<div id="${this.divId}-backbone">`)),this.widget.backbone=new Kd(e,`#${this.divId}-backbone`,"backbone"),this.popOutPanelDiv.append(r()(`<div id="${this.divId}-water">`)),this.widget.water=new Kd(e,`#${this.divId}-water`,"water"),this.popOutPanelDiv.append(r()(`<div id="${this.divId}-ribbon">`)),this.widget.ribbon=new Kd(e,`#${this.divId}-ribbon`,"ribbon"),this.popOutPanelDiv.append(r()(`<div id="${this.divId}-ligand">`)),this.widget.ligand=new Kd(e,`#${this.divId}-ligand`,"ligands"),this.soupWidget.addObserver(this),this.update()}update(){this.popOutPanelDiv.css("display",this.isShowPanel?"block":"none"),this.isShowPanel?this.div.addClass("jolecule-button-toggle-on"):this.div.removeClass("jolecule-button-toggle-on");let e=this.div.position();this.isPopAbove?this.popOutPanelDiv.css({top:e.top-this.popOutPanelDiv.outerHeight()-4,left:e.left-7}):this.popOutPanelDiv.css({top:e.top+this.div.outerHeight()+4,left:e.left-7});let t=this.popOutPanelDiv.position().left+this.popOutPanelDiv.width();t>e.left+this.div.width()&&this.popOutPanelDiv.css("left",e.left+this.div.width()-this.popOutPanelDiv.width())}}class Jd{constructor(e,t){this.soupWidget=e,this.controller=e.controller,this.div=r()(t).html(this.html()).addClass("jolecule-button").on("click touch",e=>{this.set(!this.get()),this.update(),e.preventDefault()}),this.soupWidget.addObserver(this)}html(){}get(){}set(e){}update(){this.get()?this.div.hasClass("jolecule-button-toggle-on")||this.div.addClass("jolecule-button-toggle-on"):this.div.hasClass("jolecule-button-toggle-on")&&this.div.removeClass("jolecule-button-toggle-on")}}class Kd extends Jd{constructor(e,t,n){super(e,t),this.option=n,this.div.html(this.html())}html(){return s.a.capitalize(this.option)}get(){return this.controller.getShowOption(this.option)}set(e){this.controller.setShowOption(this.option,e)}}class Qd extends Jd{constructor(e,t,n,i){super(e,t),this.state=n,this.text=i,this.div.html(this.html())}html(){return this.text}get(){return this.controller.getAnimateState()===this.state}set(e){e?this.controller.setAnimateState(this.state):this.controller.setAnimateState("none")}}class ep extends Jd{constructor(e,t){super(e,t),this.soupView=this.soupWidget.soupView,this.isText=!0}html(){return"Text"}get(){return this.isText}set(e){this.isText=e}async update(){if(super.update(),this.isText&&this.soupWidget){let e,t=this.soupView.savedViews.length;if(t>0){let n=this.soupView.currentView.order+1;e=`${n}/${t}: ${this.soupView.currentView.text}`,await this.soupWidget.asyncSetMesssage(e)}}else this.soupWidget.cleanupMessage()}}function tp(e){window.keyboardLock=!0;let t=r()("<div>").addClass("jolecule-dialog").css("display","block").css("z-index","5").css("width",Math.min(400,e.width()-100));function n(){t.remove(),window.keyboardLock=!1}let i=gh("close","jolecule-small-button",n),o=r()("<div>").css({width:"100%","box-sizing":"border-box","margin-bottom":"0.5em",padding:"1em"}).addClass("jolecule-view-text").html('<label>Jolecule is an embeddable WebGL molecular viewer with easy facilities to\n         make interactive slide shows. For more info, see\n         <a href="https://jolecule.com">jolecule.com</a>\n       </label>').keydown((function(e){if(27===e.keyCode)return n(),!0})),s=r()("<div>").css("width","100%").append(o).append(" ").append(i);t.append(s),vh(e,t,0,0),setTimeout(()=>{s.find("textarea").focus()},100)}class np{constructor(e,t,n,i=!0,o=!0){this.embedJolecule=e,this.soupWidget=this.embedJolecule.soupWidget,this.proteinDisplayDiv=r()(t),this.isToolbarOnTop=o,this.isChange=!0,this.isToggleOn=!i,this.buttonInDisplayOffset={x:0,y:0},this.toolbarDiv=r()(n),this.buttonInDisplayDiv=r()('<div id="toggle-toolbar-button">').html("&#9776;").addClass("jolecule-button").css({margin:"5px",position:"absolute"}).on("click touch",e=>{this.isChange=!0,this.update(),e.preventDefault()}),this.proteinDisplayDiv.append(this.buttonInDisplayDiv),this.buttonInToolbarDiv=r()('<div id="toggle-toolbar-button2">').html("&#9776;").addClass("jolecule-button").addClass("jolecule-button-toggle-on").on("click touch",e=>{this.isChange=!0,this.update(),e.preventDefault()}),this.toolbarDiv.append(this.buttonInToolbarDiv),this.soupWidget.addObserver(this),this.resize()}resize(){this.isToolbarOnTop?this.buttonInDisplayDiv.css({top:this.buttonInDisplayOffset.y,left:this.buttonInDisplayOffset.x}):this.buttonInDisplayDiv.css({bottom:this.buttonInDisplayOffset.y,left:this.buttonInDisplayOffset.x})}async update(){this.isChange&&(this.isToggleOn=!this.isToggleOn,this.isChange=!1,this.isToggleOn?(this.buttonInDisplayDiv.hide(),this.toolbarDiv.show()):(this.buttonInDisplayDiv.show(),this.toolbarDiv.hide()),this.isToolbarOnTop?this.isToggleOn?(this.soupWidget.messageOffset.x=5,this.soupWidget.messageOffset.y=5):(this.soupWidget.messageOffset.x=35,this.soupWidget.messageOffset.y=5):this.isToggleOn?this.embedJolecule.widget.colorLegend.offset.y=5:this.embedJolecule.widget.colorLegend.offset.y=50,this.resize(),this.embedJolecule.resize())}}var ip={LineElement:Ud,PopupText:zd,AtomLabelsWidget:jd,DistanceMeasuresWidget:Bd,SequenceWidget:$d,ClippingPlaneWidget:Hd,ColorLegendWidget:qd,SelectionWidget:Yd,GridControlWidget:Wd,ResidueSelectorWidget:Xd,ToggleOptionWidget:Kd,ToggleAnimateWidget:Qd,GraphicsMenuWidget:Zd,HudTextWidget:ep,openAboutDialog:tp,ToggleToolbarWidget:np};let rp=new Nr({vertexColors:b}),op=new fl({vertexColors:b}),sp=new fl({opacity:.15,premultipliedAlpha:!0,vertexColors:b,transparent:!0});function ap(e){return(new nr).setHex(e+1)}function lp(e,t){for(let n of s.a.values(e.children))t.add(n)}class up{constructor(e){this.soup=e,this.displayObj=new ur,this.displayMaterial=op,this.pickingMaterial=rp,this.pickingObj=new ur,this.isTransparent=!1}setTransparent(e){this.isTransparent=e,this.isTransparent?this.displayMaterial=sp:this.displayMaterial=op}build(){}}class cp extends up{constructor(e,t=!1,n=[]){super(e),this.selectedTraces=s.a.cloneDeep(n),this.setTransparent(t),this.traces=[],this.build()}build(){if(this.traces=this.soup.traces,this.selectedTraces.length>0){let e=[];for(let[t,n]of this.traces.entries())s.a.includes(this.selectedTraces,t)&&e.push(n);this.traces=e}Dh(this.displayObj),Dh(this.pickingObj);let e=0;for(let o of this.traces)e+=o.points.length;let t=new Lh,n=(new Cr).fromGeometry(t);this.displayGeom=new qh(n,e),this.pickingGeom=new qh(n,e);let i=new ur,r=0;for(let o of this.traces){let e=o.points.length;for(let t of s.a.range(e)){let e=o.points[t],n=o.tangents[t],s=o.binormals[t],a=e.clone().add(n);i.matrix.identity(),i.position.copy(e),i.up.copy(s),i.lookAt(a),i.updateMatrix(),this.displayGeom.applyMatrixToCopy(i.matrix,r),this.pickingGeom.applyMatrixToCopy(i.matrix,r),this.pickingGeom.applyColorToCopy(o.indexColors[t],r),r+=1}}this.recolor(),this.displayObj.add(new zr(this.displayGeom,this.displayMaterial)),this.pickingObj.add(new zr(this.pickingGeom,this.pickingMaterial))}recolor(){let e=0,t=this.soup.getResidueProxy();for(let n of this.traces){let i=n.points.length;for(let r of s.a.range(i)){let i=n.refIndices[r],o=t.load(i).activeColor;this.displayGeom.applyColorToCopy(o,e),e+=1}}this.displayGeom.attributes.color.needsUpdate=!0}}class hp extends up{constructor(e,t=!1,n=[]){super(e),this.selectedTraces=s.a.cloneDeep(n),this.traces=[],this.setTransparent(t),this.build()}build(){if(this.traces=this.soup.traces,this.selectedTraces.length>0){let e=[];for(let[t,n]of this.traces.entries())s.a.includes(this.selectedTraces,t)&&e.push(n);this.traces=e}this.displayGeom=new Ph(this.traces,gd,!1),this.pickingGeom=new Ph(this.traces,gd,!0),Dh(this.displayObj),Dh(this.pickingObj);let e=new zr(this.displayGeom,this.displayMaterial),t=new zr(this.pickingGeom,this.pickingMaterial);this.displayObj.add(e),this.pickingObj.add(t),this.recolor()}recolor(){let e=this.soup.getResidueProxy();for(let t of this.traces)for(let n of s.a.range(t.points.length)){let i=t.refIndices[n];t.colors[n]=e.load(i).activeColor}this.displayGeom.setColors()}}class dp extends up{constructor(e,t=!1,n=null){super(e),this.selectedTraces=s.a.cloneDeep(n),this.setTransparent(t),this.traces=[],this.build()}build(){Dh(this.displayObj),Dh(this.pickingObj),this.displayObj.name="NucleotideRepresentation";let e=this.soup.getResidueProxy(),t=this.soup.getAtomProxy();function n(n){let i=e.getIAtom(n);return null===i?null:t.load(i).pos.clone()}let i=[];this.nucleotideColorList=[];let r=[];if(this.traces=this.soup.traces,this.selectedTraces.length>0){let e=[];for(let[t,n]of this.traces.entries())s.a.includes(this.selectedTraces,t)&&e.push(n);this.traces=e}for(let d of this.traces)for(let t of d.indices)if(e.iRes=t,"D"===e.ss&&e.isPolymer){let t=vd(e.resType),o=s.a.map(t,n);if(s.a.some(o,e=>null===e))continue;i.push(o),r.push(ap(e.iAtom)),this.nucleotideColorList.push(e.activeColor)}this.nucleotideGeom=new Rh(i,this.nucleotideColorList,.2);let o=new zr(this.nucleotideGeom,this.displayMaterial);this.displayObj.add(o);let a=new Rh(i,r,.2),l=new zr(a,this.pickingMaterial);this.pickingObj.add(l),this.nucleotideConnectList=[];for(let s of this.traces)for(let t of s.indices)if(e.iRes=t,"D"===e.ss&&e.isPolymer)for(let i of yd(e.resType)){let e=n(i[0]),r=n(i[1]);null!=e&&null!=r&&this.nucleotideConnectList.push([e,r,t])}let u=this.nucleotideConnectList.length,c=zh(.4);this.nucleotideConnectorGeom=new qh(c,u);for(let s=0;s<u;s+=1){let[e,t,n]=this.nucleotideConnectList[s];this.nucleotideConnectorGeom.applyMatrixToCopy(jh(e,t,.3),s)}for(let s=0;s<u;s+=1){let[t,n,i]=this.nucleotideConnectList[s],r=e.load(i).activeColor;this.nucleotideConnectorGeom.applyColorToCopy(r,s)}let h=new zr(this.nucleotideConnectorGeom,this.displayMaterial);h.name="nucleotideConnector",this.displayObj.add(h)}recolor(){this.nucleotideColorList=[];let e=this.soup.getResidueProxy();for(let n of this.traces)for(let t of n.indices)e.iRes=t,"D"===e.ss&&e.isPolymer&&this.nucleotideColorList.push(e.activeColor);this.nucleotideGeom.recolor(this.nucleotideColorList);let t=this.nucleotideConnectList.length;for(let n=0;n<t;n+=1){let[t,i,r]=this.nucleotideConnectList[n],o=e.load(r).activeColor;this.nucleotideConnectorGeom.applyColorToCopy(o,n)}this.nucleotideConnectorGeom.attributes.color.needsUpdate=!0}}class pp extends up{constructor(e,t=!1,n=[]){super(e),super.setTransparent(t),this.selectedTraces=s.a.cloneDeep(n),this.build()}setTransparent(e){super.setTransparent(e),this.ribbonRepr.setTransparent(e),this.arrowRepr.setTransparent(e),this.nucRepr.setTransparent(e)}build(){this.ribbonRepr=new hp(this.soup,this.isTransparent,this.selectedTraces),this.arrowRepr=new cp(this.soup,this.isTransparent,this.selectedTraces),this.nucRepr=new dp(this.soup,this.isTransparent,this.selectedTraces),Dh(this.displayObj),Dh(this.pickingObj),this.displayObj.name="CartoonRepr",lp(this.ribbonRepr.displayObj,this.displayObj),lp(this.arrowRepr.displayObj,this.displayObj),lp(this.nucRepr.displayObj,this.displayObj),lp(this.ribbonRepr.pickingObj,this.pickingObj),lp(this.arrowRepr.pickingObj,this.pickingObj),lp(this.nucRepr.pickingObj,this.pickingObj)}recolor(){this.ribbonRepr.recolor(),this.arrowRepr.recolor(),this.nucRepr.recolor()}}class fp{constructor(e,t,n,i=!1){this.soup=e,this.displayObj=new ur,this.pickingObj=new ur,this.atomIndices=t,this.atomRadius=n,this.displayMaterial=op,this.pickingMaterial=rp,this.isElementRadius=i,this.build()}build(){if(Dh(this.displayObj),Dh(this.pickingObj),0===this.atomIndices.length)return;let e=this.atomIndices.length,t=new Ya(1,8,8);this.displayGeom=new qh(t,e);let n=new qh(t,e),i=this.soup.getAtomProxy(),r=this.atomRadius;for(let o=0;o<e;o+=1){let e=this.atomIndices[o];i.iAtom=e,this.isElementRadius&&(r="H"===i.elem?1.2:1.7);let t=Fh(i.pos,r);this.displayGeom.applyMatrixToCopy(t,o),n.applyMatrixToCopy(t,o),this.displayGeom.applyColorToCopy(i.color,o),n.applyColorToCopy(ap(e),o)}this.displayObj.add(new zr(this.displayGeom,this.displayMaterial)),this.pickingObj.add(new zr(n,this.pickingMaterial))}recolor(){if(0===this.atomIndices.length)return;let e=this.atomIndices.length,t=this.soup.getAtomProxy();for(let n=0;n<e;n+=1)t.iAtom=this.atomIndices[n],this.displayGeom.applyColorToCopy(t.color,n);this.displayGeom.attributes.color.needsUpdate=!0}}class mp extends fp{constructor(e,t){super(e,[],t)}build(){let e=this.soup.grid;this.atomIndices=[];let t=this.soup.getResidueProxy(),n=this.soup.getAtomProxy();for(let i of s.a.range(this.soup.getResidueCount()))t.iRes=i,"G"===t.ss&&(n.iAtom=t.iAtom,n.bfactor>e.bCutoff&&e.isElem[n.elem]&&this.atomIndices.push(n.iAtom));super.build()}}class gp extends fp{constructor(e){super(e,[],1.7,!0)}build(){this.soup.grid;this.atomIndices=[];let e=this.soup.getResidueProxy(),t=this.soup.getAtomProxy();for(let n of s.a.range(this.soup.getResidueCount()))if(e.iRes=n,e.isPolymer)for(let i of e.getAtomIndices())t.iAtom=i,this.atomIndices.push(i);this.isElementRadius=!0,super.build()}}class vp{constructor(e,t){this.soup=e,this.bondIndices=t,this.displayObj=new ur,this.pickingObj=new ur,this.displayMaterial=op,this.pickingMaterial=rp,this.build()}build(){Dh(this.displayObj),Dh(this.pickingObj);let e=this.bondIndices;if(0===e.length)return;let t=e.length,n=new rl(1,1,1,4,1,!1);n.applyMatrix((new Dt).makeRotationFromEuler(new sr(Math.PI/2,Math.PI,0))),this.displayGeom=new qh(n,t);let i=this.soup.getAtomProxy(),r=this.soup.getAtomProxy(),o=this.soup.getBondProxy(),s=this.soup.getResidueProxy();for(let l=0;l<t;l+=1){o.iBond=e[l],i.iAtom=o.iAtom1,r.iAtom=o.iAtom2,s.iRes=i.iRes;let t=i.pos.clone(),n=r.pos.clone();if(i.iRes!==r.iRes){let e=n.clone().add(t).multiplyScalar(.5);i.iRes===s.iRes?n=e:r.iRes===s.iRes&&(t=e)}let a=jh(t,n,.2);this.displayGeom.applyMatrixToCopy(a,l),this.displayGeom.applyColorToCopy(s.activeColor,l)}let a=new zr(this.displayGeom,this.displayMaterial);this.displayObj.add(a)}recolor(){let e=this.bondIndices;if(0===e.length)return;let t=e.length,n=this.soup.getBondProxy(),i=this.soup.getAtomProxy(),r=this.soup.getResidueProxy();for(let o=0;o<t;o+=1)n.iBond=e[o],i.iAtom=n.iAtom1,r.iRes=i.iRes,this.displayGeom.applyColorToCopy(r.activeColor,o);this.displayGeom.attributes.color.needsUpdate=!0}}class yp{constructor(e,t){this.soup=e,this.radius=t,this.displayObj=new ur,this.pickingObj=new ur,this.build()}build(){Dh(this.displayObj),Dh(this.pickingObj);let e=[],t=[],n=this.soup.getAtomProxy(),i=this.soup.getResidueProxy();for(let r of s.a.range(this.soup.getResidueCount()))if(i.iRes=r,"-"===i.ss)for(let o of i.getAtomIndices()){n.iAtom=o,e.push(o);for(let e of n.getBondIndices())t.push(e)}this.atomRepr=new fp(this.soup,e,this.radius),this.bondRepr=new vp(this.soup,t),e.length>0&&(lp(this.atomRepr.displayObj,this.displayObj),lp(this.bondRepr.displayObj,this.displayObj),lp(this.atomRepr.pickingObj,this.pickingObj))}}class xp extends fp{constructor(e,t){super(e,[],t),this.name="water",this.atomIndices=[];let n=this.soup.getResidueProxy();for(let i of s.a.range(this.soup.getResidueCount()))n.iRes=i,"HOH"===n.resType&&this.atomIndices.push(n.iAtom);this.build()}}class bp{constructor(e,t){this.soup=e,this.displayObj=new ur,this.pickingObj=new ur,this.radius=t,this.build()}build(){Dh(this.displayObj),Dh(this.pickingObj);let e=[],t=[],n=this.soup.getAtomProxy(),i=this.soup.getResidueProxy();for(let r of s.a.range(this.soup.getResidueCount()))if(i.iRes=r,i.isPolymer&&i.sidechain)for(let o of i.getAtomIndices())if(n.iAtom=o,!yh(n.atomType,md)){e.push(o);for(let e of n.getBondIndices())t.push(e)}this.atomRepr=new fp(this.soup,e,this.radius),this.bondRepr=new vp(this.soup,t),lp(this.atomRepr.displayObj,this.displayObj),lp(this.bondRepr.displayObj,this.displayObj),lp(this.atomRepr.pickingObj,this.pickingObj)}recolor(){this.atomRepr.recolor(),this.bondRepr.recolor()}}class wp{constructor(e,t){this.soup=e,this.displayObj=new ur,this.pickingObj=new ur,this.radius=t,this.build()}build(){let e=[],t=[],n=this.soup.getAtomProxy(),i=this.soup.getResidueProxy();for(let r of s.a.range(this.soup.getResidueCount()))if(i.iRes=r,i.isPolymer)for(let o of i.getAtomIndices())if(n.iAtom=o,yh(n.atomType,md)){e.push(o);for(let e of n.getBondIndices())t.push(e)}this.atomRepr=new fp(this.soup,e,this.radius),this.bondRepr=new vp(this.soup,t),e.length>0&&(lp(this.atomRepr.displayObj,this.displayObj),lp(this.bondRepr.displayObj,this.displayObj),lp(this.atomRepr.pickingObj,this.pickingObj))}recolor(){this.atomRepr.recolor(),this.bondRepr.recolor()}}function _p(){if(requestAnimationFrame(_p),window.globalWidgets===[])return;let e=(new Date).getTime(),t=e-window.lastTime;for(let n of window.globalWidgets)n.animate(t);for(let n of window.globalWidgets)n.isChanged()&&n.drawFrame();window.lastTime=e}function Ap(e){"undefined"===typeof window.globalWidgets&&(window.globalWidgets=[],_p(),window.lastTime=(new Date).getTime()),window.globalWidgets.push(e)}class Sp{constructor(e,t){this.divTag=e,this.div=r()(this.divTag),this.div.css("overflow","hidden"),this.backgroundColor=t,this.div.css("background-color",this.backgroundColor),this.webglDivId=this.div.attr("id")+"-canvas-wrapper",this.webglDiv=r()("<div>").attr("id",this.webglDivId).css("overflow","hidden").css("box-sizing","border-box").css("z-index","0").css("background-color","#CCC").css("position","relative"),this.webglDiv.contextmenu(()=>!1),this.div.append(this.webglDiv),this.cameraParams={focus:new Nt(0,0,0),position:new Nt(0,0,-1),up:new Nt(0,1,0),zFront:-40,zBack:20,zoom:1},this.camera=new _s(45,this.width()/this.height()),this.displayScene=new Cs,this.displayScene.background=new nr(this.backgroundColor),this.displayScene.fog=new Ts(this.backgroundColor,1,100),this.representations={},this.displayMeshes={},this.pickingMeshes={},this.pickingScene=new Cs,this.pickingTexture=new zt(this.width(),this.height()),this.pickingTexture.texture.minFilter=xe,this.lights=[],this.buildLights(),this.messageOffset={x:5,y:5},this.messageDiv=r()("<div>").attr("id","loading-message").css("position","absolute").addClass("jolecule-overlay-text"),this.div.append(this.messageDiv),this.setMesssage("Initialized jolecule."),this.saveMouseX=null,this.saveMouseY=null,this.saveMouseR=null,this.saveMouseT=null,this.mouseX=null,this.mouseY=null,this.mouseR=null,this.mouseT=null}initWebglRenderer(){this.renderer=new Es({antialias:!0}),this.renderer.setClearColor(this.backgroundColor),this.renderer.setSize(this.width(),this.height());let e=this.renderer.domElement;this.webglDiv[0].appendChild(e);const t=(t,n)=>{e.addEventListener(t,n)};t("mousedown",e=>this.mousedown(e)),t("mousemove",e=>this.mousemove(e)),t("mouseup",e=>this.mouseup(e)),t("mouseleave",e=>this.mouseout(e)),t("mousewheel",e=>this.mousewheel(e)),t("DOMMouseScroll",e=>this.mousewheel(e)),t("touchstart",e=>this.mousedown(e)),t("touchmove",e=>this.mousemove(e)),t("touchend",e=>this.mouseup(e)),t("touchcancel",e=>this.mouseup(e)),t("gesturestart",e=>this.gesturestart(e)),t("gesturechange",e=>this.gesturechange(e)),t("gestureend",e=>this.gestureend(e))}render(){mh(this.renderer)||this.initWebglRenderer(),this.renderer.render(this.displayScene,this.camera)}getPosXY(e){let t=.5*this.width(),n=.5*this.height(),i=e.clone().project(this.camera);return{x:i.x*t+t+this.x(),y:-i.y*n+n+this.y()}}getPickColorFromMouse(){let e=this.mouseX,t=this.mouseY;if(null===e||null===t)return null;let n=new Uint8Array(4);return this.renderer.render(this.pickingScene,this.camera,this.pickingTexture),this.renderer.readRenderTargetPixels(this.pickingTexture,this.mouseX,this.pickingTexture.height-t,1,1,n),n[0]<<16|n[1]<<8|n[2]}setCameraParams(e){let t=this.cameraParams.position.clone().sub(this.cameraParams.focus).normalize(),n=e.position.clone().sub(e.focus);n.normalize();let i=kh(t,n);for(let s=0;s<this.lights.length;s+=1)this.lights[s].position.applyQuaternion(i);this.cameraParams=e;let r=this.cameraParams.zoom+this.cameraParams.zBack,o=this.cameraParams.zoom+this.cameraParams.zFront;o<1&&(o=1),this.camera.position.copy(this.cameraParams.position),this.camera.up.copy(this.cameraParams.up),this.camera.lookAt(this.cameraParams.focus),this.camera.near=o,this.camera.far=r,this.camera.updateProjectionMatrix(),this.displayScene.fog.near=this.cameraParams.zoom,this.displayScene.fog.far=r}buildLights(){this.lights.length=0;let e=new pu(16777215);e.position.copy(fh.create(.2,.2,-100).normalize()),e.dontDelete=!0,this.lights.push(e);let t=new fu(6316128,1);t.dontDelete=!0,this.lights.push(t);for(let n=0;n<this.lights.length;n+=1)this.displayScene.add(this.lights[n])}resize(){let e=this.div.outerHeight();this.webglDiv.css("height",e);let t=this.div.outerWidth();this.webglDiv.css("width",t),this.messageDiv.css({top:this.messageOffset.y,left:this.messageOffset.x}),this.messageDiv.css("max-width",Math.max(.9*this.div.width()-40,this.div.width()-200)),this.camera.aspect=this.width()/this.height(),this.camera.updateProjectionMatrix(),this.pickingTexture.setSize(this.width(),this.height()),mh(this.renderer)&&this.renderer.setSize(this.width(),this.height())}setMesssage(e){console.log("SoupWidget.setMesssage:",e),this.messageDiv.html(e).show()}async asyncSetMesssage(e){this.setMesssage(e),await _h(0)}async asyncFlashMesssage(e,t){this.setMesssage(e),await _h(t),this.messageDiv.hide().html("")}cleanupMessage(){this.messageDiv.hide()}rebuildSceneFromMeshes(){Dh(this.displayScene),Dh(this.pickingScene);for(let e of s.a.values(this.displayMeshes))e.children.length>0&&this.displayScene.add(e);for(let e of s.a.values(this.pickingMeshes))e.children.length>0&&this.pickingScene.add(e)}setMeshVisible(e,t){e in this.displayMeshes&&Oh(this.displayMeshes[e],t),e in this.pickingMeshes&&Oh(this.pickingMeshes[e],t)}x(){return 0}y(){return 0}width(){let e=this.div.width()-this.x();return e}height(){let e=this.div.height()-this.y();return e}getPointer(e){mh(e.touches)&&e.touches.length>0?(this.eventX=e.touches[0].clientX,this.eventY=e.touches[0].clientY):(this.eventX=e.clientX,this.eventY=e.clientY);let t=e.target.getBoundingClientRect();this.mouseX=this.eventX-t.left,this.mouseY=this.eventY-t.top;let n=this.mouseX-this.width()/2,i=this.mouseY-this.height()/2;this.mouseR=Math.sqrt(n*n+i*i),this.mouseT=Math.atan(i/n),n<0&&(i>0?this.mouseT+=Math.PI:this.mouseT-=Math.PI)}savePointer(){this.saveMouseX=this.mouseX,this.saveMouseY=this.mouseY,this.saveMouseR=this.mouseR,this.saveMouseT=this.mouseT}}class Ep extends Sp{constructor(e,t,n,i,r,o){super(t,r),this.observers={rebuilt:new Vd.a,updated:new Vd.a,resized:new Vd.a},this.dataServer=null,this.soupView=e,this.soup=e.soup,this.controller=n,this.atomRadius=.35,this.gridAtomRadius=1,this.isCrossHairs=!0,this.buildCrossHairs(),this.isClickInitiated=!1,this.hover=new ip.PopupText(this.divTag,50),this.iAtomHover=null,this.isGrid=i,this.isMouseWheel=o,this.distanceMeasuresWidget=new ip.DistanceMeasuresWidget(this),this.atomLabelsWidget=new ip.AtomLabelsWidget(this),this.lineElement=new ip.LineElement(this,"#FF7777"),Ap(this)}addObserver(e){"update"in e&&this.observers.updated.add(()=>{e.update()}),"rebuild"in e&&this.observers.rebuilt.add(()=>{e.rebuild()}),"resize"in e&&this.observers.resized.add(()=>{e.resize()})}buildCrossHairs(){let e=2,t=60,n=new Ns({color:16733525}),i=new al(e,t);i.vertices.shift(),this.crossHairs=new Us(i,n),this.crossHairs.dontDelete=!0,this.displayScene.add(this.crossHairs)}setTargetViewByIAtom(e){this.controller.setTargetViewByIAtom(e)}getCameraOfCurrentView(){return this.soupView.currentView.cameraParams}getZ(e){let t=this.getCameraOfCurrentView(),n=t.focus.clone().sub(t.position).normalize(),i=e.clone().sub(t.focus);return i.dot(n)}inZlab(e){let t=this.getZ(e),n=this.getCameraOfCurrentView();return t>=n.zFront&&t<=n.zBack}opacity(e){let t=this.getZ(e),n=this.getCameraOfCurrentView();return t<n.zFront?1:t>n.zBack?0:1-(t-n.zFront)/(n.zBack-n.zFront)}updateCrossHairs(){let e=this.getCameraOfCurrentView();this.crossHairs.position.copy(e.focus),this.crossHairs.lookAt(e.position),this.crossHairs.updateMatrix()}atomLabelDialog(){let e=this.soupView.currentView.iAtom;if(e>=0){let t=this.soup.getAtomProxy(e),n="Label atom : "+t.label,i=t=>{this.controller.makeAtomLabel(e,t)};wh(this.div,n,i)}}getIAtomHover(){let e=this.getPickColorFromMouse();return e>0&&e<this.soup.getAtomCount()+1?e-1:null}popupText(e){let t=this.soup.getAtomProxy(e),n=t.label,i=t.iAtom;"XXX"===t.resType&&(n+=":E="+this.soup.grid.convertB(t.bfactor));let r="";return i===this.soupView.getICenteredAtom()?(r='<div style="text-align: center">',r+=n,r+="<br>[drag distances]<br>",r+="[double-click labels]",r+="</div>"):r=n,r}updateHover(){if(this.iAtomHover=this.getIAtomHover(),this.iAtomHover){this.hover.html(this.popupText(this.iAtomHover));let e=this.soup.getAtomProxy(this.iAtomHover).pos,t=this.getPosXY(e);this.hover.move(t.x,t.y)}else this.hover.hide()}addRepresentation(e,t){this.representations[e]=t,this.displayMeshes[e]=t.displayObj,this.pickingMeshes[e]=t.pickingObj,this.updateMeshesInScene=!0}buildScene(){for(let e of s.a.keys(this.displayMeshes))s.a.unset(this.displayMeshes,e);for(let e of s.a.keys(this.pickingMeshes))s.a.unset(this.pickingMeshes,e);this.addRepresentation("transparentRibbon",new pp(this.soup,!0)),this.addRepresentation("ribbon",new pp(this.soup,!1,this.soup.selectedTraces)),this.addRepresentation("ligand",new yp(this.soup,this.atomRadius)),this.isGrid&&this.addRepresentation("grid",new mp(this.soup,this.gridAtomRadius)),this.addRepresentation("sidechain",new bp(this.soup,this.atomRadius)),this.rebuildSceneFromMeshes(),this.observers.rebuilt.dispatch(),this.soupView.isChanged=!0,this.soupView.isUpdateObservers=!0}deleteStructure(e){this.controller.deleteStructure(e),this.buildScene(),this.observers.rebuilt.dispatch()}isChanged(){return this.soupView.isChanged}drawFrame(){if(!this.isChanged())return;let e=!this.soupView.soup.grid.isChanged&&!this.soupView.isUpdateSidechain&&!this.soupView.isUpdateColors;this.soupView.isStartTargetAfterRender&&e&&(this.soupView.startTargetView(),this.soupView.nUpdateStep=this.soupView.maxUpdateStep),this.updateMeshesInScene=!1;let t=(e,t)=>t&&!(e in this.displayMeshes),n=this.soupView.currentView.show;if(t("water",n.water)&&this.addRepresentation("water",new xp(this.soup,this.atomRadius)),t("backbone",n.backbone)&&this.addRepresentation("backbone",new wp(this.soup,this.atomRadius)),t("sphere",n.sphere)&&this.addRepresentation("sphere",new gp(this.soup)),this.setMeshVisible("ribbon",n.ribbon),this.setMeshVisible("transparentRibbon",n.ribbon&&n.transparent),this.setMeshVisible("water",n.water),this.setMeshVisible("backbone",n.backbone),this.setMeshVisible("ligand",n.ligands),this.setMeshVisible("sphere",n.sphere),n.transparent?s.a.isEqual(this.soup.selectedTraces,this.representations.ribbon.selectedTraces)||(this.representations.ribbon.selectedTraces=s.a.cloneDeep(this.soup.selectedTraces),this.representations.ribbon.build(),this.updateMeshesInScene=!0):this.representations.ribbon&&this.representations.ribbon.selectedTraces.length>0&&(this.representations.ribbon.selectedTraces.length=0,this.representations.ribbon.build(),this.updateMeshesInScene=!0),this.isGrid?this.soupView.soup.grid.isChanged&&(s.a.isUndefined(this.representations.grid)||(this.soup.colorResidues(),this.representations.grid.build()),this.soupView.soup.grid.isChanged=!1):this.soupView.soup.grid.isChanged=!1,this.soupView.isUpdateSidechain&&(this.representations.sidechain.build(),this.soupView.isUpdateSidechain=!1,this.updateMeshesInScene=!0),this.soupView.isUpdateColors){for(let e of s.a.values(this.representations))"recolor"in e&&e.recolor();this.soupView.isUpdateColors=!1,this.soupView.isUpdateObservers=!0}this.updateMeshesInScene&&this.rebuildSceneFromMeshes(),this.updateCrossHairs(),this.setCameraParams(this.getCameraOfCurrentView()),this.distanceMeasuresWidget.drawFrame(),this.render(),this.soupView.isUpdateObservers&&(this.observers.updated.dispatch(),this.soupView.isUpdateObservers=!1),this.atomLabelsWidget.drawFrame(),this.soupView.isChanged=!1}animate(e){this.soupView.animate(e),this.updateHover()}focus(){console.log("SoupWidget.focus")}resize(){super.resize(),this.observers.resized.dispatch(),this.soupView.isUpdateObservers=!0,this.controller.setChangeFlag()}doubleclick(e){null!==this.iAtomHover?(this.iAtomHover===this.soupView.getICenteredAtom()?this.atomLabelDialog():this.iAtomHover===this.iAtomPreClick&&this.controller.triggerAtom(this.iAtomHover),this.isDraggingCentralAtom=!1):this.controller.triggerAtom(),this.iAtomFirstPressed=null,this.iResFirstPressed=null,this.iAtomPreClick=null}click(e){let t=this.iAtomHover,n=this.soup.getAtomProxy(t).iRes;if(mh(n)&&n===this.iResFirstPressed)if(e.metaKey||e.shiftKey)e.shiftKey?this.controller.selectAdditionalRangeToResidue(this.iResFirstPressed):this.controller.selectAdditionalResidue(this.iResFirstPressed);else{let e=this.soup.getResidueProxy(n),t=!e.selected;this.controller.selectResidue(n,t)}else this.controller.clearSelectedResidues();this.iAtomFirstPressed=null,this.iResFirstPressed=null,this.getPointer(e),this.updateHover()}mousedown(e){if(this.focus(),this.isGesture)return;e.preventDefault(),this.getPointer(e),this.updateHover(),this.iAtomFirstPressed=this.iAtomHover,this.iResFirstPressed=this.soup.getAtomProxy(this.iAtomFirstPressed).iRes,this.iAtomFirstPressed===this.soupView.getICenteredAtom()&&(this.isDraggingCentralAtom=null!==this.iAtomFirstPressed);let t=(new Date).getTime(),n=this.timePressed?t-this.timePressed:0;this.isClickInitiated?n<600&&(this.doubleclick(e),this.isClickInitiated=!1):(this.iAtomPreClick=this.iAtomHover,this.isClickInitiated=!0),this.getPointer(e),this.savePointer(),this.timePressed=(new Date).getTime(),this.pointerPressedAndInDiv=!0}mousemove(e){if(e.preventDefault(),!this.isGesture)if(this.getPointer(e),this.updateHover(),this.isDraggingCentralAtom){let e=this.soup.getAtomProxy(this.soupView.getICenteredAtom()).pos,t=this.getPosXY(e);this.lineElement.move(this.mouseX+this.x(),this.mouseY+this.y(),t.x,t.y)}else{let t=2===e.button||3===e.which;if(this.pointerPressedAndInDiv){let n=1,i=0,r=0,o=0,s=this.mouseX-this.saveMouseX,a=this.mouseY-this.saveMouseY;if(this.isClickInitiated=!1,t||e.metaKey)i=this.mouseT-this.saveMouseT,this.mouseR>0&&(n=this.saveMouseR/this.mouseR);else if(e.ctrlKey)i=this.mouseT-this.saveMouseT;else if(e.shiftKey){let e=a/100;n=Math.pow(1+Math.abs(e)/2,e>0?1:-1)}else r=fh.degToRad(s),o=fh.degToRad(a);this.controller.adjustCamera(o,r,i,n),this.savePointer()}}}mouseout(e){this.hover.hide(),this.pointerPressedAndInDiv=!1}mouseup(e){if(this.getPointer(e),e.preventDefault(),this.isDraggingCentralAtom){if(null!==this.iAtomHover){let e=this.soupView.getICenteredAtom();this.iAtomHover!==e&&this.controller.makeDistance(this.iAtomHover,e)}this.lineElement.hide(),this.isDraggingCentralAtom=!1}this.isClickInitiated&&this.click(e),mh(e.touches)&&this.hover.hide(),this.pointerPressedAndInDiv=!1}mousewheel(e){if(console.log("SoupWidget.mousewheel",this.isMouseWheel),!this.isMouseWheel)return;if(this.isGesture)return;let t;e.preventDefault(),t=mh(e.wheelDelta)?e.wheelDelta/480:-e.detail/24,e.ctrlKey&&(t/=2,t*=-1);let n=Math.pow(1+Math.abs(t)/2,t>0?1:-1);this.controller.adjustCamera(0,0,0,n)}gesturestart(e){e.preventDefault(),this.isGesture=!0,this.lastPinchRotation=0,this.lastScale=e.scale*e.scale}gesturechange(e){e.preventDefault(),this.controller.adjustCamera(0,0,fh.degToRad(2*e.rotation-this.lastPinchRotation),this.lastScale/(e.scale*e.scale)),this.lastPinchRotation=2*e.rotation,this.lastScale=e.scale*e.scale}gestureend(e){e.preventDefault(),this.isGesture=!1,this.iAtomFirstPressed=null,this.iResFirstPressed=null,null!==this.isClickInitiated&&(clearTimeout(this.isClickInitiated),this.isClickInitiated=null),this.pointerPressedAndInDiv=!1}}n("f21a");let Mp={divTag:"",backgroundColor:0,viewId:"",viewHeight:170,isViewTextShown:!1,isSequenceBar:!0,isResidueSelector:!0,isLegend:!1,isEditable:!0,animateState:"none",isGrid:!1,bCutoff:.5,isPlayable:!1,maxUpdateStep:50,msPerStep:17,maxWaitStep:30,isToolbarOnTop:!1,isToolbarOn:!1,isTextOverlay:!0,isMouseWheel:!0};class Tp{constructor(e){this.params=s.a.cloneDeep(Mp),s.a.assign(this.params,e),console.log("EmbedJolecule.constructor",this.params),this.isProcessing={flag:!1},this.divTag=this.params.divTag,this.div=r()(this.params.divTag),this.divId=this.div.attr("id"),this.div[0].oncontextmenu=s.a.noop,this.soup=new Nd,this.soupView=new Zh(this.soup),this.controller=new Jh(this.soupView),this.soupView.animateState=this.params.animateState,this.soupView.maxUpdateStep=this.params.maxUpdateStep,this.soupView.msPerStep=this.params.msPerStep,this.soupView.maxWaitStep=this.params.maxWaitStep,null!==this.params.bCutoff&&(this.soup.grid.bCutoff=this.params.bCutoff),this.widget={},this.createDivs();let t=()=>this.resize();r()(window).resize(t),window.onorientationchange=t,t()}async asyncAddDataServer(e){while(this.isProcessing.flag)await _h(100);console.log("EmbedJolecule.asyncAddDataServer",e),this.isProcessing.flag=!0,await this.soupWidget.asyncSetMesssage("Loading structure...");let t=e=>this.soupWidget.asyncSetMesssage(e);await new Promise(n=>{e.getProteinData(async e=>{await this.controller.asyncLoadProteinData(e,t),n()})}),this.soupWidget.buildScene(),this.resize(),this.controller.zoomOut(),s.a.isNil(this.soupView.dataServer)&&(await this.soupWidget.asyncSetMesssage("Preparing views..."),this.soupWidget.dataServer=e,await new Promise(t=>{e.getViews((e,n)=>{this.controller.loadViewsFromViewDicts(e),n&&(this.params.viewId=n);let i=this.params.viewId in this.soupView.savedViewsByViewId;i&&this.controller.setTargetViewByViewId(this.params.viewId),t()})}),this.soupView.isUpdateObservers=!0),this.soupWidget.cleanupMessage(),this.isProcessing.flag=!1,console.log("EmbedJolecule.asyncAddDataServer finished")}clear(){while(this.soupWidget.soup.structureIds.length>0)this.soupWidget.deleteStructure(0)}createDivs(){this.div.css({display:"flex","flex-direction":"column"}),this.headerDiv=r()("<div>").addClass("jolecule-embed-header").css({display:"flex","flex-wrap":"wrap","flex-direction":"row"}),this.div.append(this.headerDiv),this.bodyDiv=r()("<div>").attr("id",this.divId+"-jolecule-soup-display").addClass("jolecule-embed-body").css({flex:"1 1",position:"relative"}),this.div.append(this.bodyDiv),this.soupWidget=new Ep(this.soupView,`#${this.divId}-jolecule-soup-display`,this.controller,this.params.isGrid,this.params.backgroundColor,this.params.isMouseWheel),this.footerDiv=r()("<div>").addClass("jolecule-embed-footer").css({display:"flex","flex-wrap":"wrap","flex-direction":"row"}),this.div.append(this.footerDiv),this.sequenceBarDiv=r()("<div>").attr("id",this.divId+"-sequence-widget").css({width:"100%"}),this.params.isToolbarOnTop?this.footerDiv.append(this.sequenceBarDiv):this.headerDiv.append(this.sequenceBarDiv),this.params.isSequenceBar&&(this.widget.sequence=new ip.SequenceWidget(`#${this.divId}-sequence-widget`,this.soupWidget)),this.params.isGrid&&(this.widget.grid=new ip.GridControlWidget(this.soupWidget)),this.widget.colorLegend=new ip.ColorLegendWidget(this.soupWidget),this.widget.colorLegend.isShow=this.params.isLegend,this.widget.selection=new ip.SelectionWidget(this.soupWidget),this.params.isToolbarOnTop?this.toolbarDiv=this.headerDiv:(this.toolbarDiv=this.footerDiv,this.widget.selection.offset.y=5,this.widget.colorLegend.offset.y=5);let e=this.params.isPlayable||this.params.isEditable||this.params.isExtraEditable;e&&(this.toolbarDiv.css({display:"flex","flex-wrap":"wrap","flex-direction":"row"}).addClass("jolecule-embed-toolbar"),this.params.isToolbarOn&&(this.widget.toolbar=new ip.ToggleToolbarWidget(this,this.soupWidget.divTag,".jolecule-embed-toolbar",!1,this.params.isToolbarOnTop)),this.toolbarDiv.append(gh("?","jolecule-button",()=>{ip.openAboutDialog(this.soupWidget.div)})),this.params.isPlayable&&(this.toolbarDiv.append(r()(`<div id="${this.divId}-rotate">`)),this.widget.rotate=new ip.ToggleAnimateWidget(this.soupWidget,`#${this.divId}-rotate`,"rotate","&orarr;"),this.toolbarDiv.append(r()(`<div id="${this.divId}-rock">`)),this.widget.rotate=new ip.ToggleAnimateWidget(this.soupWidget,`#${this.divId}-rock`,"rock","&hArr;"),this.toolbarDiv.append(gh("<","jolecule-button",()=>{this.controller.setTargetToPrevView()})),this.toolbarDiv.append(r()(`<div id="${this.divId}-loop">`)),this.widget.loop=new ip.ToggleAnimateWidget(this.soupWidget,`#${this.divId}-loop`,"loop","Play"),this.toolbarDiv.append(gh(">","jolecule-button",()=>{this.controller.setTargetToNextView()})),this.params.isTextOverlay&&(this.toolbarDiv.append(r()(`<div id="${this.divId}-hud">`)),this.widget.hud=new ip.HudTextWidget(this.soupWidget,`#${this.divId}-hud`))),this.params.isEditable&&(this.params.isResidueSelector&&(this.toolbarDiv.append(r()("<div>").attr("id",this.divId+"-res-selector").addClass("jolecule-button").css({"padding-top":"6px",height:"24px","box-sizing":"content-box"})),this.widget.residueSelect=new ip.ResidueSelectorWidget(this.soupWidget,`#${this.divId}-res-selector`)),this.toolbarDiv.append(r()("<div>").attr("id",this.divId+"-clipping-plane").addClass("jolecule-button").css({flex:"1 1 80px",display:"flex","flex-diretion":"row","justify-content":"center","max-width":"40%"})),this.widget.clippingPlane=new ip.ClippingPlaneWidget(this.soupWidget,`#${this.divId}-clipping-plane`)),this.params.isEditable&&(this.toolbarDiv.append(gh("Zoom","jolecule-button",()=>{this.controller.zoomToSelection()})),this.toolbarDiv.append(gh("Clear","jolecule-button",()=>{this.controller.clear()})).append(gh("Sidechains","jolecule-button",()=>{this.controller.toggleSelectedSidechains()})).append(gh("Neighbors","jolecule-button",()=>{this.controller.toggleResidueNeighbors()})).append(r()("<div>").attr("id",this.divId+"-menu").addClass("jolecule-button")),this.widget.graphicsMenu=new ip.GraphicsMenuWidget(this.soupWidget,`#${this.divId}-menu`,!this.params.isToolbarOnTop)),this.headerDiv.contents().length>0&&this.headerDiv.css({"border-bottom":"2px solid #AAA"}),this.footerDiv.contents().length>0&&this.footerDiv.css({"border-top":"2px solid #AAA"}))}resize(){this.soupWidget.resize()}}n("d6ec");class Cp{constructor(e){this.params=e,this.div=r()("<div>").addClass("jolecule-view"),this.makeEditDiv(),this.makeShowDiv()}saveChange(){console.log("ViewPiece.saveChange");let e=this.editTextArea.val();this.editDiv.hide(),this.showDiv.show(),this.params.saveChange(e),window.keyboardLock=!1}startEdit(){this.params.pick(),this.editTextArea.text(this.params.view.text),this.editDiv.show(),this.showDiv.hide();let e=this.editTextArea.find("textarea");setTimeout((function(){e.focus()}),100),window.keyboardLock=!0}discardChange(){this.editDiv.hide(),this.showDiv.show(),window.keyboardLock=!1}makeEditDiv(){this.editTextArea=r()("<textarea>").addClass("jolecule-view-text").css("width","100%").css("height","5em").click(s.a.noop),this.editDiv=r()("<div>").css("width","100%").click(s.a.noop).append(this.editTextArea).append(gh("save","jolecule-small-button",e=>{this.saveChange()})).append(" &nbsp; ").append(gh("discard","jolecule-small-button",e=>{this.discardChange()})).hide(),this.div.append(this.editDiv)}makeShowDiv(){let e=this.params.view,t=gh("edit","jolecule-small-button",()=>{this.startEdit()});this.showTextDiv=r()("<div>").addClass("jolecule-button").css("height","auto").css("padding","0").css("background-color","#BBB").css("text-align","left").on("click touch",e=>{"A"===e.target.tagName?window.location.href=e.target.href:(e.preventDefault(),this.params.pick())}),this.showDiv=r()("<div>").css("width","100%").append(this.showTextDiv);let n=this.params.isEditable&&!e.lock&&"view:000000"!==e.id;n&&(this.showTextDiv.css("margin-bottom","7px"),this.showDiv.append(t),mh(this.params.swapUp)&&this.showDiv.append(" ").append(gh("up","jolecule-small-button",()=>{this.params.swapUp()})),mh(this.params.swapUp)&&this.showDiv.append(" ").append(gh("down","jolecule-small-button",()=>{this.params.swapDown()})),mh(this.params.deleteView)&&this.showDiv.append(r()("<div>").css("float","right").append(gh("delete","jolecule-small-button",()=>{console.log("ViewPiece.deleteButton"),this.params.deleteView()})))),this.div.append(this.showDiv)}}class Pp{constructor(e,t,n){this.divTag=e,this.soupWidget=t,this.soupView=t.soupView,this.controller=t.controller,this.isEditable=n,this.viewPiece={},this.subheaderDiv=r()("<div>").addClass("jolecule-sub-header").append("SAVED VIEWS &nbsp;"),this.div=r()(this.divTag).append(this.subheaderDiv).append(r()('<div id="jolecule-views">')),this.isEditable&&this.subheaderDiv.append(gh("Save","jolecule-button",()=>{this.saveCurrentView()}))}saveViewsToDataServer(e){console.log("ViewPanelList.saveViewsToDataServer"),this.soupWidget.dataServer.saveViews(this.controller.getViewDicts(),e)}update(){for(let i in this.viewPiece)i in this.soupView.savedViewsByViewId||(this.viewPiece[i].div.remove(),delete this.viewPiece[i]);let e=this.soupView.savedViews.length,t=this.soupView.iLastViewSelected;t>=this.soupView.savedViews.length&&(t=0,this.soupView.iLastViewSelected=t);let n=null;t<this.soupView.savedViews.length&&(n=this.soupView.savedViews[t].id);for(let i=0;i<e;i++){let t=this.soupView.savedViews[i],r=t.id;t.id in this.viewPiece||this.insertNewViewDiv(t.id),n===r?(this.viewPiece[r].div.removeClass("jolecule-unselected-box"),this.viewPiece[r].div.addClass("jolecule-selected-box")):(this.viewPiece[r].div.removeClass("jolecule-selected-box"),this.viewPiece[r].div.addClass("jolecule-unselected-box"));let o=this.viewPiece[r],s=t.order+1+"/"+e+": "+t.text;t.creator&&(s+=` <span class="jolecule-author">${t.creator}</span>`),s!==o.showTextDiv.html()&&o.showTextDiv.html(s)}if(n&&history.pushState){let e="?view_id="+n;"view:000000"===n&&(e="");let t=window.location.protocol+"//"+window.location.host+window.location.pathname+e;window.history.pushState({path:t},"",t)}}setTargetByViewId(e){this.controller.setTargetViewByViewId(e),this.update()}gotoPrevView(){this.controller.setTargetToPrevView(),this.update()}gotoNextView(){this.controller.setTargetToNextView(),this.update()}removeView(e){console.log("ViewPanelList.removeView"),this.viewPiece[e].div.css("background-color","lightgray"),this.soupWidget.dataServer.deleteView(e,()=>{this.controller.deleteView(e),this.update()})}swapViews(e,t){let n=this.soupView.savedViews[e].id,i=this.soupView.savedViews[t].id,r=this.viewPiece[n].div,o=this.viewPiece[i].div;this.controller.swapViews(e,t),r.css("background-color","lightgray"),o.css("background-color","lightgray"),this.saveViewsToDataServer(()=>{o.insertBefore(r),this.update(),r.css("background-color",""),o.css("background-color","")})}swapUp(e){let t=this.soupView.getIViewFromViewId(e);t<2||this.swapViews(t-1,t)}swapDown(e){let t=this.soupView.getIViewFromViewId(e);t>this.soupView.savedViews.length-2||this.swapViews(t,t+1)}makeViewDiv(e){let t=this.soupView.savedViewsByViewId[e];return this.viewPiece[e]=new Cp({view:t,isEditable:this.isEditable,deleteView:()=>{this.removeView(e)},saveChange:n=>{const i=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi;while(i.test(n))n=n.replace(i,"");t.text=n,this.viewPiece[e].div.css("background-color","lightgray"),this.saveViewsToDataServer(()=>{this.viewPiece[e].div.css("background-color",""),this.soupView.isChanged=!0,this.update()})},pick:()=>{this.setTargetByViewId(e)},swapUp:()=>{this.swapUp(e)},swapDown:()=>{this.swapDown(e)}}),this.viewPiece[e].div}makeAllViews(){for(let e=0;e<this.soupView.savedViews.length;e+=1){let t=this.soupView.savedViews[e].id,n=this.makeViewDiv(t);r()("#jolecule-views").append(n)}}insertNewViewDiv(e){let t=this.makeViewDiv(e);if(0===this.soupView.iLastViewSelected||this.soupView.iLastViewSelected===this.soupView.savedViews.length-1)r()("#jolecule-views").append(t);else{let e=this.soupView.iLastViewSelected-1,n=this.soupView.savedViews[e].id,i=this.viewPiece[n].div;t.insertAfter(i)}}saveCurrentView(){console.log("ViewPanelList.saveCurrentView");let e=this.controller.saveCurrentView();this.insertNewViewDiv(e),this.update();let t=this.viewPiece[e].div;t.css("background-color","lightgray"),this.saveViewsToDataServer(()=>{console.log("ViewPieceList.saveCurrentView success"),t.css("background-color",""),r()("#jolecule-views").stop().scrollTo(t,1e3,{offset:{top:-80}})})}}function Rp(e){let t=RegExp("[?&]"+e+"=([^&]*)").exec(window.location.search);return t&&decodeURIComponent(t[1].replace(/\+/g," "))}class Lp{constructor(e,t,n){if(this.viewsDisplayTag=t,this.params={divTag:e,backgroundColor:13421772,viewId:"",viewHeight:170,isViewTextShown:!1,isSequenceBar:!0,isEditable:!0,isGrid:!0,bCutoff:.5,isPlayable:!1},mh(n)&&(this.params=s.a.assign(this.params,n)),!this.params.viewId){let e=Rp("view_id");e&&(this.params.viewId=e,console.log("FullPageJolecule.constructor viewId="+this.params.viewId))}this.embedJolecule=new Tp(this.params),this.embedJolecule.soupWidget.addObserver(this),document.oncontextmenu=s.a.noop,document.onkeydown=e=>{this.onkeydown(e)}}clear(){this.embedJolecule.clear()}async asyncAddDataServer(e){console.log("FullPageWidget.asyncAddDataServer"),await this.embedJolecule.asyncAddDataServer(e),this.viewPanelList||(this.soupView=this.embedJolecule.soupView,this.controller=this.embedJolecule.controller,this.soupWidget=this.embedJolecule.soupWidget,this.viewPanelList=new Pp(this.viewsDisplayTag,this.soupWidget,this.params.isEditable),this.viewPanelList.makeAllViews()),this.viewPanelList.update(),this.embedJolecule.resize()}update(){s.a.isUndefined(this.viewPanelList)||this.viewPanelList.update()}onkeydown(e){if(!window.keyboardLock){let t=String.fromCharCode(e.keyCode).toUpperCase();if("V"===t)this.viewPanelList.saveCurrentView();else if("K"===t||37===e.keyCode)this.controller.setTargetToPrevResidue();else if("J"===t||39===e.keyCode)this.controller.setTargetToNextResidue();else if(38===e.keyCode)this.viewPanelList.gotoPrevView();else if(" "===t||40===e.keyCode)this.viewPanelList.gotoNextView();else if("S"===t)this.controller.toggleShowOption("sphere");else if("B"===t)this.controller.toggleShowOption("backbone");else if("R"===t)this.controller.toggleShowOption("ribbon");else if("L"===t)this.controller.toggleShowOption("ligands");else if("W"===t)this.controller.toggleShowOption("water");else if("T"===t)this.controller.toggleShowOption("transparent");else if("E"===t){let e=this.soupWidget.soupView.iLastViewSelected;if(e>0){let t=this.soupWidget.soupView.savedViews[e].id;this.viewPanelList.viewPiece[t].startEdit()}}else if("N"===t)this.controller.toggleResidueNeighbors();else if("C"===t)this.controller.toggleSelectedSidechains();else if("X"===t){let e=this.soupView.getICenteredAtom();if(e>=0){let t=this.soupView.soup.getAtomProxy(e);this.controller.selectResidue(t.iRes)}}else if("A"===t)e.metaKey?(this.controller.selectAllSidechains(!0),e.preventDefault()):this.soupWidget.atomLabelDialog();else if(27===e.keyCode)this.controller.clear();else if("Z"===t||13===e.keyCode)this.controller.zoomToSelection();else{let e=parseInt(t)-1;if((e||0===e)&&e<this.soupView.savedViews.length){let t=this.soupView.savedViews[e].id;this.viewPanelList.setTargetByViewId(t)}}}}}function Op(e){let t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e),n=parseInt(t[1],16)/255,i=parseInt(t[2],16)/255,r=parseInt(t[3],16)/255;return new nr(n,i,r)}function Dp(e){return/^\d+$/.test(e)}function Ip(e){let t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e),n=parseInt(t[1],16),i=parseInt(t[2],16),r=parseInt(t[3],16);return`rgb(${n}, ${i}, ${r})`}function Np(e,t){if(!e)return[];if(!t)return e.split("").map((function(e,t){return t}));let n=[];for(let i=0;i<e.length;i+=1)e.substring(i,i+t.length)===t&&n.push(i);return n}const kp="\n  FY FW LI LM IM ST AG QE ND KR\n  FL FM FH IV YH YW SC HQ QN DE\n  FI FV LV LP LY LW IT IY IW MV \n  MY MW VP SA SN SQ PT PA TA TN \n  HN HW QK QD NE",Vp={};for(let Gp of kp.split(/\s+/)){Vp[Gp]=1;let e=Gp.charAt(1)+Gp.charAt(0);Vp[e]=1}function Up(e,t){return e===t?"identical":s.a.has(Vp,e+t)?"conserved":"nonconserved"}class Fp{reload(e,t){this.data=e,this.selectSeqId=this.data.sequences[0].primary_accession,this.pdbId=this.data.pdb_id,this.selectSeq="",console.log("AquariaAlignment.reload",this.data,this.pdbId,this.selectSeqId),this.alignEntries=[];for(let n of this.data.alignment.split(";")){let e=n.split(","),t=s.a.head(e).split(":"),[i,r,o,,a]=s.a.take(t,5);if(s.a.isNil(o))continue;let[l,u,c]=s.a.last(e).split(":"),h={pdbId:i,pdbChain:r,resNumPdbStart:o,resNumPdbEnd:a,seqId:l,resNumSeqStart:u,resNumSeqEnd:c};for(let n of s.a.keys(h))Dp(h[n])&&(h[n]=parseInt(h[n]));this.alignEntries.push(h)}this.setEmbedJolecule(t)}mapSeqResToPdbResOfChain(e,t,n){for(let i of this.alignEntries)if(t>=i.resNumSeqStart&&t<=i.resNumSeqEnd&&n===i.pdbChain){let e=t-i.resNumSeqStart,n=i.resNumPdbStart+e;return[i.pdbId,i.pdbChain,n]}return null}mapSeqResToPdbResList(e){let t=[];for(let n of this.alignEntries)if(e>=n.resNumSeqStart&&e<=n.resNumSeqEnd){let i=e-n.resNumSeqStart,r=n.resNumPdbStart+i;t.push([n.pdbId,n.pdbChain,r])}return t}mapPdbResOfChainToSeqRes(e,t){for(let n of this.alignEntries)if(e===n.pdbChain&&t>=n.resNumPdbStart&&t<=n.resNumPdbEnd){let e=this.getISeqFromSeqId(n.seqId),i=this.data.common_names[e];i||(i=null);let r=t-n.resNumPdbStart,o=n.resNumSeqStart+r,s=this.data.sequences[e].sequence[o-1];return[i,o,s]}return[null,null,null]}getChainsThatMapToSeqId(e){let t=[];for(let n of s.a.range(this.data.pdb_chain.length))this.data.sequences[n].primary_accession===e&&t.push(this.data.pdb_chain[n]);return t}getISeqFromSeqId(e){let t=this.data.sequences;for(let n of s.a.range(t.length)){if(t[n].primary_accession===e)return n;let i=this.data.pdb_id+"-"+this.data.pdb_chain[n];if(i===e)return n}return null}mapSeqResToPdbResColorEntry(e,t,n){let i=this.getChainsThatMapToSeqId(e),r=[];for(let o of this.mapSeqResToPdbResList(t)){let[e,t,a]=o;s.a.includes(i,t)&&r.push({pdbId:e,chain:t,resNum:a,color:Ip(n)})}return r}colorSoup(e){e.setSecondaryStructureColorResidues();let t=[];for(let i of s.a.range(this.data.sequences.length))s.a.isNil(this.data.sequences[i].primary_accession)||t.push(this.data.pdb_chain[i]);let n=e.getResidueProxy();for(let i=0;i<e.getResidueCount();i+=1){n.iRes=i;let e=n.chain,r=n.resNum,o=s.a.get(fd,n.resType,"."),[,a,l]=this.mapPdbResOfChainToSeqRes(e,r);s.a.isNil(a)?n.customColor="#999999":s.a.includes(t,n.chain)?"conserved"===Up(l,o)?n.customColor="#586C7C":"nonconserved"===Up(l,o)&&(n.customColor="#4D4D4D"):n.customColor="#999999"}e.colorResidues()}setColorLegend(e){e.default(),e.colorEntries.push({color:"#586C7C",label:"Conserved"}),e.colorEntries.push({color:"#4D4D4D",label:"Nonconserved"}),e.rebuild()}setFullSequence(e){let t=e.soup;e.charEntries.length=0,e.nChar=0;let n=this.data.pdb_id,i=this.data.pdb_chain;for(let r=0;r<i.length;r+=1){let o=i[r],a=this.data.sequences[r].sequence,l=this.data.sequences[r].primary_accession,u=this.data.common_names[r];s.a.isNil(l)&&(l=""),console.log("AquariaAlignment.setFullSequence",r,l,u);for(let i=0;i<a.length;i+=1){if(0===i)for(let t of s.a.range(e.nPadChar)){let i=null;0===t&&(i="",u&&(i+=u+", "),i+=n+"-"+o);let r={iStructure:0,chain:o,c:"",startLabel:i,ss:""};e.charEntries.push(r)}let r=a[i],c=i+1,h=this.mapSeqResToPdbResOfChain(l,c,o),d="";if(u&&(d=`Sequence: ${u} ${r}${c}<br>`),s.a.isNil(h)){let t={iStructure:0,chain:o,c:r,startLabel:null,ss:".",label:d+"Structure: [No match]",resNum:i+1};e.charEntries.push(t)}else{let[n,o,a]=h,l=t.findFirstResidue(o,a);if(s.a.isNil(l)){let t={chain:o,iStructure:0,c:r,startLabel:null,ss:".",label:d+"Structure: [No match]",resNum:i+1};e.charEntries.push(t)}else{let t=s.a.get(fd,l.resType,"."),u={chain:o,iStructure:l.iStructure,c:r,startLabel:null,iRes:l.iRes,ss:l.ss,label:`${d}Structure: ${n}-${o} ${t}${a}`,resNum:i+1};e.charEntries.push(u)}}}}e.nChar=e.charEntries.length}colorFromFeatures(e,t,n,i){let r=e.soupView.soup,o=r.getResidueProxy();for(let s=0;s<r.getResidueCount();s+=1)o.iRes=s,o.customColor=Op("#999999");for(let a of t){let e=parseInt(a.Residue);for(let t of this.mapSeqResToPdbResColorEntry(n,e,a.Color)){let e=r.findFirstResidue(t.chain,t.resNum);s.a.isNil(e)||(e.customColor=t.color)}}r.colorResidues(),e.soupView.isUpdateColors=!0,e.soupView.isChanged=!0,this.setFeatureColorLegend(e.widget.colorLegend,t,i)}setFeatureColorLegend(e,t,n){this.features=t;let i=[];for(let r of t){let e=s.a.find(i,e=>e.color===r.Color);e?e.label.push(r.Name):i.push({color:r.Color,label:[r.Name]})}for(let r of i){r.label=s.a.uniq(r.label),r.label=s.a.join(r.label,", ");let e=50;r.label.length>e&&(r.label=r.label.substring(0,e-3)+"...")}e.colorEntries.length=0;for(let r of i)e.colorEntries.push(r);e.title=n,e.rebuild()}colorFromConservation(e){e.soupView.isUpdateObservers=!0,e.soupView.isUpdateColors=!0,e.soupView.isChanged=!0,this.colorSoup(e.soup),this.setColorLegend(e.widget.colorLegend)}selectNewChain(e,t,n,i){console.log("AquariaAlignment.selectNewChain [overriddeable]",e,t,n,i)}setPopup(e){let t=e.soup;e.soupWidget.popupText=e=>{let n=this.data.pdb_id,i=t.getAtomProxy(e),r=i.iRes,o=t.getResidueProxy(r),[a,l,u]=this.mapPdbResOfChainToSeqRes(o.chain,o.resNum),c=s.a.get(fd,o.resType,"."),h=`Structure: ${n}-${o.chain} ${c}${o.resNum} <br>Atom: ${i.atomType}`;if(s.a.isNil(l))h="Sequence: [No match]<br>"+h;else if(h=a?`Sequence: ${a} ${u}${l} <br>`+h:"Sequence: [No match]<br>"+h,this.features)for(let t of this.features)t.Residue===l&&(h+="<br>Feature: "+t.Name,t.Description&&(t.Name&&(h+=" - "),h+=""+t.Description));return h}}getSelectionText(){if(s.a.isNil(this.embedJolecule))return"";let e=this.embedJolecule.soup,t=e.getResidueProxy(),n=[],i=null,r={},o=null,a=null,l=null,u=null;for(let h=0;h<e.getResidueCount();h+=1)if(t.iRes=h,t.selected){let[c,h,d]=this.mapPdbResOfChainToSeqRes(t.chain,t.resNum);if(null===i||i!==t.chain){r={pdbChain:e.structureIds[t.iStructure]+"-"+t.chain,seqName:c,firstPdbRes:null,firstSeqRes:null,pdbResRanges:[],seqResRanges:[]},n.push(r);let o=s.a.get(fd,t.resType,".");r.firstPdbRes=o+t.resNum,r.firstSeqRes=d+h,i=t.chain}null===o?(o=t.resNum,a=o,l=h,u=l):(a=t.resNum,u=h)}else null!==o&&(r.pdbResRanges.push([o,a]),r.seqResRanges.push([l,u])),o=null;let c="";if(this.selectSeq&&(c+=`SEQUENCE: "${this.selectSeq}" <br>`),n.length>0)for(let[h,d]of n.entries()){if(d.pdbResRanges.length>0){c+=d.pdbChain+": ";let e=d.pdbResRanges[0],t=e[0]===e[1];if(1===d.pdbResRanges.length&&t)c+=d.firstPdbRes;else for(let[n,i]of s.a.toPairs(d.pdbResRanges))n>0&&(c+=", "),i[0]===i[1]?c+=i[0]:c+=` ${i[0]}-${i[1]}`;c+="<br>"}if(d.seqName&&d.seqResRanges.length>0){c+=d.seqName+": ";let e=d.seqResRanges[0],t=e[0]===e[1];if(1===d.seqResRanges.length&&t)c+=d.firstSeqRes;else for(let[n,i]of s.a.toPairs(d.seqResRanges))n>0&&(c+=", "),i[0]===i[1]?c+=i[0]:c+=` ${i[0]}-${i[1]}`;c+="<br>"}}return c}copyToClipboard(){let e="",t=this.embedJolecule.soup,n=this.data.pdb_chain,i=this.data.pdb_id;for(let r=0;r<n.length;r+=1){let o=n[r],a=this.data.sequences[r].sequence,l=this.data.sequences[r].primary_accession,u=this.data.common_names[r],c=`${i}-${o}`,h=c+"_SELECTED";s.a.isNil(l)&&(l=""),s.a.isNil(u)&&(u="SEQUENCE");let d="",p="";for(let e=0;e<a.length;e+=1){let n=e+1,i=this.mapSeqResToPdbResOfChain(l,n,o),r="-",a="-";if(!s.a.isNil(i)){let[,e,n]=i,o=t.findFirstResidue(e,n);s.a.isNil(o)||(r=s.a.get(fd,o.resType,"-"),o.selected&&(a=r))}d+=r,p+=a}let f=[{name:u,seq:a},{name:c,seq:d},{name:h,seq:p}],m=s.a.max(s.a.map(f,e=>e.name.length)),g=s.a.max(s.a.map(f,e=>e.seq.length)),v=50,y=Math.ceil(g/v),x="";for(let e=0;e<y;e+=1){for(let t=0;t<f.length;t+=1){let n=f[t];x+=s.a.padEnd(n.name,m)+" ",x+=n.seq.substring(e*v,(e+1)*v),x+="\n"}x+="\n"}e+=x}return console.log("AquariaAlignment.copyToClipboard"),console.log(e),Ah(e),e}selectNextChar(e){this.selectSeq+=e;let t=this.embedJolecule.soup;this.embedJolecule.controller.clearSelectedResidues();let n=this.data.pdb_chain,i=this.selectSeq.length;for(let r=0;r<n.length;r+=1){let e=n[r],o=this.data.sequences[r].sequence,a=this.data.sequences[r].primary_accession;s.a.isNil(a)&&(a="");for(let n of Np(o,this.selectSeq))for(let r=n;r<n+i;r+=1){let n=this.mapSeqResToPdbResOfChain(a,r+1,e);if(!s.a.isNil(n)){let[,e,i]=n,r=t.findFirstResidue(e,i);s.a.isNil(r)||this.embedJolecule.controller.setResidueSelect(r.iRes,!0)}}}this.timeoutId&&clearTimeout(this.timeoutId),this.timeoutId=setTimeout(()=>{this.timeoutId=null,this.selectSeq="",this.embedJolecule.soupView.isUpdateObservers=!0,this.embedJolecule.soupView.isChanged=!0,console.log("AquariaAlignment.selectNextChar settimeout cancel")},4e3)}setSelectionPanel(e){let t=e.widget.selection;t.getText=()=>this.getSelectionText()}setEmbedJolecule(e){e.soupView.setMode("chain"),e.soupWidget.isCrossHairs=!1,e.soupWidget.crossHairs.visible=!1,e.soupView.setMode("chain"),this.setFullSequence(e.widget.sequence),e.widget.sequence.update();for(let[t,n]of this.data.sequences.entries())if(!s.a.isNil(n.primary_accession)){let n=this.data.pdb_chain[t];console.log("AquariaAlignment.setEmbedJolecule",n),e.controller.selectChain(0,n);break}s.a.isNil(e.soupWidget.isAquariaTracking)&&(e.soupWidget.addObserver(this),e.soupWidget.isAquariaTracking=!0,this.embedJolecule=e),this.colorFromConservation(e),this.setPopup(e),this.setSelectionPanel(e)}update(){let e=this.embedJolecule.soup.getIStructureAndChain();if(s.a.isNil(e))this.selectNewChain(null,null,null,null);else{let t=s.a.findIndex(this.data.pdb_chain,t=>t===e.chain);if(t>=0){this.selectSeqId=this.data.sequences[t].primary_accession;let n=this.data.common_names[t],i=this.embedJolecule.soup.structureIds[e.iStructure];this.selectNewChain(this.selectSeqId,n,i,e.chain)}else console.log("AquariaAlignment.update error, chain not found in alignment:",e.chain,this.data.pdb_chain,this.data)}}}function zp(e){return new Tp(s.a.merge(Mp,e))}function jp(...e){return new Lp(...e)}let Bp={pdbId:"",userId:"",isDisableSaveViews:!0,saveViewsUrl:"",isLoadViews:!1,biounit:0,viewId:""};function $p(e){return e=s.a.merge(Bp,e),console.log("makePdbDataServer",e),Hp(e.pdbId,e.userId,e.isDisableSaveViews,e.saveViewsUrl,e.isLoadViews,e.biounit,e.viewId)}function Hp(e,t=null,n=!1,i="",o=!0,s=0,a=""){return{pdbId:e,getProteinData:function(t){let n;n=4===e.length?s?`https://files.rcsb.org/download/${e}.pdb${s}`:`https://files.rcsb.org/download/${e}.pdb`:`${i}/pdb/${e}.txt`,r.a.get(n).done(i=>{let r={pdbId:e,pdbText:i};console.log(`makeDataServer.getProteinData success ${n} biounit:${s}`),t(r)}).fail(()=>{console.log(`makeDataServer.getProteinData fail ${n} biounit:${s}`),t({pdbId:e,pdbText:""})})},getViews:function(n){if(!o)return void n([]);let s=`${i}/pdb/${e}.views.json`;t&&(s+="?user_id="+t),r.a.getJSON(s).done(e=>{console.log("makeDataServer.getViews",s,e),n(e,a)}).fail(()=>{console.log("makeDataServer.getViews fail",s),n([])})},saveViews:function(e,t){n?t():r.a.post(i+"/save/views",JSON.stringify(e)).done(()=>{console.log("makeDataServer.saveViews success","/save/views",e),t(!0)}).fail(()=>{console.log("makeDataServer.saveViews fail","/save/views",e),t(!1)})},deleteView:function(t,o){n?o():r.a.post(i+"/delete/view",JSON.stringify({pdbId:e,viewId:t})).done(()=>{console.log("makeDataServer.deleteView success",t),o(!0)}).fail(()=>{console.log("makeDataServer.deleteView fail",t),o(!1)})}}}},"5cc6":function(e,t,n){var i=n("74e8");i("Uint8",(function(e){return function(t,n,i){return e(this,t,n,i)}}))},"5cf7":function(e,t,n){"use strict";function i(e){var t=this;if(t instanceof i||(t=new i),t.tail=null,t.head=null,t.length=0,e&&"function"===typeof e.forEach)e.forEach((function(e){t.push(e)}));else if(arguments.length>0)for(var n=0,r=arguments.length;n<r;n++)t.push(arguments[n]);return t}function r(e,t,n){var i=t===e.head?new a(n,null,t,e):new a(n,t,t.next,e);return null===i.next&&(e.tail=i),null===i.prev&&(e.head=i),e.length++,i}function o(e,t){e.tail=new a(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function s(e,t){e.head=new a(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function a(e,t,n,i){if(!(this instanceof a))return new a(e,t,n,i);this.list=i,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}e.exports=i,i.Node=a,i.create=i,i.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t},i.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},i.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},i.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)o(this,arguments[e]);return this.length},i.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)s(this,arguments[e]);return this.length},i.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},i.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},i.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,i=0;null!==n;i++)e.call(t,n.value,i,this),n=n.next},i.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,i=this.length-1;null!==n;i--)e.call(t,n.value,i,this),n=n.prev},i.prototype.get=function(e){for(var t=0,n=this.head;null!==n&&t<e;t++)n=n.next;if(t===e&&null!==n)return n.value},i.prototype.getReverse=function(e){for(var t=0,n=this.tail;null!==n&&t<e;t++)n=n.prev;if(t===e&&null!==n)return n.value},i.prototype.map=function(e,t){t=t||this;for(var n=new i,r=this.head;null!==r;)n.push(e.call(t,r.value,this)),r=r.next;return n},i.prototype.mapReverse=function(e,t){t=t||this;for(var n=new i,r=this.tail;null!==r;)n.push(e.call(t,r.value,this)),r=r.prev;return n},i.prototype.reduce=function(e,t){var n,i=this.head;if(arguments.length>1)n=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");i=this.head.next,n=this.head.value}for(var r=0;null!==i;r++)n=e(n,i.value,r),i=i.next;return n},i.prototype.reduceReverse=function(e,t){var n,i=this.tail;if(arguments.length>1)n=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");i=this.tail.prev,n=this.tail.value}for(var r=this.length-1;null!==i;r--)n=e(n,i.value,r),i=i.prev;return n},i.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;null!==n;t++)e[t]=n.value,n=n.next;return e},i.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;null!==n;t++)e[t]=n.value,n=n.prev;return e},i.prototype.slice=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var n=new i;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=0,o=this.head;null!==o&&r<e;r++)o=o.next;for(;null!==o&&r<t;r++,o=o.next)n.push(o.value);return n},i.prototype.sliceReverse=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var n=new i;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=this.length,o=this.tail;null!==o&&r>t;r--)o=o.prev;for(;null!==o&&r>e;r--,o=o.prev)n.push(o.value);return n},i.prototype.splice=function(e,t,...n){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var i=0,o=this.head;null!==o&&i<e;i++)o=o.next;var s=[];for(i=0;o&&i<t;i++)s.push(o.value),o=this.removeNode(o);null===o&&(o=this.tail),o!==this.head&&o!==this.tail&&(o=o.prev);for(i=0;i<n.length;i++)o=r(this,o,n[i]);return s},i.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;null!==n;n=n.prev){var i=n.prev;n.prev=n.next,n.next=i}return this.head=t,this.tail=e,this};try{n("1f03")(i)}catch(l){}},"5e89":function(e,t,n){var i=n("861d"),r=Math.floor;e.exports=function(e){return!i(e)&&isFinite(e)&&r(e)===e}},"5f3e":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("96ab"),r={message:({schemaCode:e})=>i.str`must be multiple of ${e}`,params:({schemaCode:e})=>i._`{multipleOf: ${e}}`},o={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:r,code(e){const{gen:t,data:n,schemaCode:r,it:o}=e,s=o.opts.multipleOfPrecision,a=t.let("res"),l=s?i._`Math.abs(Math.round(${a}) - ${a}) > 1e-${s}`:i._`${a} !== parseInt(${a})`;e.fail$data(i._`(${r} === 0 || (${a} = ${n}/${r}, ${l}))`)}};t.default=o},"5f96":function(e,t,n){"use strict";var i=n("ebb5"),r=i.aTypedArray,o=i.exportTypedArrayMethod,s=[].join;o("join",(function(e){return s.apply(r(this),arguments)}))},"60bd":function(e,t,n){"use strict";var i=n("da84"),r=n("ebb5"),o=n("e260"),s=n("b622"),a=s("iterator"),l=i.Uint8Array,u=o.values,c=o.keys,h=o.entries,d=r.aTypedArray,p=r.exportTypedArrayMethod,f=l&&l.prototype[a],m=!!f&&("values"==f.name||void 0==f.name),g=function(){return u.call(d(this))};p("entries",(function(){return h.call(d(this))})),p("keys",(function(){return c.call(d(this))})),p("values",g,!m),p(a,g,!m)},6125:function(e,t,n){var i=n("1212"),r=n("b838"),o=n("a49e"),s=n("cae0"),a=n("7aec"),l=n("89ed"),u=n("a49d");u.alea=i,u.xor128=r,u.xorwow=o,u.xorshift7=s,u.xor4096=a,u.tychei=l,e.exports=u},"621a":function(e,t,n){"use strict";var i=n("da84"),r=n("83ab"),o=n("a981"),s=n("9112"),a=n("e2cc"),l=n("d039"),u=n("19aa"),c=n("a691"),h=n("50c4"),d=n("0b25"),p=n("77a7"),f=n("e163"),m=n("d2bb"),g=n("241c").f,v=n("9bf2").f,y=n("81d5"),x=n("d44e"),b=n("69f3"),w=b.get,_=b.set,A="ArrayBuffer",S="DataView",E="prototype",M="Wrong length",T="Wrong index",C=i[A],P=C,R=i[S],L=R&&R[E],O=Object.prototype,D=i.RangeError,I=p.pack,N=p.unpack,k=function(e){return[255&e]},V=function(e){return[255&e,e>>8&255]},U=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},F=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},z=function(e){return I(e,23,4)},j=function(e){return I(e,52,8)},B=function(e,t){v(e[E],t,{get:function(){return w(this)[t]}})},$=function(e,t,n,i){var r=d(n),o=w(e);if(r+t>o.byteLength)throw D(T);var s=w(o.buffer).bytes,a=r+o.byteOffset,l=s.slice(a,a+t);return i?l:l.reverse()},H=function(e,t,n,i,r,o){var s=d(n),a=w(e);if(s+t>a.byteLength)throw D(T);for(var l=w(a.buffer).bytes,u=s+a.byteOffset,c=i(+r),h=0;h<t;h++)l[u+h]=c[o?h:t-h-1]};if(o){if(!l((function(){C(1)}))||!l((function(){new C(-1)}))||l((function(){return new C,new C(1.5),new C(NaN),C.name!=A}))){P=function(e){return u(this,P),new C(d(e))};for(var G,W=P[E]=C[E],q=g(C),Y=0;q.length>Y;)(G=q[Y++])in P||s(P,G,C[G]);W.constructor=P}m&&f(L)!==O&&m(L,O);var X=new R(new P(2)),Z=L.setInt8;X.setInt8(0,2147483648),X.setInt8(1,2147483649),!X.getInt8(0)&&X.getInt8(1)||a(L,{setInt8:function(e,t){Z.call(this,e,t<<24>>24)},setUint8:function(e,t){Z.call(this,e,t<<24>>24)}},{unsafe:!0})}else P=function(e){u(this,P,A);var t=d(e);_(this,{bytes:y.call(new Array(t),0),byteLength:t}),r||(this.byteLength=t)},R=function(e,t,n){u(this,R,S),u(e,P,S);var i=w(e).byteLength,o=c(t);if(o<0||o>i)throw D("Wrong offset");if(n=void 0===n?i-o:h(n),o+n>i)throw D(M);_(this,{buffer:e,byteLength:n,byteOffset:o}),r||(this.buffer=e,this.byteLength=n,this.byteOffset=o)},r&&(B(P,"byteLength"),B(R,"buffer"),B(R,"byteLength"),B(R,"byteOffset")),a(R[E],{getInt8:function(e){return $(this,1,e)[0]<<24>>24},getUint8:function(e){return $(this,1,e)[0]},getInt16:function(e){var t=$(this,2,e,arguments.length>1?arguments[1]:void 0);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=$(this,2,e,arguments.length>1?arguments[1]:void 0);return t[1]<<8|t[0]},getInt32:function(e){return F($(this,4,e,arguments.length>1?arguments[1]:void 0))},getUint32:function(e){return F($(this,4,e,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(e){return N($(this,4,e,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(e){return N($(this,8,e,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(e,t){H(this,1,e,k,t)},setUint8:function(e,t){H(this,1,e,k,t)},setInt16:function(e,t){H(this,2,e,V,t,arguments.length>2?arguments[2]:void 0)},setUint16:function(e,t){H(this,2,e,V,t,arguments.length>2?arguments[2]:void 0)},setInt32:function(e,t){H(this,4,e,U,t,arguments.length>2?arguments[2]:void 0)},setUint32:function(e,t){H(this,4,e,U,t,arguments.length>2?arguments[2]:void 0)},setFloat32:function(e,t){H(this,4,e,z,t,arguments.length>2?arguments[2]:void 0)},setFloat64:function(e,t){H(this,8,e,j,t,arguments.length>2?arguments[2]:void 0)}});x(P,A),x(R,S),e.exports={ArrayBuffer:P,DataView:R}},6267:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i extends Error{constructor(e){super("validation failed"),this.errors=e,this.ajv=this.validation=!0}}t.default=i},6292:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reportTypeError=t.checkDataTypes=t.checkDataType=t.coerceAndCheckDataType=t.getJSONTypes=t.getSchemaTypes=t.DataType=void 0;const i=n("a816"),r=n("ac74"),o=n("38d7"),s=n("96ab"),a=n("417a");var l;function u(e){const t=c(e.type),n=t.includes("null");if(n){if(!1===e.nullable)throw new Error("type: null contradicts nullable: false")}else{if(!t.length&&void 0!==e.nullable)throw new Error('"nullable" cannot be used without "type"');!0===e.nullable&&t.push("null")}return t}function c(e){const t=Array.isArray(e)?e:e?[e]:[];if(t.every(i.isJSONType))return t;throw new Error("type must be JSONType or JSONType[]: "+t.join(","))}function h(e,t){const{gen:n,data:i,opts:o}=e,s=p(t,o.coerceTypes),a=t.length>0&&!(0===s.length&&1===t.length&&r.schemaHasRulesForType(e,t[0]));if(a){const r=v(t,i,o.strictNumbers,l.Wrong);n.if(r,()=>{s.length?f(e,t,s):x(e)})}return a}(function(e){e[e["Correct"]=0]="Correct",e[e["Wrong"]=1]="Wrong"})(l=t.DataType||(t.DataType={})),t.getSchemaTypes=u,t.getJSONTypes=c,t.coerceAndCheckDataType=h;const d=new Set(["string","number","integer","boolean","null"]);function p(e,t){return t?e.filter(e=>d.has(e)||"array"===t&&"array"===e):[]}function f(e,t,n){const{gen:i,data:r,opts:o}=e,a=i.let("dataType",s._`typeof ${r}`),l=i.let("coerced",s._`undefined`);"array"===o.coerceTypes&&i.if(s._`${a} == 'object' && Array.isArray(${r}) && ${r}.length == 1`,()=>i.assign(r,s._`${r}[0]`).assign(a,s._`typeof ${r}`).if(v(t,r,o.strictNumbers),()=>i.assign(l,r))),i.if(s._`${l} !== undefined`);for(const s of n)(d.has(s)||"array"===s&&"array"===o.coerceTypes)&&u(s);function u(e){switch(e){case"string":return void i.elseIf(s._`${a} == "number" || ${a} == "boolean"`).assign(l,s._`"" + ${r}`).elseIf(s._`${r} === null`).assign(l,s._`""`);case"number":return void i.elseIf(s._`${a} == "boolean" || ${r} === null
              || (${a} == "string" && ${r} && ${r} == +${r})`).assign(l,s._`+${r}`);case"integer":return void i.elseIf(s._`${a} === "boolean" || ${r} === null
              || (${a} === "string" && ${r} && ${r} == +${r} && !(${r} % 1))`).assign(l,s._`+${r}`);case"boolean":return void i.elseIf(s._`${r} === "false" || ${r} === 0 || ${r} === null`).assign(l,!1).elseIf(s._`${r} === "true" || ${r} === 1`).assign(l,!0);case"null":return i.elseIf(s._`${r} === "" || ${r} === 0 || ${r} === false`),void i.assign(l,null);case"array":i.elseIf(s._`${a} === "string" || ${a} === "number"
              || ${a} === "boolean" || ${r} === null`).assign(l,s._`[${r}]`)}}i.else(),x(e),i.endIf(),i.if(s._`${l} !== undefined`,()=>{i.assign(r,l),m(e,l)})}function m({gen:e,parentData:t,parentDataProperty:n},i){e.if(s._`${t} !== undefined`,()=>e.assign(s._`${t}[${n}]`,i))}function g(e,t,n,i=l.Correct){const r=i===l.Correct?s.operators.EQ:s.operators.NEQ;let o;switch(e){case"null":return s._`${t} ${r} null`;case"array":o=s._`Array.isArray(${t})`;break;case"object":o=s._`${t} && typeof ${t} == "object" && !Array.isArray(${t})`;break;case"integer":o=a(s._`!(${t} % 1) && !isNaN(${t})`);break;case"number":o=a();break;default:return s._`typeof ${t} ${r} ${e}`}return i===l.Correct?o:s.not(o);function a(e=s.nil){return s.and(s._`typeof ${t} == "number"`,e,n?s._`isFinite(${t})`:s.nil)}}function v(e,t,n,i){if(1===e.length)return g(e[0],t,n,i);let r;const o=a.toHash(e);if(o.array&&o.object){const e=s._`typeof ${t} != "object"`;r=o.null?e:s._`!${t} || ${e}`,delete o.null,delete o.array,delete o.object}else r=s.nil;o.number&&delete o.integer;for(const a in o)r=s.and(r,g(a,t,n,i));return r}t.checkDataType=g,t.checkDataTypes=v;const y={message:({schema:e})=>"must be "+e,params:({schema:e,schemaValue:t})=>"string"==typeof e?s._`{type: ${e}}`:s._`{type: ${t}}`};function x(e){const t=b(e);o.reportError(t,y)}function b(e){const{gen:t,data:n,schema:i}=e,r=a.schemaRefOrVal(e,i,"type");return{gen:t,keyword:"type",data:n,schema:i.type,schemaCode:r,schemaValue:r,parentSchema:i,params:{},it:e}}t.reportTypeError=x},"62e4":function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},6374:function(e,t,n){n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0");var i=n("6613");function r(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=i(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){l=!0,s=e},f:function(){try{a||null==n["return"]||n["return"]()}finally{if(l)throw s}}}}e.exports=r,e.exports["default"]=e.exports,e.exports.__esModule=!0},"63b3":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("6f28"),r=n("5f3e"),o=n("fb27"),s=n("364e"),a=n("337b"),l=n("8623"),u=n("8ec3"),c=n("b5e2"),h=n("c201"),d=n("e978"),p=[i.default,r.default,o.default,s.default,a.default,l.default,u.default,c.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},h.default,d.default];t.default=p},"649e":function(e,t,n){"use strict";var i=n("ebb5"),r=n("b727").some,o=i.aTypedArray,s=i.exportTypedArrayMethod;s("some",(function(e){return r(o(this),e,arguments.length>1?arguments[1]:void 0)}))},6613:function(e,t,n){n("fb6a"),n("d3b7"),n("b0c0"),n("a630"),n("3ca3");var i=n("5a43");function r(e,t){if(e){if("string"===typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}e.exports=r,e.exports["default"]=e.exports,e.exports.__esModule=!0},"694b":function(e,t,n){"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var i,r,o;if(Array.isArray(t)){if(i=t.length,i!=n.length)return!1;for(r=i;0!==r--;)if(!e(t[r],n[r]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(o=Object.keys(t),i=o.length,i!==Object.keys(n).length)return!1;for(r=i;0!==r--;)if(!Object.prototype.hasOwnProperty.call(n,o[r]))return!1;for(r=i;0!==r--;){var s=o[r];if(!e(t[s],n[s]))return!1}return!0}return t!==t&&n!==n}},"6b6f":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assignDefaults=void 0;const i=n("96ab"),r=n("417a");function o(e,t){const{properties:n,items:i}=e.schema;if("object"===t&&n)for(const r in n)s(e,r,n[r].default);else"array"===t&&Array.isArray(i)&&i.forEach((t,n)=>s(e,n,t.default))}function s(e,t,n){const{gen:o,compositeRule:s,data:a,opts:l}=e;if(void 0===n)return;const u=i._`${a}${i.getProperty(t)}`;if(s)return void r.checkStrictMode(e,"default is ignored for: "+u);let c=i._`${u} === undefined`;"empty"===l.useDefaults&&(c=i._`${c} || ${u} === null || ${u} === ""`),o.if(c,i._`${u} = ${i.stringify(n)}`)}t.assignDefaults=o},"6c57":function(e,t,n){var i=n("23e7"),r=n("da84");i({global:!0},{globalThis:r})},"6f28":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("96ab"),r=i.operators,o={maximum:{okStr:"<=",ok:r.LTE,fail:r.GT},minimum:{okStr:">=",ok:r.GTE,fail:r.LT},exclusiveMaximum:{okStr:"<",ok:r.LT,fail:r.GTE},exclusiveMinimum:{okStr:">",ok:r.GT,fail:r.LTE}},s={message:({keyword:e,schemaCode:t})=>i.str`must be ${o[e].okStr} ${t}`,params:({keyword:e,schemaCode:t})=>i._`{comparison: ${o[e].okStr}, limit: ${t}}`},a={keyword:Object.keys(o),type:"number",schemaType:"number",$data:!0,error:s,code(e){const{keyword:t,data:n,schemaCode:r}=e;e.fail$data(i._`${n} ${o[t].fail} ${r} || isNaN(${n})`)}};t.default=a},"6f53":function(e,t,n){var i=n("83ab"),r=n("df75"),o=n("fc6a"),s=n("d1e7").f,a=function(e){return function(t){var n,a=o(t),l=r(a),u=l.length,c=0,h=[];while(u>c)n=l[c++],i&&!s.call(a,n)||h.push(e?[n,a[n]]:a[n]);return h}};e.exports={entries:a(!0),values:a(!1)}},7037:function(e,t,n){function i(t){return"function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?(e.exports=i=function(e){return typeof e},e.exports["default"]=e.exports,e.exports.__esModule=!0):(e.exports=i=function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports["default"]=e.exports,e.exports.__esModule=!0),i(t)}n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0"),e.exports=i,e.exports["default"]=e.exports,e.exports.__esModule=!0},7039:function(e,t,n){var i=n("23e7"),r=n("d039"),o=n("057f").f,s=r((function(){return!Object.getOwnPropertyNames(1)}));i({target:"Object",stat:!0,forced:s},{getOwnPropertyNames:o})},"72f7":function(e,t,n){"use strict";var i=n("ebb5").exportTypedArrayMethod,r=n("d039"),o=n("da84"),s=o.Uint8Array,a=s&&s.prototype||{},l=[].toString,u=[].join;r((function(){l.call({})}))&&(l=function(){return u.call(this)});var c=a.toString!=l;i("toString",l,c)},"735e":function(e,t,n){"use strict";var i=n("ebb5"),r=n("81d5"),o=i.aTypedArray,s=i.exportTypedArrayMethod;s("fill",(function(e){return r.apply(o(this),arguments)}))},"73dd":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("96ab"),r={message:({schemaCode:e})=>i.str`must match format "${e}"`,params:({schemaCode:e})=>i._`{format: ${e}}`},o={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:r,code(e,t){const{gen:n,data:r,$data:o,schema:s,schemaCode:a,it:l}=e,{opts:u,errSchemaPath:c,schemaEnv:h,self:d}=l;function p(){const o=n.scopeValue("formats",{ref:d.formats,code:u.code.formats}),s=n.const("fDef",i._`${o}[${a}]`),l=n.let("fType"),c=n.let("format");function p(){return!1===u.strictSchema?i.nil:i._`${a} && !${c}`}function f(){const e=h.$async?i._`(${s}.async ? await ${c}(${r}) : ${c}(${r}))`:i._`${c}(${r})`,n=i._`(typeof ${c} == "function" ? ${e} : ${c}.test(${r}))`;return i._`${c} && ${c} !== true && ${l} === ${t} && !${n}`}n.if(i._`typeof ${s} == "object" && !(${s} instanceof RegExp)`,()=>n.assign(l,i._`${s}.type || "string"`).assign(c,i._`${s}.validate`),()=>n.assign(l,i._`"string"`).assign(c,s)),e.fail$data(i.or(p(),f()))}function f(){const o=d.formats[s];if(!o)return void f();if(!0===o)return;const[a,l,p]=m(o);function f(){if(!1!==u.strictSchema)throw new Error(e());function e(){return`unknown format "${s}" ignored in schema at path "${c}"`}d.logger.warn(e())}function m(e){const t=e instanceof RegExp?i.regexpCode(e):u.code.formats?i._`${u.code.formats}${i.getProperty(s)}`:void 0,r=n.scopeValue("formats",{key:s,ref:e,code:t});return"object"!=typeof e||e instanceof RegExp?["string",e,r]:[e.type||"string",e.validate,i._`${r}.validate`]}function g(){if("object"==typeof o&&!(o instanceof RegExp)&&o.async){if(!h.$async)throw new Error("async format in sync schema");return i._`await ${p}(${r})`}return"function"==typeof l?i._`${p}(${r})`:i._`${p}.test(${r})`}a===t&&e.pass(g())}u.validateFormats&&(o?p():f())}};t.default=o},"74e8":function(e,t,n){"use strict";var i=n("23e7"),r=n("da84"),o=n("83ab"),s=n("8aa7"),a=n("ebb5"),l=n("621a"),u=n("19aa"),c=n("5c6c"),h=n("9112"),d=n("5e89"),p=n("50c4"),f=n("0b25"),m=n("182d"),g=n("a04b"),v=n("5135"),y=n("f5df"),x=n("861d"),b=n("d9b5"),w=n("7c73"),_=n("d2bb"),A=n("241c").f,S=n("a078"),E=n("b727").forEach,M=n("2626"),T=n("9bf2"),C=n("06cf"),P=n("69f3"),R=n("7156"),L=P.get,O=P.set,D=T.f,I=C.f,N=Math.round,k=r.RangeError,V=l.ArrayBuffer,U=l.DataView,F=a.NATIVE_ARRAY_BUFFER_VIEWS,z=a.TYPED_ARRAY_CONSTRUCTOR,j=a.TYPED_ARRAY_TAG,B=a.TypedArray,$=a.TypedArrayPrototype,H=a.aTypedArrayConstructor,G=a.isTypedArray,W="BYTES_PER_ELEMENT",q="Wrong length",Y=function(e,t){var n=0,i=t.length,r=new(H(e))(i);while(i>n)r[n]=t[n++];return r},X=function(e,t){D(e,t,{get:function(){return L(this)[t]}})},Z=function(e){var t;return e instanceof V||"ArrayBuffer"==(t=y(e))||"SharedArrayBuffer"==t},J=function(e,t){return G(e)&&!b(t)&&t in e&&d(+t)&&t>=0},K=function(e,t){return t=g(t),J(e,t)?c(2,e[t]):I(e,t)},Q=function(e,t,n){return t=g(t),!(J(e,t)&&x(n)&&v(n,"value"))||v(n,"get")||v(n,"set")||n.configurable||v(n,"writable")&&!n.writable||v(n,"enumerable")&&!n.enumerable?D(e,t,n):(e[t]=n.value,e)};o?(F||(C.f=K,T.f=Q,X($,"buffer"),X($,"byteOffset"),X($,"byteLength"),X($,"length")),i({target:"Object",stat:!0,forced:!F},{getOwnPropertyDescriptor:K,defineProperty:Q}),e.exports=function(e,t,n){var o=e.match(/\d+$/)[0]/8,a=e+(n?"Clamped":"")+"Array",l="get"+e,c="set"+e,d=r[a],g=d,v=g&&g.prototype,y={},b=function(e,t){var n=L(e);return n.view[l](t*o+n.byteOffset,!0)},T=function(e,t,i){var r=L(e);n&&(i=(i=N(i))<0?0:i>255?255:255&i),r.view[c](t*o+r.byteOffset,i,!0)},C=function(e,t){D(e,t,{get:function(){return b(this,t)},set:function(e){return T(this,t,e)},enumerable:!0})};F?s&&(g=t((function(e,t,n,i){return u(e,g,a),R(function(){return x(t)?Z(t)?void 0!==i?new d(t,m(n,o),i):void 0!==n?new d(t,m(n,o)):new d(t):G(t)?Y(g,t):S.call(g,t):new d(f(t))}(),e,g)})),_&&_(g,B),E(A(d),(function(e){e in g||h(g,e,d[e])})),g.prototype=v):(g=t((function(e,t,n,i){u(e,g,a);var r,s,l,c=0,h=0;if(x(t)){if(!Z(t))return G(t)?Y(g,t):S.call(g,t);r=t,h=m(n,o);var d=t.byteLength;if(void 0===i){if(d%o)throw k(q);if(s=d-h,s<0)throw k(q)}else if(s=p(i)*o,s+h>d)throw k(q);l=s/o}else l=f(t),s=l*o,r=new V(s);O(e,{buffer:r,byteOffset:h,byteLength:s,length:l,view:new U(r)});while(c<l)C(e,c++)})),_&&_(g,B),v=g.prototype=w($)),v.constructor!==g&&h(v,"constructor",g),h(v,z,g),j&&h(v,j,a),y[a]=g,i({global:!0,forced:g!=d,sham:!F},y),W in g||h(g,W,o),W in v||h(v,W,o),M(a)}):e.exports=function(){}},7792:function(e,t,n){"use strict";function i(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function r(e,t){this._context=e,this._k=(1-t)/6}r.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:i(this,this._x1,this._y1);break}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:i(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}},t["a"]=function e(t){function n(e){return new r(e,t)}return n.tension=function(t){return e(+t)},n}(0)},"77a7":function(e,t){var n=Math.abs,i=Math.pow,r=Math.floor,o=Math.log,s=Math.LN2,a=function(e,t,a){var l,u,c,h=new Array(a),d=8*a-t-1,p=(1<<d)-1,f=p>>1,m=23===t?i(2,-24)-i(2,-77):0,g=e<0||0===e&&1/e<0?1:0,v=0;for(e=n(e),e!=e||e===1/0?(u=e!=e?1:0,l=p):(l=r(o(e)/s),e*(c=i(2,-l))<1&&(l--,c*=2),e+=l+f>=1?m/c:m*i(2,1-f),e*c>=2&&(l++,c/=2),l+f>=p?(u=0,l=p):l+f>=1?(u=(e*c-1)*i(2,t),l+=f):(u=e*i(2,f-1)*i(2,t),l=0));t>=8;h[v++]=255&u,u/=256,t-=8);for(l=l<<t|u,d+=t;d>0;h[v++]=255&l,l/=256,d-=8);return h[--v]|=128*g,h},l=function(e,t){var n,r=e.length,o=8*r-t-1,s=(1<<o)-1,a=s>>1,l=o-7,u=r-1,c=e[u--],h=127&c;for(c>>=7;l>0;h=256*h+e[u],u--,l-=8);for(n=h&(1<<-l)-1,h>>=-l,l+=t;l>0;n=256*n+e[u],u--,l-=8);if(0===h)h=1-a;else{if(h===s)return n?NaN:c?-1/0:1/0;n+=i(2,t),h-=a}return(c?-1:1)*n*i(2,h-t)};e.exports={pack:a,unpack:l}},"7aec":function(e,t,n){(function(e){var i;(function(e,r,o){function s(e){var t=this;function n(e,t){var n,i,r,o,s,a=[],l=128;for(t===(0|t)?(i=t,t=null):(t+="\0",i=0,l=Math.max(l,t.length)),r=0,o=-32;o<l;++o)t&&(i^=t.charCodeAt((o+32)%t.length)),0===o&&(s=i),i^=i<<10,i^=i>>>15,i^=i<<4,i^=i>>>13,o>=0&&(s=s+1640531527|0,n=a[127&o]^=i+s,r=0==n?r+1:0);for(r>=128&&(a[127&(t&&t.length||0)]=-1),r=127,o=512;o>0;--o)i=a[r+34&127],n=a[r=r+1&127],i^=i<<13,n^=n<<17,i^=i>>>15,n^=n>>>12,a[r]=i^n;e.w=s,e.X=a,e.i=r}t.next=function(){var e,n,i=t.w,r=t.X,o=t.i;return t.w=i=i+1640531527|0,n=r[o+34&127],e=r[o=o+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=r[o]=n^e,t.i=o,n+(i^i>>>16)|0},n(t,e)}function a(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function l(e,t){null==e&&(e=+new Date);var n=new s(e),i=t&&t.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var e=n.next()>>>11,t=(n.next()>>>0)/4294967296,i=(e+t)/(1<<21)}while(0===i);return i},r.int32=n.next,r.quick=r,i&&(i.X&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=l:n("07d6")&&n("3c35")?(i=function(){return l}.call(t,n,t,r),void 0===i||(r.exports=i)):this.xor4096=l})(0,e,n("07d6"))}).call(this,n("62e4")(e))},"81d5":function(e,t,n){"use strict";var i=n("7b0b"),r=n("23cb"),o=n("50c4");e.exports=function(e){var t=i(this),n=o(t.length),s=arguments.length,a=r(s>1?arguments[1]:void 0,n),l=s>2?arguments[2]:void 0,u=void 0===l?n:r(l,n);while(u>a)t[a++]=e;return t}},"82ac":function(e,t,n){"use strict";n.d(t,"b",(function(){return i}));var i=Array.prototype.slice;t["a"]=function(e){return"object"===typeof e&&"length"in e?e:Array.from(e)}},"82f8":function(e,t,n){"use strict";var i=n("ebb5"),r=n("4d64").includes,o=i.aTypedArray,s=i.exportTypedArrayMethod;s("includes",(function(e){return r(o(this),e,arguments.length>1?arguments[1]:void 0)}))},"83a7":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.contentVocabulary=t.metadataVocabulary=void 0,t.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"],t.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]},"84c3":function(e,t,n){var i=n("74e8");i("Uint16",(function(e){return function(t,n,i){return e(this,t,n,i)}}))},8623:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("4c26"),r=n("96ab"),o=n("417a"),s={message:({params:{missingProperty:e}})=>r.str`must have required property '${e}'`,params:({params:{missingProperty:e}})=>r._`{missingProperty: ${e}}`},a={keyword:"required",type:"object",schemaType:"array",$data:!0,error:s,code(e){const{gen:t,schema:n,schemaCode:s,data:a,$data:l,it:u}=e,{opts:c}=u;if(!l&&0===n.length)return;const h=n.length>=c.loopRequired;if(u.allErrors?d():p(),c.strictRequired){const t=e.parentSchema.properties,{definedProperties:i}=e.it;for(const e of n)if(void 0===(null===t||void 0===t?void 0:t[e])&&!i.has(e)){const t=u.schemaEnv.baseId+u.errSchemaPath,n=`required property "${e}" is not defined at "${t}" (strictRequired)`;o.checkStrictMode(u,n,u.opts.strictRequired)}}function d(){if(h||l)e.block$data(r.nil,f);else for(const t of n)i.checkReportMissingProp(e,t)}function p(){const r=t.let("missing");if(h||l){const n=t.let("valid",!0);e.block$data(n,()=>m(r,n)),e.ok(n)}else t.if(i.checkMissingProp(e,n,r)),i.reportMissingProp(e,r),t.else()}function f(){t.forOf("prop",s,n=>{e.setParams({missingProperty:n}),t.if(i.noPropertyInData(t,a,n,c.ownProperties),()=>e.error())})}function m(n,o){e.setParams({missingProperty:n}),t.forOf(n,s,()=>{t.assign(o,i.propertyInData(t,a,n,c.ownProperties)),t.if(r.not(o),()=>{e.error(),t.break()})},r.nil)}}};t.default=a},"89ed":function(e,t,n){(function(e){var i;(function(e,r,o){function s(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,i=t.d,r=t.a;return e=e<<25^e>>>7^n,n=n-i|0,i=i<<24^i>>>8^r,r=r-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-i|0,t.d=i<<16^n>>>16^r,t.a=r-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var i=0;i<n.length+20;i++)t.b^=0|n.charCodeAt(i),t.next()}function a(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function l(e,t){var n=new s(e),i=t&&t.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var e=n.next()>>>11,t=(n.next()>>>0)/4294967296,i=(e+t)/(1<<21)}while(0===i);return i},r.int32=n.next,r.quick=r,i&&("object"==typeof i&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=l:n("07d6")&&n("3c35")?(i=function(){return l}.call(t,n,t,r),void 0===i||(r.exports=i)):this.tychei=l})(0,e,n("07d6"))}).call(this,n("62e4")(e))},"8aa7":function(e,t,n){var i=n("da84"),r=n("d039"),o=n("1c7e"),s=n("ebb5").NATIVE_ARRAY_BUFFER_VIEWS,a=i.ArrayBuffer,l=i.Int8Array;e.exports=!s||!r((function(){l(1)}))||!r((function(){new l(-1)}))||!o((function(e){new l,new l(null),new l(1.5),new l(e)}),!0)||r((function(){return 1!==new l(new a(2),1,void 0).length}))},"8b78":function(e,t,n){},"8ec3":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("96ab"),r={message({keyword:e,schemaCode:t}){const n="maxItems"===e?"more":"fewer";return i.str`must NOT have ${n} than ${t} items`},params:({schemaCode:e})=>i._`{limit: ${e}}`},o={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:r,code(e){const{keyword:t,data:n,schemaCode:r}=e,o="maxItems"===t?i.operators.GT:i.operators.LT;e.fail$data(i._`${n}.length ${o} ${r}`)}};t.default=o},9082:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};t.default=i},9091:function(e,t,n){
/*!
 * Sizzle CSS Selector Engine
 *  Copyright 2011, The Dojo Foundation
 *  Released under the MIT, BSD, and GPL Licenses.
 *  More information: http://sizzlejs.com/
 */
(function(){var t=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,n="sizcache"+(Math.random()+"").replace(".",""),i=0,r=Object.prototype.toString,o=!1,s=!0,a=/\\/g,l=/\r\n/g,u=/\W/;[0,0].sort((function(){return s=!1,0}));var c=function(e,n,i,o){i=i||[],n=n||document;var s=n;if(1!==n.nodeType&&9!==n.nodeType)return[];if(!e||"string"!==typeof e)return i;var a,l,u,h,f,m,g,v,x=!0,b=c.isXML(n),_=[],A=e;do{if(t.exec(""),a=t.exec(A),a&&(A=a[3],_.push(a[1]),a[2])){h=a[3];break}}while(a);if(_.length>1&&p.exec(e))if(2===_.length&&d.relative[_[0]])l=w(_[0]+_[1],n,o);else{l=d.relative[_[0]]?[n]:c(_.shift(),n);while(_.length)e=_.shift(),d.relative[e]&&(e+=_.shift()),l=w(e,l,o)}else if(!o&&_.length>1&&9===n.nodeType&&!b&&d.match.ID.test(_[0])&&!d.match.ID.test(_[_.length-1])&&(f=c.find(_.shift(),n,b),n=f.expr?c.filter(f.expr,f.set)[0]:f.set[0]),n){f=o?{expr:_.pop(),set:y(o)}:c.find(_.pop(),1!==_.length||"~"!==_[0]&&"+"!==_[0]||!n.parentNode?n:n.parentNode,b),l=f.expr?c.filter(f.expr,f.set):f.set,_.length>0?u=y(l):x=!1;while(_.length)m=_.pop(),g=m,d.relative[m]?g=_.pop():m="",null==g&&(g=n),d.relative[m](u,g,b)}else u=_=[];if(u||(u=l),u||c.error(m||e),"[object Array]"===r.call(u))if(x)if(n&&1===n.nodeType)for(v=0;null!=u[v];v++)u[v]&&(!0===u[v]||1===u[v].nodeType&&c.contains(n,u[v]))&&i.push(l[v]);else for(v=0;null!=u[v];v++)u[v]&&1===u[v].nodeType&&i.push(l[v]);else i.push.apply(i,u);else y(u,i);return h&&(c(h,s,i,o),c.uniqueSort(i)),i};c.uniqueSort=function(e){if(g&&(o=s,e.sort(g),o))for(var t=1;t<e.length;t++)e[t]===e[t-1]&&e.splice(t--,1);return e},c.matches=function(e,t){return c(e,null,null,t)},c.matchesSelector=function(e,t){return c(t,null,null,[e]).length>0},c.find=function(e,t,n){var i,r,o,s,l,u;if(!e)return[];for(r=0,o=d.order.length;r<o;r++)if(l=d.order[r],(s=d.leftMatch[l].exec(e))&&(u=s[1],s.splice(1,1),"\\"!==u.substr(u.length-1)&&(s[1]=(s[1]||"").replace(a,""),i=d.find[l](s,t,n),null!=i))){e=e.replace(d.match[l],"");break}return i||(i="undefined"!==typeof t.getElementsByTagName?t.getElementsByTagName("*"):[]),{set:i,expr:e}},c.filter=function(e,t,n,i){var r,o,s,a,l,u,h,p,f,m=e,g=[],v=t,y=t&&t[0]&&c.isXML(t[0]);while(e&&t.length){for(s in d.filter)if(null!=(r=d.leftMatch[s].exec(e))&&r[2]){if(u=d.filter[s],h=r[1],o=!1,r.splice(1,1),"\\"===h.substr(h.length-1))continue;if(v===g&&(g=[]),d.preFilter[s])if(r=d.preFilter[s](r,v,n,g,i,y),r){if(!0===r)continue}else o=a=!0;if(r)for(p=0;null!=(l=v[p]);p++)l&&(a=u(l,r,p,v),f=i^a,n&&null!=a?f?o=!0:v[p]=!1:f&&(g.push(l),o=!0));if(void 0!==a){if(n||(v=g),e=e.replace(d.match[s],""),!o)return[];break}}if(e===m){if(null!=o)break;c.error(e)}m=e}return v},c.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)};var h=c.getText=function(e){var t,n,i=e.nodeType,r="";if(i){if(1===i||9===i||11===i){if("string"===typeof e.textContent)return e.textContent;if("string"===typeof e.innerText)return e.innerText.replace(l,"");for(e=e.firstChild;e;e=e.nextSibling)r+=h(e)}else if(3===i||4===i)return e.nodeValue}else for(t=0;n=e[t];t++)8!==n.nodeType&&(r+=h(n));return r},d=c.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{class:"className",for:"htmlFor"},attrHandle:{href:function(e){return e.getAttribute("href")},type:function(e){return e.getAttribute("type")}},relative:{"+":function(e,t){var n="string"===typeof t,i=n&&!u.test(t),r=n&&!i;i&&(t=t.toLowerCase());for(var o,s=0,a=e.length;s<a;s++)if(o=e[s]){while((o=o.previousSibling)&&1!==o.nodeType);e[s]=r||o&&o.nodeName.toLowerCase()===t?o||!1:o===t}r&&c.filter(t,e,!0)},">":function(e,t){var n,i="string"===typeof t,r=0,o=e.length;if(i&&!u.test(t)){for(t=t.toLowerCase();r<o;r++)if(n=e[r],n){var s=n.parentNode;e[r]=s.nodeName.toLowerCase()===t&&s}}else{for(;r<o;r++)n=e[r],n&&(e[r]=i?n.parentNode:n.parentNode===t);i&&c.filter(t,e,!0)}},"":function(e,t,n){var r,o=i++,s=b;"string"!==typeof t||u.test(t)||(t=t.toLowerCase(),r=t,s=x),s("parentNode",t,o,e,r,n)},"~":function(e,t,n){var r,o=i++,s=b;"string"!==typeof t||u.test(t)||(t=t.toLowerCase(),r=t,s=x),s("previousSibling",t,o,e,r,n)}},find:{ID:function(e,t,n){if("undefined"!==typeof t.getElementById&&!n){var i=t.getElementById(e[1]);return i&&i.parentNode?[i]:[]}},NAME:function(e,t){if("undefined"!==typeof t.getElementsByName){for(var n=[],i=t.getElementsByName(e[1]),r=0,o=i.length;r<o;r++)i[r].getAttribute("name")===e[1]&&n.push(i[r]);return 0===n.length?null:n}},TAG:function(e,t){if("undefined"!==typeof t.getElementsByTagName)return t.getElementsByTagName(e[1])}},preFilter:{CLASS:function(e,t,n,i,r,o){if(e=" "+e[1].replace(a,"")+" ",o)return e;for(var s,l=0;null!=(s=t[l]);l++)s&&(r^(s.className&&(" "+s.className+" ").replace(/[\t\n\r]/g," ").indexOf(e)>=0)?n||i.push(s):n&&(t[l]=!1));return!1},ID:function(e){return e[1].replace(a,"")},TAG:function(e,t){return e[1].replace(a,"").toLowerCase()},CHILD:function(e){if("nth"===e[1]){e[2]||c.error(e[0]),e[2]=e[2].replace(/^\+|\s*/g,"");var t=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(("even"===e[2]?"2n":"odd"===e[2]&&"2n+1")||!/\D/.test(e[2])&&"0n+"+e[2]||e[2]);e[2]=t[1]+(t[2]||1)-0,e[3]=t[3]-0}else e[2]&&c.error(e[0]);return e[0]=i++,e},ATTR:function(e,t,n,i,r,o){var s=e[1]=e[1].replace(a,"");return!o&&d.attrMap[s]&&(e[1]=d.attrMap[s]),e[4]=(e[4]||e[5]||"").replace(a,""),"~="===e[2]&&(e[4]=" "+e[4]+" "),e},PSEUDO:function(e,n,i,r,o){if("not"===e[1]){if(!((t.exec(e[3])||"").length>1||/^\w/.test(e[3]))){var s=c.filter(e[3],n,i,!0^o);return i||r.push.apply(r,s),!1}e[3]=c(e[3],null,null,n)}else if(d.match.POS.test(e[0])||d.match.CHILD.test(e[0]))return!0;return e},POS:function(e){return e.unshift(!0),e}},filters:{enabled:function(e){return!1===e.disabled&&"hidden"!==e.type},disabled:function(e){return!0===e.disabled},checked:function(e){return!0===e.checked},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},parent:function(e){return!!e.firstChild},empty:function(e){return!e.firstChild},has:function(e,t,n){return!!c(n[3],e).length},header:function(e){return/h\d/i.test(e.nodeName)},text:function(e){var t=e.getAttribute("type"),n=e.type;return"input"===e.nodeName.toLowerCase()&&"text"===n&&(t===n||null===t)},radio:function(e){return"input"===e.nodeName.toLowerCase()&&"radio"===e.type},checkbox:function(e){return"input"===e.nodeName.toLowerCase()&&"checkbox"===e.type},file:function(e){return"input"===e.nodeName.toLowerCase()&&"file"===e.type},password:function(e){return"input"===e.nodeName.toLowerCase()&&"password"===e.type},submit:function(e){var t=e.nodeName.toLowerCase();return("input"===t||"button"===t)&&"submit"===e.type},image:function(e){return"input"===e.nodeName.toLowerCase()&&"image"===e.type},reset:function(e){var t=e.nodeName.toLowerCase();return("input"===t||"button"===t)&&"reset"===e.type},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},input:function(e){return/input|select|textarea|button/i.test(e.nodeName)},focus:function(e){return e===e.ownerDocument.activeElement}},setFilters:{first:function(e,t){return 0===t},last:function(e,t,n,i){return t===i.length-1},even:function(e,t){return t%2===0},odd:function(e,t){return t%2===1},lt:function(e,t,n){return t<n[3]-0},gt:function(e,t,n){return t>n[3]-0},nth:function(e,t,n){return n[3]-0===t},eq:function(e,t,n){return n[3]-0===t}},filter:{PSEUDO:function(e,t,n,i){var r=t[1],o=d.filters[r];if(o)return o(e,n,t,i);if("contains"===r)return(e.textContent||e.innerText||h([e])||"").indexOf(t[3])>=0;if("not"===r){for(var s=t[3],a=0,l=s.length;a<l;a++)if(s[a]===e)return!1;return!0}c.error(r)},CHILD:function(e,t){var i,r,o,s,a,l,u=t[1],c=e;switch(u){case"only":case"first":while(c=c.previousSibling)if(1===c.nodeType)return!1;if("first"===u)return!0;c=e;case"last":while(c=c.nextSibling)if(1===c.nodeType)return!1;return!0;case"nth":if(i=t[2],r=t[3],1===i&&0===r)return!0;if(o=t[0],s=e.parentNode,s&&(s[n]!==o||!e.nodeIndex)){for(a=0,c=s.firstChild;c;c=c.nextSibling)1===c.nodeType&&(c.nodeIndex=++a);s[n]=o}return l=e.nodeIndex-r,0===i?0===l:l%i===0&&l/i>=0}},ID:function(e,t){return 1===e.nodeType&&e.getAttribute("id")===t},TAG:function(e,t){return"*"===t&&1===e.nodeType||!!e.nodeName&&e.nodeName.toLowerCase()===t},CLASS:function(e,t){return(" "+(e.className||e.getAttribute("class"))+" ").indexOf(t)>-1},ATTR:function(e,t){var n=t[1],i=c.attr?c.attr(e,n):d.attrHandle[n]?d.attrHandle[n](e):null!=e[n]?e[n]:e.getAttribute(n),r=i+"",o=t[2],s=t[4];return null==i?"!="===o:!o&&c.attr?null!=i:"="===o?r===s:"*="===o?r.indexOf(s)>=0:"~="===o?(" "+r+" ").indexOf(s)>=0:s?"!="===o?r!==s:"^="===o?0===r.indexOf(s):"$="===o?r.substr(r.length-s.length)===s:"|="===o&&(r===s||r.substr(0,s.length+1)===s+"-"):r&&!1!==i},POS:function(e,t,n,i){var r=t[2],o=d.setFilters[r];if(o)return o(e,n,t,i)}}},p=d.match.POS,f=function(e,t){return"\\"+(t-0+1)};for(var m in d.match)d.match[m]=new RegExp(d.match[m].source+/(?![^\[]*\])(?![^\(]*\))/.source),d.leftMatch[m]=new RegExp(/(^(?:.|\r|\n)*?)/.source+d.match[m].source.replace(/\\(\d+)/g,f));d.match.globalPOS=p;var g,v,y=function(e,t){return e=Array.prototype.slice.call(e,0),t?(t.push.apply(t,e),t):e};try{Array.prototype.slice.call(document.documentElement.childNodes,0)[0].nodeType}catch(_){y=function(e,t){var n=0,i=t||[];if("[object Array]"===r.call(e))Array.prototype.push.apply(i,e);else if("number"===typeof e.length)for(var o=e.length;n<o;n++)i.push(e[n]);else for(;e[n];n++)i.push(e[n]);return i}}function x(e,t,i,r,o,s){for(var a=0,l=r.length;a<l;a++){var u=r[a];if(u){var c=!1;u=u[e];while(u){if(u[n]===i){c=r[u.sizset];break}if(1!==u.nodeType||s||(u[n]=i,u.sizset=a),u.nodeName.toLowerCase()===t){c=u;break}u=u[e]}r[a]=c}}}function b(e,t,i,r,o,s){for(var a=0,l=r.length;a<l;a++){var u=r[a];if(u){var h=!1;u=u[e];while(u){if(u[n]===i){h=r[u.sizset];break}if(1===u.nodeType)if(s||(u[n]=i,u.sizset=a),"string"!==typeof t){if(u===t){h=!0;break}}else if(c.filter(t,[u]).length>0){h=u;break}u=u[e]}r[a]=h}}}document.documentElement.compareDocumentPosition?g=function(e,t){return e===t?(o=!0,0):e.compareDocumentPosition&&t.compareDocumentPosition?4&e.compareDocumentPosition(t)?-1:1:e.compareDocumentPosition?-1:1}:(g=function(e,t){if(e===t)return o=!0,0;if(e.sourceIndex&&t.sourceIndex)return e.sourceIndex-t.sourceIndex;var n,i,r=[],s=[],a=e.parentNode,l=t.parentNode,u=a;if(a===l)return v(e,t);if(!a)return-1;if(!l)return 1;while(u)r.unshift(u),u=u.parentNode;u=l;while(u)s.unshift(u),u=u.parentNode;n=r.length,i=s.length;for(var c=0;c<n&&c<i;c++)if(r[c]!==s[c])return v(r[c],s[c]);return c===n?v(e,s[c],-1):v(r[c],t,1)},v=function(e,t,n){if(e===t)return n;var i=e.nextSibling;while(i){if(i===t)return-1;i=i.nextSibling}return 1}),function(){var e=document.createElement("div"),t="script"+(new Date).getTime(),n=document.documentElement;e.innerHTML="<a name='"+t+"'/>",n.insertBefore(e,n.firstChild),document.getElementById(t)&&(d.find.ID=function(e,t,n){if("undefined"!==typeof t.getElementById&&!n){var i=t.getElementById(e[1]);return i?i.id===e[1]||"undefined"!==typeof i.getAttributeNode&&i.getAttributeNode("id").nodeValue===e[1]?[i]:void 0:[]}},d.filter.ID=function(e,t){var n="undefined"!==typeof e.getAttributeNode&&e.getAttributeNode("id");return 1===e.nodeType&&n&&n.nodeValue===t}),n.removeChild(e),n=e=null}(),function(){var e=document.createElement("div");e.appendChild(document.createComment("")),e.getElementsByTagName("*").length>0&&(d.find.TAG=function(e,t){var n=t.getElementsByTagName(e[1]);if("*"===e[1]){for(var i=[],r=0;n[r];r++)1===n[r].nodeType&&i.push(n[r]);n=i}return n}),e.innerHTML="<a href='#'></a>",e.firstChild&&"undefined"!==typeof e.firstChild.getAttribute&&"#"!==e.firstChild.getAttribute("href")&&(d.attrHandle.href=function(e){return e.getAttribute("href",2)}),e=null}(),document.querySelectorAll&&function(){var e=c,t=document.createElement("div"),n="__sizzle__";if(t.innerHTML="<p class='TEST'></p>",!t.querySelectorAll||0!==t.querySelectorAll(".TEST").length){for(var i in c=function(t,i,r,o){if(i=i||document,!o&&!c.isXML(i)){var s=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(t);if(s&&(1===i.nodeType||9===i.nodeType)){if(s[1])return y(i.getElementsByTagName(t),r);if(s[2]&&d.find.CLASS&&i.getElementsByClassName)return y(i.getElementsByClassName(s[2]),r)}if(9===i.nodeType){if("body"===t&&i.body)return y([i.body],r);if(s&&s[3]){var a=i.getElementById(s[3]);if(!a||!a.parentNode)return y([],r);if(a.id===s[3])return y([a],r)}try{return y(i.querySelectorAll(t),r)}catch(m){}}else if(1===i.nodeType&&"object"!==i.nodeName.toLowerCase()){var l=i,u=i.getAttribute("id"),h=u||n,p=i.parentNode,f=/^\s*[+~]/.test(t);u?h=h.replace(/'/g,"\\$&"):i.setAttribute("id",h),f&&p&&(i=i.parentNode);try{if(!f||p)return y(i.querySelectorAll("[id='"+h+"'] "+t),r)}catch(g){}finally{u||l.removeAttribute("id")}}}return e(t,i,r,o)},e)c[i]=e[i];t=null}}(),function(){var e=document.documentElement,t=e.matchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.msMatchesSelector;if(t){var n=!t.call(document.createElement("div"),"div"),i=!1;try{t.call(document.documentElement,"[test!='']:sizzle")}catch(r){i=!0}c.matchesSelector=function(e,r){if(r=r.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']"),!c.isXML(e))try{if(i||!d.match.PSEUDO.test(r)&&!/!=/.test(r)){var o=t.call(e,r);if(o||!n||e.document&&11!==e.document.nodeType)return o}}catch(_){}return c(r,null,null,[e]).length>0}}}(),function(){var e=document.createElement("div");e.innerHTML="<div class='test e'></div><div class='test'></div>",e.getElementsByClassName&&0!==e.getElementsByClassName("e").length&&(e.lastChild.className="e",1!==e.getElementsByClassName("e").length&&(d.order.splice(1,0,"CLASS"),d.find.CLASS=function(e,t,n){if("undefined"!==typeof t.getElementsByClassName&&!n)return t.getElementsByClassName(e[1])},e=null))}(),document.documentElement.contains?c.contains=function(e,t){return e!==t&&(!e.contains||e.contains(t))}:document.documentElement.compareDocumentPosition?c.contains=function(e,t){return!!(16&e.compareDocumentPosition(t))}:c.contains=function(){return!1},c.isXML=function(e){var t=(e?e.ownerDocument||e:0).documentElement;return!!t&&"HTML"!==t.nodeName};var w=function(e,t,n){var i,r=[],o="",s=t.nodeType?[t]:t;while(i=d.match.PSEUDO.exec(e))o+=i[0],e=e.replace(d.match.PSEUDO,"");e=d.relative[e]?e+"*":e;for(var a=0,l=s.length;a<l;a++)c(e,s[a],r,n);return c.filter(o,r)};e.exports?e.exports=c:window.Sizzle=c})()},"91dd":function(e,t,n){"use strict";function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,o){t=t||"&",n=n||"=";var s={};if("string"!==typeof e||0===e.length)return s;var a=/\+/g;e=e.split(t);var l=1e3;o&&"number"===typeof o.maxKeys&&(l=o.maxKeys);var u=e.length;l>0&&u>l&&(u=l);for(var c=0;c<u;++c){var h,d,p,f,m=e[c].replace(a,"%20"),g=m.indexOf(n);g>=0?(h=m.substr(0,g),d=m.substr(g+1)):(h=m,d=""),p=decodeURIComponent(h),f=decodeURIComponent(d),i(s,p)?r(s[p])?s[p].push(f):s[p]=[s[p],f]:s[p]=f}return s};var r=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},9328:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("96ab"),r=n("0073"),o={message:({params:{discrError:e,tagName:t}})=>e===r.DiscrError.Tag?`tag "${t}" must be string`:`value of tag "${t}" must be in oneOf`,params:({params:{discrError:e,tag:t,tagName:n}})=>i._`{error: ${e}, tag: ${n}, tagValue: ${t}}`},s={keyword:"discriminator",type:"object",schemaType:"object",error:o,code(e){const{gen:t,data:n,schema:o,parentSchema:s,it:a}=e,{oneOf:l}=s;if(!a.opts.discriminator)throw new Error("discriminator: requires discriminator option");const u=o.propertyName;if("string"!=typeof u)throw new Error("discriminator: requires propertyName");if(o.mapping)throw new Error("discriminator: mapping is not supported");if(!l)throw new Error("discriminator: requires oneOf keyword");const c=t.let("valid",!1),h=t.const("tag",i._`${n}${i.getProperty(u)}`);function d(){const n=f();t.if(!1);for(const e in n)t.elseIf(i._`${h} === ${e}`),t.assign(c,p(n[e]));t.else(),e.error(!1,{discrError:r.DiscrError.Mapping,tag:h,tagName:u}),t.endIf()}function p(n){const r=t.name("valid"),o=e.subschema({keyword:"oneOf",schemaProp:n},r);return e.mergeEvaluated(o,i.Name),r}function f(){var e;const t={},n=r(s);let i=!0;for(let s=0;s<l.length;s++){const t=l[s],a=null===(e=t.properties)||void 0===e?void 0:e[u];if("object"!=typeof a)throw new Error(`discriminator: oneOf schemas must have "properties/${u}"`);i=i&&(n||r(t)),o(a,s)}if(!i)throw new Error(`discriminator: "${u}" must be required`);return t;function r({required:e}){return Array.isArray(e)&&e.includes(u)}function o(e,t){if(e.const)a(e.const,t);else{if(!e.enum)throw new Error(`discriminator: "properties/${u}" must have "const" or "enum"`);for(const n of e.enum)a(n,t)}}function a(e,n){if("string"!=typeof e||e in t)throw new Error(`discriminator: "${u}" values must be unique strings`);t[e]=n}}t.if(i._`typeof ${h} == "string"`,()=>d(),()=>e.error(!1,{discrError:r.DiscrError.Tag,tag:h,tagName:u})),e.ok(c)}};t.default=s},"950f":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.extendSubschemaMode=t.extendSubschemaData=t.getSubschema=void 0;const i=n("96ab"),r=n("417a");function o(e,{keyword:t,schemaProp:n,schema:o,schemaPath:s,errSchemaPath:a,topSchemaRef:l}){if(void 0!==t&&void 0!==o)throw new Error('both "keyword" and "schema" passed, only one allowed');if(void 0!==t){const o=e.schema[t];return void 0===n?{schema:o,schemaPath:i._`${e.schemaPath}${i.getProperty(t)}`,errSchemaPath:`${e.errSchemaPath}/${t}`}:{schema:o[n],schemaPath:i._`${e.schemaPath}${i.getProperty(t)}${i.getProperty(n)}`,errSchemaPath:`${e.errSchemaPath}/${t}/${r.escapeFragment(n)}`}}if(void 0!==o){if(void 0===s||void 0===a||void 0===l)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:o,schemaPath:s,topSchemaRef:l,errSchemaPath:a}}throw new Error('either "keyword" or "schema" must be passed')}function s(e,t,{dataProp:n,dataPropType:o,data:s,dataTypes:a,propertyName:l}){if(void 0!==s&&void 0!==n)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:u}=t;if(void 0!==n){const{errorPath:s,dataPathArr:a,opts:l}=t,h=u.let("data",i._`${t.data}${i.getProperty(n)}`,!0);c(h),e.errorPath=i.str`${s}${r.getErrorPath(n,o,l.jsPropertySyntax)}`,e.parentDataProperty=i._`${n}`,e.dataPathArr=[...a,e.parentDataProperty]}if(void 0!==s){const t=s instanceof i.Name?s:u.let("data",s,!0);c(t),void 0!==l&&(e.propertyName=l)}function c(n){e.data=n,e.dataLevel=t.dataLevel+1,e.dataTypes=[],t.definedProperties=new Set,e.parentData=t.data,e.dataNames=[...t.dataNames,n]}a&&(e.dataTypes=a)}function a(e,{jtdDiscriminator:t,jtdMetadata:n,compositeRule:i,createErrors:r,allErrors:o}){void 0!==i&&(e.compositeRule=i),void 0!==r&&(e.createErrors=r),void 0!==o&&(e.allErrors=o),e.jtdDiscriminator=t,e.jtdMetadata=n}t.getSubschema=o,t.extendSubschemaData=s,t.extendSubschemaMode=a},9523:function(e,t){function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}e.exports=n,e.exports["default"]=e.exports,e.exports.__esModule=!0},"95bf":function(e,t,n){"use strict";(function(e){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var s=function(e,t){return e.matches?e.matches(t):e.msMatchesSelector?e.msMatchesSelector(t):e.webkitMatchesSelector?e.webkitMatchesSelector(t):null},a=function(e,t){var n=e;while(n&&1===n.nodeType){if(s(n,t))return n;n=n.parentNode}return null},l=function(e,t){return e.closest?e.closest(t):a(e,t)},u=function(e){return Boolean(e&&"function"===typeof e.then)},c=function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=r.search,s=r.autoSelect,a=void 0!==s&&s,c=r.setValue,h=void 0===c?function(){}:c,d=r.setAttribute,p=void 0===d?function(){}:d,f=r.onUpdate,m=void 0===f?function(){}:f,g=r.onSubmit,v=void 0===g?function(){}:g,y=r.onShow,x=void 0===y?function(){}:y,b=r.onHide,w=void 0===b?function(){}:b,_=r.onLoading,A=void 0===_?function(){}:_,S=r.onLoaded,E=void 0===S?function(){}:S;n(this,e),i(this,"value",""),i(this,"searchCounter",0),i(this,"results",[]),i(this,"selectedIndex",-1),i(this,"handleInput",(function(e){var n=e.target.value;t.updateResults(n),t.value=n})),i(this,"handleKeyDown",(function(e){var n=e.key;switch(n){case"Up":case"Down":case"ArrowUp":case"ArrowDown":var i="ArrowUp"===n||"Up"===n?t.selectedIndex-1:t.selectedIndex+1;e.preventDefault(),t.handleArrows(i);break;case"Tab":t.selectResult();break;case"Enter":var r=t.results[t.selectedIndex];t.selectResult(),t.onSubmit(r);break;case"Esc":case"Escape":t.hideResults(),t.setValue();break;default:return}})),i(this,"handleFocus",(function(e){var n=e.target.value;t.updateResults(n),t.value=n})),i(this,"handleBlur",(function(){t.hideResults()})),i(this,"handleResultMouseDown",(function(e){e.preventDefault()})),i(this,"handleResultClick",(function(e){var n=e.target,i=l(n,"[data-result-index]");if(i){t.selectedIndex=parseInt(i.dataset.resultIndex,10);var r=t.results[t.selectedIndex];t.selectResult(),t.onSubmit(r)}})),i(this,"handleArrows",(function(e){var n=t.results.length;t.selectedIndex=(e%n+n)%n,t.onUpdate(t.results,t.selectedIndex)})),i(this,"selectResult",(function(){var e=t.results[t.selectedIndex];e&&t.setValue(e),t.hideResults()})),i(this,"updateResults",(function(e){var n=++t.searchCounter;t.onLoading(),t.search(e).then((function(e){n===t.searchCounter&&(t.results=e,t.onLoaded(),0!==t.results.length?(t.selectedIndex=t.autoSelect?0:-1,t.onUpdate(t.results,t.selectedIndex),t.showResults()):t.hideResults())}))})),i(this,"showResults",(function(){t.setAttribute("aria-expanded",!0),t.onShow()})),i(this,"hideResults",(function(){t.selectedIndex=-1,t.results=[],t.setAttribute("aria-expanded",!1),t.setAttribute("aria-activedescendant",""),t.onUpdate(t.results,t.selectedIndex),t.onHide()})),i(this,"checkSelectedResultVisible",(function(e){var n=e.querySelector('[data-result-index="'.concat(t.selectedIndex,'"]'));if(n){var i=e.getBoundingClientRect(),r=n.getBoundingClientRect();r.top<i.top?e.scrollTop-=i.top-r.top:r.bottom>i.bottom&&(e.scrollTop+=r.bottom-i.bottom)}})),this.search=u(o)?o:function(e){return Promise.resolve(o(e))},this.autoSelect=a,this.setValue=h,this.setAttribute=p,this.onUpdate=m,this.onSubmit=v,this.onShow=x,this.onHide=w,this.onLoading=A,this.onLoaded=E},h=0,d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"".concat(e).concat(++h)},p=function(e,t){var n=e.getBoundingClientRect(),i=t.getBoundingClientRect(),r=n.bottom+i.height>window.innerHeight&&window.innerHeight-n.bottom<n.top&&window.pageYOffset+n.top-i.height>0;return r?"above":"below"},f=function(e,t,n){var i;return function(){var r=this,o=arguments,s=function(){i=null,n||e.apply(r,o)},a=n&&!i;clearTimeout(i),i=setTimeout(s,t),a&&e.apply(r,o)}},m={name:"Autocomplete",inheritAttrs:!1,props:{search:{type:Function,required:!0},baseClass:{type:String,default:"autocomplete"},autoSelect:{type:Boolean,default:!1},getResultValue:{type:Function,default:function(e){return e}},defaultValue:{type:String,default:""},debounceTime:{type:Number,default:0}},data:function(){var e=new c({search:this.search,autoSelect:this.autoSelect,setValue:this.setValue,onUpdate:this.handleUpdate,onSubmit:this.handleSubmit,onShow:this.handleShow,onHide:this.handleHide,onLoading:this.handleLoading,onLoaded:this.handleLoaded});return this.debounceTime>0&&(e.handleInput=f(e.handleInput,this.debounceTime)),{core:e,value:this.defaultValue,resultListId:d("".concat(this.baseClass,"-result-list-")),results:[],selectedIndex:-1,expanded:!1,loading:!1,position:"below",resetPosition:!0}},computed:{rootProps:function(){return{class:this.baseClass,style:{position:"relative"},"data-expanded":this.expanded,"data-loading":this.loading,"data-position":this.position}},inputProps:function(){return o({class:"".concat(this.baseClass,"-input"),value:this.value,role:"combobox",autocomplete:"off",autocapitalize:"off",autocorrect:"off",spellcheck:"false","aria-autocomplete":"list","aria-haspopup":"listbox","aria-owns":this.resultListId,"aria-expanded":this.expanded?"true":"false","aria-activedescendant":this.selectedIndex>-1?this.resultProps[this.selectedIndex].id:""},this.$attrs)},inputListeners:function(){return{input:this.handleInput,keydown:this.core.handleKeyDown,focus:this.core.handleFocus,blur:this.core.handleBlur}},resultListProps:function(){var e="below"===this.position?"top":"bottom";return{id:this.resultListId,class:"".concat(this.baseClass,"-result-list"),role:"listbox",style:i({position:"absolute",zIndex:1,width:"100%",visibility:this.expanded?"visible":"hidden",pointerEvents:this.expanded?"auto":"none"},e,"100%")}},resultListListeners:function(){return{mousedown:this.core.handleResultMouseDown,click:this.core.handleResultClick}},resultProps:function(){var e=this;return this.results.map((function(t,n){return o({id:"".concat(e.baseClass,"-result-").concat(n),class:"".concat(e.baseClass,"-result"),"data-result-index":n,role:"option"},e.selectedIndex===n?{"aria-selected":"true"}:{})}))}},mounted:function(){document.body.addEventListener("click",this.handleDocumentClick)},beforeDestroy:function(){document.body.removeEventListener("click",this.handleDocumentClick)},updated:function(){this.$refs.input&&this.$refs.resultList&&(this.resetPosition&&this.results.length>0&&(this.resetPosition=!1,this.position=p(this.$refs.input,this.$refs.resultList)),this.core.checkSelectedResultVisible(this.$refs.resultList))},methods:{setValue:function(e){this.value=e?this.getResultValue(e):""},handleUpdate:function(e,t){this.results=e,this.selectedIndex=t,this.$emit("update",e,t)},handleShow:function(){this.expanded=!0},handleHide:function(){this.expanded=!1,this.resetPosition=!0},handleLoading:function(){this.loading=!0},handleLoaded:function(){this.loading=!1},handleInput:function(e){this.value=e.target.value,this.core.handleInput(e)},handleSubmit:function(e){this.$emit("submit",e)},handleDocumentClick:function(e){this.$refs.root.contains(e.target)||this.core.hideResults()}}};function g(e,t,n,i,r,o,s,a,l,u){"boolean"!==typeof s&&(l=a,a=s,s=!1);const c="function"===typeof n?n.options:n;let h;if(e&&e.render&&(c.render=e.render,c.staticRenderFns=e.staticRenderFns,c._compiled=!0,r&&(c.functional=!0)),i&&(c._scopeId=i),o?(h=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,l(e)),e&&e._registeredComponents&&e._registeredComponents.add(o)},c._ssrRegister=h):t&&(h=s?function(e){t.call(this,u(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,a(e))}),h)if(c.functional){const e=c.render;c.render=function(t,n){return h.call(n),e(t,n)}}else{const e=c.beforeCreate;c.beforeCreate=e?[].concat(e,h):[h]}return n}const v=m;var y=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"root"},[e._t("default",[n("div",e._b({},"div",e.rootProps,!1),[n("input",e._g(e._b({ref:"input",on:{input:e.handleInput,keydown:e.core.handleKeyDown,focus:e.core.handleFocus,blur:e.core.handleBlur}},"input",e.inputProps,!1),e.$listeners)),e._v(" "),n("ul",e._g(e._b({ref:"resultList"},"ul",e.resultListProps,!1),e.resultListListeners),[e._l(e.results,(function(t,i){return[e._t("result",[n("li",e._b({key:e.resultProps[i].id},"li",e.resultProps[i],!1),[e._v("\n              "+e._s(e.getResultValue(t))+"\n            ")])],{result:t,props:e.resultProps[i]})]}))],2)])],{rootProps:e.rootProps,inputProps:e.inputProps,inputListeners:e.inputListeners,resultListProps:e.resultListProps,resultListListeners:e.resultListListeners,results:e.results,resultProps:e.resultProps})],2)},x=[];const b=void 0,w=void 0,_=void 0,A=!1,S=g({render:y,staticRenderFns:x},b,v,w,A,_,!1,void 0,void 0,void 0);function E(e){E.installed||(E.installed=!0,e.component("Autocomplete",S))}var M,T={install:E};"undefined"!==typeof window?M=window.Vue:"undefined"!==typeof e&&(M=e.Vue),M&&M.use(T),S.install=E,t["a"]=S}).call(this,n("c8ba"))},"96ab":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.or=t.and=t.not=t.CodeGen=t.operators=t.varKinds=t.ValueScopeName=t.ValueScope=t.Scope=t.Name=t.regexpCode=t.stringify=t.getProperty=t.nil=t.strConcat=t.str=t._=void 0;const i=n("ab2c"),r=n("05c4");var o=n("ab2c");Object.defineProperty(t,"_",{enumerable:!0,get:function(){return o._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return o.str}}),Object.defineProperty(t,"strConcat",{enumerable:!0,get:function(){return o.strConcat}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return o.nil}}),Object.defineProperty(t,"getProperty",{enumerable:!0,get:function(){return o.getProperty}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return o.stringify}}),Object.defineProperty(t,"regexpCode",{enumerable:!0,get:function(){return o.regexpCode}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return o.Name}});var s=n("05c4");Object.defineProperty(t,"Scope",{enumerable:!0,get:function(){return s.Scope}}),Object.defineProperty(t,"ValueScope",{enumerable:!0,get:function(){return s.ValueScope}}),Object.defineProperty(t,"ValueScopeName",{enumerable:!0,get:function(){return s.ValueScopeName}}),Object.defineProperty(t,"varKinds",{enumerable:!0,get:function(){return s.varKinds}}),t.operators={GT:new i._Code(">"),GTE:new i._Code(">="),LT:new i._Code("<"),LTE:new i._Code("<="),EQ:new i._Code("==="),NEQ:new i._Code("!=="),NOT:new i._Code("!"),OR:new i._Code("||"),AND:new i._Code("&&"),ADD:new i._Code("+")};class a{optimizeNodes(){return this}optimizeNames(e,t){return this}}class l extends a{constructor(e,t,n){super(),this.varKind=e,this.name=t,this.rhs=n}render({es5:e,_n:t}){const n=e?r.varKinds.var:this.varKind,i=void 0===this.rhs?"":" = "+this.rhs;return`${n} ${this.name}${i};`+t}optimizeNames(e,t){if(e[this.name.str])return this.rhs&&(this.rhs=O(this.rhs,e,t)),this}get names(){return this.rhs instanceof i._CodeOrName?this.rhs.names:{}}}class u extends a{constructor(e,t,n){super(),this.lhs=e,this.rhs=t,this.sideEffects=n}render({_n:e}){return`${this.lhs} = ${this.rhs};`+e}optimizeNames(e,t){if(!(this.lhs instanceof i.Name)||e[this.lhs.str]||this.sideEffects)return this.rhs=O(this.rhs,e,t),this}get names(){const e=this.lhs instanceof i.Name?{}:{...this.lhs.names};return L(e,this.rhs)}}class c extends u{constructor(e,t,n,i){super(e,n,i),this.op=t}render({_n:e}){return`${this.lhs} ${this.op}= ${this.rhs};`+e}}class h extends a{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return this.label+":"+e}}class d extends a{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){const t=this.label?" "+this.label:"";return`break${t};`+e}}class p extends a{constructor(e){super(),this.error=e}render({_n:e}){return`throw ${this.error};`+e}get names(){return this.error.names}}class f extends a{constructor(e){super(),this.code=e}render({_n:e}){return this.code+";"+e}optimizeNodes(){return""+this.code?this:void 0}optimizeNames(e,t){return this.code=O(this.code,e,t),this}get names(){return this.code instanceof i._CodeOrName?this.code.names:{}}}class m extends a{constructor(e=[]){super(),this.nodes=e}render(e){return this.nodes.reduce((t,n)=>t+n.render(e),"")}optimizeNodes(){const{nodes:e}=this;let t=e.length;while(t--){const n=e[t].optimizeNodes();Array.isArray(n)?e.splice(t,1,...n):n?e[t]=n:e.splice(t,1)}return e.length>0?this:void 0}optimizeNames(e,t){const{nodes:n}=this;let i=n.length;while(i--){const r=n[i];r.optimizeNames(e,t)||(D(e,r.names),n.splice(i,1))}return n.length>0?this:void 0}get names(){return this.nodes.reduce((e,t)=>R(e,t.names),{})}}class g extends m{render(e){return"{"+e._n+super.render(e)+"}"+e._n}}class v extends m{}class y extends g{}y.kind="else";class x extends g{constructor(e,t){super(t),this.condition=e}render(e){let t=`if(${this.condition})`+super.render(e);return this.else&&(t+="else "+this.else.render(e)),t}optimizeNodes(){super.optimizeNodes();const e=this.condition;if(!0===e)return this.nodes;let t=this.else;if(t){const e=t.optimizeNodes();t=this.else=Array.isArray(e)?new y(e):e}return t?!1===e?t instanceof x?t:t.nodes:this.nodes.length?this:new x(I(e),t instanceof x?[t]:t.nodes):!1!==e&&this.nodes.length?this:void 0}optimizeNames(e,t){var n;if(this.else=null===(n=this.else)||void 0===n?void 0:n.optimizeNames(e,t),super.optimizeNames(e,t)||this.else)return this.condition=O(this.condition,e,t),this}get names(){const e=super.names;return L(e,this.condition),this.else&&R(e,this.else.names),e}}x.kind="if";class b extends g{}b.kind="for";class w extends b{constructor(e){super(),this.iteration=e}render(e){return`for(${this.iteration})`+super.render(e)}optimizeNames(e,t){if(super.optimizeNames(e,t))return this.iteration=O(this.iteration,e,t),this}get names(){return R(super.names,this.iteration.names)}}class _ extends b{constructor(e,t,n,i){super(),this.varKind=e,this.name=t,this.from=n,this.to=i}render(e){const t=e.es5?r.varKinds.var:this.varKind,{name:n,from:i,to:o}=this;return`for(${t} ${n}=${i}; ${n}<${o}; ${n}++)`+super.render(e)}get names(){const e=L(super.names,this.from);return L(e,this.to)}}class A extends b{constructor(e,t,n,i){super(),this.loop=e,this.varKind=t,this.name=n,this.iterable=i}render(e){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(e)}optimizeNames(e,t){if(super.optimizeNames(e,t))return this.iterable=O(this.iterable,e,t),this}get names(){return R(super.names,this.iterable.names)}}class S extends g{constructor(e,t,n){super(),this.name=e,this.args=t,this.async=n}render(e){const t=this.async?"async ":"";return`${t}function ${this.name}(${this.args})`+super.render(e)}}S.kind="func";class E extends m{render(e){return"return "+super.render(e)}}E.kind="return";class M extends g{render(e){let t="try"+super.render(e);return this.catch&&(t+=this.catch.render(e)),this.finally&&(t+=this.finally.render(e)),t}optimizeNodes(){var e,t;return super.optimizeNodes(),null===(e=this.catch)||void 0===e||e.optimizeNodes(),null===(t=this.finally)||void 0===t||t.optimizeNodes(),this}optimizeNames(e,t){var n,i;return super.optimizeNames(e,t),null===(n=this.catch)||void 0===n||n.optimizeNames(e,t),null===(i=this.finally)||void 0===i||i.optimizeNames(e,t),this}get names(){const e=super.names;return this.catch&&R(e,this.catch.names),this.finally&&R(e,this.finally.names),e}}class T extends g{constructor(e){super(),this.error=e}render(e){return`catch(${this.error})`+super.render(e)}}T.kind="catch";class C extends g{render(e){return"finally"+super.render(e)}}C.kind="finally";class P{constructor(e,t={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...t,_n:t.lines?"\n":""},this._extScope=e,this._scope=new r.Scope({parent:e}),this._nodes=[new v]}toString(){return this._root.render(this.opts)}name(e){return this._scope.name(e)}scopeName(e){return this._extScope.name(e)}scopeValue(e,t){const n=this._extScope.value(e,t),i=this._values[n.prefix]||(this._values[n.prefix]=new Set);return i.add(n),n}getScopeValue(e,t){return this._extScope.getValue(e,t)}scopeRefs(e){return this._extScope.scopeRefs(e,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(e,t,n,i){const r=this._scope.toName(t);return void 0!==n&&i&&(this._constants[r.str]=n),this._leafNode(new l(e,r,n)),r}const(e,t,n){return this._def(r.varKinds.const,e,t,n)}let(e,t,n){return this._def(r.varKinds.let,e,t,n)}var(e,t,n){return this._def(r.varKinds.var,e,t,n)}assign(e,t,n){return this._leafNode(new u(e,t,n))}add(e,n){return this._leafNode(new c(e,t.operators.ADD,n))}code(e){return"function"==typeof e?e():e!==i.nil&&this._leafNode(new f(e)),this}object(...e){const t=["{"];for(const[n,r]of e)t.length>1&&t.push(","),t.push(n),(n!==r||this.opts.es5)&&(t.push(":"),i.addCodeArg(t,r));return t.push("}"),new i._Code(t)}if(e,t,n){if(this._blockNode(new x(e)),t&&n)this.code(t).else().code(n).endIf();else if(t)this.code(t).endIf();else if(n)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(e){return this._elseNode(new x(e))}else(){return this._elseNode(new y)}endIf(){return this._endBlockNode(x,y)}_for(e,t){return this._blockNode(e),t&&this.code(t).endFor(),this}for(e,t){return this._for(new w(e),t)}forRange(e,t,n,i,o=(this.opts.es5?r.varKinds.var:r.varKinds.let)){const s=this._scope.toName(e);return this._for(new _(o,s,t,n),()=>i(s))}forOf(e,t,n,o=r.varKinds.const){const s=this._scope.toName(e);if(this.opts.es5){const e=t instanceof i.Name?t:this.var("_arr",t);return this.forRange("_i",0,i._`${e}.length`,t=>{this.var(s,i._`${e}[${t}]`),n(s)})}return this._for(new A("of",o,s,t),()=>n(s))}forIn(e,t,n,o=(this.opts.es5?r.varKinds.var:r.varKinds.const)){if(this.opts.ownProperties)return this.forOf(e,i._`Object.keys(${t})`,n);const s=this._scope.toName(e);return this._for(new A("in",o,s,t),()=>n(s))}endFor(){return this._endBlockNode(b)}label(e){return this._leafNode(new h(e))}break(e){return this._leafNode(new d(e))}return(e){const t=new E;if(this._blockNode(t),this.code(e),1!==t.nodes.length)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(E)}try(e,t,n){if(!t&&!n)throw new Error('CodeGen: "try" without "catch" and "finally"');const i=new M;if(this._blockNode(i),this.code(e),t){const e=this.name("e");this._currNode=i.catch=new T(e),t(e)}return n&&(this._currNode=i.finally=new C,this.code(n)),this._endBlockNode(T,C)}throw(e){return this._leafNode(new p(e))}block(e,t){return this._blockStarts.push(this._nodes.length),e&&this.code(e).endBlock(t),this}endBlock(e){const t=this._blockStarts.pop();if(void 0===t)throw new Error("CodeGen: not in self-balancing block");const n=this._nodes.length-t;if(n<0||void 0!==e&&n!==e)throw new Error(`CodeGen: wrong number of nodes: ${n} vs ${e} expected`);return this._nodes.length=t,this}func(e,t=i.nil,n,r){return this._blockNode(new S(e,t,n)),r&&this.code(r).endFunc(),this}endFunc(){return this._endBlockNode(S)}optimize(e=1){while(e-- >0)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(e){return this._currNode.nodes.push(e),this}_blockNode(e){this._currNode.nodes.push(e),this._nodes.push(e)}_endBlockNode(e,t){const n=this._currNode;if(n instanceof e||t&&n instanceof t)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${t?`${e.kind}/${t.kind}`:e.kind}"`)}_elseNode(e){const t=this._currNode;if(!(t instanceof x))throw new Error('CodeGen: "else" without "if"');return this._currNode=t.else=e,this}get _root(){return this._nodes[0]}get _currNode(){const e=this._nodes;return e[e.length-1]}set _currNode(e){const t=this._nodes;t[t.length-1]=e}}function R(e,t){for(const n in t)e[n]=(e[n]||0)+(t[n]||0);return e}function L(e,t){return t instanceof i._CodeOrName?R(e,t.names):e}function O(e,t,n){return e instanceof i.Name?r(e):o(e)?new i._Code(e._items.reduce((e,t)=>(t instanceof i.Name&&(t=r(t)),t instanceof i._Code?e.push(...t._items):e.push(t),e),[])):e;function r(e){const i=n[e.str];return void 0===i||1!==t[e.str]?e:(delete t[e.str],i)}function o(e){return e instanceof i._Code&&e._items.some(e=>e instanceof i.Name&&1===t[e.str]&&void 0!==n[e.str])}}function D(e,t){for(const n in t)e[n]=(e[n]||0)-(t[n]||0)}function I(e){return"boolean"==typeof e||"number"==typeof e||null===e?!e:i._`!${z(e)}`}t.CodeGen=P,t.not=I;const N=F(t.operators.AND);function k(...e){return e.reduce(N)}t.and=k;const V=F(t.operators.OR);function U(...e){return e.reduce(V)}function F(e){return(t,n)=>t===i.nil?n:n===i.nil?t:i._`${z(t)} ${e} ${z(n)}`}function z(e){return e instanceof i.Name?e:i._`(${e})`}t.or=U},"99df":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("f06c"),r=n("63b3"),o=n("3107"),s=n("f35f"),a=n("83a7"),l=[i.default,r.default,o.default(),s.default,a.metadataVocabulary,a.contentVocabulary];t.default=l},"9a8c":function(e,t,n){"use strict";var i=n("ebb5"),r=n("145e"),o=i.aTypedArray,s=i.exportTypedArrayMethod;s("copyWithin",(function(e,t){return r.call(o(this),e,t,arguments.length>2?arguments[2]:void 0)}))},"9e12":function(e,t,n){var i;
/** @license
 * JS Signals <http://millermedeiros.github.com/js-signals/>
 * Released under the MIT license
 * Author: Miller Medeiros
 * Version: 1.0.0 - Build: 268 (2012/11/29 05:48 PM)
 */(function(r){function o(e,t,n,i,r){this._listener=t,this._isOnce=n,this.context=i,this._signal=e,this._priority=r||0}function s(e,t){if("function"!==typeof e)throw new Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",t))}function a(){this._bindings=[],this._prevParams=null;var e=this;this.dispatch=function(){a.prototype.dispatch.apply(e,arguments)}}o.prototype={active:!0,params:null,execute:function(e){var t,n;return this.active&&this._listener&&(n=this.params?this.params.concat(e):e,t=this._listener.apply(this.context,n),this._isOnce&&this.detach()),t},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal,delete this._listener,delete this.context},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}},a.prototype={VERSION:"1.0.0",memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(e,t,n,i){var r,s=this._indexOfListener(e,n);if(-1!==s){if(r=this._bindings[s],r.isOnce()!==t)throw new Error("You cannot add"+(t?"":"Once")+"() then add"+(t?"Once":"")+"() the same listener without removing the relationship first.")}else r=new o(this,e,t,n,i),this._addBinding(r);return this.memorize&&this._prevParams&&r.execute(this._prevParams),r},_addBinding:function(e){var t=this._bindings.length;do{--t}while(this._bindings[t]&&e._priority<=this._bindings[t]._priority);this._bindings.splice(t+1,0,e)},_indexOfListener:function(e,t){var n,i=this._bindings.length;while(i--)if(n=this._bindings[i],n._listener===e&&n.context===t)return i;return-1},has:function(e,t){return-1!==this._indexOfListener(e,t)},add:function(e,t,n){return s(e,"add"),this._registerListener(e,!1,t,n)},addOnce:function(e,t,n){return s(e,"addOnce"),this._registerListener(e,!0,t,n)},remove:function(e,t){s(e,"remove");var n=this._indexOfListener(e,t);return-1!==n&&(this._bindings[n]._destroy(),this._bindings.splice(n,1)),e},removeAll:function(){var e=this._bindings.length;while(e--)this._bindings[e]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(e){if(this.active){var t,n=Array.prototype.slice.call(arguments),i=this._bindings.length;if(this.memorize&&(this._prevParams=n),i){t=this._bindings.slice(),this._shouldPropagate=!0;do{i--}while(t[i]&&this._shouldPropagate&&!1!==t[i].execute(n))}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll(),delete this._bindings,delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};var l=a;l.Signal=a,i=function(){return l}.call(t,n,t,e),void 0===i||(e.exports=i)})()},"9ecd":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("96ab"),r=n("417a"),o=n("4c26"),s=n("04d0"),a={message:({params:{len:e}})=>i.str`must NOT have more than ${e} items`,params:({params:{len:e}})=>i._`{limit: ${e}}`},l={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:a,code(e){const{schema:t,parentSchema:n,it:i}=e,{prefixItems:a}=n;i.items=!0,r.alwaysValidSchema(i,t)||(a?s.validateAdditionalItems(e,a):e.ok(o.validateArray(e)))}};t.default=l},a078:function(e,t,n){var i=n("7b0b"),r=n("50c4"),o=n("35a1"),s=n("e95a"),a=n("0366"),l=n("ebb5").aTypedArrayConstructor;e.exports=function(e){var t,n,u,c,h,d,p=i(e),f=arguments.length,m=f>1?arguments[1]:void 0,g=void 0!==m,v=o(p);if(void 0!=v&&!s(v)){h=v.call(p),d=h.next,p=[];while(!(c=d.call(h)).done)p.push(c.value)}for(g&&f>2&&(m=a(m,arguments[2],2)),n=r(p.length),u=new(l(this))(n),t=0;n>t;t++)u[t]=g?m(p[t],t):p[t];return u}},a2b8:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("96ab"),r=n("417a"),o={message:({params:e})=>i.str`must match "${e.ifClause}" schema`,params:({params:e})=>i._`{failingKeyword: ${e.ifClause}}`},s={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:o,code(e){const{gen:t,parentSchema:n,it:o}=e;void 0===n.then&&void 0===n.else&&r.checkStrictMode(o,'"if" without "then" and "else" is ignored');const s=a(o,"then"),l=a(o,"else");if(!s&&!l)return;const u=t.let("valid",!0),c=t.name("_valid");if(h(),e.reset(),s&&l){const n=t.let("ifClause");e.setParams({ifClause:n}),t.if(c,d("then",n),d("else",n))}else s?t.if(c,d("then")):t.if(i.not(c),d("else"));function h(){const t=e.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},c);e.mergeEvaluated(t)}function d(n,r){return()=>{const o=e.subschema({keyword:n},c);t.assign(u,c),e.mergeValidEvaluated(o,u),r?t.assign(r,i._`${n}`):e.setParams({ifClause:n})}}e.pass(u,()=>e.error(!0))}};function a(e,t){const n=e.schema[t];return void 0!==n&&!r.alwaysValidSchema(e,n)}t.default=s},a3a3:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("96ab"),r={data:new i.Name("data"),valCxt:new i.Name("valCxt"),instancePath:new i.Name("instancePath"),parentData:new i.Name("parentData"),parentDataProperty:new i.Name("parentDataProperty"),rootData:new i.Name("rootData"),dynamicAnchors:new i.Name("dynamicAnchors"),vErrors:new i.Name("vErrors"),errors:new i.Name("errors"),this:new i.Name("this"),self:new i.Name("self"),scope:new i.Name("scope"),json:new i.Name("json"),jsonPos:new i.Name("jsonPos"),jsonLen:new i.Name("jsonLen"),jsonPart:new i.Name("jsonPart")};t.default=r},a49d:function(e,t,n){var i;(function(r,o,s){var a,l=256,u=6,c=52,h="random",d=s.pow(l,u),p=s.pow(2,c),f=2*p,m=l-1;function g(e,t,n){var i=[];t=1==t?{entropy:!0}:t||{};var r=b(x(t.entropy?[e,_(o)]:null==e?w():e,3),i),a=new v(i),c=function(){var e=a.g(u),t=d,n=0;while(e<p)e=(e+n)*l,t*=l,n=a.g(1);while(e>=f)e/=2,t/=2,n>>>=1;return(e+n)/t};return c.int32=function(){return 0|a.g(4)},c.quick=function(){return a.g(4)/4294967296},c.double=c,b(_(a.S),o),(t.pass||n||function(e,t,n,i){return i&&(i.S&&y(i,a),e.state=function(){return y(a,{})}),n?(s[h]=e,t):e})(c,r,"global"in t?t.global:this==s,t.state)}function v(e){var t,n=e.length,i=this,r=0,o=i.i=i.j=0,s=i.S=[];n||(e=[n++]);while(r<l)s[r]=r++;for(r=0;r<l;r++)s[r]=s[o=m&o+e[r%n]+(t=s[r])],s[o]=t;(i.g=function(e){var t,n=0,r=i.i,o=i.j,s=i.S;while(e--)t=s[r=m&r+1],n=n*l+s[m&(s[r]=s[o=m&o+t])+(s[o]=t)];return i.i=r,i.j=o,n})(l)}function y(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function x(e,t){var n,i=[],r=typeof e;if(t&&"object"==r)for(n in e)try{i.push(x(e[n],t-1))}catch(o){}return i.length?i:"string"==r?e:e+"\0"}function b(e,t){var n,i=e+"",r=0;while(r<i.length)t[m&r]=m&(n^=19*t[m&r])+i.charCodeAt(r++);return _(t)}function w(){try{var e;return a&&(e=a.randomBytes)?e=e(l):(e=new Uint8Array(l),(r.crypto||r.msCrypto).getRandomValues(e)),_(e)}catch(i){var t=r.navigator,n=t&&t.plugins;return[+new Date,r,n,r.screen,_(o)]}}function _(e){return String.fromCharCode.apply(0,e)}if(b(s.random(),o),e.exports){e.exports=g;try{a=n(1)}catch(A){}}else i=function(){return g}.call(t,n,t,e),void 0===i||(e.exports=i)})("undefined"!==typeof self?self:this,[],Math)},a49e:function(e,t,n){(function(e){var i;(function(e,r,o){function s(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var i=0;i<n.length+64;i++)t.x^=0|n.charCodeAt(i),i==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function a(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function l(e,t){var n=new s(e),i=t&&t.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var e=n.next()>>>11,t=(n.next()>>>0)/4294967296,i=(e+t)/(1<<21)}while(0===i);return i},r.int32=n.next,r.quick=r,i&&("object"==typeof i&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=l:n("07d6")&&n("3c35")?(i=function(){return l}.call(t,n,t,r),void 0===i||(r.exports=i)):this.xorwow=l})(0,e,n("07d6"))}).call(this,n("62e4")(e))},a797:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("96ab"),r=n("417a"),o={message:({params:{min:e,max:t}})=>void 0===t?i.str`must contain at least ${e} valid item(s)`:i.str`must contain at least ${e} and no more than ${t} valid item(s)`,params:({params:{min:e,max:t}})=>void 0===t?i._`{minContains: ${e}}`:i._`{minContains: ${e}, maxContains: ${t}}`},s={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:o,code(e){const{gen:t,schema:n,parentSchema:o,data:s,it:a}=e;let l,u;const{minContains:c,maxContains:h}=o;a.opts.next?(l=void 0===c?1:c,u=h):l=1;const d=t.const("len",i._`${s}.length`);if(e.setParams({min:l,max:u}),void 0===u&&0===l)return void r.checkStrictMode(a,'"minContains" == 0 without "maxContains": "contains" keyword ignored');if(void 0!==u&&l>u)return r.checkStrictMode(a,'"minContains" > "maxContains" is always invalid'),void e.fail();if(r.alwaysValidSchema(a,n)){let t=i._`${d} >= ${l}`;return void 0!==u&&(t=i._`${t} && ${d} <= ${u}`),void e.pass(t)}a.items=!0;const p=t.name("valid");if(void 0===u&&1===l)f(p,()=>t.if(p,()=>t.break()));else{t.let(p,!1);const e=t.name("_valid"),n=t.let("count",0);f(e,()=>t.if(e,()=>m(n)))}function f(n,i){t.forRange("i",0,d,t=>{e.subschema({keyword:"contains",dataProp:t,dataPropType:r.Type.Num,compositeRule:!0},n),i()})}function m(e){t.code(i._`${e}++`),void 0===u?t.if(i._`${e} >= ${l}`,()=>t.assign(p,!0).break()):(t.if(i._`${e} > ${u}`,()=>t.assign(p,!1).break()),1===l?t.assign(p,!0):t.if(i._`${e} >= ${l}`,()=>t.assign(p,!0)))}e.result(p,()=>e.reset())}};t.default=s},a816:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRules=t.isJSONType=void 0;const i=["string","number","integer","boolean","null","object","array"],r=new Set(i);function o(e){return"string"==typeof e&&r.has(e)}function s(){const e={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...e,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},e.number,e.string,e.array,e.object],post:{rules:[]},all:{},keywords:{}}}t.isJSONType=o,t.getRules=s},a975:function(e,t,n){"use strict";var i=n("ebb5"),r=n("b727").every,o=i.aTypedArray,s=i.exportTypedArrayMethod;s("every",(function(e){return r(o(this),e,arguments.length>1?arguments[1]:void 0)}))},a981:function(e,t){e.exports="undefined"!==typeof ArrayBuffer&&"undefined"!==typeof DataView},a98d:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSchemaRefs=t.resolveUrl=t.normalizeId=t._getFullPath=t.getFullPath=t.inlineRef=void 0;const i=n("417a"),r=n("694b"),o=n("ad92"),s=n("4e14"),a=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function l(e,t=!0){return"boolean"==typeof e||(!0===t?!c(e):!!t&&h(e)<=t)}t.inlineRef=l;const u=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function c(e){for(const t in e){if(u.has(t))return!0;const n=e[t];if(Array.isArray(n)&&n.some(c))return!0;if("object"==typeof n&&c(n))return!0}return!1}function h(e){let t=0;for(const n in e){if("$ref"===n)return 1/0;if(t++,!a.has(n)&&("object"==typeof e[n]&&i.eachItem(e[n],e=>t+=h(e)),t===1/0))return 1/0}return t}function d(e="",t){!1!==t&&(e=m(e));const n=s.parse(e);return p(n)}function p(e){return s.serialize(e).split("#")[0]+"#"}t.getFullPath=d,t._getFullPath=p;const f=/#\/?$/;function m(e){return e?e.replace(f,""):""}function g(e,t){return t=m(t),s.resolve(e,t)}t.normalizeId=m,t.resolveUrl=g;const v=/^[a-z_][-a-z0-9._]*$/i;function y(e){if("boolean"==typeof e)return{};const{schemaId:t}=this.opts,n=m(e[t]),i={"":n},a=d(n,!1),l={},u=new Set;return o(e,{allKeys:!0},(e,n,r,o)=>{if(void 0===o)return;const d=a+n;let p=i[o];function f(t){if(t=m(p?s.resolve(p,t):t),u.has(t))throw h(t);u.add(t);let n=this.refs[t];return"string"==typeof n&&(n=this.refs[n]),"object"==typeof n?c(e,n.schema,t):t!==m(d)&&("#"===t[0]?(c(e,l[t],t),l[t]=e):this.refs[t]=d),t}function g(e){if("string"==typeof e){if(!v.test(e))throw new Error(`invalid anchor "${e}"`);f.call(this,"#"+e)}}"string"==typeof e[t]&&(p=f.call(this,e[t])),g.call(this,e.$anchor),g.call(this,e.$dynamicAnchor),i[n]=p}),l;function c(e,t,n){if(void 0!==t&&!r(e,t))throw h(n)}function h(e){return new Error(`reference "${e}" resolves to more than one schema`)}}t.getSchemaRefs=y},ab2c:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.regexpCode=t.getProperty=t.safeStringify=t.stringify=t.strConcat=t.addCodeArg=t.str=t._=t.nil=t._Code=t.Name=t.IDENTIFIER=t._CodeOrName=void 0;class i{}t._CodeOrName=i,t.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class r extends i{constructor(e){if(super(),!t.IDENTIFIER.test(e))throw new Error("CodeGen: name must be a valid identifier");this.str=e}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}t.Name=r;class o extends i{constructor(e){super(),this._items="string"===typeof e?[e]:e}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const e=this._items[0];return""===e||'""'===e}get str(){var e;return null!==(e=this._str)&&void 0!==e?e:this._str=this._items.reduce((e,t)=>`${e}${t}`,"")}get names(){var e;return null!==(e=this._names)&&void 0!==e?e:this._names=this._items.reduce((e,t)=>(t instanceof r&&(e[t.str]=(e[t.str]||0)+1),e),{})}}function s(e,...t){const n=[e[0]];let i=0;while(i<t.length)u(n,t[i]),n.push(e[++i]);return new o(n)}t._Code=o,t.nil=new o(""),t._=s;const a=new o("+");function l(e,...t){const n=[m(e[0])];let i=0;while(i<t.length)n.push(a),u(n,t[i]),n.push(a,m(e[++i]));return c(n),new o(n)}function u(e,t){t instanceof o?e.push(...t._items):t instanceof r?e.push(t):e.push(p(t))}function c(e){let t=1;while(t<e.length-1){if(e[t]===a){const n=h(e[t-1],e[t+1]);if(void 0!==n){e.splice(t-1,3,n);continue}e[t++]="+"}t++}}function h(e,t){if('""'===t)return e;if('""'===e)return t;if("string"==typeof e){if(t instanceof r||'"'!==e[e.length-1])return;return"string"!=typeof t?`${e.slice(0,-1)}${t}"`:'"'===t[0]?e.slice(0,-1)+t.slice(1):void 0}return"string"!=typeof t||'"'!==t[0]||e instanceof r?void 0:`"${e}${t.slice(1)}`}function d(e,t){return t.emptyStr()?e:e.emptyStr()?t:l`${e}${t}`}function p(e){return"number"==typeof e||"boolean"==typeof e||null===e?e:m(Array.isArray(e)?e.join(","):e)}function f(e){return new o(m(e))}function m(e){return JSON.stringify(e).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}function g(e){return"string"==typeof e&&t.IDENTIFIER.test(e)?new o("."+e):s`[${e}]`}function v(e){return new o(e.toString())}t.str=l,t.addCodeArg=u,t.strConcat=d,t.stringify=f,t.safeStringify=m,t.getProperty=g,t.regexpCode=v},ac74:function(e,t,n){"use strict";function i({schema:e,self:t},n){const i=t.RULES.types[n];return i&&!0!==i&&r(e,i)}function r(e,t){return t.rules.some(t=>o(e,t))}function o(e,t){var n;return void 0!==e[t.keyword]||(null===(n=t.definition.implements)||void 0===n?void 0:n.some(t=>void 0!==e[t]))}Object.defineProperty(t,"__esModule",{value:!0}),t.shouldUseRule=t.shouldUseGroup=t.schemaHasRulesForType=void 0,t.schemaHasRulesForType=i,t.shouldUseGroup=r,t.shouldUseRule=o},ace4:function(e,t,n){"use strict";var i=n("23e7"),r=n("d039"),o=n("621a"),s=n("825a"),a=n("23cb"),l=n("50c4"),u=n("4840"),c=o.ArrayBuffer,h=o.DataView,d=c.prototype.slice,p=r((function(){return!new c(2).slice(1,void 0).byteLength}));i({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:p},{slice:function(e,t){if(void 0!==d&&void 0===t)return d.call(s(this),e);var n=s(this).byteLength,i=a(e,n),r=a(void 0===t?n:t,n),o=new(u(this,c))(l(r-i)),p=new h(this),f=new h(o),m=0;while(i<r)f.setUint8(m++,p.getUint8(i++));return o}})},ad92:function(e,t,n){"use strict";var i=e.exports=function(e,t,n){"function"==typeof t&&(n=t,t={}),n=t.cb||n;var i="function"==typeof n?n:n.pre||function(){},o=n.post||function(){};r(t,i,o,e,"",e)};function r(e,t,n,s,a,l,u,c,h,d){if(s&&"object"==typeof s&&!Array.isArray(s)){for(var p in t(s,a,l,u,c,h,d),s){var f=s[p];if(Array.isArray(f)){if(p in i.arrayKeywords)for(var m=0;m<f.length;m++)r(e,t,n,f[m],a+"/"+p+"/"+m,l,a,p,s,m)}else if(p in i.propsKeywords){if(f&&"object"==typeof f)for(var g in f)r(e,t,n,f[g],a+"/"+p+"/"+o(g),l,a,p,s,g)}else(p in i.keywords||e.allKeys&&!(p in i.skipKeywords))&&r(e,t,n,f,a+"/"+p,l,a,p,s)}n(s,a,l,u,c,h,d)}}function o(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}i.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0},i.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},i.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},i.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0}},b383:function(e,t,n){"use strict";t.decode=t.parse=n("91dd"),t.encode=t.stringify=n("e099")},b39a:function(e,t,n){"use strict";var i=n("da84"),r=n("ebb5"),o=n("d039"),s=i.Int8Array,a=r.aTypedArray,l=r.exportTypedArrayMethod,u=[].toLocaleString,c=[].slice,h=!!s&&o((function(){u.call(new s(1))})),d=o((function(){return[1,2].toLocaleString()!=new s([1,2]).toLocaleString()}))||!o((function(){s.prototype.toLocaleString.call([1,2])}));l("toLocaleString",(function(){return u.apply(h?c.call(a(this)):a(this),arguments)}),d)},b5e2:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("6292"),r=n("96ab"),o=n("417a"),s=n("ea01"),a={message:({params:{i:e,j:t}})=>r.str`must NOT have duplicate items (items ## ${t} and ${e} are identical)`,params:({params:{i:e,j:t}})=>r._`{i: ${e}, j: ${t}}`},l={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:a,code(e){const{gen:t,data:n,$data:a,schema:l,parentSchema:u,schemaCode:c,it:h}=e;if(!a&&!l)return;const d=t.let("valid"),p=u.items?i.getSchemaTypes(u.items):[];function f(){const i=t.let("i",r._`${n}.length`),o=t.let("j");e.setParams({i:i,j:o}),t.assign(d,!0),t.if(r._`${i} > 1`,()=>(m()?g:v)(i,o))}function m(){return p.length>0&&!p.some(e=>"object"===e||"array"===e)}function g(o,s){const a=t.name("item"),l=i.checkDataTypes(p,a,h.opts.strictNumbers,i.DataType.Wrong),u=t.const("indices",r._`{}`);t.for(r._`;${o}--;`,()=>{t.let(a,r._`${n}[${o}]`),t.if(l,r._`continue`),p.length>1&&t.if(r._`typeof ${a} == "string"`,r._`${a} += "_"`),t.if(r._`typeof ${u}[${a}] == "number"`,()=>{t.assign(s,r._`${u}[${a}]`),e.error(),t.assign(d,!1).break()}).code(r._`${u}[${a}] = ${o}`)})}function v(i,a){const l=o.useFunc(t,s.default),u=t.name("outer");t.label(u).for(r._`;${i}--;`,()=>t.for(r._`${a} = ${i}; ${a}--;`,()=>t.if(r._`${l}(${n}[${i}], ${n}[${a}])`,()=>{e.error(),t.assign(d,!1).break(u)})))}e.block$data(d,f,r._`${c} === false`),e.ok(d)}};t.default=l},b6b7:function(e,t,n){var i=n("ebb5"),r=n("4840"),o=i.TYPED_ARRAY_CONSTRUCTOR,s=i.aTypedArrayConstructor;e.exports=function(e){return s(r(e,e[o]))}},b838:function(e,t,n){(function(e){var i;(function(e,r,o){function s(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var i=0;i<n.length+64;i++)t.x^=0|n.charCodeAt(i),t.next()}function a(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function l(e,t){var n=new s(e),i=t&&t.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var e=n.next()>>>11,t=(n.next()>>>0)/4294967296,i=(e+t)/(1<<21)}while(0===i);return i},r.int32=n.next,r.quick=r,i&&("object"==typeof i&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=l:n("07d6")&&n("3c35")?(i=function(){return l}.call(t,n,t,r),void 0===i||(r.exports=i)):this.xor128=l})(0,e,n("07d6"))}).call(this,n("62e4")(e))},bc94:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("417a"),r={keyword:"allOf",schemaType:"array",code(e){const{gen:t,schema:n,it:r}=e;if(!Array.isArray(n))throw new Error("ajv implementation error");const o=t.name("valid");n.forEach((t,n)=>{if(i.alwaysValidSchema(r,t))return;const s=e.subschema({keyword:"allOf",schemaProp:n},o);e.ok(o),e.mergeEvaluated(s)})}};t.default=r},bee2:function(e,t,n){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function r(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}n.d(t,"a",(function(){return r}))},c1ac:function(e,t,n){"use strict";var i=n("ebb5"),r=n("b727").filter,o=n("1448"),s=i.aTypedArray,a=i.exportTypedArrayMethod;a("filter",(function(e){var t=r(s(this),e,arguments.length>1?arguments[1]:void 0);return o(this,t)}))},c201:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("96ab"),r=n("417a"),o=n("ea01"),s={message:"must be equal to constant",params:({schemaCode:e})=>i._`{allowedValue: ${e}}`},a={keyword:"const",$data:!0,error:s,code(e){const{gen:t,data:n,$data:s,schemaCode:a,schema:l}=e;s||l&&"object"==typeof l?e.fail$data(i._`!${r.useFunc(t,o.default)}(${n}, ${a})`):e.fail(i._`${l} !== ${n}`)}};t.default=a},c618:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("417a"),r={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(e){const{gen:t,schema:n,it:r}=e;if(i.alwaysValidSchema(r,n))return void e.fail();const o=t.name("valid");e.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},o),e.failResult(o,()=>e.reset(),()=>e.error())},error:{message:"must NOT be valid"}};t.default=r},ca91:function(e,t,n){"use strict";var i=n("ebb5"),r=n("d58f").left,o=i.aTypedArray,s=i.exportTypedArrayMethod;s("reduce",(function(e){return r(o(this),e,arguments.length,arguments.length>1?arguments[1]:void 0)}))},cae0:function(e,t,n){(function(e){var i;(function(e,r,o){function s(e){var t=this;function n(e,t){var n,i=[];if(t===(0|t))i[0]=t;else for(t=""+t,n=0;n<t.length;++n)i[7&n]=i[7&n]<<15^t.charCodeAt(n)+i[n+1&7]<<13;while(i.length<8)i.push(0);for(n=0;n<8&&0===i[n];++n);for(8==n?i[7]=-1:i[n],e.x=i,e.i=0,n=256;n>0;--n)e.next()}t.next=function(){var e,n,i=t.x,r=t.i;return e=i[r],e^=e>>>7,n=e^e<<24,e=i[r+1&7],n^=e^e>>>10,e=i[r+3&7],n^=e^e>>>3,e=i[r+4&7],n^=e^e<<7,e=i[r+7&7],e^=e<<13,n^=e^e<<9,i[r]=n,t.i=r+1&7,n},n(t,e)}function a(e,t){return t.x=e.x.slice(),t.i=e.i,t}function l(e,t){null==e&&(e=+new Date);var n=new s(e),i=t&&t.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var e=n.next()>>>11,t=(n.next()>>>0)/4294967296,i=(e+t)/(1<<21)}while(0===i);return i},r.int32=n.next,r.quick=r,i&&(i.x&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=l:n("07d6")&&n("3c35")?(i=function(){return l}.call(t,n,t,r),void 0===i||(r.exports=i)):this.xorshift7=l})(0,e,n("07d6"))}).call(this,n("62e4")(e))},cb27:function(module,exports,__webpack_require__){"use strict";(function(global){var numeric=exports;"undefined"!==typeof global&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(e,t){var n,i,r,o;"undefined"===typeof t&&(t=15),r=.5,n=new Date;while(1){for(r*=2,o=r;o>3;o-=4)e(),e(),e(),e();while(o>0)e(),o--;if(i=new Date,i-n>t)break}for(o=r;o>3;o-=4)e(),e(),e(),e();while(o>0)e(),o--;return i=new Date,1e3*(3*r-1)/(i-n)},numeric._myIndexOf=function(e){var t,n=this.length;for(t=0;t<n;++t)if(this[t]===e)return t;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(e){function t(e){if(0===e)return"0";if(isNaN(e))return"NaN";if(e<0)return"-"+t(-e);if(isFinite(e)){var n=Math.floor(Math.log(e)/Math.log(10)),i=e/Math.pow(10,n),r=i.toPrecision(numeric.precision);return 10===parseFloat(r)&&(n++,i=1,r=i.toPrecision(numeric.precision)),parseFloat(r).toString()+"e"+n.toString()}return"Infinity"}var n=[];function i(e){var r;if("undefined"===typeof e)return n.push(Array(numeric.precision+8).join(" ")),!1;if("string"===typeof e)return n.push('"'+e+'"'),!1;if("boolean"===typeof e)return n.push(e.toString()),!1;if("number"===typeof e){var o=t(e),s=e.toPrecision(numeric.precision),a=parseFloat(e.toString()).toString(),l=[o,s,a,parseFloat(s).toString(),parseFloat(a).toString()];for(r=1;r<l.length;r++)l[r].length<o.length&&(o=l[r]);return n.push(Array(numeric.precision+8-o.length).join(" ")+o),!1}if(null===e)return n.push("null"),!1;if("function"===typeof e){n.push(e.toString());var u=!1;for(r in e)e.hasOwnProperty(r)&&(u?n.push(",\n"):n.push("\n{"),u=!0,n.push(r),n.push(": \n"),i(e[r]));return u&&n.push("}\n"),!0}if(e instanceof Array){if(e.length>numeric.largeArray)return n.push("...Large Array..."),!0;u=!1;for(n.push("["),r=0;r<e.length;r++)r>0&&(n.push(","),u&&n.push("\n ")),u=i(e[r]);return n.push("]"),!0}n.push("{");u=!1;for(r in e)e.hasOwnProperty(r)&&(u&&n.push(",\n"),u=!0,n.push(r),n.push(": \n"),i(e[r]));return n.push("}"),!0}return i(e),n.join("")},numeric.parseDate=function(e){function t(e){if("string"===typeof e)return Date.parse(e.replace(/-/g,"/"));if(!(e instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var n,i=[];for(n=0;n<e.length;n++)i[n]=t(e[n]);return i}return t(e)},numeric.parseFloat=function(e){function t(e){if("string"===typeof e)return parseFloat(e);if(!(e instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var n,i=[];for(n=0;n<e.length;n++)i[n]=t(e[n]);return i}return t(e)},numeric.parseCSV=function(e){var t,n,i=e.split("\n"),r=[],o=/(([^'",]*)|('[^']*')|("[^"]*")),/g,s=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,a=function(e){return e.substr(0,e.length-1)},l=0;for(n=0;n<i.length;n++){var u,c=(i[n]+",").match(o);if(c.length>0){for(r[l]=[],t=0;t<c.length;t++)u=a(c[t]),s.test(u)?r[l][t]=parseFloat(u):r[l][t]=u;l++}}return r},numeric.toCSV=function(e){var t,n,i,r,o,s=numeric.dim(e);for(i=s[0],s[1],o=[],t=0;t<i;t++){for(r=[],n=0;n<i;n++)r[n]=e[t][n].toString();o[t]=r.join(", ")}return o.join("\n")+"\n"},numeric.getURL=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(),t},numeric.imageURL=function(e){function t(e){var t,n,i,r,o,s,a,l,u=e.length,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h="";for(t=0;t<u;t+=3)n=e[t],i=e[t+1],r=e[t+2],o=n>>2,s=((3&n)<<4)+(i>>4),a=((15&i)<<2)+(r>>6),l=63&r,t+1>=u?a=l=64:t+2>=u&&(l=64),h+=c.charAt(o)+c.charAt(s)+c.charAt(a)+c.charAt(l);return h}function n(e,t,n){"undefined"===typeof t&&(t=0),"undefined"===typeof n&&(n=e.length);var i,r=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],o=-1,s=0;e.length;for(i=t;i<n;i++)s=255&(o^e[i]),o=o>>>8^r[s];return-1^o}var i,r,o,s,a,l,u,c,h,d,p=e[0].length,f=e[0][0].length,m=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,f>>24&255,f>>16&255,f>>8&255,255&f,p>>24&255,p>>16&255,p>>8&255,255&p,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(d=n(m,12,29),m[29]=d>>24&255,m[30]=d>>16&255,m[31]=d>>8&255,m[32]=255&d,i=1,r=0,u=0;u<p;u++){for(u<p-1?m.push(0):m.push(1),a=3*f+1+(0===u)&255,l=3*f+1+(0===u)>>8&255,m.push(a),m.push(l),m.push(255&~a),m.push(255&~l),0===u&&m.push(0),c=0;c<f;c++)for(o=0;o<3;o++)a=e[o][u][c],a=a>255?255:a<0?0:Math.round(a),i=(i+a)%65521,r=(r+i)%65521,m.push(a);m.push(0)}return h=(r<<16)+i,m.push(h>>24&255),m.push(h>>16&255),m.push(h>>8&255),m.push(255&h),s=m.length-41,m[33]=s>>24&255,m[34]=s>>16&255,m[35]=s>>8&255,m[36]=255&s,d=n(m,37),m.push(d>>24&255),m.push(d>>16&255),m.push(d>>8&255),m.push(255&d),m.push(0),m.push(0),m.push(0),m.push(0),m.push(73),m.push(69),m.push(78),m.push(68),m.push(174),m.push(66),m.push(96),m.push(130),"data:image/png;base64,"+t(m)},numeric._dim=function(e){var t=[];while("object"===typeof e)t.push(e.length),e=e[0];return t},numeric.dim=function(e){var t,n;return"object"===typeof e?(t=e[0],"object"===typeof t?(n=t[0],"object"===typeof n?numeric._dim(e):[e.length,t.length]):[e.length]):[]},numeric.mapreduce=function(e,t){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+t+';\nif(typeof x === "number") { var xi = x; '+e+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+e+";\n    xi = x[i-1];\n    "+e+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+e+"\n}\nreturn accum;")},numeric.mapreduce2=function(e,t){return Function("x","var n = x.length;\nvar i,xi;\n"+t+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+e+";\n}\nreturn accum;")},numeric.same=function e(t,n){var i,r;if(!(t instanceof Array)||!(n instanceof Array))return!1;if(r=t.length,r!==n.length)return!1;for(i=0;i<r;i++)if(t[i]!==n[i]){if("object"!==typeof t[i])return!1;if(!e(t[i],n[i]))return!1}return!0},numeric.rep=function(e,t,n){"undefined"===typeof n&&(n=0);var i,r=e[n],o=Array(r);if(n===e.length-1){for(i=r-2;i>=0;i-=2)o[i+1]=t,o[i]=t;return-1===i&&(o[0]=t),o}for(i=r-1;i>=0;i--)o[i]=numeric.rep(e,t,n+1);return o},numeric.dotMMsmall=function(e,t){var n,i,r,o,s,a,l,u,c,h,d;for(o=e.length,s=t.length,a=t[0].length,l=Array(o),n=o-1;n>=0;n--){for(u=Array(a),c=e[n],r=a-1;r>=0;r--){for(h=c[s-1]*t[s-1][r],i=s-2;i>=1;i-=2)d=i-1,h+=c[i]*t[i][r]+c[d]*t[d][r];0===i&&(h+=c[0]*t[0][r]),u[r]=h}l[n]=u}return l},numeric._getCol=function(e,t,n){var i,r=e.length;for(i=r-1;i>0;--i)n[i]=e[i][t],--i,n[i]=e[i][t];0===i&&(n[0]=e[0][t])},numeric.dotMMbig=function(e,t){var n,i,r,o=numeric._getCol,s=t.length,a=Array(s),l=e.length,u=t[0].length,c=new Array(l),h=numeric.dotVV;for(--s,--l,i=l;-1!==i;--i)c[i]=Array(u);for(--u,i=u;-1!==i;--i)for(o(t,i,a),r=l;-1!==r;--r)0,n=e[r],c[r][i]=h(n,a);return c},numeric.dotMV=function(e,t){var n,i=e.length,r=(t.length,Array(i)),o=numeric.dotVV;for(n=i-1;n>=0;n--)r[n]=o(e[n],t);return r},numeric.dotVM=function(e,t){var n,i,r,o,s,a,l;for(r=e.length,o=t[0].length,s=Array(o),i=o-1;i>=0;i--){for(a=e[r-1]*t[r-1][i],n=r-2;n>=1;n-=2)l=n-1,a+=e[n]*t[n][i]+e[l]*t[l][i];0===n&&(a+=e[0]*t[0][i]),s[i]=a}return s},numeric.dotVV=function(e,t){var n,i,r=e.length,o=e[r-1]*t[r-1];for(n=r-2;n>=1;n-=2)i=n-1,o+=e[n]*t[n]+e[i]*t[i];return 0===n&&(o+=e[0]*t[0]),o},numeric.dot=function(e,t){var n=numeric.dim;switch(1e3*n(e).length+n(t).length){case 2002:return t.length<10?numeric.dotMMsmall(e,t):numeric.dotMMbig(e,t);case 2001:return numeric.dotMV(e,t);case 1002:return numeric.dotVM(e,t);case 1001:return numeric.dotVV(e,t);case 1e3:return numeric.mulVS(e,t);case 1:return numeric.mulSV(e,t);case 0:return e*t;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(e){var t,n,i,r,o=e.length,s=Array(o);for(t=o-1;t>=0;t--){for(r=Array(o),n=t+2,i=o-1;i>=n;i-=2)r[i]=0,r[i-1]=0;for(i>t&&(r[i]=0),r[t]=e[t],i=t-1;i>=1;i-=2)r[i]=0,r[i-1]=0;0===i&&(r[0]=0),s[t]=r}return s},numeric.getDiag=function(e){var t,n=Math.min(e.length,e[0].length),i=Array(n);for(t=n-1;t>=1;--t)i[t]=e[t][t],--t,i[t]=e[t][t];return 0===t&&(i[0]=e[0][0]),i},numeric.identity=function(e){return numeric.diag(numeric.rep([e],1))},numeric.pointwise=function(e,t,n){"undefined"===typeof n&&(n="");var i,r,o=[],s=/\[i\]$/,a="",l=!1;for(i=0;i<e.length;i++)s.test(e[i])?(r=e[i].substring(0,e[i].length-3),a=r):r=e[i],"ret"===r&&(l=!0),o.push(r);return o[e.length]="_s",o[e.length+1]="_k",o[e.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+a+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(l?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+e.join(",")+",_s,_k+1);\n    return ret;\n}\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n    "+t+"\n}\nreturn ret;",Function.apply(null,o)},numeric.pointwise2=function(e,t,n){"undefined"===typeof n&&(n="");var i,r,o=[],s=/\[i\]$/,a="",l=!1;for(i=0;i<e.length;i++)s.test(e[i])?(r=e[i].substring(0,e[i].length-3),a=r):r=e[i],"ret"===r&&(l=!0),o.push(r);return o[e.length]="var _n = "+a+".length;\nvar i"+(l?"":", ret = Array(_n)")+";\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n"+t+"\n}\nreturn ret;",Function.apply(null,o)},numeric._biforeach=function e(t,n,i,r,o){if(r!==i.length-1){var s,a=i[r];for(s=a-1;s>=0;s--)e("object"===typeof t?t[s]:t,"object"===typeof n?n[s]:n,i,r+1,o)}else o(t,n)},numeric._biforeach2=function e(t,n,i,r,o){if(r===i.length-1)return o(t,n);var s,a=i[r],l=Array(a);for(s=a-1;s>=0;--s)l[s]=e("object"===typeof t?t[s]:t,"object"===typeof n?n[s]:n,i,r+1,o);return l},numeric._foreach=function e(t,n,i,r){if(i!==n.length-1){var o,s=n[i];for(o=s-1;o>=0;o--)e(t[o],n,i+1,r)}else r(t)},numeric._foreach2=function e(t,n,i,r){if(i===n.length-1)return r(t);var o,s=n[i],a=Array(s);for(o=s-1;o>=0;o--)a[o]=e(t[o],n,i+1,r);return a},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var e,t;for(e=0;e<numeric.mathfuns2.length;++e)t=numeric.mathfuns2[e],numeric.ops2[t]=t;for(e in numeric.ops2)if(numeric.ops2.hasOwnProperty(e)){t=numeric.ops2[e];var n,i,r="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,e)?(r="var "+t+" = Math."+t+";\n",n=function(e,n,i){return e+" = "+t+"("+n+","+i+")"},i=function(e,n){return e+" = "+t+"("+e+","+n+")"}):(n=function(e,n,i){return e+" = "+n+" "+t+" "+i},i=numeric.opseq.hasOwnProperty(e+"eq")?function(e,n){return e+" "+t+"= "+n}:function(e,n){return e+" = "+e+" "+t+" "+n}),numeric[e+"VV"]=numeric.pointwise2(["x[i]","y[i]"],n("ret[i]","x[i]","y[i]"),r),numeric[e+"SV"]=numeric.pointwise2(["x","y[i]"],n("ret[i]","x","y[i]"),r),numeric[e+"VS"]=numeric.pointwise2(["x[i]","y"],n("ret[i]","x[i]","y"),r),numeric[e]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+e+"VV, VS = numeric."+e+"VS, SV = numeric."+e+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+i("x","y")+"\n}\nreturn x;\n"),numeric[t]=numeric[e],numeric[e+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],i("ret[i]","x[i]"),r),numeric[e+"eqS"]=numeric.pointwise2(["ret[i]","x"],i("ret[i]","x"),r),numeric[e+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+e+"eqV, S = numeric."+e+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(e=0;e<numeric.mathfuns2.length;++e)t=numeric.mathfuns2[e],delete numeric.ops2[t];for(e=0;e<numeric.mathfuns.length;++e)t=numeric.mathfuns[e],numeric.ops1[t]=t;for(e in numeric.ops1)numeric.ops1.hasOwnProperty(e)&&(r="",t=numeric.ops1[e],-1!==numeric.myIndexOf.call(numeric.mathfuns,e)&&Math.hasOwnProperty(t)&&(r="var "+t+" = Math."+t+";\n"),numeric[e+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+t+"(ret[i]);",r),numeric[e+"eq"]=Function("x",'if(typeof x !== "object") return '+t+"x\nvar i;\nvar V = numeric."+e+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[e+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+t+"(x[i]);",r),numeric[e]=Function("x",'if(typeof x !== "object") return '+t+"(x)\nvar i;\nvar V = numeric."+e+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(e=0;e<numeric.mathfuns.length;++e)t=numeric.mathfuns[e],delete numeric.ops1[t];for(e in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(e)&&(t=numeric.mapreducers[e],numeric[e+"V"]=numeric.mapreduce2(t[0],t[1]),numeric[e]=Function("x","s","k",t[1]+'if(typeof x !== "object") {    xi = x;\n'+t[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+e+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+t[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(e,t){return"object"===typeof e?"object"===typeof t?numeric.truncVV(e,t):numeric.truncVS(e,t):"object"===typeof t?numeric.truncSV(e,t):Math.round(e/t)*t},numeric.inv=function(e){var t,n,i,r,o,s,a,l=numeric.dim(e),u=Math.abs,c=l[0],h=l[1],d=numeric.clone(e),p=numeric.identity(c);for(s=0;s<h;++s){var f=-1,m=-1;for(o=s;o!==c;++o)a=u(d[o][s]),a>m&&(f=o,m=a);for(n=d[f],d[f]=d[s],d[s]=n,r=p[f],p[f]=p[s],p[s]=r,e=n[s],a=s;a!==h;++a)n[a]/=e;for(a=h-1;-1!==a;--a)r[a]/=e;for(o=c-1;-1!==o;--o)if(o!==s){for(t=d[o],i=p[o],e=t[s],a=s+1;a!==h;++a)t[a]-=n[a]*e;for(a=h-1;a>0;--a)i[a]-=r[a]*e,--a,i[a]-=r[a]*e;0===a&&(i[0]-=r[0]*e)}}return p},numeric.det=function(e){var t=numeric.dim(e);if(2!==t.length||t[0]!==t[1])throw new Error("numeric: det() only works on square matrices");var n,i,r,o,s,a,l,u,c=t[0],h=1,d=numeric.clone(e);for(i=0;i<c-1;i++){for(r=i,n=i+1;n<c;n++)Math.abs(d[n][i])>Math.abs(d[r][i])&&(r=n);for(r!==i&&(l=d[r],d[r]=d[i],d[i]=l,h*=-1),o=d[i],n=i+1;n<c;n++){for(s=d[n],a=s[i]/o[i],r=i+1;r<c-1;r+=2)u=r+1,s[r]-=o[r]*a,s[u]-=o[u]*a;r!==c&&(s[r]-=o[r]*a)}if(0===o[i])return 0;h*=o[i]}return h*d[i][i]},numeric.transpose=function(e){var t,n,i,r,o,s=e.length,a=e[0].length,l=Array(a);for(n=0;n<a;n++)l[n]=Array(s);for(t=s-1;t>=1;t-=2){for(r=e[t],i=e[t-1],n=a-1;n>=1;--n)o=l[n],o[t]=r[n],o[t-1]=i[n],--n,o=l[n],o[t]=r[n],o[t-1]=i[n];0===n&&(o=l[0],o[t]=r[0],o[t-1]=i[0])}if(0===t){for(i=e[0],n=a-1;n>=1;--n)l[n][0]=i[n],--n,l[n][0]=i[n];0===n&&(l[0][0]=i[0])}return l},numeric.negtranspose=function(e){var t,n,i,r,o,s=e.length,a=e[0].length,l=Array(a);for(n=0;n<a;n++)l[n]=Array(s);for(t=s-1;t>=1;t-=2){for(r=e[t],i=e[t-1],n=a-1;n>=1;--n)o=l[n],o[t]=-r[n],o[t-1]=-i[n],--n,o=l[n],o[t]=-r[n],o[t-1]=-i[n];0===n&&(o=l[0],o[t]=-r[0],o[t-1]=-i[0])}if(0===t){for(i=e[0],n=a-1;n>=1;--n)l[n][0]=-i[n],--n,l[n][0]=-i[n];0===n&&(l[0][0]=-i[0])}return l},numeric._random=function e(t,n){var i,r,o=t[n],s=Array(o);if(n===t.length-1){for(r=Math.random,i=o-1;i>=1;i-=2)s[i]=r(),s[i-1]=r();return 0===i&&(s[0]=r()),s}for(i=o-1;i>=0;i--)s[i]=e(t,n+1);return s},numeric.random=function(e){return numeric._random(e,0)},numeric.norm2=function(e){return Math.sqrt(numeric.norm2Squared(e))},numeric.linspace=function(e,t,n){if("undefined"===typeof n&&(n=Math.max(Math.round(t-e)+1,1)),n<2)return 1===n?[e]:[];var i,r=Array(n);for(n--,i=n;i>=0;i--)r[i]=(i*t+(n-i)*e)/n;return r},numeric.getBlock=function(e,t,n){var i=numeric.dim(e);function r(e,o){var s,a=t[o],l=n[o]-a,u=Array(l);if(o===i.length-1){for(s=l;s>=0;s--)u[s]=e[s+a];return u}for(s=l;s>=0;s--)u[s]=r(e[s+a],o+1);return u}return r(e,0)},numeric.setBlock=function(e,t,n,i){var r=numeric.dim(e);function o(e,i,s){var a,l=t[s],u=n[s]-l;if(s===r.length-1)for(a=u;a>=0;a--)e[a+l]=i[a];for(a=u;a>=0;a--)o(e[a+l],i[a],s+1)}return o(e,i,0),e},numeric.getRange=function(e,t,n){var i,r,o,s,a=t.length,l=n.length,u=Array(a);for(i=a-1;-1!==i;--i)for(u[i]=Array(l),o=u[i],s=e[t[i]],r=l-1;-1!==r;--r)o[r]=s[n[r]];return u},numeric.blockMatrix=function(e){var t=numeric.dim(e);if(t.length<4)return numeric.blockMatrix([e]);var n,i,r,o,s,a=t[0],l=t[1];for(n=0,i=0,r=0;r<a;++r)n+=e[r][0].length;for(o=0;o<l;++o)i+=e[0][o][0].length;var u=Array(n);for(r=0;r<n;++r)u[r]=Array(i);var c,h,d,p,f,m=0;for(r=0;r<a;++r){for(c=i,o=l-1;-1!==o;--o)for(s=e[r][o],c-=s[0].length,d=s.length-1;-1!==d;--d)for(f=s[d],h=u[m+d],p=f.length-1;-1!==p;--p)h[c+p]=f[p];m+=e[r][0].length}return u},numeric.tensor=function(e,t){if("number"===typeof e||"number"===typeof t)return numeric.mul(e,t);var n=numeric.dim(e),i=numeric.dim(t);if(1!==n.length||1!==i.length)throw new Error("numeric: tensor product is only defined for vectors");var r,o,s,a,l=n[0],u=i[0],c=Array(l);for(o=l-1;o>=0;o--){for(r=Array(u),a=e[o],s=u-1;s>=3;--s)r[s]=a*t[s],--s,r[s]=a*t[s],--s,r[s]=a*t[s],--s,r[s]=a*t[s];while(s>=0)r[s]=a*t[s],--s;c[o]=r}return c},numeric.T=function(e,t){this.x=e,this.y=t},numeric.t=function(e,t){return new numeric.T(e,t)},numeric.Tbinop=function(e,t,n,i,r){var o;numeric.indexOf;if("string"!==typeof r)for(o in r="",numeric)numeric.hasOwnProperty(o)&&(e.indexOf(o)>=0||t.indexOf(o)>=0||n.indexOf(o)>=0||i.indexOf(o)>=0)&&o.length>1&&(r+="var "+o+" = numeric."+o+";\n");return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+r+"\nif(x.y) {  if(y.y) {    return new numeric.T("+i+");\n  }\n  return new numeric.T("+n+");\n}\nif(y.y) {\n  return new numeric.T("+t+");\n}\nreturn new numeric.T("+e+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var e=numeric.mul,t=numeric.div;if(this.y){var n=numeric.add(e(this.x,this.x),e(this.y,this.y));return new numeric.T(t(this.x,n),t(numeric.neg(this.y),n))}return new T(t(1,this.x))},numeric.T.prototype.div=function(e){if(e instanceof numeric.T||(e=new numeric.T(e)),e.y)return this.mul(e.reciprocal());var t=numeric.div;return this.y?new numeric.T(t(this.x,e.x),t(this.y,e.x)):new numeric.T(t(this.x,e.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var e=numeric.transpose,t=this.x,n=this.y;return n?new numeric.T(e(t),e(n)):new numeric.T(e(t))},numeric.T.prototype.transjugate=function(){var e=numeric.transpose,t=this.x,n=this.y;return n?new numeric.T(e(t),numeric.negtranspose(n)):new numeric.T(e(t))},numeric.Tunop=function(e,t,n){return"string"!==typeof n&&(n=""),Function("var x = this;\n"+n+"\nif(x.y) {  "+t+";\n}\n"+e+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var e=this;if("undefined"===typeof e.y)return new numeric.T(numeric.inv(e.x));var t,n,i,r,o,s,a,l,u,c,h,d,p,f,m,g,v,y,x=e.x.length,b=numeric.identity(x),w=numeric.rep([x,x],0),_=numeric.clone(e.x),A=numeric.clone(e.y);for(u=0;u<x;u++){for(f=_[u][u],m=A[u][u],d=f*f+m*m,h=u,c=u+1;c<x;c++)f=_[c][u],m=A[c][u],p=f*f+m*m,p>d&&(h=c,d=p);for(h!==u&&(y=_[u],_[u]=_[h],_[h]=y,y=A[u],A[u]=A[h],A[h]=y,y=b[u],b[u]=b[h],b[h]=y,y=w[u],w[u]=w[h],w[h]=y),t=_[u],n=A[u],o=b[u],s=w[u],f=t[u],m=n[u],c=u+1;c<x;c++)g=t[c],v=n[c],t[c]=(g*f+v*m)/d,n[c]=(v*f-g*m)/d;for(c=0;c<x;c++)g=o[c],v=s[c],o[c]=(g*f+v*m)/d,s[c]=(v*f-g*m)/d;for(c=u+1;c<x;c++){for(i=_[c],r=A[c],a=b[c],l=w[c],f=i[u],m=r[u],h=u+1;h<x;h++)g=t[h],v=n[h],i[h]-=g*f-v*m,r[h]-=v*f+g*m;for(h=0;h<x;h++)g=o[h],v=s[h],a[h]-=g*f-v*m,l[h]-=v*f+g*m}}for(u=x-1;u>0;u--)for(o=b[u],s=w[u],c=u-1;c>=0;c--)for(a=b[c],l=w[c],f=_[c][u],m=A[c][u],h=x-1;h>=0;h--)g=o[h],v=s[h],a[h]-=f*g-m*v,l[h]-=f*v+m*g;return new numeric.T(b,w)},numeric.T.prototype.get=function(e){var t,n=this.x,i=this.y,r=0,o=e.length;if(i){while(r<o)t=e[r],n=n[t],i=i[t],r++;return new numeric.T(n,i)}while(r<o)t=e[r],n=n[t],r++;return new numeric.T(n)},numeric.T.prototype.set=function(e,t){var n,i=this.x,r=this.y,o=0,s=e.length,a=t.x,l=t.y;if(0===s)return l?this.y=l:r&&(this.y=void 0),this.x=i,this;if(l){r||(r=numeric.rep(numeric.dim(i),0),this.y=r);while(o<s-1)n=e[o],i=i[n],r=r[n],o++;return n=e[o],i[n]=a,r[n]=l,this}if(r){while(o<s-1)n=e[o],i=i[n],r=r[n],o++;return n=e[o],i[n]=a,r[n]=a instanceof Array?numeric.rep(numeric.dim(a),0):0,this}while(o<s-1)n=e[o],i=i[n],o++;return n=e[o],i[n]=a,this},numeric.T.prototype.getRows=function(e,t){var n,i,r=t-e+1,o=Array(r),s=this.x,a=this.y;for(n=e;n<=t;n++)o[n-e]=s[n];if(a){for(i=Array(r),n=e;n<=t;n++)i[n-e]=a[n];return new numeric.T(o,i)}return new numeric.T(o)},numeric.T.prototype.setRows=function(e,t,n){var i,r=this.x,o=this.y,s=n.x,a=n.y;for(i=e;i<=t;i++)r[i]=s[i-e];if(a)for(o||(o=numeric.rep(numeric.dim(r),0),this.y=o),i=e;i<=t;i++)o[i]=a[i-e];else if(o)for(i=e;i<=t;i++)o[i]=numeric.rep([s[i-e].length],0);return this},numeric.T.prototype.getRow=function(e){var t=this.x,n=this.y;return n?new numeric.T(t[e],n[e]):new numeric.T(t[e])},numeric.T.prototype.setRow=function(e,t){var n=this.x,i=this.y,r=t.x,o=t.y;return n[e]=r,o?(i||(i=numeric.rep(numeric.dim(n),0),this.y=i),i[e]=o):i&&(i=numeric.rep([r.length],0)),this},numeric.T.prototype.getBlock=function(e,t){var n=this.x,i=this.y,r=numeric.getBlock;return i?new numeric.T(r(n,e,t),r(i,e,t)):new numeric.T(r(n,e,t))},numeric.T.prototype.setBlock=function(e,t,n){n instanceof numeric.T||(n=new numeric.T(n));var i=this.x,r=this.y,o=numeric.setBlock,s=n.x,a=n.y;if(a)return r||(this.y=numeric.rep(numeric.dim(this),0),r=this.y),o(i,e,t,s),o(r,e,t,a),this;o(i,e,t,s),r&&o(r,e,t,numeric.rep(numeric.dim(s),0))},numeric.T.rep=function(e,t){var n=numeric.T;t instanceof n||(t=new n(t));var i=t.x,r=t.y,o=numeric.rep;return r?new n(o(e,i),o(e,r)):new n(o(e,i))},numeric.T.diag=function(e){e instanceof numeric.T||(e=new numeric.T(e));var t=e.x,n=e.y,i=numeric.diag;return n?new numeric.T(i(t),i(n)):new numeric.T(i(t))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(e){return new numeric.T(numeric.identity(e))},numeric.T.prototype.getDiag=function(){var e=numeric,t=this.x,n=this.y;return n?new e.T(e.getDiag(t),e.getDiag(n)):new e.T(e.getDiag(t))},numeric.house=function(e){var t=numeric.clone(e),n=e[0]>=0?1:-1,i=n*numeric.norm2(e);t[0]+=i;var r=numeric.norm2(t);if(0===r)throw new Error("eig: internal error");return numeric.div(t,r)},numeric.toUpperHessenberg=function(e){var t=numeric.dim(e);if(2!==t.length||t[0]!==t[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var n,i,r,o,s,a,l,u,c,h,d=t[0],p=numeric.clone(e),f=numeric.identity(d);for(i=0;i<d-2;i++){for(o=Array(d-i-1),n=i+1;n<d;n++)o[n-i-1]=p[n][i];if(numeric.norm2(o)>0){for(s=numeric.house(o),a=numeric.getBlock(p,[i+1,i],[d-1,d-1]),l=numeric.tensor(s,numeric.dot(s,a)),n=i+1;n<d;n++)for(u=p[n],c=l[n-i-1],r=i;r<d;r++)u[r]-=2*c[r-i];for(a=numeric.getBlock(p,[0,i+1],[d-1,d-1]),l=numeric.tensor(numeric.dot(a,s),s),n=0;n<d;n++)for(u=p[n],c=l[n],r=i+1;r<d;r++)u[r]-=2*c[r-i-1];for(a=Array(d-i-1),n=i+1;n<d;n++)a[n-i-1]=f[n];for(l=numeric.tensor(s,numeric.dot(s,a)),n=i+1;n<d;n++)for(h=f[n],c=l[n-i-1],r=0;r<d;r++)h[r]-=2*c[r]}}return{H:p,Q:f}},numeric.epsilon=2220446049250313e-31,numeric.QRFrancis=function(e,t){"undefined"===typeof t&&(t=1e4),e=numeric.clone(e);numeric.clone(e);var n,i,r,o,s,a,l,u,c,h,d,p,f,m,g,v,y,x,b=numeric.dim(e),w=b[0],_=numeric.identity(w);if(w<3)return{Q:_,B:[[0,w-1]]};var A=numeric.epsilon;for(x=0;x<t;x++){for(v=0;v<w-1;v++)if(Math.abs(e[v+1][v])<A*(Math.abs(e[v][v])+Math.abs(e[v+1][v+1]))){var S=numeric.QRFrancis(numeric.getBlock(e,[0,0],[v,v]),t),E=numeric.QRFrancis(numeric.getBlock(e,[v+1,v+1],[w-1,w-1]),t);for(p=Array(v+1),g=0;g<=v;g++)p[g]=_[g];for(f=numeric.dot(S.Q,p),g=0;g<=v;g++)_[g]=f[g];for(p=Array(w-v-1),g=v+1;g<w;g++)p[g-v-1]=_[g];for(f=numeric.dot(E.Q,p),g=v+1;g<w;g++)_[g]=f[g-v-1];return{Q:_,B:S.B.concat(numeric.add(E.B,v+1))}}var M,T,C;if(r=e[w-2][w-2],o=e[w-2][w-1],s=e[w-1][w-2],a=e[w-1][w-1],u=r+a,l=r*a-o*s,c=numeric.getBlock(e,[0,0],[2,2]),u*u>=4*l)M=.5*(u+Math.sqrt(u*u-4*l)),T=.5*(u-Math.sqrt(u*u-4*l)),c=numeric.add(numeric.sub(numeric.dot(c,c),numeric.mul(c,M+T)),numeric.diag(numeric.rep([3],M*T)));else c=numeric.add(numeric.sub(numeric.dot(c,c),numeric.mul(c,u)),numeric.diag(numeric.rep([3],l)));for(n=[c[0][0],c[1][0],c[2][0]],i=numeric.house(n),p=[e[0],e[1],e[2]],f=numeric.tensor(i,numeric.dot(i,p)),g=0;g<3;g++)for(d=e[g],m=f[g],y=0;y<w;y++)d[y]-=2*m[y];for(p=numeric.getBlock(e,[0,0],[w-1,2]),f=numeric.tensor(numeric.dot(p,i),i),g=0;g<w;g++)for(d=e[g],m=f[g],y=0;y<3;y++)d[y]-=2*m[y];for(p=[_[0],_[1],_[2]],f=numeric.tensor(i,numeric.dot(i,p)),g=0;g<3;g++)for(h=_[g],m=f[g],y=0;y<w;y++)h[y]-=2*m[y];for(v=0;v<w-2;v++){for(y=v;y<=v+1;y++)if(Math.abs(e[y+1][y])<A*(Math.abs(e[y][y])+Math.abs(e[y+1][y+1]))){S=numeric.QRFrancis(numeric.getBlock(e,[0,0],[y,y]),t),E=numeric.QRFrancis(numeric.getBlock(e,[y+1,y+1],[w-1,w-1]),t);for(p=Array(y+1),g=0;g<=y;g++)p[g]=_[g];for(f=numeric.dot(S.Q,p),g=0;g<=y;g++)_[g]=f[g];for(p=Array(w-y-1),g=y+1;g<w;g++)p[g-y-1]=_[g];for(f=numeric.dot(E.Q,p),g=y+1;g<w;g++)_[g]=f[g-y-1];return{Q:_,B:S.B.concat(numeric.add(E.B,y+1))}}for(C=Math.min(w-1,v+3),n=Array(C-v),g=v+1;g<=C;g++)n[g-v-1]=e[g][v];for(i=numeric.house(n),p=numeric.getBlock(e,[v+1,v],[C,w-1]),f=numeric.tensor(i,numeric.dot(i,p)),g=v+1;g<=C;g++)for(d=e[g],m=f[g-v-1],y=v;y<w;y++)d[y]-=2*m[y-v];for(p=numeric.getBlock(e,[0,v+1],[w-1,C]),f=numeric.tensor(numeric.dot(p,i),i),g=0;g<w;g++)for(d=e[g],m=f[g],y=v+1;y<=C;y++)d[y]-=2*m[y-v-1];for(p=Array(C-v),g=v+1;g<=C;g++)p[g-v-1]=_[g];for(f=numeric.tensor(i,numeric.dot(i,p)),g=v+1;g<=C;g++)for(h=_[g],m=f[g-v-1],y=0;y<w;y++)h[y]-=2*m[y]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(e,t){var n,i,r,o,s,a,l,u,c,h,d,p,f,m,g,v,y,x=numeric.toUpperHessenberg(e),b=numeric.QRFrancis(x.H,t),w=numeric.T,_=e.length,A=b.B,S=numeric.dot(b.Q,numeric.dot(x.H,numeric.transpose(b.Q))),E=new w(numeric.dot(b.Q,x.Q)),M=A.length,T=Math.sqrt;for(i=0;i<M;i++)if(n=A[i][0],n===A[i][1]);else{if(o=n+1,s=S[n][n],a=S[n][o],l=S[o][n],u=S[o][o],0===a&&0===l)continue;c=-s-u,h=s*u-a*l,d=c*c-4*h,d>=0?(p=c<0?-.5*(c-T(d)):-.5*(c+T(d)),v=(s-p)*(s-p)+a*a,y=l*l+(u-p)*(u-p),v>y?(v=T(v),m=(s-p)/v,g=a/v):(y=T(y),m=l/y,g=(u-p)/y),r=new w([[g,-m],[m,g]]),E.setRows(n,o,r.dot(E.getRows(n,o)))):(p=-.5*c,f=.5*T(-d),v=(s-p)*(s-p)+a*a,y=l*l+(u-p)*(u-p),v>y?(v=T(v+f*f),m=(s-p)/v,g=a/v,p=0,f/=v):(y=T(y+f*f),m=l/y,g=(u-p)/y,p=f/y,f=0),r=new w([[g,-m],[m,g]],[[p,f],[f,-p]]),E.setRows(n,o,r.dot(E.getRows(n,o))))}var C=E.dot(e).dot(E.transjugate()),P=(_=e.length,numeric.T.identity(_));for(o=0;o<_;o++)if(o>0)for(i=o-1;i>=0;i--){var R=C.get([i,i]),L=C.get([o,o]);numeric.neq(R.x,L.x)||numeric.neq(R.y,L.y)?(p=C.getRow(i).getBlock([i],[o-1]),f=P.getRow(o).getBlock([i],[o-1]),P.set([o,i],C.get([i,o]).neg().sub(p.dot(f)).div(R.sub(L)))):P.setRow(o,P.getRow(i))}for(o=0;o<_;o++)p=P.getRow(o),P.setRow(o,p.div(p.norm2()));return P=P.transpose(),P=E.transjugate().dot(P),{lambda:C.getDiag(),E:P}},numeric.ccsSparse=function(e){var t,n,i,r=e.length,o=[];for(n=r-1;-1!==n;--n)for(i in t=e[n],t){i=parseInt(i);while(i>=o.length)o[o.length]=0;0!==t[i]&&o[i]++}var s=o.length,a=Array(s+1);for(a[0]=0,n=0;n<s;++n)a[n+1]=a[n]+o[n];var l=Array(a[s]),u=Array(a[s]);for(n=r-1;-1!==n;--n)for(i in t=e[n],t)0!==t[i]&&(o[i]--,l[a[i]+o[i]]=n,u[a[i]+o[i]]=t[i]);return[a,l,u]},numeric.ccsFull=function(e){var t,n,i,r,o=e[0],s=e[1],a=e[2],l=numeric.ccsDim(e),u=l[0],c=l[1],h=numeric.rep([u,c],0);for(t=0;t<c;t++)for(i=o[t],r=o[t+1],n=i;n<r;++n)h[s[n]][t]=a[n];return h},numeric.ccsTSolve=function(e,t,n,i,r){var o,s,a,l,u,c,h,d=e[0],p=e[1],f=e[2],m=d.length-1,g=Math.max,v=0;function y(e){var t;if(0===n[e]){for(n[e]=1,t=d[e];t<d[e+1];++t)y(p[t]);r[v]=e,++v}}for("undefined"===typeof i&&(n=numeric.rep([m],0)),"undefined"===typeof i&&(i=numeric.linspace(0,n.length-1)),"undefined"===typeof r&&(r=[]),o=i.length-1;-1!==o;--o)y(i[o]);for(r.length=v,o=r.length-1;-1!==o;--o)n[r[o]]=0;for(o=i.length-1;-1!==o;--o)s=i[o],n[s]=t[s];for(o=r.length-1;-1!==o;--o){for(s=r[o],a=d[s],l=g(d[s+1],a),u=a;u!==l;++u)if(p[u]===s){n[s]/=f[u];break}for(h=n[s],u=a;u!==l;++u)c=p[u],c!==s&&(n[c]-=h*f[u])}return n},numeric.ccsDFS=function(e){this.k=Array(e),this.k1=Array(e),this.j=Array(e)},numeric.ccsDFS.prototype.dfs=function(e,t,n,i,r,o){var s,a,l,u=0,c=r.length,h=this.k,d=this.k1,p=this.j;if(0===i[e]){i[e]=1,p[0]=e,h[0]=a=t[e],d[0]=l=t[e+1];while(1)if(a>=l){if(r[c]=p[u],0===u)return;++c,--u,a=h[u],l=d[u]}else s=o[n[a]],0===i[s]?(i[s]=1,h[u]=a,++u,p[u]=s,a=t[s],d[u]=l=t[s+1]):++a}},numeric.ccsLPSolve=function(e,t,n,i,r,o,s){var a,l,u,c,h,d,p,f,m,g=e[0],v=e[1],y=e[2],x=(g.length,t[0]),b=t[1],w=t[2];for(l=x[r],u=x[r+1],i.length=0,a=l;a<u;++a)s.dfs(o[b[a]],g,v,n,i,o);for(a=i.length-1;-1!==a;--a)n[i[a]]=0;for(a=l;a!==u;++a)c=o[b[a]],n[c]=w[a];for(a=i.length-1;-1!==a;--a){for(c=i[a],h=g[c],d=g[c+1],p=h;p<d;++p)if(o[v[p]]===c){n[c]/=y[p];break}for(m=n[c],p=h;p<d;++p)f=o[v[p]],f!==c&&(n[f]-=m*y[p])}return n},numeric.ccsLUP1=function(e,t){var n,i,r,o,s,a,l,u=e[0].length-1,c=[numeric.rep([u+1],0),[],[]],h=[numeric.rep([u+1],0),[],[]],d=c[0],p=c[1],f=c[2],m=h[0],g=h[1],v=h[2],y=numeric.rep([u],0),x=numeric.rep([u],0),b=numeric.ccsLPSolve,w=(Math.max,Math.abs),_=numeric.linspace(0,u-1),A=numeric.linspace(0,u-1),S=new numeric.ccsDFS(u);for("undefined"===typeof t&&(t=1),n=0;n<u;++n){for(b(c,e,y,x,n,A,S),o=-1,s=-1,i=x.length-1;-1!==i;--i)r=x[i],r<=n||(a=w(y[r]),a>o&&(s=r,o=a));for(w(y[n])<t*o&&(i=_[n],o=_[s],_[n]=o,A[o]=n,_[s]=i,A[i]=s,o=y[n],y[n]=y[s],y[s]=o),o=d[n],s=m[n],l=y[n],p[o]=_[n],f[o]=1,++o,i=x.length-1;-1!==i;--i)r=x[i],a=y[r],x[i]=0,y[r]=0,r<=n?(g[s]=r,v[s]=a,++s):(p[o]=_[r],f[o]=a/l,++o);d[n+1]=o,m[n+1]=s}for(i=p.length-1;-1!==i;--i)p[i]=A[p[i]];return{L:c,U:h,P:_,Pinv:A}},numeric.ccsDFS0=function(e){this.k=Array(e),this.k1=Array(e),this.j=Array(e)},numeric.ccsDFS0.prototype.dfs=function(e,t,n,i,r,o,s){var a,l,u,c=0,h=r.length,d=this.k,p=this.k1,f=this.j;if(0===i[e]){i[e]=1,f[0]=e,d[0]=l=t[o[e]],p[0]=u=t[o[e]+1];while(1){if(isNaN(l))throw new Error("Ow!");if(l>=u){if(r[h]=o[f[c]],0===c)return;++h,--c,l=d[c],u=p[c]}else a=n[l],0===i[a]?(i[a]=1,d[c]=l,++c,f[c]=a,a=o[a],l=t[a],p[c]=u=t[a+1]):++l}}},numeric.ccsLPSolve0=function(e,t,n,i,r,o,s,a){var l,u,c,h,d,p,f,m,g,v=e[0],y=e[1],x=e[2],b=(v.length,t[0]),w=t[1],_=t[2];for(u=b[r],c=b[r+1],i.length=0,l=u;l<c;++l)a.dfs(w[l],v,y,n,i,o,s);for(l=i.length-1;-1!==l;--l)h=i[l],n[s[h]]=0;for(l=u;l!==c;++l)h=w[l],n[h]=_[l];for(l=i.length-1;-1!==l;--l){for(h=i[l],m=s[h],d=v[h],p=v[h+1],f=d;f<p;++f)if(y[f]===m){n[m]/=x[f];break}for(g=n[m],f=d;f<p;++f)n[y[f]]-=g*x[f];n[m]=g}},numeric.ccsLUP0=function(e,t){var n,i,r,o,s,a,l,u=e[0].length-1,c=[numeric.rep([u+1],0),[],[]],h=[numeric.rep([u+1],0),[],[]],d=c[0],p=c[1],f=c[2],m=h[0],g=h[1],v=h[2],y=numeric.rep([u],0),x=numeric.rep([u],0),b=numeric.ccsLPSolve0,w=(Math.max,Math.abs),_=numeric.linspace(0,u-1),A=numeric.linspace(0,u-1),S=new numeric.ccsDFS0(u);for("undefined"===typeof t&&(t=1),n=0;n<u;++n){for(b(c,e,y,x,n,A,_,S),o=-1,s=-1,i=x.length-1;-1!==i;--i)r=x[i],r<=n||(a=w(y[_[r]]),a>o&&(s=r,o=a));for(w(y[_[n]])<t*o&&(i=_[n],o=_[s],_[n]=o,A[o]=n,_[s]=i,A[i]=s),o=d[n],s=m[n],l=y[_[n]],p[o]=_[n],f[o]=1,++o,i=x.length-1;-1!==i;--i)r=x[i],a=y[_[r]],x[i]=0,y[_[r]]=0,r<=n?(g[s]=r,v[s]=a,++s):(p[o]=_[r],f[o]=a/l,++o);d[n+1]=o,m[n+1]=s}for(i=p.length-1;-1!==i;--i)p[i]=A[p[i]];return{L:c,U:h,P:_,Pinv:A}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(e){return[numeric.sup(e[1])+1,e[0].length-1]},numeric.ccsGetBlock=function(e,t,n){var i=numeric.ccsDim(e),r=i[0],o=i[1];"undefined"===typeof t?t=numeric.linspace(0,r-1):"number"===typeof t&&(t=[t]),"undefined"===typeof n?n=numeric.linspace(0,o-1):"number"===typeof n&&(n=[n]);var s,a,l,u,c,h=t.length,d=n.length,p=numeric.rep([o],0),f=[],m=[],g=[p,f,m],v=e[0],y=e[1],x=e[2],b=numeric.rep([r],0),w=0,_=numeric.rep([r],0);for(a=0;a<d;++a){u=n[a];var A=v[u],S=v[u+1];for(s=A;s<S;++s)l=y[s],_[l]=1,b[l]=x[s];for(s=0;s<h;++s)c=t[s],_[c]&&(f[w]=s,m[w]=b[t[s]],++w);for(s=A;s<S;++s)l=y[s],_[l]=0;p[a+1]=w}return g},numeric.ccsDot=function(e,t){var n,i,r,o,s,a,l,u,c,h,d,p=e[0],f=e[1],m=e[2],g=t[0],v=t[1],y=t[2],x=numeric.ccsDim(e),b=numeric.ccsDim(t),w=x[0],_=(x[1],b[1]),A=numeric.rep([w],0),S=numeric.rep([w],0),E=Array(w),M=numeric.rep([_],0),T=[],C=[],P=[M,T,C];for(r=0;r!==_;++r){for(o=g[r],s=g[r+1],c=0,i=o;i<s;++i)for(h=v[i],d=y[i],a=p[h],l=p[h+1],n=a;n<l;++n)u=f[n],0===S[u]&&(E[c]=u,S[u]=1,c+=1),A[u]=A[u]+m[n]*d;for(o=M[r],s=o+c,M[r+1]=s,i=c-1;-1!==i;--i)d=o+i,n=E[i],T[d]=n,C[d]=A[n],S[n]=0,A[n]=0;M[r+1]=M[r]+c}return P},numeric.ccsLUPSolve=function(e,t){var n=e.L,i=e.U,r=(e.P,t[0]),o=!1;"object"!==typeof r&&(t=[[0,t.length],numeric.linspace(0,t.length-1),t],r=t[0],o=!0);var s,a,l,u,c,h,d=t[1],p=t[2],f=n[0].length-1,m=r.length-1,g=numeric.rep([f],0),v=Array(f),y=numeric.rep([f],0),x=Array(f),b=numeric.rep([m+1],0),w=[],_=[],A=numeric.ccsTSolve,S=0;for(s=0;s<m;++s){for(c=0,l=r[s],u=r[s+1],a=l;a<u;++a)h=e.Pinv[d[a]],x[c]=h,y[h]=p[a],++c;for(x.length=c,A(n,y,g,x,v),a=x.length-1;-1!==a;--a)y[x[a]]=0;if(A(i,g,y,v,x),o)return y;for(a=v.length-1;-1!==a;--a)g[v[a]]=0;for(a=x.length-1;-1!==a;--a)h=x[a],w[S]=h,_[S]=y[h],y[h]=0,++S;b[s+1]=S}return[b,w,_]},numeric.ccsbinop=function(e,t){return"undefined"===typeof t&&(t=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+t+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+e+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(e){var t,n=e[0],i=e[1],r=e[2],o=numeric.sup(i)+1,s=n.length,a=numeric.rep([o],0),l=Array(s),u=Array(s),c=numeric.rep([o],0);for(t=0;t<s;++t)c[i[t]]++;for(t=0;t<o;++t)a[t+1]=a[t]+c[t];var h,d,p=a.slice(0);for(t=0;t<s;++t)d=i[t],h=p[d],l[h]=n[t],u[h]=r[t],p[d]=p[d]+1;return[a,l,u]},numeric.ccsGather=function(e){var t,n,i,r,o,s=e[0],a=e[1],l=e[2],u=s.length-1,c=a.length,h=Array(c),d=Array(c),p=Array(c);for(o=0,t=0;t<u;++t)for(i=s[t],r=s[t+1],n=i;n!==r;++n)d[o]=t,h[o]=a[n],p[o]=l[n],++o;return[h,d,p]},numeric.sdim=function e(t,n,i){if("undefined"===typeof n&&(n=[]),"object"!==typeof t)return n;var r;for(r in"undefined"===typeof i&&(i=0),i in n||(n[i]=0),t.length>n[i]&&(n[i]=t.length),t)t.hasOwnProperty(r)&&e(t[r],n,i+1);return n},numeric.sclone=function e(t,n,i){"undefined"===typeof n&&(n=0),"undefined"===typeof i&&(i=numeric.sdim(t).length);var r,o=Array(t.length);if(n===i-1){for(r in t)t.hasOwnProperty(r)&&(o[r]=t[r]);return o}for(r in t)t.hasOwnProperty(r)&&(o[r]=e(t[r],n+1,i));return o},numeric.sdiag=function(e){var t,n,i=e.length,r=Array(i);for(t=i-1;t>=1;t-=2)n=t-1,r[t]=[],r[t][t]=e[t],r[n]=[],r[n][n]=e[n];return 0===t&&(r[0]=[],r[0][0]=e[t]),r},numeric.sidentity=function(e){return numeric.sdiag(numeric.rep([e],1))},numeric.stranspose=function(e){var t,n,i,r=[];e.length;for(t in e)if(e.hasOwnProperty(t))for(n in i=e[t],i)i.hasOwnProperty(n)&&("object"!==typeof r[n]&&(r[n]=[]),r[n][t]=i[n]);return r},numeric.sLUP=function(e,t){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(e,t){var n,i,r,o,s,a,l,u=e.length,c=(t.length,numeric.stranspose(t)),h=c.length,d=Array(u);for(r=u-1;r>=0;r--){for(l=[],n=e[r],s=h-1;s>=0;s--){for(o in a=0,i=c[s],n)n.hasOwnProperty(o)&&o in i&&(a+=n[o]*i[o]);a&&(l[s]=a)}d[r]=l}return d},numeric.sdotMV=function(e,t){var n,i,r,o,s=e.length,a=Array(s);for(i=s-1;i>=0;i--){for(r in n=e[i],o=0,n)n.hasOwnProperty(r)&&t[r]&&(o+=n[r]*t[r]);o&&(a[i]=o)}return a},numeric.sdotVM=function(e,t){var n,i,r,o,s=[];for(n in e)if(e.hasOwnProperty(n))for(i in r=t[n],o=e[n],r)r.hasOwnProperty(i)&&(s[i]||(s[i]=0),s[i]+=o*r[i]);return s},numeric.sdotVV=function(e,t){var n,i=0;for(n in e)e[n]&&t[n]&&(i+=e[n]*t[n]);return i},numeric.sdot=function(e,t){var n=numeric.sdim(e).length,i=numeric.sdim(t).length,r=1e3*n+i;switch(r){case 0:return e*t;case 1001:return numeric.sdotVV(e,t);case 2001:return numeric.sdotMV(e,t);case 1002:return numeric.sdotVM(e,t);case 2002:return numeric.sdotMM(e,t);default:throw new Error("numeric.sdot not implemented for tensors of order "+n+" and "+i)}},numeric.sscatter=function(e){var t,n,i,r,o=e[0].length,s=e.length,a=[];for(n=o-1;n>=0;--n)if(e[s-1][n]){for(r=a,i=0;i<s-2;i++)t=e[i][n],r[t]||(r[t]=[]),r=r[t];r[e[i][n]]=e[i+1][n]}return a},numeric.sgather=function e(t,n,i){var r,o,s;for(o in"undefined"===typeof n&&(n=[]),"undefined"===typeof i&&(i=[]),r=i.length,t)if(t.hasOwnProperty(o))if(i[r]=parseInt(o),s=t[o],"number"===typeof s){if(s){if(0===n.length)for(o=r+1;o>=0;--o)n[o]=[];for(o=r;o>=0;--o)n[o].push(i[o]);n[r+1].push(s)}}else e(s,n,i);return i.length>r&&i.pop(),n},numeric.cLU=function(e){var t,n,i,r,o,s,a=e[0],l=e[1],u=e[2],c=a.length,h=0;for(t=0;t<c;t++)a[t]>h&&(h=a[t]);h++;var d,p=Array(h),f=Array(h),m=numeric.rep([h],1/0),g=numeric.rep([h],-1/0);for(i=0;i<c;i++)t=a[i],n=l[i],n<m[t]&&(m[t]=n),n>g[t]&&(g[t]=n);for(t=0;t<h-1;t++)g[t]>g[t+1]&&(g[t+1]=g[t]);for(t=h-1;t>=1;t--)m[t]<m[t-1]&&(m[t-1]=m[t]);for(t=0;t<h;t++)f[t]=numeric.rep([g[t]-m[t]+1],0),p[t]=numeric.rep([t-m[t]],0),t-m[t]+1,g[t]-t+1;for(i=0;i<c;i++)t=a[i],f[t][l[i]-m[t]]=u[i];for(t=0;t<h-1;t++)for(r=t-m[t],x=f[t],n=t+1;m[n]<=t&&n<h;n++)if(o=t-m[n],s=g[t]-t,b=f[n],d=b[o]/x[r],d){for(i=1;i<=s;i++)b[i+o]-=d*x[i+r];p[n][t-m[n]]=d}var v,y,x=[],b=[],w=[],_=[],A=[],S=[];for(c=0,v=0,t=0;t<h;t++){for(r=m[t],o=g[t],y=f[t],n=t;n<=o;n++)y[n-r]&&(x[c]=t,b[c]=n,w[c]=y[n-r],c++);for(y=p[t],n=r;n<t;n++)y[n-r]&&(_[v]=t,A[v]=n,S[v]=y[n-r],v++);_[v]=t,A[v]=t,S[v]=1,v++}return{U:[x,b,w],L:[_,A,S]}},numeric.cLUsolve=function(e,t){var n,i,r=e.L,o=e.U,s=numeric.clone(t),a=r[0],l=r[1],u=r[2],c=o[0],h=o[1],d=o[2],p=c.length,f=(a.length,s.length);for(i=0,n=0;n<f;n++){while(l[i]<n)s[n]-=u[i]*s[l[i]],i++;i++}for(i=p-1,n=f-1;n>=0;n--){while(h[i]>n)s[n]-=d[i]*s[h[i]],i--;s[n]/=d[i],i--}return s},numeric.cgrid=function(e,t){"number"===typeof e&&(e=[e,e]);var n,i,r,o=numeric.rep(e,-1);if("function"!==typeof t)switch(t){case"L":t=function(t,n){return t>=e[0]/2||n<e[1]/2};break;default:t=function(e,t){return!0};break}for(r=0,n=1;n<e[0]-1;n++)for(i=1;i<e[1]-1;i++)t(n,i)&&(o[n][i]=r,r++);return o},numeric.cdelsq=function(e){var t,n,i,r,o,s=[[-1,0],[0,-1],[0,1],[1,0]],a=numeric.dim(e),l=a[0],u=a[1],c=[],h=[],d=[];for(t=1;t<l-1;t++)for(n=1;n<u-1;n++)if(!(e[t][n]<0)){for(i=0;i<4;i++)r=t+s[i][0],o=n+s[i][1],e[r][o]<0||(c.push(e[t][n]),h.push(e[r][o]),d.push(-1));c.push(e[t][n]),h.push(e[t][n]),d.push(4)}return[c,h,d]},numeric.cdotMV=function(e,t){var n,i,r,o=e[0],s=e[1],a=e[2],l=o.length;for(r=0,i=0;i<l;i++)o[i]>r&&(r=o[i]);for(r++,n=numeric.rep([r],0),i=0;i<l;i++)n[o[i]]+=a[i]*t[s[i]];return n},numeric.Spline=function(e,t,n,i,r){this.x=e,this.yl=t,this.yr=n,this.kl=i,this.kr=r},numeric.Spline.prototype._at=function(e,t){var n,i,r,o=this.x,s=this.yl,a=this.yr,l=this.kl,u=this.kr,c=numeric.add,h=numeric.sub,d=numeric.mul;n=h(d(l[t],o[t+1]-o[t]),h(a[t+1],s[t])),i=c(d(u[t+1],o[t]-o[t+1]),h(a[t+1],s[t])),r=(e-o[t])/(o[t+1]-o[t]);var p=r*(1-r);return c(c(c(d(1-r,s[t]),d(r,a[t+1])),d(n,p*(1-r))),d(i,p*r))},numeric.Spline.prototype.at=function(e){if("number"===typeof e){var t,n,i,r=this.x,o=r.length,s=Math.floor;t=0,n=o-1;while(n-t>1)i=s((t+n)/2),r[i]<=e?t=i:n=i;return this._at(e,t)}o=e.length;var a,l=Array(o);for(a=o-1;-1!==a;--a)l[a]=this.at(e[a]);return l},numeric.Spline.prototype.diff=function(){var e,t,n,i=this.x,r=this.yl,o=this.yr,s=this.kl,a=this.kr,l=r.length,u=s,c=a,h=Array(l),d=Array(l),p=numeric.add,f=numeric.mul,m=numeric.div,g=numeric.sub;for(e=l-1;-1!==e;--e)t=i[e+1]-i[e],n=g(o[e+1],r[e]),h[e]=m(p(f(n,6),f(s[e],-4*t),f(a[e+1],-2*t)),t*t),d[e+1]=m(p(f(n,-6),f(s[e],2*t),f(a[e+1],4*t)),t*t);return new numeric.Spline(i,u,c,h,d)},numeric.Spline.prototype.roots=function(){function e(e){return e*e}var t=[],n=this.x,i=this.yl,r=this.yr,o=this.kl,s=this.kr;"number"===typeof i[0]&&(i=[i],r=[r],o=[o],s=[s]);var a,l,u,c,h,d,p,f,m,g,v,y,x,b,w,_,A,S,E,M,T,C,P,R=i.length,L=n.length-1,O=(t=Array(R),Math.sqrt);for(a=0;a!==R;++a){for(c=i[a],h=r[a],d=o[a],p=s[a],f=[],l=0;l!==L;l++){for(l>0&&h[l]*c[l]<0&&f.push(n[l]),_=n[l+1]-n[l],n[l],v=c[l],y=h[l+1],m=d[l]/_,g=p[l+1]/_,w=e(m-g+3*(v-y))+12*g*v,x=g+3*v+2*m-3*y,b=3*(g+m+2*(v-y)),w<=0?(S=x/b,A=S>n[l]&&S<n[l+1]?[n[l],S,n[l+1]]:[n[l],n[l+1]]):(S=(x-O(w))/b,E=(x+O(w))/b,A=[n[l]],S>n[l]&&S<n[l+1]&&A.push(S),E>n[l]&&E<n[l+1]&&A.push(E),A.push(n[l+1])),T=A[0],S=this._at(T,l),u=0;u<A.length-1;u++)if(C=A[u+1],E=this._at(C,l),0!==S)if(0===E||S*E>0)T=C,S=E;else{var D=0;while(1){if(P=(S*C-E*T)/(S-E),P<=T||P>=C)break;if(M=this._at(P,l),M*E>0)C=P,E=M,-1===D&&(S*=.5),D=-1;else{if(!(M*S>0))break;T=P,S=M,1===D&&(E*=.5),D=1}}f.push(P),T=A[u+1],S=this._at(T,l)}else f.push(T),T=C,S=E;0===E&&f.push(C)}t[a]=f}return"number"===typeof this.yl[0]?t[0]:t},numeric.spline=function(e,t,n,i){var r,o=e.length,s=[],a=[],l=[],u=numeric.sub,c=numeric.mul,h=numeric.add;for(r=o-2;r>=0;r--)a[r]=e[r+1]-e[r],l[r]=u(t[r+1],t[r]);"string"!==typeof n&&"string"!==typeof i||(n=i="periodic");var d=[[],[],[]];switch(typeof n){case"undefined":s[0]=c(3/(a[0]*a[0]),l[0]),d[0].push(0,0),d[1].push(0,1),d[2].push(2/a[0],1/a[0]);break;case"string":s[0]=h(c(3/(a[o-2]*a[o-2]),l[o-2]),c(3/(a[0]*a[0]),l[0])),d[0].push(0,0,0),d[1].push(o-2,0,1),d[2].push(1/a[o-2],2/a[o-2]+2/a[0],1/a[0]);break;default:s[0]=n,d[0].push(0),d[1].push(0),d[2].push(1);break}for(r=1;r<o-1;r++)s[r]=h(c(3/(a[r-1]*a[r-1]),l[r-1]),c(3/(a[r]*a[r]),l[r])),d[0].push(r,r,r),d[1].push(r-1,r,r+1),d[2].push(1/a[r-1],2/a[r-1]+2/a[r],1/a[r]);switch(typeof i){case"undefined":s[o-1]=c(3/(a[o-2]*a[o-2]),l[o-2]),d[0].push(o-1,o-1),d[1].push(o-2,o-1),d[2].push(1/a[o-2],2/a[o-2]);break;case"string":d[1][d[1].length-1]=0;break;default:s[o-1]=i,d[0].push(o-1),d[1].push(o-1),d[2].push(1);break}s="number"!==typeof s[0]?numeric.transpose(s):[s];var p=Array(s.length);if("string"===typeof n)for(r=p.length-1;-1!==r;--r)p[r]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(d)),s[r]),p[r][o-1]=p[r][0];else for(r=p.length-1;-1!==r;--r)p[r]=numeric.cLUsolve(numeric.cLU(d),s[r]);return p="number"===typeof t[0]?p[0]:numeric.transpose(p),new numeric.Spline(e,t,t,p,p)},numeric.fftpow2=function e(t,n){var i=t.length;if(1!==i){var r,o,s=Math.cos,a=Math.sin,l=Array(i/2),u=Array(i/2),c=Array(i/2),h=Array(i/2);for(o=i/2,r=i-1;-1!==r;--r)--o,c[o]=t[r],h[o]=n[r],--r,l[o]=t[r],u[o]=n[r];e(l,u),e(c,h),o=i/2;var d,p,f,m=-6.283185307179586/i;for(r=i-1;-1!==r;--r)--o,-1===o&&(o=i/2-1),d=m*r,p=s(d),f=a(d),t[r]=l[o]+p*c[o]-f*h[o],n[r]=u[o]+p*h[o]+f*c[o]}},numeric._ifftpow2=function e(t,n){var i=t.length;if(1!==i){var r,o,s=Math.cos,a=Math.sin,l=Array(i/2),u=Array(i/2),c=Array(i/2),h=Array(i/2);for(o=i/2,r=i-1;-1!==r;--r)--o,c[o]=t[r],h[o]=n[r],--r,l[o]=t[r],u[o]=n[r];e(l,u),e(c,h),o=i/2;var d,p,f,m=6.283185307179586/i;for(r=i-1;-1!==r;--r)--o,-1===o&&(o=i/2-1),d=m*r,p=s(d),f=a(d),t[r]=l[o]+p*c[o]-f*h[o],n[r]=u[o]+p*h[o]+f*c[o]}},numeric.ifftpow2=function(e,t){numeric._ifftpow2(e,t),numeric.diveq(e,e.length),numeric.diveq(t,t.length)},numeric.convpow2=function(e,t,n,i){numeric.fftpow2(e,t),numeric.fftpow2(n,i);var r,o,s,a,l,u=e.length;for(r=u-1;-1!==r;--r)o=e[r],a=t[r],s=n[r],l=i[r],e[r]=o*s-a*l,t[r]=o*l+a*s;numeric.ifftpow2(e,t)},numeric.T.prototype.fft=function(){var e,t,n=this.x,i=this.y,r=n.length,o=Math.log,s=o(2),a=Math.ceil(o(2*r-1)/s),l=Math.pow(2,a),u=numeric.rep([l],0),c=numeric.rep([l],0),h=Math.cos,d=Math.sin,p=-3.141592653589793/r,f=numeric.rep([l],0),m=numeric.rep([l],0);Math.floor(r/2);for(e=0;e<r;e++)f[e]=n[e];if("undefined"!==typeof i)for(e=0;e<r;e++)m[e]=i[e];for(u[0]=1,e=1;e<=l/2;e++)t=p*e*e,u[e]=h(t),c[e]=d(t),u[l-e]=h(t),c[l-e]=d(t);var g=new numeric.T(f,m),v=new numeric.T(u,c);return g=g.mul(v),numeric.convpow2(g.x,g.y,numeric.clone(v.x),numeric.neg(v.y)),g=g.mul(v),g.x.length=r,g.y.length=r,g},numeric.T.prototype.ifft=function(){var e,t,n=this.x,i=this.y,r=n.length,o=Math.log,s=o(2),a=Math.ceil(o(2*r-1)/s),l=Math.pow(2,a),u=numeric.rep([l],0),c=numeric.rep([l],0),h=Math.cos,d=Math.sin,p=3.141592653589793/r,f=numeric.rep([l],0),m=numeric.rep([l],0);Math.floor(r/2);for(e=0;e<r;e++)f[e]=n[e];if("undefined"!==typeof i)for(e=0;e<r;e++)m[e]=i[e];for(u[0]=1,e=1;e<=l/2;e++)t=p*e*e,u[e]=h(t),c[e]=d(t),u[l-e]=h(t),c[l-e]=d(t);var g=new numeric.T(f,m),v=new numeric.T(u,c);return g=g.mul(v),numeric.convpow2(g.x,g.y,numeric.clone(v.x),numeric.neg(v.y)),g=g.mul(v),g.x.length=r,g.y.length=r,g.div(r)},numeric.gradient=function(e,t){var n=t.length,i=e(t);if(isNaN(i))throw new Error("gradient: f(x) is a NaN!");var r,o,s,a,l,u,c,h,d,p,f=Math.max,m=numeric.clone(t),g=Array(n),v=(numeric.div,numeric.sub,f=Math.max,.001),y=Math.abs,x=Math.min,b=0;for(r=0;r<n;r++){var w=f(1e-6*i,1e-8);while(1){if(++b,b>20)throw new Error("Numerical gradient fails");if(m[r]=t[r]+w,o=e(m),m[r]=t[r]-w,s=e(m),m[r]=t[r],isNaN(o)||isNaN(s))w/=16;else{if(g[r]=(o-s)/(2*w),l=t[r]-w,u=t[r],c=t[r]+w,h=(o-i)/w,d=(i-s)/w,p=f(y(g[r]),y(i),y(o),y(s),y(l),y(u),y(c),1e-8),a=x(f(y(h-g[r]),y(d-g[r]),y(h-d))/p,w/p),!(a>v))break;w/=16}}}return g},numeric.uncmin=function(e,t,n,i,r,o,s){var a=numeric.gradient;"undefined"===typeof s&&(s={}),"undefined"===typeof n&&(n=1e-8),"undefined"===typeof i&&(i=function(t){return a(e,t)}),"undefined"===typeof r&&(r=1e3),t=numeric.clone(t);var l,u,c=t.length,h=e(t);if(isNaN(h))throw new Error("uncmin: f(x0) is a NaN!");var d=Math.max,p=numeric.norm2;n=d(n,numeric.epsilon);var f,m,g,v,y,x,b,w,_,A,S=s.Hinv||numeric.identity(c),E=numeric.dot,M=(numeric.inv,numeric.sub),T=numeric.add,C=numeric.tensor,P=numeric.div,R=numeric.mul,L=numeric.all,O=numeric.isFinite,D=numeric.neg,I=0,N="";m=i(t);while(I<r){if("function"===typeof o&&o(I,t,h,m,S)){N="Callback returned true";break}if(!L(O(m))){N="Gradient has Infinity or NaN";break}if(f=D(E(S,m)),!L(O(f))){N="Search direction has Infinity or NaN";break}if(A=p(f),A<n){N="Newton step smaller than tol";break}_=1,u=E(m,f),y=t;while(I<r){if(_*A<n)break;if(v=R(f,_),y=T(t,v),l=e(y),!(l-h>=.1*_*u||isNaN(l)))break;_*=.5,++I}if(_*A<n){N="Line search step size smaller than tol";break}if(I===r){N="maxit reached during line search";break}g=i(y),x=M(g,m),w=E(x,v),b=E(S,x),S=M(T(S,R((w+E(x,b))/(w*w),C(v,v))),P(T(C(b,v),C(v,b)),w)),t=y,h=l,m=g,++I}return{solution:t,f:h,gradient:m,invHessian:S,iterations:I,message:N}},numeric.Dopri=function(e,t,n,i,r,o,s){this.x=e,this.y=t,this.f=n,this.ymid=i,this.iterations=r,this.events=s,this.message=o},numeric.Dopri.prototype._at=function(e,t){function n(e){return e*e}var i,r,o,s,a,l,u,c,h,d,p=this,f=p.x,m=p.y,g=p.f,v=p.ymid,y=(f.length,Math.floor,.5),x=numeric.add,b=numeric.mul,w=numeric.sub;return i=f[t],r=f[t+1],s=m[t],a=m[t+1],u=r-i,o=i+y*u,l=v[t],c=w(g[t],b(s,1/(i-o)+2/(i-r))),h=w(g[t+1],b(a,1/(r-o)+2/(r-i))),d=[n(e-r)*(e-o)/n(i-r)/(i-o),n(e-i)*n(e-r)/n(i-o)/n(r-o),n(e-i)*(e-o)/n(r-i)/(r-o),(e-i)*n(e-r)*(e-o)/n(i-r)/(i-o),(e-r)*n(e-i)*(e-o)/n(i-r)/(r-o)],x(x(x(x(b(s,d[0]),b(l,d[1])),b(a,d[2])),b(c,d[3])),b(h,d[4]))},numeric.Dopri.prototype.at=function(e){var t,n,i,r=Math.floor;if("number"!==typeof e){var o=e.length,s=Array(o);for(t=o-1;-1!==t;--t)s[t]=this.at(e[t]);return s}var a=this.x;t=0,n=a.length-1;while(n-t>1)i=r(.5*(t+n)),a[i]<=e?t=i:n=i;return this._at(e,t)},numeric.dopri=function(e,t,n,i,r,o,s){"undefined"===typeof r&&(r=1e-6),"undefined"===typeof o&&(o=1e3);var a,l,u,c,h,d,p,f,m,g,v,y,x,b=[e],w=[n],_=[i(e,n)],A=[],S=.2,E=[3/40,9/40],M=[44/45,-56/15,32/9],T=[19372/6561,-25360/2187,64448/6561,-212/729],C=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],P=[35/384,0,500/1113,125/192,-2187/6784,11/84],R=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,5618549.5/235043384],L=[.2,.3,.8,8/9,1,1],O=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,1/40],D=0,I=(t-e)/10,N=0,k=numeric.add,V=numeric.mul,U=(Math.max,Math.min),F=Math.abs,z=numeric.norminf,j=Math.pow,B=numeric.any,$=numeric.lt,H=numeric.and,G=(numeric.sub,new numeric.Dopri(b,w,_,A,-1,""));"function"===typeof s&&(v=s(e,n));while(e<t&&N<o)if(++N,e+I>t&&(I=t-e),a=i(e+L[0]*I,k(n,V(S*I,_[D]))),l=i(e+L[1]*I,k(k(n,V(E[0]*I,_[D])),V(E[1]*I,a))),u=i(e+L[2]*I,k(k(k(n,V(M[0]*I,_[D])),V(M[1]*I,a)),V(M[2]*I,l))),c=i(e+L[3]*I,k(k(k(k(n,V(T[0]*I,_[D])),V(T[1]*I,a)),V(T[2]*I,l)),V(T[3]*I,u))),h=i(e+L[4]*I,k(k(k(k(k(n,V(C[0]*I,_[D])),V(C[1]*I,a)),V(C[2]*I,l)),V(C[3]*I,u)),V(C[4]*I,c))),m=k(k(k(k(k(n,V(_[D],I*P[0])),V(l,I*P[2])),V(u,I*P[3])),V(c,I*P[4])),V(h,I*P[5])),d=i(e+I,m),p=k(k(k(k(k(V(_[D],I*O[0]),V(l,I*O[2])),V(u,I*O[3])),V(c,I*O[4])),V(h,I*O[5])),V(d,I*O[6])),g="number"===typeof p?F(p):z(p),g>r){if(I=.2*I*j(r/g,.25),e+I===e){G.msg="Step size became too small";break}}else{if(A[D]=k(k(k(k(k(k(n,V(_[D],I*R[0])),V(l,I*R[2])),V(u,I*R[3])),V(c,I*R[4])),V(h,I*R[5])),V(d,I*R[6])),++D,b[D]=e+I,w[D]=m,_[D]=d,"function"===typeof s){var W,q,Y=e,X=e+.5*I;if(y=s(X,A[D-1]),x=H($(v,0),$(0,y)),B(x)||(Y=X,X=e+I,v=y,y=s(X,m),x=H($(v,0),$(0,y))),B(x)){var Z,J,K=0,Q=1,ee=1;while(1){if("number"===typeof v)q=(ee*y*Y-Q*v*X)/(ee*y-Q*v);else for(q=X,f=v.length-1;-1!==f;--f)v[f]<0&&y[f]>0&&(q=U(q,(ee*y[f]*Y-Q*v[f]*X)/(ee*y[f]-Q*v[f])));if(q<=Y||q>=X)break;W=G._at(q,D-1),J=s(q,W),Z=H($(v,0),$(0,J)),B(Z)?(X=q,y=J,x=Z,ee=1,-1===K?Q*=.5:Q=1,K=-1):(Y=q,v=J,Q=1,1===K?ee*=.5:ee=1,K=1)}return m=G._at(.5*(e+q),D-1),G.f[D]=i(q,W),G.x[D]=q,G.y[D]=W,G.ymid[D-1]=m,G.events=x,G.iterations=N,G}}e+=I,n=m,v=y,I=U(.8*I*j(r/g,.25),4*I)}return G.iterations=N,G},numeric.LU=function(e,t){t=t||!1;var n,i,r,o,s,a,l,u,c,h=Math.abs,d=e.length,p=d-1,f=new Array(d);for(t||(e=numeric.clone(e)),r=0;r<d;++r){for(l=r,a=e[r],c=h(a[r]),i=r+1;i<d;++i)o=h(e[i][r]),c<o&&(c=o,l=i);for(f[r]=l,l!=r&&(e[r]=e[l],e[l]=a,a=e[r]),s=a[r],n=r+1;n<d;++n)e[n][r]/=s;for(n=r+1;n<d;++n){for(u=e[n],i=r+1;i<p;++i)u[i]-=u[r]*a[i],++i,u[i]-=u[r]*a[i];i===p&&(u[i]-=u[r]*a[i])}}return{LU:e,P:f}},numeric.LUsolve=function(e,t){var n,i,r,o,s,a=e.LU,l=a.length,u=numeric.clone(t),c=e.P;for(n=l-1;-1!==n;--n)u[n]=t[n];for(n=0;n<l;++n)for(r=c[n],c[n]!==n&&(s=u[n],u[n]=u[r],u[r]=s),o=a[n],i=0;i<n;++i)u[n]-=u[i]*o[i];for(n=l-1;n>=0;--n){for(o=a[n],i=n+1;i<l;++i)u[n]-=u[i]*o[i];u[n]/=o[n]}return u},numeric.solve=function(e,t,n){return numeric.LUsolve(numeric.LU(e,n),t)},numeric.echelonize=function(e){var t,n,i,r,o,s,a,l,u=numeric.dim(e),c=u[0],h=u[1],d=numeric.identity(c),p=Array(c),f=Math.abs,m=numeric.diveq;for(e=numeric.clone(e),t=0;t<c;++t){for(i=0,o=e[t],s=d[t],n=1;n<h;++n)f(o[i])<f(o[n])&&(i=n);for(p[t]=i,m(s,o[i]),m(o,o[i]),n=0;n<c;++n)if(n!==t){for(a=e[n],l=a[i],r=h-1;-1!==r;--r)a[r]-=o[r]*l;for(a=d[n],r=c-1;-1!==r;--r)a[r]-=s[r]*l}}return{I:d,A:e,P:p}},numeric.__solveLP=function(e,t,n,i,r,o,s){var a,l,u,c,h=numeric.sum,d=(numeric.log,numeric.mul),p=numeric.sub,f=numeric.dot,m=numeric.div,g=numeric.add,v=e.length,y=n.length,x=!1,b=0,w=1,_=(numeric.transpose(t),numeric.svd,numeric.transpose),A=(numeric.leq,Math.sqrt),S=Math.abs,E=(numeric.muleq,numeric.norminf,numeric.any,Math.min),M=numeric.all,T=numeric.gt,C=Array(v),P=Array(y),R=(numeric.rep([y],1),numeric.solve),L=p(n,f(t,o)),O=f(e,e);for(u=b;u<r;++u){var D,I;for(D=y-1;-1!==D;--D)P[D]=m(t[D],L[D]);var N=_(P);for(D=v-1;-1!==D;--D)C[D]=h(N[D]);w=.25*S(O/f(e,C));var k=100*A(O/f(C,C));for((!isFinite(w)||w>k)&&(w=k),c=g(e,d(w,C)),l=f(N,P),D=v-1;-1!==D;--D)l[D][D]+=1;I=R(l,m(c,w),!0);var V=m(L,f(t,I)),U=1;for(D=y-1;-1!==D;--D)V[D]<0&&(U=E(U,-.999*V[D]));if(a=p(o,d(I,U)),L=p(n,f(t,a)),!M(T(L,0)))return{solution:o,message:"",iterations:u};if(o=a,w<i)return{solution:a,message:"",iterations:u};if(s){var F=f(e,c),z=f(t,c);for(x=!0,D=y-1;-1!==D;--D)if(F*z[D]<0){x=!1;break}}else x=!(o[v-1]>=0);if(x)return{solution:a,message:"Unbounded",iterations:u}}return{solution:o,message:"maximum iteration count exceeded",iterations:u}},numeric._solveLP=function(e,t,n,i,r){var o=e.length,s=n.length,a=(numeric.sum,numeric.log,numeric.mul,numeric.sub),l=numeric.dot,u=(numeric.div,numeric.add,numeric.rep([o],0).concat([1])),c=numeric.rep([s,1],-1),h=numeric.blockMatrix([[t,c]]),d=n,p=numeric.rep([o],0).concat(Math.max(0,numeric.sup(numeric.neg(n)))+1),f=numeric.__solveLP(u,h,d,i,r,p,!1),m=numeric.clone(f.solution);m.length=o;var g=numeric.inf(a(n,l(t,m)));if(g<0)return{solution:NaN,message:"Infeasible",iterations:f.iterations};var v=numeric.__solveLP(e,t,n,i,r-f.iterations,m,!0);return v.iterations+=f.iterations,v},numeric.solveLP=function(e,t,n,i,r,o,s){if("undefined"===typeof s&&(s=1e3),"undefined"===typeof o&&(o=numeric.epsilon),"undefined"===typeof i)return numeric._solveLP(e,t,n,o,s);var a,l=i.length,u=i[0].length,c=t.length,h=numeric.echelonize(i),d=numeric.rep([u],0),p=h.P,f=[];for(a=p.length-1;-1!==a;--a)d[p[a]]=1;for(a=u-1;-1!==a;--a)0===d[a]&&f.push(a);var m=numeric.getRange,g=numeric.linspace(0,l-1),v=numeric.linspace(0,c-1),y=m(i,g,f),x=m(t,v,p),b=m(t,v,f),w=numeric.dot,_=numeric.sub,A=w(x,h.I),S=_(b,w(A,y)),E=_(n,w(A,r)),M=Array(p.length),T=Array(f.length);for(a=p.length-1;-1!==a;--a)M[a]=e[p[a]];for(a=f.length-1;-1!==a;--a)T[a]=e[f[a]];var C=_(T,w(M,w(h.I,y))),P=numeric._solveLP(C,S,E,o,s),R=P.solution;if(R!==R)return P;var L=w(h.I,_(r,w(y,R))),O=Array(e.length);for(a=p.length-1;-1!==a;--a)O[p[a]]=L[a];for(a=f.length-1;-1!==a;--a)O[f[a]]=R[a];return{solution:O,message:P.message,iterations:P.iterations}},numeric.MPStoLP=function(e){e instanceof String&&e.split("\n");var t,n,i,r,o=0,s=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],a=e.length,l=0,u={},c=[],h=0,d={},p=0,f=[],m=[],g=[];function v(n){throw new Error("MPStoLP: "+n+"\nLine "+t+": "+e[t]+"\nCurrent state: "+s[o]+"\n")}for(t=0;t<a;++t){i=e[t];var y=i.match(/\S*/g),x=[];for(n=0;n<y.length;++n)""!==y[n]&&x.push(y[n]);if(0!==x.length){for(n=0;n<s.length;++n)if(i.substr(0,s[n].length)===s[n])break;if(n<s.length){if(o=n,1===n&&(r=x[1]),6===n)return{name:r,c:f,A:numeric.transpose(m),b:g,rows:u,vars:d}}else switch(o){case 0:case 1:v("Unexpected line");case 2:switch(x[0]){case"N":0===l?l=x[1]:v("Two or more N rows");break;case"L":u[x[1]]=h,c[h]=1,g[h]=0,++h;break;case"G":u[x[1]]=h,c[h]=-1,g[h]=0,++h;break;case"E":u[x[1]]=h,c[h]=0,g[h]=0,++h;break;default:v("Parse error "+numeric.prettyPrint(x))}break;case 3:d.hasOwnProperty(x[0])||(d[x[0]]=p,f[p]=0,m[p]=numeric.rep([h],0),++p);var b=d[x[0]];for(n=1;n<x.length;n+=2)if(x[n]!==l){var w=u[x[n]];m[b][w]=(c[w]<0?-1:1)*parseFloat(x[n+1])}else f[b]=parseFloat(x[n+1]);break;case 4:for(n=1;n<x.length;n+=2)g[u[x[n]]]=(c[u[x[n]]]<0?-1:1)*parseFloat(x[n+1]);break;case 5:break;case 6:v("Internal error")}}}v("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(e,t,n,i,r,o,s){function a(e){var t,i,r=this,o=e.length,s=0,a=r.i=r.j=r.m=0;r.S=[],r.c=[],o||(e=[o++]);while(s<n)r.S[s]=s++;for(s=0;s<n;s++)t=r.S[s],a=c(a+t+e[s%o]),i=r.S[a],r.S[s]=i,r.S[a]=t;r.g=function(e){var t=r.S,i=c(r.i+1),o=t[i],s=c(r.j+o),a=t[s];t[i]=a,t[s]=o;var l=t[c(o+a)];while(--e)i=c(i+1),o=t[i],s=c(s+o),a=t[s],t[i]=a,t[s]=o,l=l*n+t[c(o+a)];return r.i=i,r.j=s,l},r.g(n)}function l(e,t,n,i,r){if(n=[],r=typeof e,t&&"object"==r)for(i in e)if(i.indexOf("S")<5)try{n.push(l(e[i],t-1))}catch(o){}return n.length?n:e+("string"!=r?"\0":"")}function u(e,t,n,i){for(e+="",n=0,i=0;i<e.length;i++)t[c(i)]=c((n^=19*t[c(i)])+e.charCodeAt(i));for(i in e="",t)e+=String.fromCharCode(t[i]);return e}function c(e){return e&n-1}t["seedrandom"]=function(c,h){var d,p=[];return c=u(l(h?[c,e]:arguments.length?c:[(new Date).getTime(),e,window],3),p),d=new a(p),u(d.S,e),t["random"]=function(){var e=d.g(i),t=s,a=0;while(e<r)e=(e+a)*n,t*=n,a=d.g(1);while(e>=o)e/=2,t/=2,a>>>=1;return(e+a)/t},c},s=t.pow(n,i),r=t.pow(2,r),o=2*r,u(t.random(),e)}([],numeric.seedrandom,256,6,52),function(e){function t(e){if("object"!==typeof e)return e;var n,i=[],r=e.length;for(n=0;n<r;n++)i[n+1]=t(e[n]);return i}function n(e){if("object"!==typeof e)return e;var t,i=[],r=e.length;for(t=1;t<r;t++)i[t-1]=n(e[t]);return i}function i(e,t,n){var i,r,o,s,a;for(o=1;o<=n;o+=1){for(e[o][o]=1/e[o][o],a=-e[o][o],i=1;i<o;i+=1)e[i][o]=a*e[i][o];if(s=o+1,n<s)break;for(r=s;r<=n;r+=1)for(a=e[o][r],e[o][r]=0,i=1;i<=o;i+=1)e[i][r]=e[i][r]+a*e[i][o]}}function r(e,t,n,i){var r,o,s,a;for(o=1;o<=n;o+=1){for(a=0,r=1;r<o;r+=1)a+=e[r][o]*i[r];i[o]=(i[o]-a)/e[o][o]}for(s=1;s<=n;s+=1)for(o=n+1-s,i[o]=i[o]/e[o][o],a=-i[o],r=1;r<o;r+=1)i[r]=i[r]+a*e[r][o]}function o(e,t,n,i){var r,o,s,a,l,u;for(o=1;o<=n;o+=1){if(i[1]=o,u=0,s=o-1,s<1){if(u=e[o][o]-u,u<=0)break;e[o][o]=Math.sqrt(u)}else{for(a=1;a<=s;a+=1){for(l=e[a][o],r=1;r<a;r+=1)l-=e[r][o]*e[r][a];l/=e[a][a],e[a][o]=l,u+=l*l}if(u=e[o][o]-u,u<=0)break;e[o][o]=Math.sqrt(u)}i[1]=0}}function s(e,t,n,s,a,l,u,c,h,d,p,f,m,g,v,y){var x,b,w,_,A,S,E,M,T,C,P,R,L,O,D,I,N,k,V,U,F,z,j,B,$,H,G;L=Math.min(s,d),w=2*s+L*(L+5)/2+2*d+1,B=1e-60;do{B+=B,$=1+.1*B,H=1+.2*B}while($<=1||H<=1);for(x=1;x<=s;x+=1)v[x]=t[x];for(x=s+1;x<=w;x+=1)v[x]=0;for(x=1;x<=d;x+=1)f[x]=0;if(A=[],0===y[1]){if(o(e,n,s,A),0!==A[1])return void(y[1]=2);r(e,n,s,t),i(e,n,s)}else{for(b=1;b<=s;b+=1)for(a[b]=0,x=1;x<=b;x+=1)a[b]=a[b]+e[x][b]*t[x];for(b=1;b<=s;b+=1)for(t[b]=0,x=b;x<=s;x+=1)t[b]=t[b]+e[b][x]*a[x]}for(l[1]=0,b=1;b<=s;b+=1)for(a[b]=t[b],l[1]=l[1]+v[b]*a[b],v[b]=0,x=b+1;x<=s;x+=1)e[x][b]=0;for(l[1]=-l[1]/2,y[1]=0,E=s,M=E+s,P=M+L,T=P+L+1,C=T+L*(L+1)/2,O=C+d,x=1;x<=d;x+=1){for(I=0,b=1;b<=s;b+=1)I+=u[b][x]*u[b][x];v[O+x]=Math.sqrt(I)}function W(){for(g[1]=g[1]+1,w=C,x=1;x<=d;x+=1){for(w+=1,I=-c[x],b=1;b<=s;b+=1)I+=u[b][x]*a[b];if(Math.abs(I)<B&&(I=0),x>p)v[w]=I;else if(v[w]=-Math.abs(I),I>0){for(b=1;b<=s;b+=1)u[b][x]=-u[b][x];c[x]=-c[x]}}for(x=1;x<=m;x+=1)v[C+f[x]]=0;for(R=0,D=0,x=1;x<=d;x+=1)v[C+x]<D*v[O+x]&&(R=x,D=v[C+x]/v[O+x]);return 0===R?999:0}function q(){for(x=1;x<=s;x+=1){for(I=0,b=1;b<=s;b+=1)I+=e[b][x]*u[b][R];v[x]=I}for(_=E,x=1;x<=s;x+=1)v[_+x]=0;for(b=m+1;b<=s;b+=1)for(x=1;x<=s;x+=1)v[_+x]=v[_+x]+e[x][b]*v[b];for(z=!0,x=m;x>=1;x-=1){for(I=v[x],w=T+x*(x+3)/2,_=w-x,b=x+1;b<=m;b+=1)I-=v[w]*v[M+b],w+=b;if(I/=v[_],v[M+x]=I,f[x]<p)break;if(I<0)break;z=!1,S=x}if(!z)for(N=v[P+S]/v[M+S],x=1;x<=m;x+=1){if(f[x]<p)break;if(v[M+x]<0)break;D=v[P+x]/v[M+x],D<N&&(N=D,S=x)}for(I=0,x=E+1;x<=E+s;x+=1)I+=v[x]*v[x];if(Math.abs(I)<=B){if(z)return y[1]=1,999;for(x=1;x<=m;x+=1)v[P+x]=v[P+x]-N*v[M+x];return v[P+m+1]=v[P+m+1]+N,700}for(I=0,x=1;x<=s;x+=1)I+=v[E+x]*u[x][R];for(k=-v[C+R]/I,j=!0,z||N<k&&(k=N,j=!1),x=1;x<=s;x+=1)a[x]=a[x]+k*v[E+x],Math.abs(a[x])<B&&(a[x]=0);for(l[1]=l[1]+k*I*(k/2+v[P+m+1]),x=1;x<=m;x+=1)v[P+x]=v[P+x]-k*v[M+x];if(v[P+m+1]=v[P+m+1]+k,!j){for(I=-c[R],b=1;b<=s;b+=1)I+=a[b]*u[b][R];if(R>p)v[C+R]=I;else if(v[C+R]=-Math.abs(I),I>0){for(b=1;b<=s;b+=1)u[b][R]=-u[b][R];c[R]=-c[R]}return 700}for(m+=1,f[m]=R,w=T+(m-1)*m/2+1,x=1;x<=m-1;x+=1)v[w]=v[x],w+=1;if(m===s)v[w]=v[s];else{for(x=s;x>=m+1;x-=1){if(0===v[x])break;if(V=Math.max(Math.abs(v[x-1]),Math.abs(v[x])),U=Math.min(Math.abs(v[x-1]),Math.abs(v[x])),D=v[x-1]>=0?Math.abs(V*Math.sqrt(1+U*U/(V*V))):-Math.abs(V*Math.sqrt(1+U*U/(V*V))),V=v[x-1]/D,U=v[x]/D,1===V)break;if(0===V)for(v[x-1]=U*D,b=1;b<=s;b+=1)D=e[b][x-1],e[b][x-1]=e[b][x],e[b][x]=D;else for(v[x-1]=D,F=U/(1+V),b=1;b<=s;b+=1)D=V*e[b][x-1]+U*e[b][x],e[b][x]=F*(e[b][x-1]+D)-e[b][x],e[b][x-1]=D}v[w]=v[m]}return 0}function Y(){if(w=T+S*(S+1)/2+1,_=w+S,0===v[_])return 798;if(V=Math.max(Math.abs(v[_-1]),Math.abs(v[_])),U=Math.min(Math.abs(v[_-1]),Math.abs(v[_])),D=v[_-1]>=0?Math.abs(V*Math.sqrt(1+U*U/(V*V))):-Math.abs(V*Math.sqrt(1+U*U/(V*V))),V=v[_-1]/D,U=v[_]/D,1===V)return 798;if(0===V){for(x=S+1;x<=m;x+=1)D=v[_-1],v[_-1]=v[_],v[_]=D,_+=x;for(x=1;x<=s;x+=1)D=e[x][S],e[x][S]=e[x][S+1],e[x][S+1]=D}else{for(F=U/(1+V),x=S+1;x<=m;x+=1)D=V*v[_-1]+U*v[_],v[_]=F*(v[_-1]+D)-v[_],v[_-1]=D,_+=x;for(x=1;x<=s;x+=1)D=V*e[x][S]+U*e[x][S+1],e[x][S+1]=F*(e[x][S]+D)-e[x][S+1],e[x][S]=D}return 0}function X(){for(_=w-S,x=1;x<=S;x+=1)v[_]=v[w],w+=1,_+=1;return v[P+S]=v[P+S+1],f[S]=f[S+1],S+=1,S<m?797:0}function Z(){return v[P+m]=v[P+m+1],v[P+m+1]=0,f[m]=0,m-=1,g[2]=g[2]+1,0}m=0,g[1]=0,g[2]=0,G=0;while(1){if(G=W(),999===G)return;while(1){if(G=q(),0===G)break;if(999===G)return;if(700===G)if(S===m)Z();else{while(1)if(Y(),G=X(),797!==G)break;Z()}}}}function a(e,i,r,o,a,l){e=t(e),i=t(i),r=t(r);var u,c,h,d,p,f,m=[],g=[],v=[],y=[],x=[];if(a=a||0,l=l?t(l):[void 0,0],o=o?t(o):[],c=e.length-1,h=r[1].length-1,!o)for(u=1;u<=h;u+=1)o[u]=0;for(u=1;u<=h;u+=1)g[u]=0;for(d=0,p=Math.min(c,h),u=1;u<=c;u+=1)v[u]=0;for(m[1]=0,u=1;u<=2*c+p*(p+5)/2+2*h+1;u+=1)y[u]=0;for(u=1;u<=2;u+=1)x[u]=0;return s(e,i,c,c,v,m,r,o,c,h,a,g,d,x,y,l),f="",1===l[1]&&(f="constraints are inconsistent, no solution!"),2===l[1]&&(f="matrix D in quadratic function is not positive definite!"),{solution:n(v),value:n(m),unconstrained_solution:n(i),iterations:n(x),iact:n(g),message:f}}e.solveQP=a}(numeric),numeric.svd=function(e){var t,n=numeric.epsilon,i=1e-64/n,r=50,o=0,s=0,a=0,l=0,u=0,c=numeric.clone(e),h=c.length,d=c[0].length;if(h<d)throw"Need more rows than columns";var p=new Array(d),f=new Array(d);for(s=0;s<d;s++)p[s]=f[s]=0;var m=numeric.rep([d,d],0);function g(e,t){return e=Math.abs(e),t=Math.abs(t),e>t?e*Math.sqrt(1+t*t/e/e):0==t?e:t*Math.sqrt(1+e*e/t/t)}var v=0,y=0,x=0,b=0,w=0,_=0,A=0;for(s=0;s<d;s++){for(p[s]=y,A=0,u=s+1,a=s;a<h;a++)A+=c[a][s]*c[a][s];if(A<=i)y=0;else for(v=c[s][s],y=Math.sqrt(A),v>=0&&(y=-y),x=v*y-A,c[s][s]=v-y,a=u;a<d;a++){for(A=0,l=s;l<h;l++)A+=c[l][s]*c[l][a];for(v=A/x,l=s;l<h;l++)c[l][a]+=v*c[l][s]}for(f[s]=y,A=0,a=u;a<d;a++)A+=c[s][a]*c[s][a];if(A<=i)y=0;else{for(v=c[s][s+1],y=Math.sqrt(A),v>=0&&(y=-y),x=v*y-A,c[s][s+1]=v-y,a=u;a<d;a++)p[a]=c[s][a]/x;for(a=u;a<h;a++){for(A=0,l=u;l<d;l++)A+=c[a][l]*c[s][l];for(l=u;l<d;l++)c[a][l]+=A*p[l]}}w=Math.abs(f[s])+Math.abs(p[s]),w>b&&(b=w)}for(s=d-1;-1!=s;s+=-1){if(0!=y){for(x=y*c[s][s+1],a=u;a<d;a++)m[a][s]=c[s][a]/x;for(a=u;a<d;a++){for(A=0,l=u;l<d;l++)A+=c[s][l]*m[l][a];for(l=u;l<d;l++)m[l][a]+=A*m[l][s]}}for(a=u;a<d;a++)m[s][a]=0,m[a][s]=0;m[s][s]=1,y=p[s],u=s}for(s=d-1;-1!=s;s+=-1){for(u=s+1,y=f[s],a=u;a<d;a++)c[s][a]=0;if(0!=y){for(x=c[s][s]*y,a=u;a<d;a++){for(A=0,l=u;l<h;l++)A+=c[l][s]*c[l][a];for(v=A/x,l=s;l<h;l++)c[l][a]+=v*c[l][s]}for(a=s;a<h;a++)c[a][s]=c[a][s]/y}else for(a=s;a<h;a++)c[a][s]=0;c[s][s]+=1}for(n*=b,l=d-1;-1!=l;l+=-1)for(var S=0;S<r;S++){var E=!1;for(u=l;-1!=u;u+=-1){if(Math.abs(p[u])<=n){E=!0;break}if(Math.abs(f[u-1])<=n)break}if(!E){o=0,A=1;var M=u-1;for(s=u;s<l+1;s++){if(v=A*p[s],p[s]=o*p[s],Math.abs(v)<=n)break;for(y=f[s],x=g(v,y),f[s]=x,o=y/x,A=-v/x,a=0;a<h;a++)w=c[a][M],_=c[a][s],c[a][M]=w*o+_*A,c[a][s]=-w*A+_*o}}if(_=f[l],u==l){if(_<0)for(f[l]=-_,a=0;a<d;a++)m[a][l]=-m[a][l];break}if(S>=r-1)throw"Error: no convergence.";for(b=f[u],w=f[l-1],y=p[l-1],x=p[l],v=((w-_)*(w+_)+(y-x)*(y+x))/(2*x*w),y=g(v,1),v=v<0?((b-_)*(b+_)+x*(w/(v-y)-x))/b:((b-_)*(b+_)+x*(w/(v+y)-x))/b,o=1,A=1,s=u+1;s<l+1;s++){for(y=p[s],w=f[s],x=A*y,y*=o,_=g(v,x),p[s-1]=_,o=v/_,A=x/_,v=b*o+y*A,y=-b*A+y*o,x=w*A,w*=o,a=0;a<d;a++)b=m[a][s-1],_=m[a][s],m[a][s-1]=b*o+_*A,m[a][s]=-b*A+_*o;for(_=g(v,x),f[s-1]=_,o=v/_,A=x/_,v=o*y+A*w,b=-A*y+o*w,a=0;a<h;a++)w=c[a][s-1],_=c[a][s],c[a][s-1]=w*o+_*A,c[a][s]=-w*A+_*o}p[u]=0,p[l]=v,f[l]=b}for(s=0;s<f.length;s++)f[s]<n&&(f[s]=0);for(s=0;s<d;s++)for(a=s-1;a>=0;a--)if(f[a]<f[s]){for(o=f[a],f[a]=f[s],f[s]=o,l=0;l<c.length;l++)t=c[l][s],c[l][s]=c[l][a],c[l][a]=t;for(l=0;l<m.length;l++)t=m[l][s],m[l][s]=m[l][a],m[l][a]=t;s=a}return{U:c,S:f,V:m}}}).call(this,__webpack_require__("c8ba"))},cb29:function(e,t,n){var i=n("23e7"),r=n("81d5"),o=n("44d2");i({target:"Array",proto:!0},{fill:r}),o("fill")},cd26:function(e,t,n){"use strict";var i=n("ebb5"),r=i.aTypedArray,o=i.exportTypedArrayMethod,s=Math.floor;o("reverse",(function(){var e,t=this,n=r(t).length,i=s(n/2),o=0;while(o<i)e=t[o],t[o++]=t[--n],t[n]=e;return t}))},cddc:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.callRef=t.getValidate=void 0;const i=n("ed2c"),r=n("4c26"),o=n("96ab"),s=n("a3a3"),a=n("4a69"),l=n("417a"),u={keyword:"$ref",schemaType:"string",code(e){const{gen:t,schema:n,it:r}=e,{baseId:s,schemaEnv:l,validateName:u,opts:d,self:p}=r,{root:f}=l;if(("#"===n||"#/"===n)&&s===f.baseId)return g();const m=a.resolveRef.call(p,f,s,n);if(void 0===m)throw new i.default(s,n);return m instanceof a.SchemaEnv?v(m):y(m);function g(){if(l===f)return h(e,u,l,l.$async);const n=t.scopeValue("root",{ref:f});return h(e,o._`${n}.validate`,f,f.$async)}function v(t){const n=c(e,t);h(e,n,t,t.$async)}function y(i){const r=t.scopeValue("schema",!0===d.code.source?{ref:i,code:o.stringify(i)}:{ref:i}),s=t.name("valid"),a=e.subschema({schema:i,dataTypes:[],schemaPath:o.nil,topSchemaRef:r,errSchemaPath:n},s);e.mergeEvaluated(a),e.ok(s)}}};function c(e,t){const{gen:n}=e;return t.validate?n.scopeValue("validate",{ref:t.validate}):o._`${n.scopeValue("wrapper",{ref:t})}.validate`}function h(e,t,n,i){const{gen:a,it:u}=e,{allErrors:c,schemaEnv:h,opts:d}=u,p=d.passContext?s.default.this:o.nil;function f(){if(!h.$async)throw new Error("async schema referenced by sync schema");const n=a.let("valid");a.try(()=>{a.code(o._`await ${r.callValidateCode(e,t,p)}`),v(t),c||a.assign(n,!0)},e=>{a.if(o._`!(${e} instanceof ${u.ValidationError})`,()=>a.throw(e)),g(e),c||a.assign(n,!1)}),e.ok(n)}function m(){e.result(r.callValidateCode(e,t,p),()=>v(t),()=>g(t))}function g(e){const t=o._`${e}.errors`;a.assign(s.default.vErrors,o._`${s.default.vErrors} === null ? ${t} : ${s.default.vErrors}.concat(${t})`),a.assign(s.default.errors,o._`${s.default.vErrors}.length`)}function v(e){var t;if(!u.opts.unevaluated)return;const i=null===(t=null===n||void 0===n?void 0:n.validate)||void 0===t?void 0:t.evaluated;if(!0!==u.props)if(i&&!i.dynamicProps)void 0!==i.props&&(u.props=l.mergeEvaluated.props(a,i.props,u.props));else{const t=a.var("props",o._`${e}.evaluated.props`);u.props=l.mergeEvaluated.props(a,t,u.props,o.Name)}if(!0!==u.items)if(i&&!i.dynamicItems)void 0!==i.items&&(u.items=l.mergeEvaluated.items(a,i.items,u.items));else{const t=a.var("items",o._`${e}.evaluated.items`);u.items=l.mergeEvaluated.items(a,t,u.items,o.Name)}}i?f():m()}t.getValidate=c,t.callRef=h,t.default=u},cf9b:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=void 0;var i=n("2b0b");Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return i.KeywordCxt}});var r=n("96ab");Object.defineProperty(t,"_",{enumerable:!0,get:function(){return r._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return r.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return r.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return r.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return r.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return r.CodeGen}});const o=n("6267"),s=n("ed2c"),a=n("a816"),l=n("4a69"),u=n("96ab"),c=n("a98d"),h=n("6292"),d=n("417a"),p=n("f640"),f=["removeAdditional","useDefaults","coerceTypes"],m=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),g={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},v={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},y=200;function x(e){var t,n,i,r,o,s,a,l,u,c,h,d,p,f,m,g,v,x,b,w,_,A;const S=e.strict,E=null===(t=e.code)||void 0===t?void 0:t.optimize,M=!0===E||void 0===E?1:E||0;return{strictSchema:null===(i=null!==(n=e.strictSchema)&&void 0!==n?n:S)||void 0===i||i,strictNumbers:null===(o=null!==(r=e.strictNumbers)&&void 0!==r?r:S)||void 0===o||o,strictTypes:null!==(a=null!==(s=e.strictTypes)&&void 0!==s?s:S)&&void 0!==a?a:"log",strictTuples:null!==(u=null!==(l=e.strictTuples)&&void 0!==l?l:S)&&void 0!==u?u:"log",strictRequired:null!==(h=null!==(c=e.strictRequired)&&void 0!==c?c:S)&&void 0!==h&&h,code:e.code?{...e.code,optimize:M}:{optimize:M},loopRequired:null!==(d=e.loopRequired)&&void 0!==d?d:y,loopEnum:null!==(p=e.loopEnum)&&void 0!==p?p:y,meta:null===(f=e.meta)||void 0===f||f,messages:null===(m=e.messages)||void 0===m||m,inlineRefs:null===(g=e.inlineRefs)||void 0===g||g,schemaId:null!==(v=e.schemaId)&&void 0!==v?v:"$id",addUsedSchema:null===(x=e.addUsedSchema)||void 0===x||x,validateSchema:null===(b=e.validateSchema)||void 0===b||b,validateFormats:null===(w=e.validateFormats)||void 0===w||w,unicodeRegExp:null===(_=e.unicodeRegExp)||void 0===_||_,int32range:null===(A=e.int32range)||void 0===A||A}}class b{constructor(e={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,e=this.opts={...e,...x(e)};const{es5:t,lines:n}=this.opts.code;this.scope=new u.ValueScope({scope:{},prefixes:m,es5:t,lines:n}),this.logger=C(e.logger);const i=e.validateFormats;e.validateFormats=!1,this.RULES=a.getRules(),w.call(this,g,e,"NOT SUPPORTED"),w.call(this,v,e,"DEPRECATED","warn"),this._metaOpts=M.call(this),e.formats&&S.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),e.keywords&&E.call(this,e.keywords),"object"==typeof e.meta&&this.addMetaSchema(e.meta),A.call(this),e.validateFormats=i}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:e,meta:t,schemaId:n}=this.opts;let i=p;"id"===n&&(i={...p},i.id=i.$id,delete i.$id),t&&e&&this.addMetaSchema(i,i[n],!1)}defaultMeta(){const{meta:e,schemaId:t}=this.opts;return this.opts.defaultMeta="object"==typeof e?e[t]||e:void 0}validate(e,t){let n;if("string"==typeof e){if(n=this.getSchema(e),!n)throw new Error(`no schema with key or ref "${e}"`)}else n=this.compile(e);const i=n(t);return"$async"in n||(this.errors=n.errors),i}compile(e,t){const n=this._addSchema(e,t);return n.validate||this._compileSchemaEnv(n)}compileAsync(e,t){if("function"!=typeof this.opts.loadSchema)throw new Error("options.loadSchema should be a function");const{loadSchema:n}=this.opts;return i.call(this,e,t);async function i(e,t){await r.call(this,e.$schema);const n=this._addSchema(e,t);return n.validate||o.call(this,n)}async function r(e){e&&!this.getSchema(e)&&await i.call(this,{$ref:e},!0)}async function o(e){try{return this._compileSchemaEnv(e)}catch(t){if(!(t instanceof s.default))throw t;return a.call(this,t),await l.call(this,t.missingSchema),o.call(this,e)}}function a({missingSchema:e,missingRef:t}){if(this.refs[e])throw new Error(`AnySchema ${e} is loaded but ${t} cannot be resolved`)}async function l(e){const n=await u.call(this,e);this.refs[e]||await r.call(this,n.$schema),this.refs[e]||this.addSchema(n,e,t)}async function u(e){const t=this._loading[e];if(t)return t;try{return await(this._loading[e]=n(e))}finally{delete this._loading[e]}}}addSchema(e,t,n,i=this.opts.validateSchema){if(Array.isArray(e)){for(const t of e)this.addSchema(t,void 0,n,i);return this}let r;if("object"===typeof e){const{schemaId:t}=this.opts;if(r=e[t],void 0!==r&&"string"!=typeof r)throw new Error(`schema ${t} must be string`)}return t=c.normalizeId(t||r),this._checkUnique(t),this.schemas[t]=this._addSchema(e,n,t,i,!0),this}addMetaSchema(e,t,n=this.opts.validateSchema){return this.addSchema(e,t,!0,n),this}validateSchema(e,t){if("boolean"==typeof e)return!0;let n;if(n=e.$schema,void 0!==n&&"string"!=typeof n)throw new Error("$schema must be a string");if(n=n||this.opts.defaultMeta||this.defaultMeta(),!n)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const i=this.validate(n,e);if(!i&&t){const e="schema is invalid: "+this.errorsText();if("log"!==this.opts.validateSchema)throw new Error(e);this.logger.error(e)}return i}getSchema(e){let t;while("string"==typeof(t=_.call(this,e)))e=t;if(void 0===t){const{schemaId:n}=this.opts,i=new l.SchemaEnv({schema:{},schemaId:n});if(t=l.resolveSchema.call(this,i,e),!t)return;this.refs[e]=t}return t.validate||this._compileSchemaEnv(t)}removeSchema(e){if(e instanceof RegExp)return this._removeAllSchemas(this.schemas,e),this._removeAllSchemas(this.refs,e),this;switch(typeof e){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const t=_.call(this,e);return"object"==typeof t&&this._cache.delete(t.schema),delete this.schemas[e],delete this.refs[e],this}case"object":{const t=e;this._cache.delete(t);let n=e[this.opts.schemaId];return n&&(n=c.normalizeId(n),delete this.schemas[n],delete this.refs[n]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(e){for(const t of e)this.addKeyword(t);return this}addKeyword(e,t){let n;if("string"==typeof e)n=e,"object"==typeof t&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),t.keyword=n);else{if("object"!=typeof e||void 0!==t)throw new Error("invalid addKeywords parameters");if(t=e,n=t.keyword,Array.isArray(n)&&!n.length)throw new Error("addKeywords: keyword must be string or non-empty array")}if(R.call(this,n,t),!t)return d.eachItem(n,e=>L.call(this,e)),this;D.call(this,t);const i={...t,type:h.getJSONTypes(t.type),schemaType:h.getJSONTypes(t.schemaType)};return d.eachItem(n,0===i.type.length?e=>L.call(this,e,i):e=>i.type.forEach(t=>L.call(this,e,i,t))),this}getKeyword(e){const t=this.RULES.all[e];return"object"==typeof t?t.definition:!!t}removeKeyword(e){const{RULES:t}=this;delete t.keywords[e],delete t.all[e];for(const n of t.rules){const t=n.rules.findIndex(t=>t.keyword===e);t>=0&&n.rules.splice(t,1)}return this}addFormat(e,t){return"string"==typeof t&&(t=new RegExp(t)),this.formats[e]=t,this}errorsText(e=this.errors,{separator:t=", ",dataVar:n="data"}={}){return e&&0!==e.length?e.map(e=>`${n}${e.instancePath} ${e.message}`).reduce((e,n)=>e+t+n):"No errors"}$dataMetaSchema(e,t){const n=this.RULES.all;e=JSON.parse(JSON.stringify(e));for(const i of t){const t=i.split("/").slice(1);let r=e;for(const e of t)r=r[e];for(const e in n){const t=n[e];if("object"!=typeof t)continue;const{$data:i}=t.definition,o=r[e];i&&o&&(r[e]=N(o))}}return e}_removeAllSchemas(e,t){for(const n in e){const i=e[n];t&&!t.test(n)||("string"==typeof i?delete e[n]:i&&!i.meta&&(this._cache.delete(i.schema),delete e[n]))}}_addSchema(e,t,n,i=this.opts.validateSchema,r=this.opts.addUsedSchema){let o;const{schemaId:s}=this.opts;if("object"==typeof e)o=e[s];else{if(this.opts.jtd)throw new Error("schema must be object");if("boolean"!=typeof e)throw new Error("schema must be object or boolean")}let a=this._cache.get(e);if(void 0!==a)return a;const u=c.getSchemaRefs.call(this,e);return n=c.normalizeId(o||n),a=new l.SchemaEnv({schema:e,schemaId:s,meta:t,baseId:n,localRefs:u}),this._cache.set(a.schema,a),r&&!n.startsWith("#")&&(n&&this._checkUnique(n),this.refs[n]=a),i&&this.validateSchema(e,!0),a}_checkUnique(e){if(this.schemas[e]||this.refs[e])throw new Error(`schema with key or id "${e}" already exists`)}_compileSchemaEnv(e){if(e.meta?this._compileMetaSchema(e):l.compileSchema.call(this,e),!e.validate)throw new Error("ajv implementation error");return e.validate}_compileMetaSchema(e){const t=this.opts;this.opts=this._metaOpts;try{l.compileSchema.call(this,e)}finally{this.opts=t}}}function w(e,t,n,i="error"){for(const r in e){const o=r;o in t&&this.logger[i](`${n}: option ${r}. ${e[o]}`)}}function _(e){return e=c.normalizeId(e),this.schemas[e]||this.refs[e]}function A(){const e=this.opts.schemas;if(e)if(Array.isArray(e))this.addSchema(e);else for(const t in e)this.addSchema(e[t],t)}function S(){for(const e in this.opts.formats){const t=this.opts.formats[e];t&&this.addFormat(e,t)}}function E(e){if(Array.isArray(e))this.addVocabulary(e);else{this.logger.warn("keywords option as map is deprecated, pass array");for(const t in e){const n=e[t];n.keyword||(n.keyword=t),this.addKeyword(n)}}}function M(){const e={...this.opts};for(const t of f)delete e[t];return e}t.default=b,b.ValidationError=o.default,b.MissingRefError=s.default;const T={log(){},warn(){},error(){}};function C(e){if(!1===e)return T;if(void 0===e)return console;if(e.log&&e.warn&&e.error)return e;throw new Error("logger must implement log, warn and error methods")}const P=/^[a-z_$][a-z0-9_$:-]*$/i;function R(e,t){const{RULES:n}=this;if(d.eachItem(e,e=>{if(n.keywords[e])throw new Error(`Keyword ${e} is already defined`);if(!P.test(e))throw new Error(`Keyword ${e} has invalid name`)}),t&&t.$data&&!("code"in t)&&!("validate"in t))throw new Error('$data keyword must have "code" or "validate" function')}function L(e,t,n){var i;const r=null===t||void 0===t?void 0:t.post;if(n&&r)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:o}=this;let s=r?o.post:o.rules.find(({type:e})=>e===n);if(s||(s={type:n,rules:[]},o.rules.push(s)),o.keywords[e]=!0,!t)return;const a={keyword:e,definition:{...t,type:h.getJSONTypes(t.type),schemaType:h.getJSONTypes(t.schemaType)}};t.before?O.call(this,s,a,t.before):s.rules.push(a),o.all[e]=a,null===(i=t.implements)||void 0===i||i.forEach(e=>this.addKeyword(e))}function O(e,t,n){const i=e.rules.findIndex(e=>e.keyword===n);i>=0?e.rules.splice(i,0,t):(e.rules.push(t),this.logger.warn(`rule ${n} is not defined`))}function D(e){let{metaSchema:t}=e;void 0!==t&&(e.$data&&this.opts.$data&&(t=N(t)),e.validateSchema=this.compile(t,!0))}const I={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function N(e){return{anyOf:[e,I]}}},d139:function(e,t,n){"use strict";var i=n("ebb5"),r=n("b727").find,o=i.aTypedArray,s=i.exportTypedArrayMethod;s("find",(function(e){return r(o(this),e,arguments.length>1?arguments[1]:void 0)}))},d4ec:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",(function(){return i}))},d58f:function(e,t,n){var i=n("1c0b"),r=n("7b0b"),o=n("44ad"),s=n("50c4"),a=function(e){return function(t,n,a,l){i(n);var u=r(t),c=o(u),h=s(u.length),d=e?h-1:0,p=e?-1:1;if(a<2)while(1){if(d in c){l=c[d],d+=p;break}if(d+=p,e?d<0:h<=d)throw TypeError("Reduce of empty array with no initial value")}for(;e?d>=0:h>d;d+=p)d in c&&(l=n(l,c[d],d,u));return l}};e.exports={left:a(!1),right:a(!0)}},d5d6:function(e,t,n){"use strict";var i=n("ebb5"),r=n("b727").forEach,o=i.aTypedArray,s=i.exportTypedArrayMethod;s("forEach",(function(e){r(o(this),e,arguments.length>1?arguments[1]:void 0)}))},d6ec:function(e,t,n){var i,r,o;
/*!
 * jQuery.scrollTo
 * Copyright (c) 2007 Ariel Flesler - aflesler ○ gmail • com | https://github.com/flesler
 * Licensed under MIT
 * https://github.com/flesler/jquery.scrollTo
 * @projectDescription Lightweight, cross-browser and highly customizable animated scrolling with jQuery
 * @author Ariel Flesler
 * @version 2.1.3
 */(function(s){"use strict";r=[n("1157")],i=s,o="function"===typeof i?i.apply(t,r):i,void 0===o||(e.exports=o)})((function(e){"use strict";var t=e.scrollTo=function(t,n,i){return e(window).scrollTo(t,n,i)};function n(t){return!t.nodeName||-1!==e.inArray(t.nodeName.toLowerCase(),["iframe","#document","html","body"])}function i(e){return"function"===typeof e}function r(t){return i(t)||e.isPlainObject(t)?t:{top:t,left:t}}return t.defaults={axis:"xy",duration:0,limit:!0},e.fn.scrollTo=function(o,s,a){"object"===typeof s&&(a=s,s=0),"function"===typeof a&&(a={onAfter:a}),"max"===o&&(o=9e9),a=e.extend({},t.defaults,a),s=s||a.duration;var l=a.queue&&a.axis.length>1;return l&&(s/=2),a.offset=r(a.offset),a.over=r(a.over),this.each((function(){if(null!==o){var u,c=n(this),h=c?this.contentWindow||window:this,d=e(h),p=o,f={};switch(typeof p){case"number":case"string":if(/^([+-]=?)?\d+(\.\d+)?(px|%)?$/.test(p)){p=r(p);break}p=c?e(p):e(p,h);case"object":if(0===p.length)return;(p.is||p.style)&&(u=(p=e(p)).offset())}var m=i(a.offset)&&a.offset(h,p)||a.offset;e.each(a.axis.split(""),(function(e,n){var i="x"===n?"Left":"Top",r=i.toLowerCase(),o="scroll"+i,s=d[o](),v=t.max(h,n);if(u)f[o]=u[r]+(c?0:s-d.offset()[r]),a.margin&&(f[o]-=parseInt(p.css("margin"+i),10)||0,f[o]-=parseInt(p.css("border"+i+"Width"),10)||0),f[o]+=m[r]||0,a.over[r]&&(f[o]+=p["x"===n?"width":"height"]()*a.over[r]);else{var y=p[r];f[o]=y.slice&&"%"===y.slice(-1)?parseFloat(y)/100*v:y}a.limit&&/^\d+$/.test(f[o])&&(f[o]=f[o]<=0?0:Math.min(f[o],v)),!e&&a.axis.length>1&&(s===f[o]?f={}:l&&(g(a.onAfterFirst),f={}))})),g(a.onAfter)}function g(t){var n=e.extend({},a,{queue:!0,duration:s,complete:t&&function(){t.call(h,p,a)}});d.animate(f,n)}}))},t.max=function(t,i){var r="x"===i?"Width":"Height",o="scroll"+r;if(!n(t))return t[o]-e(t)[r.toLowerCase()]();var s="client"+r,a=t.ownerDocument||t.document,l=a.documentElement,u=a.body;return Math.max(l[o],u[o])-Math.min(l[s],u[s])},e.Tween.propHooks.scrollLeft=e.Tween.propHooks.scrollTop={get:function(t){return e(t.elem)[t.prop]()},set:function(t){var n=this.get(t);if(t.options.interrupt&&t._last&&t._last!==n)return e(t.elem).stop();var i=Math.round(t.now);n!==i&&(e(t.elem)[t.prop](i),t._last=this.get(t))}},t}))},d8ad:function(e,t,n){"use strict";t["a"]=function(e){return function(){return e}}},dbb4:function(e,t,n){var i=n("23e7"),r=n("83ab"),o=n("56ef"),s=n("fc6a"),a=n("06cf"),l=n("8418");i({target:"Object",stat:!0,sham:!r},{getOwnPropertyDescriptors:function(e){var t,n,i=s(e),r=a.f,u=o(i),c={},h=0;while(u.length>h)n=r(i,t=u[h++]),void 0!==n&&l(c,t,n);return c}})},dfb9:function(e,t){e.exports=function(e,t){var n=0,i=t.length,r=new e(i);while(i>n)r[n]=t[n++];return r}},e099:function(e,t,n){"use strict";var i=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,a){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"===typeof e?o(s(e),(function(s){var a=encodeURIComponent(i(s))+n;return r(e[s])?o(e[s],(function(e){return a+encodeURIComponent(i(e))})).join(t):a+encodeURIComponent(i(e[s]))})).join(t):a?encodeURIComponent(i(a))+n+encodeURIComponent(i(e)):""};var r=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function o(e,t){if(e.map)return e.map(t);for(var n=[],i=0;i<e.length;i++)n.push(t(e[i],i));return n}var s=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},e439:function(e,t,n){var i=n("23e7"),r=n("d039"),o=n("fc6a"),s=n("06cf").f,a=n("83ab"),l=r((function(){s(1)})),u=!a||l;i({target:"Object",stat:!0,forced:u,sham:!a},{getOwnPropertyDescriptor:function(e,t){return s(o(e),t)}})},e58c:function(e,t,n){"use strict";var i=n("fc6a"),r=n("a691"),o=n("50c4"),s=n("a640"),a=Math.min,l=[].lastIndexOf,u=!!l&&1/[1].lastIndexOf(1,-0)<0,c=s("lastIndexOf"),h=u||!c;e.exports=h?function(e){if(u)return l.apply(this,arguments)||0;var t=i(this),n=o(t.length),s=n-1;for(arguments.length>1&&(s=a(s,r(arguments[1]))),s<0&&(s=n+s);s>=0;s--)if(s in t&&t[s]===e)return s||0;return-1}:l},e735:function(e,t){(function(){function e(e,t){try{for(var n in t)Object.defineProperty(e.prototype,n,{value:t[n],enumerable:!1})}catch(i){e.prototype=t}}function t(e){var t=-1,n=e.length,i=[];while(++t<n)i.push(e[t]);return i}function n(e){return Array.prototype.slice.call(e)}function i(){}function r(e){return e}function o(){return this}function s(){return!0}function a(e){return"function"===typeof e?e:function(){return e}}function l(e,t,n){return function(){var i=n.apply(t,arguments);return arguments.length?e:i}}function u(e){return null!=e&&!isNaN(e)}function c(e){return e.length}function h(e){return null==e}function d(e){return e.trim().replace(/\s+/g," ")}function p(e){var t=1;while(e*t%1)t*=10;return t}function f(){}function m(e){function t(){var t,i=n,r=-1,o=i.length;while(++r<o)(t=i[r].on)&&t.apply(this,arguments);return e}var n=[],r=new i;return t.on=function(t,i){var o,s=r.get(t);return arguments.length<2?s&&s.on:(s&&(s.on=null,n=n.slice(0,o=n.indexOf(s)).concat(n.slice(o+1)),r.remove(t)),i&&n.push(r.set(t,{on:i})),e)},t}function g(e,t){return t-(e?1+Math.floor(Math.log(e+Math.pow(10,1+Math.floor(Math.log(e)/Math.LN10)-t))/Math.LN10):1)}function v(e){return e+""}function y(e){var t=e.lastIndexOf("."),n=t>=0?e.substring(t):(t=e.length,""),i=[];while(t>0)i.push(e.substring(t-=3,t+3));return i.reverse().join(",")+n}function x(e,t){var n=Math.pow(10,3*Math.abs(8-t));return{scale:t>8?function(e){return e/n}:function(e){return e*n},symbol:e}}function b(e){return function(t){return t<=0?0:t>=1?1:e(t)}}function w(e){return function(t){return 1-e(1-t)}}function _(e){return function(t){return.5*(t<.5?e(2*t):2-e(2-2*t))}}function A(e){return e}function S(e){return function(t){return Math.pow(t,e)}}function E(e){return 1-Math.cos(e*Math.PI/2)}function M(e){return Math.pow(2,10*(e-1))}function T(e){return 1-Math.sqrt(1-e*e)}function C(e,t){var n;return arguments.length<2&&(t=.45),arguments.length<1?(e=1,n=t/4):n=t/(2*Math.PI)*Math.asin(1/e),function(i){return 1+e*Math.pow(2,10*-i)*Math.sin(2*(i-n)*Math.PI/t)}}function P(e){return e||(e=1.70158),function(t){return t*t*((e+1)*t-e)}}function R(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}function L(){d3.event.stopPropagation(),d3.event.preventDefault()}function O(){var e,t=d3.event;while(e=t.sourceEvent)t=e;return t}function D(e){var t=new f,n=0,i=arguments.length;while(++n<i)t[arguments[n]]=m(t);return t.of=function(n,i){return function(r){try{var o=r.sourceEvent=d3.event;r.target=e,d3.event=r,t[r.type].apply(n,i)}finally{d3.event=o}}},t}function I(e){var t=[e.a,e.b],n=[e.c,e.d],i=k(t),r=N(t,n),o=k(V(n,t,-r))||0;t[0]*n[1]<n[0]*t[1]&&(t[0]*=-1,t[1]*=-1,i*=-1,r*=-1),this.rotate=(i?Math.atan2(t[1],t[0]):Math.atan2(-n[0],n[1]))*or,this.translate=[e.e,e.f],this.scale=[i,o],this.skew=o?Math.atan2(r,o)*or:0}function N(e,t){return e[0]*t[0]+e[1]*t[1]}function k(e){var t=Math.sqrt(N(e,e));return t&&(e[0]/=t,e[1]/=t),t}function V(e,t,n){return e[0]+=n*t[0],e[1]+=n*t[1],e}function U(e){return"transform"==e?d3.interpolateTransform:d3.interpolate}function F(e,t){return t=t-(e=+e)?1/(t-e):0,function(n){return(n-e)*t}}function z(e,t){return t=t-(e=+e)?1/(t-e):0,function(n){return Math.max(0,Math.min(1,(n-e)*t))}}function j(){}function B(e,t,n){return new $(e,t,n)}function $(e,t,n){this.r=e,this.g=t,this.b=n}function H(e){return e<16?"0"+Math.max(0,e).toString(16):Math.min(255,e).toString(16)}function G(e,t,n){var i,r,o,s=0,a=0,l=0;if(i=/([a-z]+)\((.*)\)/i.exec(e),i)switch(r=i[2].split(","),i[1]){case"hsl":return n(parseFloat(r[0]),parseFloat(r[1])/100,parseFloat(r[2])/100);case"rgb":return t(X(r[0]),X(r[1]),X(r[2]))}return(o=ur.get(e))?t(o.r,o.g,o.b):(null!=e&&"#"===e.charAt(0)&&(4===e.length?(s=e.charAt(1),s+=s,a=e.charAt(2),a+=a,l=e.charAt(3),l+=l):7===e.length&&(s=e.substring(1,3),a=e.substring(3,5),l=e.substring(5,7)),s=parseInt(s,16),a=parseInt(a,16),l=parseInt(l,16)),t(s,a,l))}function W(e,t,n){var i,r,o=Math.min(e/=255,t/=255,n/=255),s=Math.max(e,t,n),a=s-o,l=(s+o)/2;return a?(r=l<.5?a/(s+o):a/(2-s-o),i=e==s?(t-n)/a+(t<n?6:0):t==s?(n-e)/a+2:(e-t)/a+4,i*=60):r=i=0,Z(i,r,l)}function q(e,t,n){e=Y(e),t=Y(t),n=Y(n);var i=ae((.4124564*e+.3575761*t+.1804375*n)/pr),r=ae((.2126729*e+.7151522*t+.072175*n)/fr),o=ae((.0193339*e+.119192*t+.9503041*n)/mr);return ne(116*r-16,500*(i-r),200*(r-o))}function Y(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function X(e){var t=parseFloat(e);return"%"===e.charAt(e.length-1)?Math.round(2.55*t):t}function Z(e,t,n){return new J(e,t,n)}function J(e,t,n){this.h=e,this.s=t,this.l=n}function K(e,t,n){function i(e){return e>360?e-=360:e<0&&(e+=360),e<60?o+(s-o)*e/60:e<180?s:e<240?o+(s-o)*(240-e)/60:o}function r(e){return Math.round(255*i(e))}var o,s;return e%=360,e<0&&(e+=360),t=t<0?0:t>1?1:t,n=n<0?0:n>1?1:n,s=n<=.5?n*(1+t):n+t-n*t,o=2*n-s,B(r(e+120),r(e),r(e-120))}function Q(e,t,n){return new ee(e,t,n)}function ee(e,t,n){this.h=e,this.c=t,this.l=n}function te(e,t,n){return ne(n,Math.cos(e*=Math.PI/180)*t,Math.sin(e)*t)}function ne(e,t,n){return new ie(e,t,n)}function ie(e,t,n){this.l=e,this.a=t,this.b=n}function re(e,t,n){var i=(e+16)/116,r=i+t/500,o=i-n/200;return r=se(r)*pr,i=se(i)*fr,o=se(o)*mr,B(le(3.2404542*r-1.5371385*i-.4985314*o),le(-.969266*r+1.8760108*i+.041556*o),le(.0556434*r-.2040259*i+1.0572252*o))}function oe(e,t,n){return Q(Math.atan2(n,t)/Math.PI*180,Math.sqrt(t*t+n*n),e)}function se(e){return e>.206893034?e*e*e:(e-4/29)/7.787037}function ae(e){return e>.008856?Math.pow(e,1/3):7.787037*e+4/29}function le(e){return Math.round(255*(e<=.00304?12.92*e:1.055*Math.pow(e,1/2.4)-.055))}function ue(e){return Gi(e,_r),e}function ce(e){return function(){return vr(e,this)}}function he(e){return function(){return yr(e,this)}}function de(e,t){function n(){this.removeAttribute(e)}function i(){this.removeAttributeNS(e.space,e.local)}function r(){this.setAttribute(e,t)}function o(){this.setAttributeNS(e.space,e.local,t)}function s(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}function a(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}return e=d3.ns.qualify(e),null==t?e.local?i:n:"function"===typeof t?e.local?a:s:e.local?o:r}function pe(e){return new RegExp("(?:^|\\s+)"+d3.requote(e)+"(?:\\s+|$)","g")}function fe(e,t){function n(){var n=-1;while(++n<r)e[n](this,t)}function i(){var n=-1,i=t.apply(this,arguments);while(++n<r)e[n](this,i)}e=e.trim().split(/\s+/).map(me);var r=e.length;return"function"===typeof t?i:n}function me(e){var t=pe(e);return function(n,i){if(r=n.classList)return i?r.add(e):r.remove(e);var r=n.className,o=null!=r.baseVal,s=o?r.baseVal:r;i?(t.lastIndex=0,t.test(s)||(s=d(s+" "+e),o?r.baseVal=s:n.className=s)):s&&(s=d(s.replace(t," ")),o?r.baseVal=s:n.className=s)}}function ge(e,t,n){function i(){this.style.removeProperty(e)}function r(){this.style.setProperty(e,t,n)}function o(){var i=t.apply(this,arguments);null==i?this.style.removeProperty(e):this.style.setProperty(e,i,n)}return null==t?i:"function"===typeof t?o:r}function ve(e,t){function n(){delete this[e]}function i(){this[e]=t}function r(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}return null==t?n:"function"===typeof t?r:i}function ye(e){return{__data__:e}}function xe(e){return function(){return wr(this,e)}}function be(e){return arguments.length||(e=d3.ascending),function(t,n){return e(t&&t.__data__,n&&n.__data__)}}function we(e,t,n){function i(){var t=this[o];t&&(this.removeEventListener(e,t,t.$),delete this[o])}function r(){function r(e){var n=d3.event;d3.event=e,a[0]=s.__data__;try{t.apply(s,a)}finally{d3.event=n}}var s=this,a=arguments;i.call(this),this.addEventListener(e,this[o]=r,r.$=n),r._=t}var o="__on"+e,s=e.indexOf(".");return s>0&&(e=e.substring(0,s)),t?r:i}function _e(e,t){for(var n=0,i=e.length;n<i;n++)for(var r,o=e[n],s=0,a=o.length;s<a;s++)(r=o[s])&&t(r,s,n);return e}function Ae(e){return Gi(e,Sr),e}function Se(e,t,n){Gi(e,Er);var r=new i,o=d3.dispatch("start","end"),s=Dr;return e.id=t,e.time=n,e.tween=function(t,n){return arguments.length<2?r.get(t):(null==n?r.remove(t):r.set(t,n),e)},e.ease=function(t){return arguments.length?(s="function"===typeof t?t:d3.ease.apply(d3,arguments),e):s},e.each=function(t,n){return arguments.length<2?Ee.call(e,t):(o.on(t,n),e)},d3.timer((function(i){return _e(e,(function(e,a,l){function u(i){return m.active>t?h():(m.active=t,r.forEach((function(t,n){(n=n.call(e,g,a))&&d.push(n)})),o.start.call(e,g,a),c(i)||d3.timer(c,0,n),1)}function c(n){if(m.active!==t)return h();var i=(n-p)/f,r=s(i),l=d.length;while(l>0)d[--l].call(e,r);return i>=1?(h(),Tr=t,o.end.call(e,g,a),Tr=0,1):void 0}function h(){return--m.count||delete e.__transition__,1}var d=[],p=e.delay,f=e.duration,m=(e=e.node).__transition__||(e.__transition__={active:0,count:0}),g=e.__data__;++m.count,p<=i?u(i):d3.timer(u,p,n)}))}),0,n),e}function Ee(e){var t=Tr,n=Dr,i=Lr,r=Or;return Tr=this.id,Dr=this.ease(),_e(this,(function(t,n,i){Lr=t.delay,Or=t.duration,e.call(t=t.node,t.__data__,n,i)})),Tr=t,Dr=n,Lr=i,Or=r,this}function Me(e,t,n){return""!=n&&kr}function Te(e,t){return d3.tween(e,U(t))}function Ce(){var e,t=Date.now(),n=Fr;while(n)e=t-n.then,e>=n.delay&&(n.flush=n.callback(e)),n=n.next;var i=Pe()-t;i>24?(isFinite(i)&&(clearTimeout(Nr),Nr=setTimeout(Ce,i)),Ir=0):(Ir=1,zr(Ce))}function Pe(){var e=null,t=Fr,n=1/0;while(t)t.flush?(delete Ur[t.callback.id],t=e?e.next=t.next:Fr=t.next):(n=Math.min(n,t.then+t.delay),t=(e=t).next);return n}function Re(e,t){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var i=n.createSVGPoint();if(jr<0&&(window.scrollX||window.scrollY)){n=d3.select(document.body).append("svg").style("position","absolute").style("top",0).style("left",0);var r=n[0][0].getScreenCTM();jr=!(r.f||r.e),n.remove()}return jr?(i.x=t.pageX,i.y=t.pageY):(i.x=t.clientX,i.y=t.clientY),i=i.matrixTransform(e.getScreenCTM().inverse()),[i.x,i.y]}var o=e.getBoundingClientRect();return[t.clientX-o.left-e.clientLeft,t.clientY-o.top-e.clientTop]}function Le(e){var t=e[0],n=e[e.length-1];return t<n?[t,n]:[n,t]}function Oe(e){return e.rangeExtent?e.rangeExtent():Le(e.range())}function De(e,t){var n,i=0,r=e.length-1,o=e[i],s=e[r];return s<o&&(n=i,i=r,r=n,n=o,o=s,s=n),(t=t(s-o))&&(e[i]=t.floor(o),e[r]=t.ceil(s)),e}function Ie(){return Math}function Ne(e,t,n,i){function r(){var r=Math.min(e.length,t.length)>2?Be:je,l=i?z:F;return s=r(e,t,l,n),a=r(t,e,l,d3.interpolate),o}function o(e){return s(e)}var s,a;return o.invert=function(e){return a(e)},o.domain=function(t){return arguments.length?(e=t.map(Number),r()):e},o.range=function(e){return arguments.length?(t=e,r()):t},o.rangeRound=function(e){return o.range(e).interpolate(d3.interpolateRound)},o.clamp=function(e){return arguments.length?(i=e,r()):i},o.interpolate=function(e){return arguments.length?(n=e,r()):n},o.ticks=function(t){return Fe(e,t)},o.tickFormat=function(t){return ze(e,t)},o.nice=function(){return De(e,Ve),r()},o.copy=function(){return Ne(e,t,n,i)},r()}function ke(e,t){return d3.rebind(e,t,"range","rangeRound","interpolate","clamp")}function Ve(e){return e=Math.pow(10,Math.round(Math.log(e)/Math.LN10)-1),e&&{floor:function(t){return Math.floor(t/e)*e},ceil:function(t){return Math.ceil(t/e)*e}}}function Ue(e,t){var n=Le(e),i=n[1]-n[0],r=Math.pow(10,Math.floor(Math.log(i/t)/Math.LN10)),o=t/i*r;return o<=.15?r*=10:o<=.35?r*=5:o<=.75&&(r*=2),n[0]=Math.ceil(n[0]/r)*r,n[1]=Math.floor(n[1]/r)*r+.5*r,n[2]=r,n}function Fe(e,t){return d3.range.apply(d3,Ue(e,t))}function ze(e,t){return d3.format(",."+Math.max(0,-Math.floor(Math.log(Ue(e,t)[2])/Math.LN10+.01))+"f")}function je(e,t,n,i){var r=n(e[0],e[1]),o=i(t[0],t[1]);return function(e){return o(r(e))}}function Be(e,t,n,i){var r=[],o=[],s=0,a=Math.min(e.length,t.length)-1;e[a]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());while(++s<=a)r.push(n(e[s-1],e[s])),o.push(i(t[s-1],t[s]));return function(t){var n=d3.bisect(e,t,1,a)-1;return o[n](r[n](t))}}function $e(e,t){function n(n){return e(t(n))}var i=t.pow;return n.invert=function(t){return i(e.invert(t))},n.domain=function(r){return arguments.length?(t=r[0]<0?Ge:He,i=t.pow,e.domain(r.map(t)),n):e.domain().map(i)},n.nice=function(){return e.domain(De(e.domain(),Ie)),n},n.ticks=function(){var n=Le(e.domain()),r=[];if(n.every(isFinite)){var o=Math.floor(n[0]),s=Math.ceil(n[1]),a=i(n[0]),l=i(n[1]);if(t===Ge)for(r.push(i(o));o++<s;)for(var u=9;u>0;u--)r.push(i(o)*u);else{for(;o<s;o++)for(u=1;u<10;u++)r.push(i(o)*u);r.push(i(o))}for(o=0;r[o]<a;o++);for(s=r.length;r[s-1]>l;s--);r=r.slice(o,s)}return r},n.tickFormat=function(e,r){if(arguments.length<2&&(r=Br),arguments.length<1)return r;var o,s=Math.max(.1,e/n.ticks().length),a=t===Ge?(o=-1e-12,Math.floor):(o=1e-12,Math.ceil);return function(e){return e/i(a(t(e)+o))<=s?r(e):""}},n.copy=function(){return $e(e.copy(),t)},ke(n,e)}function He(e){return Math.log(e<0?0:e)/Math.LN10}function Ge(e){return-Math.log(e>0?0:-e)/Math.LN10}function We(e,t){function n(t){return e(i(t))}var i=qe(t),r=qe(1/t);return n.invert=function(t){return r(e.invert(t))},n.domain=function(t){return arguments.length?(e.domain(t.map(i)),n):e.domain().map(r)},n.ticks=function(e){return Fe(n.domain(),e)},n.tickFormat=function(e){return ze(n.domain(),e)},n.nice=function(){return n.domain(De(n.domain(),Ve))},n.exponent=function(e){if(!arguments.length)return t;var o=n.domain();return i=qe(t=e),r=qe(1/t),n.domain(o)},n.copy=function(){return We(e.copy(),t)},ke(n,e)}function qe(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Ye(e,t){function n(t){return s[((o.get(t)||o.set(t,e.push(t)))-1)%s.length]}function r(t,n){return d3.range(e.length).map((function(e){return t+n*e}))}var o,s,a;return n.domain=function(r){if(!arguments.length)return e;e=[],o=new i;var s,a=-1,l=r.length;while(++a<l)o.has(s=r[a])||o.set(s,e.push(s));return n[t.t].apply(n,t.a)},n.range=function(e){return arguments.length?(s=e,a=0,t={t:"range",a:arguments},n):s},n.rangePoints=function(i,o){arguments.length<2&&(o=0);var l=i[0],u=i[1],c=(u-l)/(Math.max(1,e.length-1)+o);return s=r(e.length<2?(l+u)/2:l+c*o/2,c),a=0,t={t:"rangePoints",a:arguments},n},n.rangeBands=function(i,o,l){arguments.length<2&&(o=0),arguments.length<3&&(l=o);var u=i[1]<i[0],c=i[u-0],h=i[1-u],d=(h-c)/(e.length-o+2*l);return s=r(c+d*l,d),u&&s.reverse(),a=d*(1-o),t={t:"rangeBands",a:arguments},n},n.rangeRoundBands=function(i,o,l){arguments.length<2&&(o=0),arguments.length<3&&(l=o);var u=i[1]<i[0],c=i[u-0],h=i[1-u],d=Math.floor((h-c)/(e.length-o+2*l)),p=h-c-(e.length-o)*d;return s=r(c+Math.round(p/2),d),u&&s.reverse(),a=Math.round(d*(1-o)),t={t:"rangeRoundBands",a:arguments},n},n.rangeBand=function(){return a},n.rangeExtent=function(){return Le(t.a[0])},n.copy=function(){return Ye(e,t)},n.domain(e)}function Xe(e,t){function n(){var n=0,o=(e.length,t.length);r=[];while(++n<o)r[n-1]=d3.quantile(e,n/o);return i}function i(e){return isNaN(e=+e)?NaN:t[d3.bisect(r,e)]}var r;return i.domain=function(t){return arguments.length?(e=t.filter((function(e){return!isNaN(e)})).sort(d3.ascending),n()):e},i.range=function(e){return arguments.length?(t=e,n()):t},i.quantiles=function(){return r},i.copy=function(){return Xe(e,t)},n()}function Ze(e,t,n){function i(t){return n[Math.max(0,Math.min(s,Math.floor(o*(t-e))))]}function r(){return o=n.length/(t-e),s=n.length-1,i}var o,s;return i.domain=function(n){return arguments.length?(e=+n[0],t=+n[n.length-1],r()):[e,t]},i.range=function(e){return arguments.length?(n=e,r()):n},i.copy=function(){return Ze(e,t,n)},r()}function Je(e,t){function n(n){return t[d3.bisect(e,n)]}return n.domain=function(t){return arguments.length?(e=t,n):e},n.range=function(e){return arguments.length?(t=e,n):t},n.copy=function(){return Je(e,t)},n}function Ke(e){function t(e){return+e}return t.invert=t,t.domain=t.range=function(n){return arguments.length?(e=n.map(t),t):e},t.ticks=function(t){return Fe(e,t)},t.tickFormat=function(t){return ze(e,t)},t.copy=function(){return Ke(e)},t}function Qe(e){return e.innerRadius}function et(e){return e.outerRadius}function tt(e){return e.startAngle}function nt(e){return e.endAngle}function it(e){function t(t){function s(){c.push("M",o(e(h),u))}var l,c=[],h=[],d=-1,p=t.length,f=a(n),m=a(i);while(++d<p)r.call(this,l=t[d],d)?h.push([+f.call(this,l,d),+m.call(this,l,d)]):h.length&&(s(),h=[]);return h.length&&s(),c.length?c.join(""):null}var n=rt,i=ot,r=s,o=st,l=o.key,u=.7;return t.x=function(e){return arguments.length?(n=e,t):n},t.y=function(e){return arguments.length?(i=e,t):i},t.defined=function(e){return arguments.length?(r=e,t):r},t.interpolate=function(e){return arguments.length?(l="function"===typeof e?o=e:(o=Xr.get(e)||st).key,t):l},t.tension=function(e){return arguments.length?(u=e,t):u},t}function rt(e){return e[0]}function ot(e){return e[1]}function st(e){return e.join("L")}function at(e){return st(e)+"Z"}function lt(e){var t=0,n=e.length,i=e[0],r=[i[0],",",i[1]];while(++t<n)r.push("V",(i=e[t])[1],"H",i[0]);return r.join("")}function ut(e){var t=0,n=e.length,i=e[0],r=[i[0],",",i[1]];while(++t<n)r.push("H",(i=e[t])[0],"V",i[1]);return r.join("")}function ct(e,t){return e.length<4?st(e):e[1]+pt(e.slice(1,e.length-1),ft(e,t))}function ht(e,t){return e.length<3?st(e):e[0]+pt((e.push(e[0]),e),ft([e[e.length-2]].concat(e,[e[1]]),t))}function dt(e,t,n){return e.length<3?st(e):e[0]+pt(e,ft(e,t))}function pt(e,t){if(t.length<1||e.length!=t.length&&e.length!=t.length+2)return st(e);var n=e.length!=t.length,i="",r=e[0],o=e[1],s=t[0],a=s,l=1;if(n&&(i+="Q"+(o[0]-2*s[0]/3)+","+(o[1]-2*s[1]/3)+","+o[0]+","+o[1],r=e[1],l=2),t.length>1){a=t[1],o=e[l],l++,i+="C"+(r[0]+s[0])+","+(r[1]+s[1])+","+(o[0]-a[0])+","+(o[1]-a[1])+","+o[0]+","+o[1];for(var u=2;u<t.length;u++,l++)o=e[l],a=t[u],i+="S"+(o[0]-a[0])+","+(o[1]-a[1])+","+o[0]+","+o[1]}if(n){var c=e[l];i+="Q"+(o[0]+2*a[0]/3)+","+(o[1]+2*a[1]/3)+","+c[0]+","+c[1]}return i}function ft(e,t){var n,i=[],r=(1-t)/2,o=e[0],s=e[1],a=1,l=e.length;while(++a<l)n=o,o=s,s=e[a],i.push([r*(s[0]-n[0]),r*(s[1]-n[1])]);return i}function mt(e){if(e.length<3)return st(e);var t=1,n=e.length,i=e[0],r=i[0],o=i[1],s=[r,r,r,(i=e[1])[0]],a=[o,o,o,i[1]],l=[r,",",o];bt(l,s,a);while(++t<n)i=e[t],s.shift(),s.push(i[0]),a.shift(),a.push(i[1]),bt(l,s,a);t=-1;while(++t<2)s.shift(),s.push(i[0]),a.shift(),a.push(i[1]),bt(l,s,a);return l.join("")}function gt(e){if(e.length<4)return st(e);var t,n=[],i=-1,r=e.length,o=[0],s=[0];while(++i<3)t=e[i],o.push(t[0]),s.push(t[1]);n.push(xt(Kr,o)+","+xt(Kr,s)),--i;while(++i<r)t=e[i],o.shift(),o.push(t[0]),s.shift(),s.push(t[1]),bt(n,o,s);return n.join("")}function vt(e){var t,n,i=-1,r=e.length,o=r+4,s=[],a=[];while(++i<4)n=e[i%r],s.push(n[0]),a.push(n[1]);t=[xt(Kr,s),",",xt(Kr,a)],--i;while(++i<o)n=e[i%r],s.shift(),s.push(n[0]),a.shift(),a.push(n[1]),bt(t,s,a);return t.join("")}function yt(e,t){var n=e.length-1;if(n){var i,r,o=e[0][0],s=e[0][1],a=e[n][0]-o,l=e[n][1]-s,u=-1;while(++u<=n)i=e[u],r=u/n,i[0]=t*i[0]+(1-t)*(o+r*a),i[1]=t*i[1]+(1-t)*(s+r*l)}return mt(e)}function xt(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function bt(e,t,n){e.push("C",xt(Zr,t),",",xt(Zr,n),",",xt(Jr,t),",",xt(Jr,n),",",xt(Kr,t),",",xt(Kr,n))}function wt(e,t){return(t[1]-e[1])/(t[0]-e[0])}function _t(e){var t=0,n=e.length-1,i=[],r=e[0],o=e[1],s=i[0]=wt(r,o);while(++t<n)i[t]=(s+(s=wt(r=o,o=e[t+1])))/2;return i[t]=s,i}function At(e){var t,n,i,r,o=[],s=_t(e),a=-1,l=e.length-1;while(++a<l)t=wt(e[a],e[a+1]),Math.abs(t)<1e-6?s[a]=s[a+1]=0:(n=s[a]/t,i=s[a+1]/t,r=n*n+i*i,r>9&&(r=3*t/Math.sqrt(r),s[a]=r*n,s[a+1]=r*i));a=-1;while(++a<=l)r=(e[Math.min(l,a+1)][0]-e[Math.max(0,a-1)][0])/(6*(1+s[a]*s[a])),o.push([r||0,s[a]*r||0]);return o}function St(e){return e.length<3?st(e):e[0]+pt(e,At(e))}function Et(e){var t,n,i,r=-1,o=e.length;while(++r<o)t=e[r],n=t[0],i=t[1]+qr,t[0]=n*Math.cos(i),t[1]=n*Math.sin(i);return e}function Mt(e){function t(t){function s(){g.push("M",u(e(y),p),d,h(e(v.reverse()),p),"Z")}var c,f,m,g=[],v=[],y=[],x=-1,b=t.length,w=a(n),_=a(r),A=n===i?function(){return f}:a(i),S=r===o?function(){return m}:a(o);while(++x<b)l.call(this,c=t[x],x)?(v.push([f=+w.call(this,c,x),m=+_.call(this,c,x)]),y.push([+A.call(this,c,x),+S.call(this,c,x)])):v.length&&(s(),v=[],y=[]);return v.length&&s(),g.length?g.join(""):null}var n=rt,i=rt,r=0,o=ot,l=s,u=st,c=u.key,h=u,d="L",p=.7;return t.x=function(e){return arguments.length?(n=i=e,t):i},t.x0=function(e){return arguments.length?(n=e,t):n},t.x1=function(e){return arguments.length?(i=e,t):i},t.y=function(e){return arguments.length?(r=o=e,t):o},t.y0=function(e){return arguments.length?(r=e,t):r},t.y1=function(e){return arguments.length?(o=e,t):o},t.defined=function(e){return arguments.length?(l=e,t):l},t.interpolate=function(e){return arguments.length?(c="function"===typeof e?u=e:(u=Xr.get(e)||st).key,h=u.reverse||u,d=u.closed?"M":"L",t):c},t.tension=function(e){return arguments.length?(p=e,t):p},t}function Tt(e){return e.source}function Ct(e){return e.target}function Pt(e){return e.radius}function Rt(e){return[e.x,e.y]}function Lt(e){return function(){var t=e.apply(this,arguments),n=t[0],i=t[1]+qr;return[n*Math.cos(i),n*Math.sin(i)]}}function Ot(){return 64}function Dt(){return"circle"}function It(e){var t=Math.sqrt(e/Math.PI);return"M0,"+t+"A"+t+","+t+" 0 1,1 0,"+-t+"A"+t+","+t+" 0 1,1 0,"+t+"Z"}function Nt(e,t){e.attr("transform",(function(e){return"translate("+t(e)+",0)"}))}function kt(e,t){e.attr("transform",(function(e){return"translate(0,"+t(e)+")"}))}function Vt(e,t,n){if(i=[],n&&t.length>1){var i,r,o,s=Le(e.domain()),a=-1,l=t.length,u=(t[1]-t[0])/++n;while(++a<l)for(r=n;--r>0;)(o=+t[a]-r*u)>=s[0]&&i.push(o);for(--a,r=0;++r<n&&(o=+t[a]+r*u)<s[1];)i.push(o)}return i}function Ut(){ro||(ro=d3.select("body").append("div").style("visibility","hidden").style("top",0).style("height",0).style("width",0).style("overflow-y","scroll").append("div").style("height","2000px").node().parentNode);var e,t=d3.event;try{ro.scrollTop=1e3,ro.dispatchEvent(t),e=1e3-ro.scrollTop}catch(n){e=t.wheelDelta||5*-t.detail}return e}function Ft(e){var t=e.source,n=e.target,i=jt(t,n),r=[t];while(t!==i)t=t.parent,r.push(t);var o=r.length;while(n!==i)r.splice(o,0,n),n=n.parent;return r}function zt(e){var t=[],n=e.parent;while(null!=n)t.push(e),e=n,n=n.parent;return t.push(e),t}function jt(e,t){if(e===t)return e;var n=zt(e),i=zt(t),r=n.pop(),o=i.pop(),s=null;while(r===o)s=r,r=n.pop(),o=i.pop();return s}function Bt(e){e.fixed|=2}function $t(e){e.fixed&=1}function Ht(e){e.fixed|=4}function Gt(e){e.fixed&=3}function Wt(e,t,n){var i=0,r=0;if(e.charge=0,!e.leaf){var o,s=e.nodes,a=s.length,l=-1;while(++l<a)o=s[l],null!=o&&(Wt(o,t,n),e.charge+=o.charge,i+=o.charge*o.cx,r+=o.charge*o.cy)}if(e.point){e.leaf||(e.point.x+=Math.random()-.5,e.point.y+=Math.random()-.5);var u=t*n[e.point.index];e.charge+=e.pointCharge=u,i+=u*e.point.x,r+=u*e.point.y}e.cx=i/e.charge,e.cy=r/e.charge}function qt(e){return 20}function Yt(e){return 1}function Xt(e){return e.x}function Zt(e){return e.y}function Jt(e,t,n){e.y0=t,e.y=n}function Kt(e){return d3.range(e.length)}function Qt(e){var t=-1,n=e[0].length,i=[];while(++t<n)i[t]=0;return i}function en(e){for(var t,n=1,i=0,r=e[0][1],o=e.length;n<o;++n)(t=e[n][1])>r&&(i=n,r=t);return i}function tn(e){return e.reduce(nn,0)}function nn(e,t){return e+t[1]}function rn(e,t){return on(e,Math.ceil(Math.log(t.length)/Math.LN2+1))}function on(e,t){var n=-1,i=+e[0],r=(e[1]-i)/t,o=[];while(++n<=t)o[n]=r*n+i;return o}function sn(e){return[d3.min(e),d3.max(e)]}function an(e,t){return d3.rebind(e,t,"sort","children","value"),e.links=hn,e.nodes=function(t){return uo=!0,(e.nodes=e)(t)},e}function ln(e){return e.children}function un(e){return e.value}function cn(e,t){return t.value-e.value}function hn(e){return d3.merge(e.map((function(e){return(e.children||[]).map((function(t){return{source:e,target:t}}))})))}function dn(e,t){return e.value-t.value}function pn(e,t){var n=e._pack_next;e._pack_next=t,t._pack_prev=e,t._pack_next=n,n._pack_prev=t}function fn(e,t){e._pack_next=t,t._pack_prev=e}function mn(e,t){var n=t.x-e.x,i=t.y-e.y,r=e.r+t.r;return r*r-n*n-i*i>.001}function gn(e){function t(e){c=Math.min(e.x-e.r,c),h=Math.max(e.x+e.r,h),d=Math.min(e.y-e.r,d),p=Math.max(e.y+e.r,p)}if((n=e.children)&&(u=n.length)){var n,i,r,o,s,a,l,u,c=1/0,h=-1/0,d=1/0,p=-1/0;if(n.forEach(vn),i=n[0],i.x=-i.r,i.y=0,t(i),u>1&&(r=n[1],r.x=r.r,r.y=0,t(r),u>2))for(o=n[2],bn(i,r,o),t(o),pn(i,o),i._pack_prev=o,pn(o,r),r=i._pack_next,s=3;s<u;s++){bn(i,r,o=n[s]);var f=0,m=1,g=1;for(a=r._pack_next;a!==r;a=a._pack_next,m++)if(mn(a,o)){f=1;break}if(1==f)for(l=i._pack_prev;l!==a._pack_prev;l=l._pack_prev,g++)if(mn(l,o))break;f?(m<g||m==g&&r.r<i.r?fn(i,r=a):fn(i=l,r),s--):(pn(i,o),r=o,t(o))}var v=(c+h)/2,y=(d+p)/2,x=0;for(s=0;s<u;s++)o=n[s],o.x-=v,o.y-=y,x=Math.max(x,o.r+Math.sqrt(o.x*o.x+o.y*o.y));e.r=x,n.forEach(yn)}}function vn(e){e._pack_next=e._pack_prev=e}function yn(e){delete e._pack_next,delete e._pack_prev}function xn(e,t,n,i){var r=e.children;if(e.x=t+=i*e.x,e.y=n+=i*e.y,e.r*=i,r){var o=-1,s=r.length;while(++o<s)xn(r[o],t,n,i)}}function bn(e,t,n){var i=e.r+n.r,r=t.x-e.x,o=t.y-e.y;if(i&&(r||o)){var s=t.r+n.r,a=r*r+o*o;s*=s,i*=i;var l=.5+(i-s)/(2*a),u=Math.sqrt(Math.max(0,2*s*(i+a)-(i-=a)*i-s*s))/(2*a);n.x=e.x+l*r+u*o,n.y=e.y+l*o-u*r}else n.x=e.x+i,n.y=e.y}function wn(e){return 1+d3.max(e,(function(e){return e.y}))}function _n(e){return e.reduce((function(e,t){return e+t.x}),0)/e.length}function An(e){var t=e.children;return t&&t.length?An(t[0]):e}function Sn(e){var t,n=e.children;return n&&(t=n.length)?Sn(n[t-1]):e}function En(e,t){return e.parent==t.parent?1:2}function Mn(e){var t=e.children;return t&&t.length?t[0]:e._tree.thread}function Tn(e){var t,n=e.children;return n&&(t=n.length)?n[t-1]:e._tree.thread}function Cn(e,t){var n=e.children;if(n&&(r=n.length)){var i,r,o=-1;while(++o<r)t(i=Cn(n[o],t),e)>0&&(e=i)}return e}function Pn(e,t){return e.x-t.x}function Rn(e,t){return t.x-e.x}function Ln(e,t){return e.depth-t.depth}function On(e,t){function n(e,i){var r=e.children;if(r&&(s=r.length)){var o,s,a=null,l=-1;while(++l<s)o=r[l],n(o,a),a=o}t(e,i)}n(e,null)}function Dn(e){var t,n=0,i=0,r=e.children,o=r.length;while(--o>=0)t=r[o]._tree,t.prelim+=n,t.mod+=n,n+=t.shift+(i+=t.change)}function In(e,t,n){e=e._tree,t=t._tree;var i=n/(t.number-e.number);e.change+=i,t.change-=i,t.shift+=n,t.prelim+=n,t.mod+=n}function Nn(e,t,n){return e._tree.ancestor.parent==t.parent?e._tree.ancestor:n}function kn(e){return{x:e.x,y:e.y,dx:e.dx,dy:e.dy}}function Vn(e,t){var n=e.x+t[3],i=e.y+t[0],r=e.dx-t[1]-t[3],o=e.dy-t[0]-t[2];return r<0&&(n+=r/2,r=0),o<0&&(i+=o/2,o=0),{x:n,y:i,dx:r,dy:o}}function Un(e,t){function n(e,i){d3.text(e,t,(function(e){i(e&&n.parse(e))}))}function i(t){return t.map(r).join(e)}function r(e){return s.test(e)?'"'+e.replace(/\"/g,'""')+'"':e}var o=new RegExp("\r\n|["+e+"\r\n]","g"),s=new RegExp('["'+e+"\n]"),a=e.charCodeAt(0);return n.parse=function(e){var t;return n.parseRows(e,(function(e,n){if(n){var i={},r=-1,o=t.length;while(++r<o)i[t[r]]=e[r];return i}return t=e,null}))},n.parseRows=function(e,t){function n(){if(o.lastIndex>=e.length)return l;if(r)return r=!1,s;var t=o.lastIndex;if(34===e.charCodeAt(t)){var n=t;while(n++<e.length)if(34===e.charCodeAt(n)){if(34!==e.charCodeAt(n+1))break;n++}o.lastIndex=n+2;var i=e.charCodeAt(n+1);return 13===i?(r=!0,10===e.charCodeAt(n+2)&&o.lastIndex++):10===i&&(r=!0),e.substring(t+1,n).replace(/""/g,'"')}var u=o.exec(e);return u?(r=u[0].charCodeAt(0)!==a,e.substring(t,u.index)):(o.lastIndex=e.length,e.substring(t))}var i,r,s={},l={},u=[],c=0;o.lastIndex=0;while((i=n())!==l){var h=[];while(i!==s&&i!==l)h.push(i),i=n();t&&!(h=t(h,c++))||u.push(h)}return u},n.format=function(e){return e.map(i).join("\n")},n}function Fn(e,t){return function(n){return n&&e.hasOwnProperty(n.type)?e[n.type](n):t}}function zn(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function jn(e,t){ho.hasOwnProperty(e.type)&&ho[e.type](e,t)}function Bn(e,t){jn(e.geometry,t)}function $n(e,t){for(var n=e.features,i=0,r=n.length;i<r;i++)jn(n[i].geometry,t)}function Hn(e,t){for(var n=e.geometries,i=0,r=n.length;i<r;i++)jn(n[i],t)}function Gn(e,t){for(var n=e.coordinates,i=0,r=n.length;i<r;i++)t.apply(null,n[i])}function Wn(e,t){for(var n=e.coordinates,i=0,r=n.length;i<r;i++)for(var o=n[i],s=0,a=o.length;s<a;s++)t.apply(null,o[s])}function qn(e,t){for(var n=e.coordinates,i=0,r=n.length;i<r;i++)for(var o=n[i][0],s=0,a=o.length;s<a;s++)t.apply(null,o[s])}function Yn(e,t){t.apply(null,e.coordinates)}function Xn(e,t){for(var n=e.coordinates[0],i=0,r=n.length;i<r;i++)t.apply(null,n[i])}function Zn(e){return e.source}function Jn(e){return e.target}function Kn(){function e(e){var t=Math.sin(e*=p)*f,n=Math.sin(p-e)*f,i=n*o+t*h,a=n*s+t*d,l=n*r+t*c;return[Math.atan2(a,i)/co,Math.atan2(l,Math.sqrt(i*i+a*a))/co]}var t,n,i,r,o,s,a,l,u,c,h,d,p,f;return e.distance=function(){return null==p&&(f=1/Math.sin(p=Math.acos(Math.max(-1,Math.min(1,r*c+i*u*Math.cos(a-t)))))),p},e.source=function(a){var l=Math.cos(t=a[0]*co),u=Math.sin(t);return i=Math.cos(n=a[1]*co),r=Math.sin(n),o=i*l,s=i*u,p=null,e},e.target=function(t){var n=Math.cos(a=t[0]*co),i=Math.sin(a);return u=Math.cos(l=t[1]*co),c=Math.sin(l),h=u*n,d=u*i,p=null,e},e}function Qn(e,t){var n=Kn().source(e).target(t);return n.distance(),n}function ei(e){var t=0,n=0;while(1){if(e(t,n))return[t,n];0===t?(t=n+1,n=0):(t-=1,n+=1)}}function ti(e,t,n,i){var r,o,s,a,l,u,c;return r=i[e],o=r[0],s=r[1],r=i[t],a=r[0],l=r[1],r=i[n],u=r[0],c=r[1],(c-s)*(a-o)-(l-s)*(u-o)>0}function ni(e,t,n){return(n[0]-t[0])*(e[1]-t[1])<(n[1]-t[1])*(e[0]-t[0])}function ii(e,t,n,i){var r=e[0],o=t[0],s=n[0],a=i[0],l=e[1],u=t[1],c=n[1],h=i[1],d=r-s,p=o-r,f=a-s,m=l-c,g=u-l,v=h-c,y=(f*m-v*d)/(v*p-f*g);return[r+y*p,l+y*g]}function ri(e,t){var n={list:e.map((function(e,t){return{index:t,x:e[0],y:e[1]}})).sort((function(e,t){return e.y<t.y?-1:e.y>t.y?1:e.x<t.x?-1:e.x>t.x?1:0})),bottomSite:null},i={list:[],leftEnd:null,rightEnd:null,init:function(){i.leftEnd=i.createHalfEdge(null,"l"),i.rightEnd=i.createHalfEdge(null,"l"),i.leftEnd.r=i.rightEnd,i.rightEnd.l=i.leftEnd,i.list.unshift(i.leftEnd,i.rightEnd)},createHalfEdge:function(e,t){return{edge:e,side:t,vertex:null,l:null,r:null}},insert:function(e,t){t.l=e,t.r=e.r,e.r.l=t,e.r=t},leftBound:function(e){var t=i.leftEnd;do{t=t.r}while(t!=i.rightEnd&&r.rightOf(t,e));return t=t.l,t},del:function(e){e.l.r=e.r,e.r.l=e.l,e.edge=null},right:function(e){return e.r},left:function(e){return e.l},leftRegion:function(e){return null==e.edge?n.bottomSite:e.edge.region[e.side]},rightRegion:function(e){return null==e.edge?n.bottomSite:e.edge.region[mo[e.side]]}},r={bisect:function(e,t){var n={region:{l:e,r:t},ep:{l:null,r:null}},i=t.x-e.x,r=t.y-e.y,o=i>0?i:-i,s=r>0?r:-r;return n.c=e.x*i+e.y*r+.5*(i*i+r*r),o>s?(n.a=1,n.b=r/i,n.c/=i):(n.b=1,n.a=i/r,n.c/=r),n},intersect:function(e,t){var n=e.edge,i=t.edge;if(!n||!i||n.region.r==i.region.r)return null;var r=n.a*i.b-n.b*i.a;if(Math.abs(r)<1e-10)return null;var o,s,a=(n.c*i.b-i.c*n.b)/r,l=(i.c*n.a-n.c*i.a)/r,u=n.region.r,c=i.region.r;u.y<c.y||u.y==c.y&&u.x<c.x?(o=e,s=n):(o=t,s=i);var h=a>=s.region.r.x;return h&&"l"===o.side||!h&&"r"===o.side?null:{x:a,y:l}},rightOf:function(e,t){var n=e.edge,i=n.region.r,r=t.x>i.x;if(r&&"l"===e.side)return 1;if(!r&&"r"===e.side)return 0;if(1===n.a){var o=t.y-i.y,s=t.x-i.x,a=0,l=0;if(!r&&n.b<0||r&&n.b>=0?l=a=o>=n.b*s:(l=t.x+t.y*n.b>n.c,n.b<0&&(l=!l),l||(a=1)),!a){var u=i.x-n.region.l.x;l=n.b*(s*s-o*o)<u*o*(1+2*s/u+n.b*n.b),n.b<0&&(l=!l)}}else{var c=n.c-n.a*t.x,h=t.y-c,d=t.x-i.x,p=c-i.y;l=h*h>d*d+p*p}return"l"===e.side?l:!l},endPoint:function(e,n,i){e.ep[n]=i,e.ep[mo[n]]&&t(e)},distance:function(e,t){var n=e.x-t.x,i=e.y-t.y;return Math.sqrt(n*n+i*i)}},o={list:[],insert:function(e,t,n){e.vertex=t,e.ystar=t.y+n;for(var i=0,r=o.list,s=r.length;i<s;i++){var a=r[i];if(!(e.ystar>a.ystar||e.ystar==a.ystar&&t.x>a.vertex.x))break}r.splice(i,0,e)},del:function(e){for(var t=0,n=o.list,i=n.length;t<i&&n[t]!=e;++t);n.splice(t,1)},empty:function(){return 0===o.list.length},nextEvent:function(e){for(var t=0,n=o.list,i=n.length;t<i;++t)if(n[t]==e)return n[t+1];return null},min:function(){var e=o.list[0];return{x:e.vertex.x,y:e.ystar}},extractMin:function(){return o.list.shift()}};i.init(),n.bottomSite=n.list.shift();var s,a,l,u,c,h,d,p,f,m,g,v,y,x=n.list.shift();while(1)if(o.empty()||(s=o.min()),x&&(o.empty()||x.y<s.y||x.y==s.y&&x.x<s.x))a=i.leftBound(x),l=i.right(a),d=i.rightRegion(a),v=r.bisect(d,x),h=i.createHalfEdge(v,"l"),i.insert(a,h),m=r.intersect(a,h),m&&(o.del(a),o.insert(a,m,r.distance(m,x))),a=h,h=i.createHalfEdge(v,"r"),i.insert(a,h),m=r.intersect(h,l),m&&o.insert(h,m,r.distance(m,x)),x=n.list.shift();else{if(o.empty())break;a=o.extractMin(),u=i.left(a),l=i.right(a),c=i.right(l),d=i.leftRegion(a),p=i.rightRegion(l),g=a.vertex,r.endPoint(a.edge,a.side,g),r.endPoint(l.edge,l.side,g),i.del(a),o.del(l),i.del(l),y="l",d.y>p.y&&(f=d,d=p,p=f,y="r"),v=r.bisect(d,p),h=i.createHalfEdge(v,y),i.insert(u,h),r.endPoint(v,mo[y],g),m=r.intersect(u,h),m&&(o.del(u),o.insert(u,m,r.distance(m,d))),m=r.intersect(h,c),m&&o.insert(h,m,r.distance(m,d))}for(a=i.right(i.leftEnd);a!=i.rightEnd;a=i.right(a))t(a.edge)}function oi(){return{leaf:!0,nodes:[],point:null}}function si(e,t,n,i,r,o){if(!e(t,n,i,r,o)){var s=.5*(n+r),a=.5*(i+o),l=t.nodes;l[0]&&si(e,l[0],n,i,s,a),l[1]&&si(e,l[1],s,i,r,a),l[2]&&si(e,l[2],n,a,s,o),l[3]&&si(e,l[3],s,a,r,o)}}function ai(e){return{x:e[0],y:e[1]}}function li(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function ui(e){return e.substring(0,3)}function ci(e,t,n,i){var r,o,s=0,a=t.length,l=n.length;while(s<a){if(i>=l)return-1;if(r=t.charCodeAt(s++),37==r){if(o=Vo[t.charAt(s++)],!o||(i=o(e,n,i))<0)return-1}else if(r!=n.charCodeAt(i++))return-1}return i}function hi(e){return new RegExp("^(?:"+e.map(d3.requote).join("|")+")","i")}function di(e){var t=new i,n=-1,r=e.length;while(++n<r)t.set(e[n].toLowerCase(),n);return t}function pi(e,t,n){Lo.lastIndex=0;var i=Lo.exec(t.substring(n));return i?n+=i[0].length:-1}function fi(e,t,n){Ro.lastIndex=0;var i=Ro.exec(t.substring(n));return i?n+=i[0].length:-1}function mi(e,t,n){Io.lastIndex=0;var i=Io.exec(t.substring(n));return i?(e.m=No.get(i[0].toLowerCase()),n+=i[0].length):-1}function gi(e,t,n){Oo.lastIndex=0;var i=Oo.exec(t.substring(n));return i?(e.m=Do.get(i[0].toLowerCase()),n+=i[0].length):-1}function vi(e,t,n){return ci(e,ko.c.toString(),t,n)}function yi(e,t,n){return ci(e,ko.x.toString(),t,n)}function xi(e,t,n){return ci(e,ko.X.toString(),t,n)}function bi(e,t,n){Uo.lastIndex=0;var i=Uo.exec(t.substring(n,n+4));return i?(e.y=+i[0],n+=i[0].length):-1}function wi(e,t,n){Uo.lastIndex=0;var i=Uo.exec(t.substring(n,n+2));return i?(e.y=_i(+i[0]),n+=i[0].length):-1}function _i(e){return e+(e>68?1900:2e3)}function Ai(e,t,n){Uo.lastIndex=0;var i=Uo.exec(t.substring(n,n+2));return i?(e.m=i[0]-1,n+=i[0].length):-1}function Si(e,t,n){Uo.lastIndex=0;var i=Uo.exec(t.substring(n,n+2));return i?(e.d=+i[0],n+=i[0].length):-1}function Ei(e,t,n){Uo.lastIndex=0;var i=Uo.exec(t.substring(n,n+2));return i?(e.H=+i[0],n+=i[0].length):-1}function Mi(e,t,n){Uo.lastIndex=0;var i=Uo.exec(t.substring(n,n+2));return i?(e.M=+i[0],n+=i[0].length):-1}function Ti(e,t,n){Uo.lastIndex=0;var i=Uo.exec(t.substring(n,n+2));return i?(e.S=+i[0],n+=i[0].length):-1}function Ci(e,t,n){Uo.lastIndex=0;var i=Uo.exec(t.substring(n,n+3));return i?(e.L=+i[0],n+=i[0].length):-1}function Pi(e,t,n){var i=Fo.get(t.substring(n,n+=2).toLowerCase());return null==i?-1:(e.p=i,n)}function Ri(e){var t=e.getTimezoneOffset(),n=t>0?"-":"+",i=~~(Math.abs(t)/60),r=Math.abs(t)%60;return n+Mo(i)+Mo(r)}function Li(e){return e.toISOString()}function Oi(e,t,n){function i(t){var n=e(t),i=o(n,1);return t-n<i-t?n:i}function r(n){return t(n=e(new go(n-1)),1),n}function o(e,n){return t(e=new go(+e),n),e}function s(e,i,o){var s=r(e),a=[];if(o>1)while(s<i)n(s)%o||a.push(new Date(+s)),t(s,1);else while(s<i)a.push(new Date(+s)),t(s,1);return a}function a(e,t,n){try{go=li;var i=new li;return i._=e,s(i,t,n)}finally{go=Date}}e.floor=e,e.round=i,e.ceil=r,e.offset=o,e.range=s;var l=e.utc=Di(e);return l.floor=l,l.round=Di(i),l.ceil=Di(r),l.offset=Di(o),l.range=a,e}function Di(e){return function(t,n){try{go=li;var i=new li;return i._=t,e(i,n)._}finally{go=Date}}}function Ii(e,t,n){function i(t){return e(t)}return i.invert=function(t){return ki(e.invert(t))},i.domain=function(t){return arguments.length?(e.domain(t),i):e.domain().map(ki)},i.nice=function(e){return i.domain(De(i.domain(),(function(){return e})))},i.ticks=function(n,r){var o=Ni(i.domain());if("function"!==typeof n){var s=o[1]-o[0],a=s/n,l=d3.bisect(jo,a);if(l==jo.length)return t.year(o,n);if(!l)return e.ticks(n).map(ki);Math.log(a/jo[l-1])<Math.log(jo[l]/a)&&--l,n=t[l],r=n[1],n=n[0].range}return n(o[0],new Date(+o[1]+1),r)},i.tickFormat=function(){return n},i.copy=function(){return Ii(e.copy(),t,n)},d3.rebind(i,e,"range","rangeRound","interpolate","clamp")}function Ni(e){var t=e[0],n=e[e.length-1];return t<n?[t,n]:[n,t]}function ki(e){return new Date(e)}function Vi(e){return function(t){var n=e.length-1,i=e[n];while(!i[1](t))i=e[--n];return i[0](t)}}function Ui(e){var t=new Date(e,0,1);return t.setFullYear(e),t}function Fi(e){var t=e.getFullYear(),n=Ui(t),i=Ui(t+1);return t+(e-n)/(i-n)}function zi(e){var t=new Date(Date.UTC(e,0,1));return t.setUTCFullYear(e),t}function ji(e){var t=e.getUTCFullYear(),n=zi(t),i=zi(t+1);return t+(e-n)/(i-n)}Date.now||(Date.now=function(){return+new Date});try{document.createElement("div").style.setProperty("opacity",0,"")}catch(Xo){var Bi=CSSStyleDeclaration.prototype,$i=Bi.setProperty;Bi.setProperty=function(e,t,n){$i.call(this,e,t+"",n)}}d3={version:"2.10.3"};var Hi=n;try{Hi(document.documentElement.childNodes)[0].nodeType}catch(Zo){Hi=t}var Gi=[].__proto__?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)e[n]=t[n]};d3.map=function(e){var t=new i;for(var n in e)t.set(n,e[n]);return t},e(i,{has:function(e){return Wi+e in this},get:function(e){return this[Wi+e]},set:function(e,t){return this[Wi+e]=t},remove:function(e){return e=Wi+e,e in this&&delete this[e]},keys:function(){var e=[];return this.forEach((function(t){e.push(t)})),e},values:function(){var e=[];return this.forEach((function(t,n){e.push(n)})),e},entries:function(){var e=[];return this.forEach((function(t,n){e.push({key:t,value:n})})),e},forEach:function(e){for(var t in this)t.charCodeAt(0)===qi&&e.call(this,t.substring(1),this[t])}});var Wi="\0",qi=Wi.charCodeAt(0);d3.functor=a,d3.rebind=function(e,t){var n,i=1,r=arguments.length;while(++i<r)e[n=arguments[i]]=l(e,t,t[n]);return e},d3.ascending=function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN},d3.descending=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN},d3.mean=function(e,t){var n,i=e.length,r=0,o=-1,s=0;if(1===arguments.length)while(++o<i)u(n=e[o])&&(r+=(n-r)/++s);else while(++o<i)u(n=t.call(e,e[o],o))&&(r+=(n-r)/++s);return s?r:void 0},d3.median=function(e,t){return arguments.length>1&&(e=e.map(t)),e=e.filter(u),e.length?d3.quantile(e.sort(d3.ascending),.5):void 0},d3.min=function(e,t){var n,i,r=-1,o=e.length;if(1===arguments.length){while(++r<o&&(null==(n=e[r])||n!=n))n=void 0;while(++r<o)null!=(i=e[r])&&n>i&&(n=i)}else{while(++r<o&&(null==(n=t.call(e,e[r],r))||n!=n))n=void 0;while(++r<o)null!=(i=t.call(e,e[r],r))&&n>i&&(n=i)}return n},d3.max=function(e,t){var n,i,r=-1,o=e.length;if(1===arguments.length){while(++r<o&&(null==(n=e[r])||n!=n))n=void 0;while(++r<o)null!=(i=e[r])&&i>n&&(n=i)}else{while(++r<o&&(null==(n=t.call(e,e[r],r))||n!=n))n=void 0;while(++r<o)null!=(i=t.call(e,e[r],r))&&i>n&&(n=i)}return n},d3.extent=function(e,t){var n,i,r,o=-1,s=e.length;if(1===arguments.length){while(++o<s&&(null==(n=r=e[o])||n!=n))n=r=void 0;while(++o<s)null!=(i=e[o])&&(n>i&&(n=i),r<i&&(r=i))}else{while(++o<s&&(null==(n=r=t.call(e,e[o],o))||n!=n))n=void 0;while(++o<s)null!=(i=t.call(e,e[o],o))&&(n>i&&(n=i),r<i&&(r=i))}return[n,r]},d3.random={normal:function(e,t){var n=arguments.length;return n<2&&(t=1),n<1&&(e=0),function(){var n,i,r;do{n=2*Math.random()-1,i=2*Math.random()-1,r=n*n+i*i}while(!r||r>1);return e+t*n*Math.sqrt(-2*Math.log(r)/r)}},logNormal:function(e,t){var n=arguments.length;n<2&&(t=1),n<1&&(e=0);var i=d3.random.normal();return function(){return Math.exp(e+t*i())}},irwinHall:function(e){return function(){for(var t=0,n=0;n<e;n++)t+=Math.random();return t/e}}},d3.sum=function(e,t){var n,i=0,r=e.length,o=-1;if(1===arguments.length)while(++o<r)isNaN(n=+e[o])||(i+=n);else while(++o<r)isNaN(n=+t.call(e,e[o],o))||(i+=n);return i},d3.quantile=function(e,t){var n=(e.length-1)*t+1,i=Math.floor(n),r=e[i-1],o=n-i;return o?r+o*(e[i]-r):r},d3.transpose=function(e){return d3.zip.apply(d3,e)},d3.zip=function(){if(!(i=arguments.length))return[];for(var e=-1,t=d3.min(arguments,c),n=new Array(t);++e<t;)for(var i,r=-1,o=n[e]=new Array(i);++r<i;)o[r]=arguments[r][e];return n},d3.bisector=function(e){return{left:function(t,n,i,r){arguments.length<3&&(i=0),arguments.length<4&&(r=t.length);while(i<r){var o=i+r>>>1;e.call(t,t[o],o)<n?i=o+1:r=o}return i},right:function(t,n,i,r){arguments.length<3&&(i=0),arguments.length<4&&(r=t.length);while(i<r){var o=i+r>>>1;n<e.call(t,t[o],o)?r=o:i=o+1}return i}}};var Yi=d3.bisector((function(e){return e}));d3.bisectLeft=Yi.left,d3.bisect=d3.bisectRight=Yi.right,d3.first=function(e,t){var n,i=0,r=e.length,o=e[0];1===arguments.length&&(t=d3.ascending);while(++i<r)t.call(e,o,n=e[i])>0&&(o=n);return o},d3.last=function(e,t){var n,i=0,r=e.length,o=e[0];1===arguments.length&&(t=d3.ascending);while(++i<r)t.call(e,o,n=e[i])<=0&&(o=n);return o},d3.nest=function(){function e(t,a){if(a>=s.length)return r?r.call(o,t):n?t.sort(n):t;var l,u,c,h=-1,d=t.length,p=s[a++],f=new i,m={};while(++h<d)(c=f.get(l=p(u=t[h])))?c.push(u):f.set(l,[u]);return f.forEach((function(t,n){m[t]=e(n,a)})),m}function t(e,n){if(n>=s.length)return e;var i,r=[],o=a[n++];for(i in e)r.push({key:i,values:t(e[i],n)});return o&&r.sort((function(e,t){return o(e.key,t.key)})),r}var n,r,o={},s=[],a=[];return o.map=function(t){return e(t,0)},o.entries=function(n){return t(e(n,0),0)},o.key=function(e){return s.push(e),o},o.sortKeys=function(e){return a[s.length-1]=e,o},o.sortValues=function(e){return n=e,o},o.rollup=function(e){return r=e,o},o},d3.keys=function(e){var t=[];for(var n in e)t.push(n);return t},d3.values=function(e){var t=[];for(var n in e)t.push(e[n]);return t},d3.entries=function(e){var t=[];for(var n in e)t.push({key:n,value:e[n]});return t},d3.permute=function(e,t){var n=[],i=-1,r=t.length;while(++i<r)n[i]=e[t[i]];return n},d3.merge=function(e){return Array.prototype.concat.apply([],e)},d3.split=function(e,t){var n,i=[],r=[],o=-1,s=e.length;arguments.length<2&&(t=h);while(++o<s)t.call(r,n=e[o],o)?r=[]:(r.length||i.push(r),r.push(n));return i},d3.range=function(e,t,n){if(arguments.length<3&&(n=1,arguments.length<2&&(t=e,e=0)),(t-e)/n===1/0)throw new Error("infinite range");var i,r=[],o=p(Math.abs(n)),s=-1;if(e*=o,t*=o,n*=o,n<0)while((i=e+n*++s)>t)r.push(i/o);else while((i=e+n*++s)<t)r.push(i/o);return r},d3.requote=function(e){return e.replace(Xi,"\\$&")};var Xi=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;d3.round=function(e,t){return t?Math.round(e*(t=Math.pow(10,t)))/t:Math.round(e)},d3.xhr=function(e,t,n){var i=new XMLHttpRequest;arguments.length<3?(n=t,t=null):t&&i.overrideMimeType&&i.overrideMimeType(t),i.open("GET",e,!0),t&&i.setRequestHeader("Accept",t),i.onreadystatechange=function(){if(4===i.readyState){var e=i.status;n(!e&&i.response||e>=200&&e<300||304===e?i:null)}},i.send(null)},d3.text=function(e,t,n){function i(e){n(e&&e.responseText)}arguments.length<3&&(n=t,t=null),d3.xhr(e,t,i)},d3.json=function(e,t){d3.text(e,"application/json",(function(e){t(e?JSON.parse(e):null)}))},d3.html=function(e,t){d3.text(e,"text/html",(function(e){if(null!=e){var n=document.createRange();n.selectNode(document.body),e=n.createContextualFragment(e)}t(e)}))},d3.xml=function(e,t,n){function i(e){n(e&&e.responseXML)}arguments.length<3&&(n=t,t=null),d3.xhr(e,t,i)};var Zi={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};d3.ns={prefix:Zi,qualify:function(e){var t=e.indexOf(":"),n=e;return t>=0&&(n=e.substring(0,t),e=e.substring(t+1)),Zi.hasOwnProperty(n)?{space:Zi[n],local:e}:e}},d3.dispatch=function(){var e=new f,t=-1,n=arguments.length;while(++t<n)e[arguments[t]]=m(e);return e},f.prototype.on=function(e,t){var n=e.indexOf("."),i="";return n>0&&(i=e.substring(n+1),e=e.substring(0,n)),arguments.length<2?this[e].on(i):this[e].on(i,t)},d3.format=function(e){var t=Ji.exec(e),n=t[1]||" ",i=t[3]||"",r=t[5],o=+t[6],s=t[7],a=t[8],l=t[9],u=1,c="",h=!1;switch(a&&(a=+a.substring(1)),r&&(n="0",s&&(o-=Math.floor((o-1)/4))),l){case"n":s=!0,l="g";break;case"%":u=100,c="%",l="f";break;case"p":u=100,c="%",l="r";break;case"d":h=!0,a=0;break;case"s":u=-1,l="r";break}return"r"!=l||a||(l="g"),l=Ki.get(l)||v,function(e){if(h&&e%1)return"";var t=e<0&&(e=-e)?"-":i;if(u<0){var d=d3.formatPrefix(e,a);e=d.scale(e),c=d.symbol}else e*=u;if(e=l(e,a),r){var p=e.length+t.length;p<o&&(e=new Array(o-p+1).join(n)+e),s&&(e=y(e)),e=t+e}else{s&&(e=y(e)),e=t+e;p=e.length;p<o&&(e=new Array(o-p+1).join(n)+e)}return e+c}};var Ji=/(?:([^{])?([<>=^]))?([+\- ])?(#)?(0)?([0-9]+)?(,)?(\.[0-9]+)?([a-zA-Z%])?/,Ki=d3.map({g:function(e,t){return e.toPrecision(t)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},r:function(e,t){return d3.round(e,t=g(e,t)).toFixed(Math.max(0,Math.min(20,t)))}}),Qi=["y","z","a","f","p","n","μ","m","","k","M","G","T","P","E","Z","Y"].map(x);d3.formatPrefix=function(e,t){var n=0;return e&&(e<0&&(e*=-1),t&&(e=d3.round(e,g(e,t))),n=1+Math.floor(1e-12+Math.log(e)/Math.LN10),n=Math.max(-24,Math.min(24,3*Math.floor((n<=0?n+1:n-1)/3)))),Qi[8+n/3]};var er=S(2),tr=S(3),nr=function(){return A},ir=d3.map({linear:nr,poly:S,quad:function(){return er},cubic:function(){return tr},sin:function(){return E},exp:function(){return M},circle:function(){return T},elastic:C,back:P,bounce:function(){return R}}),rr=d3.map({in:A,out:w,"in-out":_,"out-in":function(e){return _(w(e))}});d3.ease=function(e){var t=e.indexOf("-"),n=t>=0?e.substring(0,t):e,i=t>=0?e.substring(t+1):"in";return n=ir.get(n)||nr,i=rr.get(i)||A,b(i(n.apply(null,Array.prototype.slice.call(arguments,1))))},d3.event=null,d3.transform=function(e){var t=document.createElementNS(d3.ns.prefix.svg,"g");return(d3.transform=function(e){t.setAttribute("transform",e);var n=t.transform.baseVal.consolidate();return new I(n?n.matrix:sr)})(e)},I.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var or=180/Math.PI,sr={a:1,b:0,c:0,d:1,e:0,f:0};d3.interpolate=function(e,t){var n,i=d3.interpolators.length;while(--i>=0&&!(n=d3.interpolators[i](e,t)));return n},d3.interpolateNumber=function(e,t){return t-=e,function(n){return e+t*n}},d3.interpolateRound=function(e,t){return t-=e,function(n){return Math.round(e+t*n)}},d3.interpolateString=function(e,t){var n,i,r,o,s,a=0,l=[],u=[];for(ar.lastIndex=0,i=0;n=ar.exec(t);++i)n.index&&l.push(t.substring(a,n.index)),u.push({i:l.length,x:n[0]}),l.push(null),a=ar.lastIndex;for(a<t.length&&l.push(t.substring(a)),i=0,o=u.length;(n=ar.exec(e))&&i<o;++i)if(s=u[i],s.x==n[0]){if(s.i)if(null==l[s.i+1])for(l[s.i-1]+=s.x,l.splice(s.i,1),r=i+1;r<o;++r)u[r].i--;else for(l[s.i-1]+=s.x+l[s.i+1],l.splice(s.i,2),r=i+1;r<o;++r)u[r].i-=2;else if(null==l[s.i+1])l[s.i]=s.x;else for(l[s.i]=s.x+l[s.i+1],l.splice(s.i+1,1),r=i+1;r<o;++r)u[r].i--;u.splice(i,1),o--,i--}else s.x=d3.interpolateNumber(parseFloat(n[0]),parseFloat(s.x));while(i<o)s=u.pop(),null==l[s.i+1]?l[s.i]=s.x:(l[s.i]=s.x+l[s.i+1],l.splice(s.i+1,1)),o--;return 1===l.length?null==l[0]?u[0].x:function(){return t}:function(e){for(i=0;i<o;++i)l[(s=u[i]).i]=s.x(e);return l.join("")}},d3.interpolateTransform=function(e,t){var n,i=[],r=[],o=d3.transform(e),s=d3.transform(t),a=o.translate,l=s.translate,u=o.rotate,c=s.rotate,h=o.skew,d=s.skew,p=o.scale,f=s.scale;return a[0]!=l[0]||a[1]!=l[1]?(i.push("translate(",null,",",null,")"),r.push({i:1,x:d3.interpolateNumber(a[0],l[0])},{i:3,x:d3.interpolateNumber(a[1],l[1])})):l[0]||l[1]?i.push("translate("+l+")"):i.push(""),u!=c?(u-c>180?c+=360:c-u>180&&(u+=360),r.push({i:i.push(i.pop()+"rotate(",null,")")-2,x:d3.interpolateNumber(u,c)})):c&&i.push(i.pop()+"rotate("+c+")"),h!=d?r.push({i:i.push(i.pop()+"skewX(",null,")")-2,x:d3.interpolateNumber(h,d)}):d&&i.push(i.pop()+"skewX("+d+")"),p[0]!=f[0]||p[1]!=f[1]?(n=i.push(i.pop()+"scale(",null,",",null,")"),r.push({i:n-4,x:d3.interpolateNumber(p[0],f[0])},{i:n-2,x:d3.interpolateNumber(p[1],f[1])})):1==f[0]&&1==f[1]||i.push(i.pop()+"scale("+f+")"),n=r.length,function(e){var t,o=-1;while(++o<n)i[(t=r[o]).i]=t.x(e);return i.join("")}},d3.interpolateRgb=function(e,t){e=d3.rgb(e),t=d3.rgb(t);var n=e.r,i=e.g,r=e.b,o=t.r-n,s=t.g-i,a=t.b-r;return function(e){return"#"+H(Math.round(n+o*e))+H(Math.round(i+s*e))+H(Math.round(r+a*e))}},d3.interpolateHsl=function(e,t){e=d3.hsl(e),t=d3.hsl(t);var n=e.h,i=e.s,r=e.l,o=t.h-n,s=t.s-i,a=t.l-r;return o>180?o-=360:o<-180&&(o+=360),function(e){return K(n+o*e,i+s*e,r+a*e)+""}},d3.interpolateLab=function(e,t){e=d3.lab(e),t=d3.lab(t);var n=e.l,i=e.a,r=e.b,o=t.l-n,s=t.a-i,a=t.b-r;return function(e){return re(n+o*e,i+s*e,r+a*e)+""}},d3.interpolateHcl=function(e,t){e=d3.hcl(e),t=d3.hcl(t);var n=e.h,i=e.c,r=e.l,o=t.h-n,s=t.c-i,a=t.l-r;return o>180?o-=360:o<-180&&(o+=360),function(e){return te(n+o*e,i+s*e,r+a*e)+""}},d3.interpolateArray=function(e,t){var n,i=[],r=[],o=e.length,s=t.length,a=Math.min(e.length,t.length);for(n=0;n<a;++n)i.push(d3.interpolate(e[n],t[n]));for(;n<o;++n)r[n]=e[n];for(;n<s;++n)r[n]=t[n];return function(e){for(n=0;n<a;++n)r[n]=i[n](e);return r}},d3.interpolateObject=function(e,t){var n,i={},r={};for(n in e)n in t?i[n]=U(n)(e[n],t[n]):r[n]=e[n];for(n in t)n in e||(r[n]=t[n]);return function(e){for(n in i)r[n]=i[n](e);return r}};var ar=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g;d3.interpolators=[d3.interpolateObject,function(e,t){return t instanceof Array&&d3.interpolateArray(e,t)},function(e,t){return("string"===typeof e||"string"===typeof t)&&d3.interpolateString(e+"",t+"")},function(e,t){return("string"===typeof t?ur.has(t)||/^(#|rgb\(|hsl\()/.test(t):t instanceof j)&&d3.interpolateRgb(e,t)},function(e,t){return!isNaN(e=+e)&&!isNaN(t=+t)&&d3.interpolateNumber(e,t)}],j.prototype.toString=function(){return this.rgb()+""},d3.rgb=function(e,t,n){return 1===arguments.length?e instanceof $?B(e.r,e.g,e.b):G(""+e,B,K):B(~~e,~~t,~~n)};var lr=$.prototype=new j;lr.brighter=function(e){e=Math.pow(.7,arguments.length?e:1);var t=this.r,n=this.g,i=this.b,r=30;return t||n||i?(t&&t<r&&(t=r),n&&n<r&&(n=r),i&&i<r&&(i=r),B(Math.min(255,Math.floor(t/e)),Math.min(255,Math.floor(n/e)),Math.min(255,Math.floor(i/e)))):B(r,r,r)},lr.darker=function(e){return e=Math.pow(.7,arguments.length?e:1),B(Math.floor(e*this.r),Math.floor(e*this.g),Math.floor(e*this.b))},lr.hsl=function(){return W(this.r,this.g,this.b)},lr.toString=function(){return"#"+H(this.r)+H(this.g)+H(this.b)};var ur=d3.map({aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"});ur.forEach((function(e,t){ur.set(e,G(t,B,K))})),d3.hsl=function(e,t,n){return 1===arguments.length?e instanceof J?Z(e.h,e.s,e.l):G(""+e,W,Z):Z(+e,+t,+n)};var cr=J.prototype=new j;cr.brighter=function(e){return e=Math.pow(.7,arguments.length?e:1),Z(this.h,this.s,this.l/e)},cr.darker=function(e){return e=Math.pow(.7,arguments.length?e:1),Z(this.h,this.s,e*this.l)},cr.rgb=function(){return K(this.h,this.s,this.l)},d3.hcl=function(e,t,n){return 1===arguments.length?e instanceof ee?Q(e.h,e.c,e.l):oe(e instanceof ie?e.l:(e=q((e=d3.rgb(e)).r,e.g,e.b)).l,e.a,e.b):Q(+e,+t,+n)};var hr=ee.prototype=new j;hr.brighter=function(e){return Q(this.h,this.c,Math.min(100,this.l+dr*(arguments.length?e:1)))},hr.darker=function(e){return Q(this.h,this.c,Math.max(0,this.l-dr*(arguments.length?e:1)))},hr.rgb=function(){return te(this.h,this.c,this.l).rgb()},d3.lab=function(e,t,n){return 1===arguments.length?e instanceof ie?ne(e.l,e.a,e.b):e instanceof ee?te(e.l,e.c,e.h):q((e=d3.rgb(e)).r,e.g,e.b):ne(+e,+t,+n)};var dr=18,pr=.95047,fr=1,mr=1.08883,gr=ie.prototype=new j;gr.brighter=function(e){return ne(Math.min(100,this.l+dr*(arguments.length?e:1)),this.a,this.b)},gr.darker=function(e){return ne(Math.max(0,this.l-dr*(arguments.length?e:1)),this.a,this.b)},gr.rgb=function(){return re(this.l,this.a,this.b)};var vr=function(e,t){return t.querySelector(e)},yr=function(e,t){return t.querySelectorAll(e)},xr=document.documentElement,br=xr.matchesSelector||xr.webkitMatchesSelector||xr.mozMatchesSelector||xr.msMatchesSelector||xr.oMatchesSelector,wr=function(e,t){return br.call(e,t)};"function"===typeof Sizzle&&(vr=function(e,t){return Sizzle(e,t)[0]||null},yr=function(e,t){return Sizzle.uniqueSort(Sizzle(e,t))},wr=Sizzle.matchesSelector);var _r=[];d3.selection=function(){return Ar},d3.selection.prototype=_r,_r.select=function(e){var t,n,i,r,o=[];"function"!==typeof e&&(e=ce(e));for(var s=-1,a=this.length;++s<a;){o.push(t=[]),t.parentNode=(i=this[s]).parentNode;for(var l=-1,u=i.length;++l<u;)(r=i[l])?(t.push(n=e.call(r,r.__data__,l)),n&&"__data__"in r&&(n.__data__=r.__data__)):t.push(null)}return ue(o)},_r.selectAll=function(e){var t,n,i=[];"function"!==typeof e&&(e=he(e));for(var r=-1,o=this.length;++r<o;)for(var s=this[r],a=-1,l=s.length;++a<l;)(n=s[a])&&(i.push(t=Hi(e.call(n,n.__data__,a))),t.parentNode=n);return ue(i)},_r.attr=function(e,t){if(arguments.length<2){if("string"===typeof e){var n=this.node();return e=d3.ns.qualify(e),e.local?n.getAttributeNS(e.space,e.local):n.getAttribute(e)}for(t in e)this.each(de(t,e[t]));return this}return this.each(de(e,t))},_r.classed=function(e,t){if(arguments.length<2){if("string"===typeof e){var n=this.node(),i=(e=e.trim().split(/^|\s+/g)).length,r=-1;if(t=n.classList){while(++r<i)if(!t.contains(e[r]))return!1}else{t=n.className,null!=t.baseVal&&(t=t.baseVal);while(++r<i)if(!pe(e[r]).test(t))return!1}return!0}for(t in e)this.each(fe(t,e[t]));return this}return this.each(fe(e,t))},_r.style=function(e,t,n){var i=arguments.length;if(i<3){if("string"!==typeof e){for(n in i<2&&(t=""),e)this.each(ge(n,e[n],t));return this}if(i<2)return window.getComputedStyle(this.node(),null).getPropertyValue(e);n=""}return this.each(ge(e,t,n))},_r.property=function(e,t){if(arguments.length<2){if("string"===typeof e)return this.node()[e];for(t in e)this.each(ve(t,e[t]));return this}return this.each(ve(e,t))},_r.text=function(e){return arguments.length<1?this.node().textContent:this.each("function"===typeof e?function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}:null==e?function(){this.textContent=""}:function(){this.textContent=e})},_r.html=function(e){return arguments.length<1?this.node().innerHTML:this.each("function"===typeof e?function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}:null==e?function(){this.innerHTML=""}:function(){this.innerHTML=e})},_r.append=function(e){function t(){return this.appendChild(document.createElementNS(this.namespaceURI,e))}function n(){return this.appendChild(document.createElementNS(e.space,e.local))}return e=d3.ns.qualify(e),this.select(e.local?n:t)},_r.insert=function(e,t){function n(){return this.insertBefore(document.createElementNS(this.namespaceURI,e),vr(t,this))}function i(){return this.insertBefore(document.createElementNS(e.space,e.local),vr(t,this))}return e=d3.ns.qualify(e),this.select(e.local?i:n)},_r.remove=function(){return this.each((function(){var e=this.parentNode;e&&e.removeChild(this)}))},_r.data=function(e,t){function n(e,n){var r,o,s,a=e.length,h=n.length,d=Math.min(a,h),p=Math.max(a,h),f=[],m=[],g=[];if(t){var v,y=new i,x=[],b=n.length;for(r=-1;++r<a;)v=t.call(o=e[r],o.__data__,r),y.has(v)?g[b++]=o:y.set(v,o),x.push(v);for(r=-1;++r<h;)v=t.call(n,s=n[r],r),y.has(v)?(f[r]=o=y.get(v),o.__data__=s,m[r]=g[r]=null):(m[r]=ye(s),f[r]=g[r]=null),y.remove(v);for(r=-1;++r<a;)y.has(x[r])&&(g[r]=e[r])}else{for(r=-1;++r<d;)o=e[r],s=n[r],o?(o.__data__=s,f[r]=o,m[r]=g[r]=null):(m[r]=ye(s),f[r]=g[r]=null);for(;r<h;++r)m[r]=ye(n[r]),f[r]=g[r]=null;for(;r<p;++r)g[r]=e[r],m[r]=f[r]=null}m.update=f,m.parentNode=f.parentNode=g.parentNode=e.parentNode,l.push(m),u.push(f),c.push(g)}var r,o,s=-1,a=this.length;if(!arguments.length){e=new Array(a=(r=this[0]).length);while(++s<a)(o=r[s])&&(e[s]=o.__data__);return e}var l=Ae([]),u=ue([]),c=ue([]);if("function"===typeof e)while(++s<a)n(r=this[s],e.call(r,r.parentNode.__data__,s));else while(++s<a)n(r=this[s],e);return u.enter=function(){return l},u.exit=function(){return c},u},_r.datum=_r.map=function(e){return arguments.length<1?this.property("__data__"):this.property("__data__",e)},_r.filter=function(e){var t,n,i,r=[];"function"!==typeof e&&(e=xe(e));for(var o=0,s=this.length;o<s;o++){r.push(t=[]),t.parentNode=(n=this[o]).parentNode;for(var a=0,l=n.length;a<l;a++)(i=n[a])&&e.call(i,i.__data__,a)&&t.push(i)}return ue(r)},_r.order=function(){for(var e=-1,t=this.length;++e<t;)for(var n,i=this[e],r=i.length-1,o=i[r];--r>=0;)(n=i[r])&&(o&&o!==n.nextSibling&&o.parentNode.insertBefore(n,o),o=n);return this},_r.sort=function(e){e=be.apply(this,arguments);for(var t=-1,n=this.length;++t<n;)this[t].sort(e);return this.order()},_r.on=function(e,t,n){var i=arguments.length;if(i<3){if("string"!==typeof e){for(n in i<2&&(t=!1),e)this.each(we(n,e[n],t));return this}if(i<2)return(i=this.node()["__on"+e])&&i._;n=!1}return this.each(we(e,t,n))},_r.each=function(e){return _e(this,(function(t,n,i){e.call(t,t.__data__,n,i)}))},_r.call=function(e){return e.apply(this,(arguments[0]=this,arguments)),this},_r.empty=function(){return!this.node()},_r.node=function(e){for(var t=0,n=this.length;t<n;t++)for(var i=this[t],r=0,o=i.length;r<o;r++){var s=i[r];if(s)return s}return null},_r.transition=function(){for(var e,t,n=[],i=-1,r=this.length;++i<r;){n.push(e=[]);for(var o=this[i],s=-1,a=o.length;++s<a;)e.push((t=o[s])?{node:t,delay:Lr,duration:Or}:null)}return Se(n,Tr||++Mr,Date.now())};var Ar=ue([[document]]);Ar[0].parentNode=xr,d3.select=function(e){return"string"===typeof e?Ar.select(e):ue([[e]])},d3.selectAll=function(e){return"string"===typeof e?Ar.selectAll(e):ue([Hi(e)])};var Sr=[];d3.selection.enter=Ae,d3.selection.enter.prototype=Sr,Sr.append=_r.append,Sr.insert=_r.insert,Sr.empty=_r.empty,Sr.node=_r.node,Sr.select=function(e){for(var t,n,i,r,o,s=[],a=-1,l=this.length;++a<l;){i=(r=this[a]).update,s.push(t=[]),t.parentNode=r.parentNode;for(var u=-1,c=r.length;++u<c;)(o=r[u])?(t.push(i[u]=n=e.call(r.parentNode,o.__data__,u)),n.__data__=o.__data__):t.push(null)}return ue(s)};var Er=[],Mr=0,Tr=0,Cr=0,Pr=250,Rr=d3.ease("cubic-in-out"),Lr=Cr,Or=Pr,Dr=Rr;Er.call=_r.call,d3.transition=function(e){return arguments.length?Tr?e.transition():e:Ar.transition()},d3.transition.prototype=Er,Er.select=function(e){var t,n,i,r=[];"function"!==typeof e&&(e=ce(e));for(var o=-1,s=this.length;++o<s;){r.push(t=[]);for(var a=this[o],l=-1,u=a.length;++l<u;)(i=a[l])&&(n=e.call(i.node,i.node.__data__,l))?("__data__"in i.node&&(n.__data__=i.node.__data__),t.push({node:n,delay:i.delay,duration:i.duration})):t.push(null)}return Se(r,this.id,this.time).ease(this.ease())},Er.selectAll=function(e){var t,n,i,r=[];"function"!==typeof e&&(e=he(e));for(var o=-1,s=this.length;++o<s;)for(var a=this[o],l=-1,u=a.length;++l<u;)if(i=a[l]){n=e.call(i.node,i.node.__data__,l),r.push(t=[]);for(var c=-1,h=n.length;++c<h;)t.push({node:n[c],delay:i.delay,duration:i.duration})}return Se(r,this.id,this.time).ease(this.ease())},Er.filter=function(e){var t,n,i=[];"function"!==typeof e&&(e=xe(e));for(var r=0,o=this.length;r<o;r++){i.push(t=[]);for(var s=this[r],a=0,l=s.length;a<l;a++)(n=s[a])&&e.call(n.node,n.node.__data__,a)&&t.push(n)}return Se(i,this.id,this.time).ease(this.ease())},Er.attr=function(e,t){if(arguments.length<2){for(t in e)this.attrTween(t,Te(e[t],t));return this}return this.attrTween(e,Te(t,e))},Er.attrTween=function(e,t){function n(e,n){var i=t.call(this,e,n,this.getAttribute(r));return i===kr?(this.removeAttribute(r),null):i&&function(e){this.setAttribute(r,i(e))}}function i(e,n){var i=t.call(this,e,n,this.getAttributeNS(r.space,r.local));return i===kr?(this.removeAttributeNS(r.space,r.local),null):i&&function(e){this.setAttributeNS(r.space,r.local,i(e))}}var r=d3.ns.qualify(e);return this.tween("attr."+e,r.local?i:n)},Er.style=function(e,t,n){var i=arguments.length;if(i<3){if("string"!==typeof e){for(n in i<2&&(t=""),e)this.styleTween(n,Te(e[n],n),t);return this}n=""}return this.styleTween(e,Te(t,e),n)},Er.styleTween=function(e,t,n){return arguments.length<3&&(n=""),this.tween("style."+e,(function(i,r){var o=t.call(this,i,r,window.getComputedStyle(this,null).getPropertyValue(e));return o===kr?(this.style.removeProperty(e),null):o&&function(t){this.style.setProperty(e,o(t),n)}}))},Er.text=function(e){return this.tween("text",(function(t,n){this.textContent="function"===typeof e?e.call(this,t,n):e}))},Er.remove=function(){return this.each("end.transition",(function(){var e;!this.__transition__&&(e=this.parentNode)&&e.removeChild(this)}))},Er.delay=function(e){return _e(this,"function"===typeof e?function(t,n,i){t.delay=0|e.call(t=t.node,t.__data__,n,i)}:(e|=0,function(t){t.delay=e}))},Er.duration=function(e){return _e(this,"function"===typeof e?function(t,n,i){t.duration=Math.max(1,0|e.call(t=t.node,t.__data__,n,i))}:(e=Math.max(1,0|e),function(t){t.duration=e}))},Er.transition=function(){return this.select(o)},d3.tween=function(e,t){function n(n,i,r){var o=e.call(this,n,i);return null==o?""!=r&&kr:r!=o&&t(r,o+"")}function i(n,i,r){return r!=e&&t(r,e)}return"function"===typeof e?n:null==e?Me:(e+="",i)};var Ir,Nr,kr={},Vr=0,Ur={},Fr=null;d3.timer=function(e,t,n){if(arguments.length<3){if(arguments.length<2)t=0;else if(!isFinite(t))return;n=Date.now()}var i=Ur[e.id];i&&i.callback===e?(i.then=n,i.delay=t):Ur[e.id=++Vr]=Fr={callback:e,then:n,delay:t,next:Fr},Ir||(Nr=clearTimeout(Nr),Ir=1,zr(Ce))},d3.timer.flush=function(){var e,t=Date.now(),n=Fr;while(n)e=t-n.then,n.delay||(n.flush=n.callback(e)),n=n.next;Pe()};var zr=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,17)};d3.mouse=function(e){return Re(e,O())};var jr=/WebKit/.test(navigator.userAgent)?-1:0;d3.touches=function(e,t){return arguments.length<2&&(t=O().touches),t?Hi(t).map((function(t){var n=Re(e,t);return n.identifier=t.identifier,n})):[]},d3.scale={},d3.scale.linear=function(){return Ne([0,1],[0,1],d3.interpolate,!1)},d3.scale.log=function(){return $e(d3.scale.linear(),He)};var Br=d3.format(".0e");He.pow=function(e){return Math.pow(10,e)},Ge.pow=function(e){return-Math.pow(10,-e)},d3.scale.pow=function(){return We(d3.scale.linear(),1)},d3.scale.sqrt=function(){return d3.scale.pow().exponent(.5)},d3.scale.ordinal=function(){return Ye([],{t:"range",a:[[]]})},d3.scale.category10=function(){return d3.scale.ordinal().range($r)},d3.scale.category20=function(){return d3.scale.ordinal().range(Hr)},d3.scale.category20b=function(){return d3.scale.ordinal().range(Gr)},d3.scale.category20c=function(){return d3.scale.ordinal().range(Wr)};var $r=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],Hr=["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"],Gr=["#393b79","#5254a3","#6b6ecf","#9c9ede","#637939","#8ca252","#b5cf6b","#cedb9c","#8c6d31","#bd9e39","#e7ba52","#e7cb94","#843c39","#ad494a","#d6616b","#e7969c","#7b4173","#a55194","#ce6dbd","#de9ed6"],Wr=["#3182bd","#6baed6","#9ecae1","#c6dbef","#e6550d","#fd8d3c","#fdae6b","#fdd0a2","#31a354","#74c476","#a1d99b","#c7e9c0","#756bb1","#9e9ac8","#bcbddc","#dadaeb","#636363","#969696","#bdbdbd","#d9d9d9"];d3.scale.quantile=function(){return Xe([],[])},d3.scale.quantize=function(){return Ze(0,1,[0,1])},d3.scale.threshold=function(){return Je([.5],[0,1])},d3.scale.identity=function(){return Ke([0,1])},d3.svg={},d3.svg.arc=function(){function e(){var e=t.apply(this,arguments),o=n.apply(this,arguments),s=i.apply(this,arguments)+qr,a=r.apply(this,arguments)+qr,l=(a<s&&(l=s,s=a,a=l),a-s),u=l<Math.PI?"0":"1",c=Math.cos(s),h=Math.sin(s),d=Math.cos(a),p=Math.sin(a);return l>=Yr?e?"M0,"+o+"A"+o+","+o+" 0 1,1 0,"+-o+"A"+o+","+o+" 0 1,1 0,"+o+"M0,"+e+"A"+e+","+e+" 0 1,0 0,"+-e+"A"+e+","+e+" 0 1,0 0,"+e+"Z":"M0,"+o+"A"+o+","+o+" 0 1,1 0,"+-o+"A"+o+","+o+" 0 1,1 0,"+o+"Z":e?"M"+o*c+","+o*h+"A"+o+","+o+" 0 "+u+",1 "+o*d+","+o*p+"L"+e*d+","+e*p+"A"+e+","+e+" 0 "+u+",0 "+e*c+","+e*h+"Z":"M"+o*c+","+o*h+"A"+o+","+o+" 0 "+u+",1 "+o*d+","+o*p+"L0,0Z"}var t=Qe,n=et,i=tt,r=nt;return e.innerRadius=function(n){return arguments.length?(t=a(n),e):t},e.outerRadius=function(t){return arguments.length?(n=a(t),e):n},e.startAngle=function(t){return arguments.length?(i=a(t),e):i},e.endAngle=function(t){return arguments.length?(r=a(t),e):r},e.centroid=function(){var e=(t.apply(this,arguments)+n.apply(this,arguments))/2,o=(i.apply(this,arguments)+r.apply(this,arguments))/2+qr;return[Math.cos(o)*e,Math.sin(o)*e]},e};var qr=-Math.PI/2,Yr=2*Math.PI-1e-6;d3.svg.line=function(){return it(r)};var Xr=d3.map({linear:st,"linear-closed":at,"step-before":lt,"step-after":ut,basis:mt,"basis-open":gt,"basis-closed":vt,bundle:yt,cardinal:dt,"cardinal-open":ct,"cardinal-closed":ht,monotone:St});Xr.forEach((function(e,t){t.key=e,t.closed=/-closed$/.test(e)}));var Zr=[0,2/3,1/3,0],Jr=[0,1/3,2/3,0],Kr=[0,1/6,2/3,1/6];d3.svg.line.radial=function(){var e=it(Et);return e.radius=e.x,delete e.x,e.angle=e.y,delete e.y,e},lt.reverse=ut,ut.reverse=lt,d3.svg.area=function(){return Mt(r)},d3.svg.area.radial=function(){var e=Mt(Et);return e.radius=e.x,delete e.x,e.innerRadius=e.x0,delete e.x0,e.outerRadius=e.x1,delete e.x1,e.angle=e.y,delete e.y,e.startAngle=e.y0,delete e.y0,e.endAngle=e.y1,delete e.y1,e},d3.svg.chord=function(){function e(e,a){var l=t(this,o,e,a),u=t(this,s,e,a);return"M"+l.p0+i(l.r,l.p1,l.a1-l.a0)+(n(l,u)?r(l.r,l.p1,l.r,l.p0):r(l.r,l.p1,u.r,u.p0)+i(u.r,u.p1,u.a1-u.a0)+r(u.r,u.p1,l.r,l.p0))+"Z"}function t(e,t,n,i){var r=t.call(e,n,i),o=l.call(e,r,i),s=u.call(e,r,i)+qr,a=c.call(e,r,i)+qr;return{r:o,a0:s,a1:a,p0:[o*Math.cos(s),o*Math.sin(s)],p1:[o*Math.cos(a),o*Math.sin(a)]}}function n(e,t){return e.a0==t.a0&&e.a1==t.a1}function i(e,t,n){return"A"+e+","+e+" 0 "+ +(n>Math.PI)+",1 "+t}function r(e,t,n,i){return"Q 0,0 "+i}var o=Tt,s=Ct,l=Pt,u=tt,c=nt;return e.radius=function(t){return arguments.length?(l=a(t),e):l},e.source=function(t){return arguments.length?(o=a(t),e):o},e.target=function(t){return arguments.length?(s=a(t),e):s},e.startAngle=function(t){return arguments.length?(u=a(t),e):u},e.endAngle=function(t){return arguments.length?(c=a(t),e):c},e},d3.svg.diagonal=function(){function e(e,r){var o=t.call(this,e,r),s=n.call(this,e,r),a=(o.y+s.y)/2,l=[o,{x:o.x,y:a},{x:s.x,y:a},s];return l=l.map(i),"M"+l[0]+"C"+l[1]+" "+l[2]+" "+l[3]}var t=Tt,n=Ct,i=Rt;return e.source=function(n){return arguments.length?(t=a(n),e):t},e.target=function(t){return arguments.length?(n=a(t),e):n},e.projection=function(t){return arguments.length?(i=t,e):i},e},d3.svg.diagonal.radial=function(){var e=d3.svg.diagonal(),t=Rt,n=e.projection;return e.projection=function(e){return arguments.length?n(Lt(t=e)):t},e},d3.svg.mouse=d3.mouse,d3.svg.touches=d3.touches,d3.svg.symbol=function(){function e(e,i){return(Qr.get(t.call(this,e,i))||It)(n.call(this,e,i))}var t=Dt,n=Ot;return e.type=function(n){return arguments.length?(t=a(n),e):t},e.size=function(t){return arguments.length?(n=a(t),e):n},e};var Qr=d3.map({circle:It,cross:function(e){var t=Math.sqrt(e/5)/2;return"M"+-3*t+","+-t+"H"+-t+"V"+-3*t+"H"+t+"V"+-t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+-t+"V"+t+"H"+-3*t+"Z"},diamond:function(e){var t=Math.sqrt(e/(2*to)),n=t*to;return"M0,"+-t+"L"+n+",0 0,"+t+" "+-n+",0Z"},square:function(e){var t=Math.sqrt(e)/2;return"M"+-t+","+-t+"L"+t+","+-t+" "+t+","+t+" "+-t+","+t+"Z"},"triangle-down":function(e){var t=Math.sqrt(e/eo),n=t*eo/2;return"M0,"+n+"L"+t+","+-n+" "+-t+","+-n+"Z"},"triangle-up":function(e){var t=Math.sqrt(e/eo),n=t*eo/2;return"M0,"+-n+"L"+t+","+n+" "+-t+","+n+"Z"}});d3.svg.symbolTypes=Qr.keys();var eo=Math.sqrt(3),to=Math.tan(30*Math.PI/180);d3.svg.axis=function(){function e(e){e.each((function(){var e,h=d3.select(this),d=null==u?n.ticks?n.ticks.apply(n,l):n.domain():u,p=null==t?n.tickFormat?n.tickFormat.apply(n,l):String:t,f=Vt(n,d,c),m=h.selectAll(".minor").data(f,String),g=m.enter().insert("line","g").attr("class","tick minor").style("opacity",1e-6),v=d3.transition(m.exit()).style("opacity",1e-6).remove(),y=d3.transition(m).style("opacity",1),x=h.selectAll("g").data(d,String),b=x.enter().insert("g","path").style("opacity",1e-6),w=d3.transition(x.exit()).style("opacity",1e-6).remove(),_=d3.transition(x).style("opacity",1),A=Oe(n),S=h.selectAll(".domain").data([0]),E=(S.enter().append("path").attr("class","domain"),d3.transition(S)),M=n.copy(),T=this.__chart__||M;this.__chart__=M,b.append("line").attr("class","tick"),b.append("text");var C=b.select("line"),P=_.select("line"),R=x.select("text").text(p),L=b.select("text"),O=_.select("text");switch(i){case"bottom":e=Nt,g.attr("y2",o),y.attr("x2",0).attr("y2",o),C.attr("y2",r),L.attr("y",Math.max(r,0)+a),P.attr("x2",0).attr("y2",r),O.attr("x",0).attr("y",Math.max(r,0)+a),R.attr("dy",".71em").attr("text-anchor","middle"),E.attr("d","M"+A[0]+","+s+"V0H"+A[1]+"V"+s);break;case"top":e=Nt,g.attr("y2",-o),y.attr("x2",0).attr("y2",-o),C.attr("y2",-r),L.attr("y",-(Math.max(r,0)+a)),P.attr("x2",0).attr("y2",-r),O.attr("x",0).attr("y",-(Math.max(r,0)+a)),R.attr("dy","0em").attr("text-anchor","middle"),E.attr("d","M"+A[0]+","+-s+"V0H"+A[1]+"V"+-s);break;case"left":e=kt,g.attr("x2",-o),y.attr("x2",-o).attr("y2",0),C.attr("x2",-r),L.attr("x",-(Math.max(r,0)+a)),P.attr("x2",-r).attr("y2",0),O.attr("x",-(Math.max(r,0)+a)).attr("y",0),R.attr("dy",".32em").attr("text-anchor","end"),E.attr("d","M"+-s+","+A[0]+"H0V"+A[1]+"H"+-s);break;case"right":e=kt,g.attr("x2",o),y.attr("x2",o).attr("y2",0),C.attr("x2",r),L.attr("x",Math.max(r,0)+a),P.attr("x2",r).attr("y2",0),O.attr("x",Math.max(r,0)+a).attr("y",0),R.attr("dy",".32em").attr("text-anchor","start"),E.attr("d","M"+s+","+A[0]+"H0V"+A[1]+"H"+s);break}if(n.ticks)b.call(e,T),_.call(e,M),w.call(e,M),g.call(e,T),y.call(e,M),v.call(e,M);else{var D=M.rangeBand()/2,I=function(e){return M(e)+D};b.call(e,I),_.call(e,I)}}))}var t,n=d3.scale.linear(),i="bottom",r=6,o=6,s=6,a=3,l=[10],u=null,c=0;return e.scale=function(t){return arguments.length?(n=t,e):n},e.orient=function(t){return arguments.length?(i=t,e):i},e.ticks=function(){return arguments.length?(l=arguments,e):l},e.tickValues=function(t){return arguments.length?(u=t,e):u},e.tickFormat=function(n){return arguments.length?(t=n,e):t},e.tickSize=function(t,n,i){if(!arguments.length)return r;var a=arguments.length-1;return r=+t,o=a>1?+n:r,s=a>0?+arguments[a]:r,e},e.tickPadding=function(t){return arguments.length?(a=+t,e):a},e.tickSubdivide=function(t){return arguments.length?(c=+t,e):c},e},d3.svg.brush=function(){function e(o){o.each((function(){var o,s=d3.select(this),c=s.selectAll(".background").data([0]),h=s.selectAll(".extent").data([0]),d=s.selectAll(".resize").data(u,String);s.style("pointer-events","all").on("mousedown.brush",r).on("touchstart.brush",r),c.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),h.enter().append("rect").attr("class","extent").style("cursor","move"),d.enter().append("g").attr("class",(function(e){return"resize "+e})).style("cursor",(function(e){return no[e]})).append("rect").attr("x",(function(e){return/[ew]$/.test(e)?-3:null})).attr("y",(function(e){return/^[ns]/.test(e)?-3:null})).attr("width",6).attr("height",6).style("visibility","hidden"),d.style("display",e.empty()?"none":null),d.exit().remove(),a&&(o=Oe(a),c.attr("x",o[0]).attr("width",o[1]-o[0]),n(s)),l&&(o=Oe(l),c.attr("y",o[0]).attr("height",o[1]-o[0]),i(s)),t(s)}))}function t(e){e.selectAll(".resize").attr("transform",(function(e){return"translate("+c[+/e$/.test(e)][0]+","+c[+/^s/.test(e)][1]+")"}))}function n(e){e.select(".extent").attr("x",c[0][0]),e.selectAll(".extent,.n>rect,.s>rect").attr("width",c[1][0]-c[0][0])}function i(e){e.select(".extent").attr("y",c[0][1]),e.selectAll(".extent,.e>rect,.w>rect").attr("height",c[1][1]-c[0][1])}function r(){function r(){var e=d3.event.changedTouches;return e?d3.touches(v,e)[0]:d3.mouse(v)}function u(){32==d3.event.keyCode&&(S||(m=null,E[0]-=c[1][0],E[1]-=c[1][1],S=2),L())}function h(){32==d3.event.keyCode&&2==S&&(E[0]+=c[1][0],E[1]+=c[1][1],S=0,L())}function d(){var e=r(),o=!1;g&&(e[0]+=g[0],e[1]+=g[1]),S||(d3.event.altKey?(m||(m=[(c[0][0]+c[1][0])/2,(c[0][1]+c[1][1])/2]),E[0]=c[+(e[0]<m[0])][0],E[1]=c[+(e[1]<m[1])][1]):m=null),_&&p(e,a,0)&&(n(b),o=!0),A&&p(e,l,1)&&(i(b),o=!0),o&&(t(b),x({type:"brush",mode:S?"move":"resize"}))}function p(e,t,n){var i,r,s=Oe(t),a=s[0],l=s[1],u=E[n],h=c[1][n]-c[0][n];if(S&&(a-=u,l-=h+u),i=Math.max(a,Math.min(l,e[n])),S?r=(i+=u)+h:(m&&(u=Math.max(a,Math.min(l,2*m[n]-i))),u<i?(r=i,i=u):r=u),c[0][n]!==i||c[1][n]!==r)return o=null,c[0][n]=i,c[1][n]=r,!0}function f(){d(),b.style("pointer-events","all").selectAll(".resize").style("display",e.empty()?"none":null),d3.select("body").style("cursor",null),M.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),x({type:"brushend"}),L()}var m,g,v=this,y=d3.select(d3.event.target),x=s.of(v,arguments),b=d3.select(v),w=y.datum(),_=!/^(n|s)$/.test(w)&&a,A=!/^(e|w)$/.test(w)&&l,S=y.classed("extent"),E=r(),M=d3.select(window).on("mousemove.brush",d).on("mouseup.brush",f).on("touchmove.brush",d).on("touchend.brush",f).on("keydown.brush",u).on("keyup.brush",h);if(S)E[0]=c[0][0]-E[0],E[1]=c[0][1]-E[1];else if(w){var T=+/w$/.test(w),C=+/^n/.test(w);g=[c[1-T][0]-E[0],c[1-C][1]-E[1]],E[0]=c[T][0],E[1]=c[C][1]}else d3.event.altKey&&(m=E.slice());b.style("pointer-events","none").selectAll(".resize").style("display",null),d3.select("body").style("cursor",y.style("cursor")),x({type:"brushstart"}),d(),L()}var o,s=D(e,"brushstart","brush","brushend"),a=null,l=null,u=io[0],c=[[0,0],[0,0]];return e.x=function(t){return arguments.length?(a=t,u=io[!a<<1|!l],e):a},e.y=function(t){return arguments.length?(l=t,u=io[!a<<1|!l],e):l},e.extent=function(t){var n,i,r,s,u;return arguments.length?(o=[[0,0],[0,0]],a&&(n=t[0],i=t[1],l&&(n=n[0],i=i[0]),o[0][0]=n,o[1][0]=i,a.invert&&(n=a(n),i=a(i)),i<n&&(u=n,n=i,i=u),c[0][0]=0|n,c[1][0]=0|i),l&&(r=t[0],s=t[1],a&&(r=r[1],s=s[1]),o[0][1]=r,o[1][1]=s,l.invert&&(r=l(r),s=l(s)),s<r&&(u=r,r=s,s=u),c[0][1]=0|r,c[1][1]=0|s),e):(t=o||c,a&&(n=t[0][0],i=t[1][0],o||(n=c[0][0],i=c[1][0],a.invert&&(n=a.invert(n),i=a.invert(i)),i<n&&(u=n,n=i,i=u))),l&&(r=t[0][1],s=t[1][1],o||(r=c[0][1],s=c[1][1],l.invert&&(r=l.invert(r),s=l.invert(s)),s<r&&(u=r,r=s,s=u))),a&&l?[[n,r],[i,s]]:a?[n,i]:l&&[r,s])},e.clear=function(){return o=null,c[0][0]=c[0][1]=c[1][0]=c[1][1]=0,e},e.empty=function(){return a&&c[0][0]===c[1][0]||l&&c[0][1]===c[1][1]},d3.rebind(e,s,"on")};var no={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},io=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];d3.behavior={},d3.behavior.drag=function(){function e(){this.on("mousedown.drag",t).on("touchstart.drag",t)}function t(){function e(){var e=a.parentNode;return c?d3.touches(e).filter((function(e){return e.identifier===c}))[0]:d3.mouse(e)}function t(){if(!a.parentNode)return r();var t=e(),n=t[0]-h[0],i=t[1]-h[1];d|=n|i,h=t,L(),l({type:"drag",x:t[0]+s[0],y:t[1]+s[1],dx:n,dy:i})}function r(){l({type:"dragend"}),d&&(L(),d3.event.target===u&&p.on("click.drag",o,!0)),p.on(c?"touchmove.drag-"+c:"mousemove.drag",null).on(c?"touchend.drag-"+c:"mouseup.drag",null)}function o(){L(),p.on("click.drag",null)}var s,a=this,l=n.of(a,arguments),u=d3.event.target,c=d3.event.touches&&d3.event.changedTouches[0].identifier,h=e(),d=0,p=d3.select(window).on(c?"touchmove.drag-"+c:"mousemove.drag",t).on(c?"touchend.drag-"+c:"mouseup.drag",r,!0);i?(s=i.apply(a,arguments),s=[s.x-h[0],s.y-h[1]]):s=[0,0],c||L(),l({type:"dragstart"})}var n=D(e,"drag","dragstart","dragend"),i=null;return e.origin=function(t){return arguments.length?(i=t,e):i},d3.rebind(e,n,"on")},d3.behavior.zoom=function(){function e(){this.on("mousedown.zoom",s).on("mousewheel.zoom",a).on("mousemove.zoom",l).on("DOMMouseScroll.zoom",a).on("dblclick.zoom",u).on("touchstart.zoom",c).on("touchmove.zoom",h).on("touchend.zoom",c)}function t(e){return[(e[0]-x[0])/b,(e[1]-x[1])/b]}function n(e){return[e[0]*b+x[0],e[1]*b+x[1]]}function i(e){b=Math.max(w[0],Math.min(w[1],e))}function r(e,t){t=n(t),x[0]+=e[0]-t[0],x[1]+=e[1]-t[1]}function o(e){m&&m.domain(f.range().map((function(e){return(e-x[0])/b})).map(f.invert)),v&&v.domain(g.range().map((function(e){return(e-x[1])/b})).map(g.invert)),d3.event.preventDefault(),e({type:"zoom",scale:b,translate:x})}function s(){function e(){u=1,r(d3.mouse(s),h),o(a)}function n(){u&&L(),c.on("mousemove.zoom",null).on("mouseup.zoom",null),u&&d3.event.target===l&&c.on("click.zoom",i,!0)}function i(){L(),c.on("click.zoom",null)}var s=this,a=_.of(s,arguments),l=d3.event.target,u=0,c=d3.select(window).on("mousemove.zoom",e).on("mouseup.zoom",n),h=t(d3.mouse(s));window.focus(),L()}function a(){d||(d=t(d3.mouse(this))),i(Math.pow(2,.002*Ut())*b),r(d3.mouse(this),d),o(_.of(this,arguments))}function l(){d=null}function u(){var e=d3.mouse(this),n=t(e);i(d3.event.shiftKey?b/2:2*b),r(e,n),o(_.of(this,arguments))}function c(){var e=d3.touches(this),n=Date.now();if(p=b,d={},e.forEach((function(e){d[e.identifier]=t(e)})),L(),1===e.length){if(n-y<500){var s=e[0],a=t(e[0]);i(2*b),r(s,a),o(_.of(this,arguments))}y=n}}function h(){var e=d3.touches(this),t=e[0],n=d[t.identifier];if(s=e[1]){var s,a=d[s.identifier];t=[(t[0]+s[0])/2,(t[1]+s[1])/2],n=[(n[0]+a[0])/2,(n[1]+a[1])/2],i(d3.event.scale*p)}r(t,n),y=null,o(_.of(this,arguments))}var d,p,f,m,g,v,y,x=[0,0],b=1,w=oo,_=D(e,"zoom");return e.translate=function(t){return arguments.length?(x=t.map(Number),e):x},e.scale=function(t){return arguments.length?(b=+t,e):b},e.scaleExtent=function(t){return arguments.length?(w=null==t?oo:t.map(Number),e):w},e.x=function(t){return arguments.length?(m=t,f=t.copy(),e):m},e.y=function(t){return arguments.length?(v=t,g=t.copy(),e):v},d3.rebind(e,_,"on")};var ro,oo=[0,1/0];d3.layout={},d3.layout.bundle=function(){return function(e){var t=[],n=-1,i=e.length;while(++n<i)t.push(Ft(e[n]));return t}},d3.layout.chord=function(){function e(){var e,u,h,d,p,f={},m=[],g=d3.range(o),v=[];n=[],i=[],e=0,d=-1;while(++d<o){u=0,p=-1;while(++p<o)u+=r[d][p];m.push(u),v.push(d3.range(o)),e+=u}s&&g.sort((function(e,t){return s(m[e],m[t])})),a&&v.forEach((function(e,t){e.sort((function(e,n){return a(r[t][e],r[t][n])}))})),e=(2*Math.PI-c*o)/e,u=0,d=-1;while(++d<o){h=u,p=-1;while(++p<o){var y=g[d],x=v[y][p],b=r[y][x],w=u,_=u+=b*e;f[y+"-"+x]={index:y,subindex:x,startAngle:w,endAngle:_,value:b}}i[y]={index:y,startAngle:h,endAngle:u,value:(u-h)/e},u+=c}d=-1;while(++d<o){p=d-1;while(++p<o){var A=f[d+"-"+p],S=f[p+"-"+d];(A.value||S.value)&&n.push(A.value<S.value?{source:S,target:A}:{source:A,target:S})}}l&&t()}function t(){n.sort((function(e,t){return l((e.source.value+e.target.value)/2,(t.source.value+t.target.value)/2)}))}var n,i,r,o,s,a,l,u={},c=0;return u.matrix=function(e){return arguments.length?(o=(r=e)&&r.length,n=i=null,u):r},u.padding=function(e){return arguments.length?(c=e,n=i=null,u):c},u.sortGroups=function(e){return arguments.length?(s=e,n=i=null,u):s},u.sortSubgroups=function(e){return arguments.length?(a=e,n=null,u):a},u.sortChords=function(e){return arguments.length?(l=e,n&&t(),u):l},u.chords=function(){return n||e(),n},u.groups=function(){return i||e(),i},u},d3.layout.force=function(){function e(e){return function(t,n,i,r,o){if(t.point!==e){var s=t.cx-e.x,a=t.cy-e.y,l=1/Math.sqrt(s*s+a*a);if((r-n)*l<v){var u=t.charge*l*l;return e.px-=s*u,e.py-=a*u,!0}if(t.point&&isFinite(l)){u=t.pointCharge*l*l;e.px-=s*u,e.py-=a*u}}return!t.charge}}function t(e){e.px=d3.event.x,e.py=d3.event.y,u.resume()}var n,i,o,s,l,u={},c=d3.dispatch("start","tick","end"),h=[1,1],d=.9,p=qt,f=Yt,m=-30,g=.1,v=.8,y=[],x=[];return u.tick=function(){if((i*=.99)<.005)return c.end({type:"end",alpha:i=0}),!0;var t,n,r,a,u,p,f,v,b,w=y.length,_=x.length;for(n=0;n<_;++n)r=x[n],a=r.source,u=r.target,v=u.x-a.x,b=u.y-a.y,(p=v*v+b*b)&&(p=i*s[n]*((p=Math.sqrt(p))-o[n])/p,v*=p,b*=p,u.x-=v*(f=a.weight/(u.weight+a.weight)),u.y-=b*f,a.x+=v*(f=1-f),a.y+=b*f);if((f=i*g)&&(v=h[0]/2,b=h[1]/2,n=-1,f))while(++n<w)r=y[n],r.x+=(v-r.x)*f,r.y+=(b-r.y)*f;if(m){Wt(t=d3.geom.quadtree(y),i,l),n=-1;while(++n<w)(r=y[n]).fixed||t.visit(e(r))}n=-1;while(++n<w)r=y[n],r.fixed?(r.x=r.px,r.y=r.py):(r.x-=(r.px-(r.px=r.x))*d,r.y-=(r.py-(r.py=r.y))*d);c.tick({type:"tick",alpha:i})},u.nodes=function(e){return arguments.length?(y=e,u):y},u.links=function(e){return arguments.length?(x=e,u):x},u.size=function(e){return arguments.length?(h=e,u):h},u.linkDistance=function(e){return arguments.length?(p=a(e),u):p},u.distance=u.linkDistance,u.linkStrength=function(e){return arguments.length?(f=a(e),u):f},u.friction=function(e){return arguments.length?(d=e,u):d},u.charge=function(e){return arguments.length?(m="function"===typeof e?e:+e,u):m},u.gravity=function(e){return arguments.length?(g=e,u):g},u.theta=function(e){return arguments.length?(v=e,u):v},u.alpha=function(e){return arguments.length?(i?i=e>0?e:0:e>0&&(c.start({type:"start",alpha:i=e}),d3.timer(u.tick)),u):i},u.start=function(){function e(e,i){var r,o=t(n),s=-1,a=o.length;while(++s<a)if(!isNaN(r=o[s][e]))return r;return Math.random()*i}function t(){if(!r){for(r=[],i=0;i<c;++i)r[i]=[];for(i=0;i<d;++i){var e=x[i];r[e.source.index].push(e.target),r[e.target.index].push(e.source)}}return r[n]}var n,i,r,a,c=y.length,d=x.length,g=h[0],v=h[1];for(n=0;n<c;++n)(a=y[n]).index=n,a.weight=0;for(o=[],s=[],n=0;n<d;++n)a=x[n],"number"==typeof a.source&&(a.source=y[a.source]),"number"==typeof a.target&&(a.target=y[a.target]),o[n]=p.call(this,a,n),s[n]=f.call(this,a,n),++a.source.weight,++a.target.weight;for(n=0;n<c;++n)a=y[n],isNaN(a.x)&&(a.x=e("x",g)),isNaN(a.y)&&(a.y=e("y",v)),isNaN(a.px)&&(a.px=a.x),isNaN(a.py)&&(a.py=a.y);if(l=[],"function"===typeof m)for(n=0;n<c;++n)l[n]=+m.call(this,y[n],n);else for(n=0;n<c;++n)l[n]=m;return u.resume()},u.resume=function(){return u.alpha(.1)},u.stop=function(){return u.alpha(0)},u.drag=function(){n||(n=d3.behavior.drag().origin(r).on("dragstart",Bt).on("drag",t).on("dragend",$t)),this.on("mouseover.force",Ht).on("mouseout.force",Gt).call(n)},d3.rebind(u,c,"on")},d3.layout.partition=function(){function e(t,n,i,r){var o=t.children;if(t.x=n,t.y=t.depth*r,t.dx=i,t.dy=r,o&&(s=o.length)){var s,a,l,u=-1;i=t.value?i/t.value:0;while(++u<s)e(a=o[u],n,l=a.value*i,r),n+=l}}function t(e){var n=e.children,i=0;if(n&&(r=n.length)){var r,o=-1;while(++o<r)i=Math.max(i,t(n[o]))}return 1+i}function n(n,o){var s=i.call(this,n,o);return e(s[0],0,r[0],r[1]/t(s[0])),s}var i=d3.layout.hierarchy(),r=[1,1];return n.size=function(e){return arguments.length?(r=e,n):r},an(n,i)},d3.layout.pie=function(){function e(o,s){var a=o.map((function(n,i){return+t.call(e,n,i)})),l=+("function"===typeof i?i.apply(this,arguments):i),u=(("function"===typeof r?r.apply(this,arguments):r)-i)/d3.sum(a),c=d3.range(o.length);null!=n&&c.sort(n===so?function(e,t){return a[t]-a[e]}:function(e,t){return n(o[e],o[t])});var h=[];return c.forEach((function(e){var t;h[e]={data:o[e],value:t=a[e],startAngle:l,endAngle:l+=t*u}})),h}var t=Number,n=so,i=0,r=2*Math.PI;return e.value=function(n){return arguments.length?(t=n,e):t},e.sort=function(t){return arguments.length?(n=t,e):n},e.startAngle=function(t){return arguments.length?(i=t,e):i},e.endAngle=function(t){return arguments.length?(r=t,e):r},e};var so={};d3.layout.stack=function(){function e(r,l){var u=r.map((function(n,i){return t.call(e,n,i)})),c=u.map((function(t,n){return t.map((function(t,n){return[s.call(e,t,n),a.call(e,t,n)]}))})),h=n.call(e,c,l);u=d3.permute(u,h),c=d3.permute(c,h);var d,p,f,m=i.call(e,c,l),g=u.length,v=u[0].length;for(p=0;p<v;++p)for(o.call(e,u[0][p],f=m[p],c[0][p][1]),d=1;d<g;++d)o.call(e,u[d][p],f+=c[d-1][p][1],c[d][p][1]);return r}var t=r,n=Kt,i=Qt,o=Jt,s=Xt,a=Zt;return e.values=function(n){return arguments.length?(t=n,e):t},e.order=function(t){return arguments.length?(n="function"===typeof t?t:ao.get(t)||Kt,e):n},e.offset=function(t){return arguments.length?(i="function"===typeof t?t:lo.get(t)||Qt,e):i},e.x=function(t){return arguments.length?(s=t,e):s},e.y=function(t){return arguments.length?(a=t,e):a},e.out=function(t){return arguments.length?(o=t,e):o},e};var ao=d3.map({"inside-out":function(e){var t,n,i=e.length,r=e.map(en),o=e.map(tn),s=d3.range(i).sort((function(e,t){return r[e]-r[t]})),a=0,l=0,u=[],c=[];for(t=0;t<i;++t)n=s[t],a<l?(a+=o[n],u.push(n)):(l+=o[n],c.push(n));return c.reverse().concat(u)},reverse:function(e){return d3.range(e.length).reverse()},default:Kt}),lo=d3.map({silhouette:function(e){var t,n,i,r=e.length,o=e[0].length,s=[],a=0,l=[];for(n=0;n<o;++n){for(t=0,i=0;t<r;t++)i+=e[t][n][1];i>a&&(a=i),s.push(i)}for(n=0;n<o;++n)l[n]=(a-s[n])/2;return l},wiggle:function(e){var t,n,i,r,o,s,a,l,u,c=e.length,h=e[0],d=h.length,p=[];for(p[0]=l=u=0,n=1;n<d;++n){for(t=0,r=0;t<c;++t)r+=e[t][n][1];for(t=0,o=0,a=h[n][0]-h[n-1][0];t<c;++t){for(i=0,s=(e[t][n][1]-e[t][n-1][1])/(2*a);i<t;++i)s+=(e[i][n][1]-e[i][n-1][1])/a;o+=s*e[t][n][1]}p[n]=l-=r?o/r*a:0,l<u&&(u=l)}for(n=0;n<d;++n)p[n]-=u;return p},expand:function(e){var t,n,i,r=e.length,o=e[0].length,s=1/r,a=[];for(n=0;n<o;++n){for(t=0,i=0;t<r;t++)i+=e[t][n][1];if(i)for(t=0;t<r;t++)e[t][n][1]/=i;else for(t=0;t<r;t++)e[t][n][1]=s}for(n=0;n<o;++n)a[n]=0;return a},zero:Qt});d3.layout.histogram=function(){function e(e,o){var s,a,l=[],u=e.map(n,this),c=i.call(this,u,o),h=r.call(this,c,u,o),d=(o=-1,u.length),p=h.length-1,f=t?1:1/d;while(++o<p)s=l[o]=[],s.dx=h[o+1]-(s.x=h[o]),s.y=0;if(p>0){o=-1;while(++o<d)a=u[o],a>=c[0]&&a<=c[1]&&(s=l[d3.bisect(h,a,1,p)-1],s.y+=f,s.push(e[o]))}return l}var t=!0,n=Number,i=sn,r=rn;return e.value=function(t){return arguments.length?(n=t,e):n},e.range=function(t){return arguments.length?(i=a(t),e):i},e.bins=function(t){return arguments.length?(r="number"===typeof t?function(e){return on(e,t)}:a(t),e):r},e.frequency=function(n){return arguments.length?(t=!!n,e):t},e},d3.layout.hierarchy=function(){function e(t,s,a){var l=r.call(n,t,s),u=uo?t:{data:t};if(u.depth=s,a.push(u),l&&(c=l.length)){var c,h,d=-1,p=u.children=[],f=0,m=s+1;while(++d<c)h=e(l[d],m,a),h.parent=u,p.push(h),f+=h.value;i&&p.sort(i),o&&(u.value=f)}else o&&(u.value=+o.call(n,t,s)||0);return u}function t(e,i){var r=e.children,s=0;if(r&&(a=r.length)){var a,l=-1,u=i+1;while(++l<a)s+=t(r[l],u)}else o&&(s=+o.call(n,uo?e:e.data,i)||0);return o&&(e.value=s),s}function n(t){var n=[];return e(t,0,n),n}var i=cn,r=ln,o=un;return n.sort=function(e){return arguments.length?(i=e,n):i},n.children=function(e){return arguments.length?(r=e,n):r},n.value=function(e){return arguments.length?(o=e,n):o},n.revalue=function(e){return t(e,0),e},n};var uo=!1;d3.layout.pack=function(){function e(e,r){var o=t.call(this,e,r),s=o[0];s.x=0,s.y=0,On(s,(function(e){e.r=Math.sqrt(e.value)})),On(s,gn);var a=i[0],l=i[1],u=Math.max(2*s.r/a,2*s.r/l);if(n>0){var c=n*u/2;On(s,(function(e){e.r+=c})),On(s,gn),On(s,(function(e){e.r-=c})),u=Math.max(2*s.r/a,2*s.r/l)}return xn(s,a/2,l/2,1/u),o}var t=d3.layout.hierarchy().sort(dn),n=0,i=[1,1];return e.size=function(t){return arguments.length?(i=t,e):i},e.padding=function(t){return arguments.length?(n=+t,e):n},an(e,t)},d3.layout.cluster=function(){function e(e,r){var o,s=t.call(this,e,r),a=s[0],l=0;On(a,(function(e){var t=e.children;t&&t.length?(e.x=_n(t),e.y=wn(t)):(e.x=o?l+=n(e,o):0,e.y=0,o=e)}));var u=An(a),c=Sn(a),h=u.x-n(u,c)/2,d=c.x+n(c,u)/2;return On(a,(function(e){e.x=(e.x-h)/(d-h)*i[0],e.y=(1-(a.y?e.y/a.y:1))*i[1]})),s}var t=d3.layout.hierarchy().sort(null).value(null),n=En,i=[1,1];return e.separation=function(t){return arguments.length?(n=t,e):n},e.size=function(t){return arguments.length?(i=t,e):i},an(e,t)},d3.layout.tree=function(){function e(e,r){function o(e,t){var i=e.children,r=e._tree;if(i&&(s=i.length)){var s,l,u,c=i[0],h=c,d=-1;while(++d<s)u=i[d],o(u,l),h=a(u,l,h),l=u;Dn(e);var p=.5*(c._tree.prelim+u._tree.prelim);t?(r.prelim=t._tree.prelim+n(e,t),r.mod=r.prelim-p):r.prelim=p}else t&&(r.prelim=t._tree.prelim+n(e,t))}function s(e,t){e.x=e._tree.prelim+t;var n=e.children;if(n&&(i=n.length)){var i,r=-1;t+=e._tree.mod;while(++r<i)s(n[r],t)}}function a(e,t,i){if(t){var r,o=e,s=e,a=t,l=e.parent.children[0],u=o._tree.mod,c=s._tree.mod,h=a._tree.mod,d=l._tree.mod;while(a=Tn(a),o=Mn(o),a&&o)l=Mn(l),s=Tn(s),s._tree.ancestor=e,r=a._tree.prelim+h-o._tree.prelim-u+n(a,o),r>0&&(In(Nn(a,e,i),e,r),u+=r,c+=r),h+=a._tree.mod,u+=o._tree.mod,d+=l._tree.mod,c+=s._tree.mod;a&&!Tn(s)&&(s._tree.thread=a,s._tree.mod+=h-c),o&&!Mn(l)&&(l._tree.thread=o,l._tree.mod+=u-d,i=e)}return i}var l=t.call(this,e,r),u=l[0];On(u,(function(e,t){e._tree={ancestor:e,prelim:0,mod:0,change:0,shift:0,number:t?t._tree.number+1:0}})),o(u),s(u,-u._tree.prelim);var c=Cn(u,Rn),h=Cn(u,Pn),d=Cn(u,Ln),p=c.x-n(c,h)/2,f=h.x+n(h,c)/2,m=d.depth||1;return On(u,(function(e){e.x=(e.x-p)/(f-p)*i[0],e.y=e.depth/m*i[1],delete e._tree})),l}var t=d3.layout.hierarchy().sort(null).value(null),n=En,i=[1,1];return e.separation=function(t){return arguments.length?(n=t,e):n},e.size=function(t){return arguments.length?(i=t,e):i},an(e,t)},d3.layout.treemap=function(){function e(e,t){var n,i,r=-1,o=e.length;while(++r<o)i=(n=e[r]).value*(t<0?0:t),n.area=isNaN(i)||i<=0?0:i}function t(n){var o=n.children;if(o&&o.length){var s,a,l,u=h(n),c=[],d=o.slice(),p=1/0,f=Math.min(u.dx,u.dy);e(d,u.dx*u.dy/n.value),c.area=0;while((l=d.length)>0)c.push(s=d[l-1]),c.area+=s.area,(a=i(c,f))<=p?(d.pop(),p=a):(c.area-=c.pop().area,r(c,f,u,!1),f=Math.min(u.dx,u.dy),c.length=c.area=0,p=1/0);c.length&&(r(c,f,u,!0),c.length=c.area=0),o.forEach(t)}}function n(t){var i=t.children;if(i&&i.length){var o,s=h(t),a=i.slice(),l=[];e(a,s.dx*s.dy/t.value),l.area=0;while(o=a.pop())l.push(o),l.area+=o.area,null!=o.z&&(r(l,o.z?s.dx:s.dy,s,!a.length),l.length=l.area=0);i.forEach(n)}}function i(e,t){var n,i=e.area,r=0,o=1/0,s=-1,a=e.length;while(++s<a)(n=e[s].area)&&(n<o&&(o=n),n>r&&(r=n));return i*=i,t*=t,i?Math.max(t*r*p/i,i/(t*o*p)):1/0}function r(e,t,n,i){var r,o=-1,s=e.length,a=n.x,u=n.y,c=t?l(e.area/t):0;if(t==n.dx){(i||c>n.dy)&&(c=n.dy);while(++o<s)r=e[o],r.x=a,r.y=u,r.dy=c,a+=r.dx=Math.min(n.x+n.dx-a,c?l(r.area/c):0);r.z=!0,r.dx+=n.x+n.dx-a,n.y+=c,n.dy-=c}else{(i||c>n.dx)&&(c=n.dx);while(++o<s)r=e[o],r.x=a,r.y=u,r.dx=c,u+=r.dy=Math.min(n.y+n.dy-u,c?l(r.area/c):0);r.z=!1,r.dy+=n.y+n.dy-u,n.x+=c,n.dx-=c}}function o(i){var r=s||a(i),o=r[0];return o.x=0,o.y=0,o.dx=u[0],o.dy=u[1],s&&a.revalue(o),e([o],o.dx*o.dy/o.value),(s?n:t)(o),d&&(s=r),r}var s,a=d3.layout.hierarchy(),l=Math.round,u=[1,1],c=null,h=kn,d=!1,p=.5*(1+Math.sqrt(5));return o.size=function(e){return arguments.length?(u=e,o):u},o.padding=function(e){function t(t){var n=e.call(o,t,t.depth);return null==n?kn(t):Vn(t,"number"===typeof n?[n,n,n,n]:n)}function n(t){return Vn(t,e)}return arguments.length?(h=null==(c=e)?kn:"function"===(i=typeof e)?t:"number"===i?(e=[e,e,e,e],n):n,o):c;var i},o.round=function(e){return arguments.length?(l=e?Math.round:Number,o):l!=Number},o.sticky=function(e){return arguments.length?(d=e,s=null,o):d},o.ratio=function(e){return arguments.length?(p=e,o):p},an(o,a)},d3.csv=Un(",","text/csv"),d3.tsv=Un("\t","text/tab-separated-values"),d3.geo={};var co=Math.PI/180;d3.geo.azimuthal=function(){function e(e){var t,i=e[0]*co-n,u=e[1]*co,c=Math.cos(i),h=Math.sin(i),d=Math.cos(u),p=Math.sin(u),f="orthographic"!==s?o*p+r*d*c:null,m="stereographic"===s?1/(1+f):"gnomonic"===s?1/f:"equidistant"===s?(t=Math.acos(f),t?t/Math.sin(t):0):"equalarea"===s?Math.sqrt(2/(1+f)):1,g=m*d*h,v=m*(o*d*c-r*p);return[a*g+l[0],a*v+l[1]]}var t,n,i,r,o,s="orthographic",a=200,l=[480,250];return e.invert=function(e){var t=(e[0]-l[0])/a,i=(e[1]-l[1])/a,u=Math.sqrt(t*t+i*i),c="stereographic"===s?2*Math.atan(u):"gnomonic"===s?Math.atan(u):"equidistant"===s?u:"equalarea"===s?2*Math.asin(.5*u):Math.asin(u),h=Math.sin(c),d=Math.cos(c);return[(n+Math.atan2(t*h,u*r*d+i*o*h))/co,Math.asin(d*o-(u?i*h*r/u:0))/co]},e.mode=function(t){return arguments.length?(s=t+"",e):s},e.origin=function(s){return arguments.length?(t=s,n=t[0]*co,i=t[1]*co,r=Math.cos(i),o=Math.sin(i),e):t},e.scale=function(t){return arguments.length?(a=+t,e):a},e.translate=function(t){return arguments.length?(l=[+t[0],+t[1]],e):l},e.origin([0,0])},d3.geo.albers=function(){function e(e){var t=i*(co*e[0]-n),s=Math.sqrt(r-2*i*Math.sin(co*e[1]))/i;return[l*s*Math.sin(t)+u[0],l*(s*Math.cos(t)-o)+u[1]]}function t(){var t=co*a[0],l=co*a[1],u=co*s[1],c=Math.sin(t),h=Math.cos(t);return n=co*s[0],i=.5*(c+Math.sin(l)),r=h*h+2*i*c,o=Math.sqrt(r-2*i*Math.sin(u))/i,e}var n,i,r,o,s=[-98,38],a=[29.5,45.5],l=1e3,u=[480,250];return e.invert=function(e){var t=(e[0]-u[0])/l,s=(e[1]-u[1])/l,a=o+s,c=Math.atan2(t,a),h=Math.sqrt(t*t+a*a);return[(n+c/i)/co,Math.asin((r-h*h*i*i)/(2*i))/co]},e.origin=function(e){return arguments.length?(s=[+e[0],+e[1]],t()):s},e.parallels=function(e){return arguments.length?(a=[+e[0],+e[1]],t()):a},e.scale=function(t){return arguments.length?(l=+t,e):l},e.translate=function(t){return arguments.length?(u=[+t[0],+t[1]],e):u},t()},d3.geo.albersUsa=function(){function e(e){var o=e[0],s=e[1];return(s>50?n:o<-140?i:s<21?r:t)(e)}var t=d3.geo.albers(),n=d3.geo.albers().origin([-160,60]).parallels([55,65]),i=d3.geo.albers().origin([-160,20]).parallels([8,18]),r=d3.geo.albers().origin([-60,10]).parallels([8,18]);return e.scale=function(o){return arguments.length?(t.scale(o),n.scale(.6*o),i.scale(o),r.scale(1.5*o),e.translate(t.translate())):t.scale()},e.translate=function(o){if(!arguments.length)return t.translate();var s=t.scale()/1e3,a=o[0],l=o[1];return t.translate(o),n.translate([a-400*s,l+170*s]),i.translate([a-190*s,l+200*s]),r.translate([a+580*s,l+430*s]),e},e.scale(t.scale())},d3.geo.bonne=function(){function e(e){var a=e[0]*co-t,l=e[1]*co-n;if(i){var u=r+i-l,c=a*Math.cos(l)/u;a=u*Math.sin(c),l=u*Math.cos(c)-r}else a*=Math.cos(l),l*=-1;return[o*a+s[0],o*l+s[1]]}var t,n,i,r,o=200,s=[480,250];return e.invert=function(e){var n=(e[0]-s[0])/o,a=(e[1]-s[1])/o;if(i){var l=r+a,u=Math.sqrt(n*n+l*l);a=r+i-u,n=t+u*Math.atan2(n,l)/Math.cos(a)}else a*=-1,n/=Math.cos(a);return[n/co,a/co]},e.parallel=function(t){return arguments.length?(r=1/Math.tan(i=t*co),e):i/co},e.origin=function(i){return arguments.length?(t=i[0]*co,n=i[1]*co,e):[t/co,n/co]},e.scale=function(t){return arguments.length?(o=+t,e):o},e.translate=function(t){return arguments.length?(s=[+t[0],+t[1]],e):s},e.origin([0,0]).parallel(45)},d3.geo.equirectangular=function(){function e(e){var i=e[0]/360,r=-e[1]/360;return[t*i+n[0],t*r+n[1]]}var t=500,n=[480,250];return e.invert=function(e){var i=(e[0]-n[0])/t,r=(e[1]-n[1])/t;return[360*i,-360*r]},e.scale=function(n){return arguments.length?(t=+n,e):t},e.translate=function(t){return arguments.length?(n=[+t[0],+t[1]],e):n},e},d3.geo.mercator=function(){function e(e){var i=e[0]/360,r=-Math.log(Math.tan(Math.PI/4+e[1]*co/2))/co/360;return[t*i+n[0],t*Math.max(-.5,Math.min(.5,r))+n[1]]}var t=500,n=[480,250];return e.invert=function(e){var i=(e[0]-n[0])/t,r=(e[1]-n[1])/t;return[360*i,2*Math.atan(Math.exp(-360*r*co))/co-90]},e.scale=function(n){return arguments.length?(t=+n,e):t},e.translate=function(t){return arguments.length?(n=[+t[0],+t[1]],e):n},e},d3.geo.path=function(){function e(e,t){"function"===typeof o&&(s=zn(o.apply(this,arguments))),u(e);var n=l.length?l.join(""):null;return l=[],n}function t(e){return a(e).join(",")}function n(e){var t=r(e[0]),n=0,i=e.length;while(++n<i)t-=r(e[n]);return t}function i(e){var t=d3.geom.polygon(e[0].map(a)),n=t.area(),i=t.centroid(n<0?(n*=-1,1):-1),r=i[0],o=i[1],s=n,l=0,u=e.length;while(++l<u)t=d3.geom.polygon(e[l].map(a)),n=t.area(),i=t.centroid(n<0?(n*=-1,1):-1),r-=i[0],o-=i[1],s-=n;return[r,o,6*s]}function r(e){return Math.abs(d3.geom.polygon(e.map(a)).area())}var o=4.5,s=zn(o),a=d3.geo.albersUsa(),l=[],u=Fn({FeatureCollection:function(e){var t=e.features,n=-1,i=t.length;while(++n<i)l.push(u(t[n].geometry))},Feature:function(e){u(e.geometry)},Point:function(e){l.push("M",t(e.coordinates),s)},MultiPoint:function(e){var n=e.coordinates,i=-1,r=n.length;while(++i<r)l.push("M",t(n[i]),s)},LineString:function(e){var n=e.coordinates,i=-1,r=n.length;l.push("M");while(++i<r)l.push(t(n[i]),"L");l.pop()},MultiLineString:function(e){var n,i,r,o=e.coordinates,s=-1,a=o.length;while(++s<a){n=o[s],i=-1,r=n.length,l.push("M");while(++i<r)l.push(t(n[i]),"L");l.pop()}},Polygon:function(e){var n,i,r,o=e.coordinates,s=-1,a=o.length;while(++s<a)if(n=o[s],i=-1,(r=n.length-1)>0){l.push("M");while(++i<r)l.push(t(n[i]),"L");l[l.length-1]="Z"}},MultiPolygon:function(e){var n,i,r,o,s,a,u=e.coordinates,c=-1,h=u.length;while(++c<h){n=u[c],i=-1,r=n.length;while(++i<r)if(o=n[i],s=-1,(a=o.length-1)>0){l.push("M");while(++s<a)l.push(t(o[s]),"L");l[l.length-1]="Z"}}},GeometryCollection:function(e){var t=e.geometries,n=-1,i=t.length;while(++n<i)l.push(u(t[n]))}}),c=e.area=Fn({FeatureCollection:function(e){var t=0,n=e.features,i=-1,r=n.length;while(++i<r)t+=c(n[i]);return t},Feature:function(e){return c(e.geometry)},Polygon:function(e){return n(e.coordinates)},MultiPolygon:function(e){var t=0,i=e.coordinates,r=-1,o=i.length;while(++r<o)t+=n(i[r]);return t},GeometryCollection:function(e){var t=0,n=e.geometries,i=-1,r=n.length;while(++i<r)t+=c(n[i]);return t}},0),h=e.centroid=Fn({Feature:function(e){return h(e.geometry)},Polygon:function(e){var t=i(e.coordinates);return[t[0]/t[2],t[1]/t[2]]},MultiPolygon:function(e){var t,n=e.coordinates,r=0,o=0,s=0,a=-1,l=n.length;while(++a<l)t=i(n[a]),r+=t[0],o+=t[1],s+=t[2];return[r/s,o/s]}});return e.projection=function(t){return a=t,e},e.pointRadius=function(t){return"function"===typeof t?o=t:(o=+t,s=zn(o)),e},e},d3.geo.bounds=function(e){var t=1/0,n=1/0,i=-1/0,r=-1/0;return jn(e,(function(e,o){e<t&&(t=e),e>i&&(i=e),o<n&&(n=o),o>r&&(r=o)})),[[t,n],[i,r]]};var ho={Feature:Bn,FeatureCollection:$n,GeometryCollection:Hn,LineString:Gn,MultiLineString:Wn,MultiPoint:Gn,MultiPolygon:qn,Point:Yn,Polygon:Xn};d3.geo.circle=function(){function e(){}function t(e){return l.distance(e)<a}function n(e){var t,n,r,o,s,u=-1,c=e.length,h=[];while(++u<c)s=l.distance(r=e[u]),s<a?(n&&h.push(Qn(n,r)((o-a)/(o-s))),h.push(r),t=n=null):(n=r,!t&&h.length&&(h.push(Qn(h[h.length-1],n)((a-o)/(s-o))),t=n)),o=s;return t=e[0],n=h[0],!n||r[0]!==t[0]||r[1]!==t[1]||r[0]===n[0]&&r[1]===n[1]||h.push(n),i(h)}function i(e){var t,n,i,r=0,o=e.length,s=o?[e[0]]:e,a=l.source();while(++r<o)for(i=l.source(e[r-1])(e[r]).coordinates,t=0,n=i.length;++t<n;)s.push(i[t]);return l.source(a),s}var o=[0,0],s=89.99,a=s*co,l=d3.geo.greatArc().source(o).target(r);e.clip=function(e){return"function"===typeof o&&l.source(o.apply(this,arguments)),u(e)||null};var u=Fn({FeatureCollection:function(e){var t=e.features.map(u).filter(r);return t&&(e=Object.create(e),e.features=t,e)},Feature:function(e){var t=u(e.geometry);return t&&(e=Object.create(e),e.geometry=t,e)},Point:function(e){return t(e.coordinates)&&e},MultiPoint:function(e){var n=e.coordinates.filter(t);return n.length&&{type:e.type,coordinates:n}},LineString:function(e){var t=n(e.coordinates);return t.length&&(e=Object.create(e),e.coordinates=t,e)},MultiLineString:function(e){var t=e.coordinates.map(n).filter((function(e){return e.length}));return t.length&&(e=Object.create(e),e.coordinates=t,e)},Polygon:function(e){var t=e.coordinates.map(n);return t[0].length&&(e=Object.create(e),e.coordinates=t,e)},MultiPolygon:function(e){var t=e.coordinates.map((function(e){return e.map(n)})).filter((function(e){return e[0].length}));return t.length&&(e=Object.create(e),e.coordinates=t,e)},GeometryCollection:function(e){var t=e.geometries.map(u).filter(r);return t.length&&(e=Object.create(e),e.geometries=t,e)}});return e.origin=function(t){return arguments.length?(o=t,"function"!==typeof o&&l.source(o),e):o},e.angle=function(t){return arguments.length?(a=(s=+t)*co,e):s},d3.rebind(e,l,"precision")},d3.geo.greatArc=function(){function e(){var i=e.distance.apply(this,arguments),r=0,a=o/i,l=[t];while((r+=a)<1)l.push(s(r));return l.push(n),{type:"LineString",coordinates:l}}var t,n,i=Zn,r=Jn,o=6*co,s=Kn();return e.distance=function(){return"function"===typeof i&&s.source(t=i.apply(this,arguments)),"function"===typeof r&&s.target(n=r.apply(this,arguments)),s.distance()},e.source=function(n){return arguments.length?(i=n,"function"!==typeof i&&s.source(t=i),e):i},e.target=function(t){return arguments.length?(r=t,"function"!==typeof r&&s.target(n=r),e):r},e.precision=function(t){return arguments.length?(o=t*co,e):o/co},e},d3.geo.greatCircle=d3.geo.circle,d3.geom={},d3.geom.contour=function(e,t){var n=t||ei(e),i=[],r=n[0],o=n[1],s=0,a=0,l=NaN,u=NaN,c=0;do{c=0,e(r-1,o-1)&&(c+=1),e(r,o-1)&&(c+=2),e(r-1,o)&&(c+=4),e(r,o)&&(c+=8),6===c?(s=-1===u?-1:1,a=0):9===c?(s=0,a=1===l?-1:1):(s=po[c],a=fo[c]),s!=l&&a!=u&&(i.push([r,o]),l=s,u=a),r+=s,o+=a}while(n[0]!=r||n[1]!=o);return i};var po=[1,0,1,1,-1,0,-1,1,0,0,0,0,-1,0,-1,NaN],fo=[0,-1,0,0,0,-1,0,0,1,-1,1,1,0,-1,0,NaN];d3.geom.hull=function(e){if(e.length<3)return[];var t,n,i,r,o,s,a,l,u,c,h=e.length,d=h-1,p=[],f=[],m=0;for(t=1;t<h;++t)e[t][1]<e[m][1]?m=t:e[t][1]==e[m][1]&&(m=e[t][0]<e[m][0]?t:m);for(t=0;t<h;++t)t!==m&&(r=e[t][1]-e[m][1],i=e[t][0]-e[m][0],p.push({angle:Math.atan2(r,i),index:t}));for(p.sort((function(e,t){return e.angle-t.angle})),u=p[0].angle,l=p[0].index,a=0,t=1;t<d;++t)n=p[t].index,u==p[t].angle?(i=e[l][0]-e[m][0],r=e[l][1]-e[m][1],o=e[n][0]-e[m][0],s=e[n][1]-e[m][1],i*i+r*r>=o*o+s*s?p[t].index=-1:(p[a].index=-1,u=p[t].angle,a=t,l=n)):(u=p[t].angle,a=t,l=n);for(f.push(m),t=0,n=0;t<2;++n)-1!==p[n].index&&(f.push(p[n].index),t++);for(c=f.length;n<d;++n)if(-1!==p[n].index){while(!ti(f[c-2],f[c-1],p[n].index,e))--c;f[c++]=p[n].index}var g=[];for(t=0;t<c;++t)g.push(e[f[t]]);return g},d3.geom.polygon=function(e){return e.area=function(){var t=0,n=e.length,i=e[n-1][0]*e[0][1],r=e[n-1][1]*e[0][0];while(++t<n)i+=e[t-1][0]*e[t][1],r+=e[t-1][1]*e[t][0];return.5*(r-i)},e.centroid=function(t){var n,i,r=-1,o=e.length,s=0,a=0,l=e[o-1];arguments.length||(t=-1/(6*e.area()));while(++r<o)n=l,l=e[r],i=n[0]*l[1]-l[0]*n[1],s+=(n[0]+l[0])*i,a+=(n[1]+l[1])*i;return[s*t,a*t]},e.clip=function(t){var n,i,r,o,s,a,l=-1,u=e.length,c=e[u-1];while(++l<u){n=t.slice(),t.length=0,o=e[l],s=n[(r=n.length)-1],i=-1;while(++i<r)a=n[i],ni(a,c,o)?(ni(s,c,o)||t.push(ii(s,a,c,o)),t.push(a)):ni(s,c,o)&&t.push(ii(s,a,c,o)),s=a;c=o}return t},e},d3.geom.voronoi=function(e){var t=e.map((function(){return[]}));return ri(e,(function(e){var n,i,r,o,s,a;1===e.a&&e.b>=0?(n=e.ep.r,i=e.ep.l):(n=e.ep.l,i=e.ep.r),1===e.a?(s=n?n.y:-1e6,r=e.c-e.b*s,a=i?i.y:1e6,o=e.c-e.b*a):(r=n?n.x:-1e6,s=e.c-e.a*r,o=i?i.x:1e6,a=e.c-e.a*o);var l=[r,s],u=[o,a];t[e.region.l.index].push(l,u),t[e.region.r.index].push(l,u)})),t.map((function(t,n){var i=e[n][0],r=e[n][1];return t.forEach((function(e){e.angle=Math.atan2(e[0]-i,e[1]-r)})),t.sort((function(e,t){return e.angle-t.angle})).filter((function(e,n){return!n||e.angle-t[n-1].angle>1e-10}))}))};var mo={l:"r",r:"l"};d3.geom.delaunay=function(e){var t=e.map((function(){return[]})),n=[];return ri(e,(function(n){t[n.region.l.index].push(e[n.region.r.index])})),t.forEach((function(t,i){var r=e[i],o=r[0],s=r[1];t.forEach((function(e){e.angle=Math.atan2(e[0]-o,e[1]-s)})),t.sort((function(e,t){return e.angle-t.angle}));for(var a=0,l=t.length-1;a<l;a++)n.push([r,t[a],t[a+1]])})),n},d3.geom.quadtree=function(e,t,n,i,r){function o(e,t,n,i,r,o){if(!isNaN(t.x)&&!isNaN(t.y))if(e.leaf){var a=e.point;a?(Math.abs(a.x-t.x)+Math.abs(a.y-t.y)<.01||(e.point=null,s(e,a,n,i,r,o)),s(e,t,n,i,r,o)):e.point=t}else s(e,t,n,i,r,o)}function s(e,t,n,i,r,s){var a=.5*(n+r),l=.5*(i+s),u=t.x>=a,c=t.y>=l,h=(c<<1)+u;e.leaf=!1,e=e.nodes[h]||(e.nodes[h]=oi()),u?n=a:r=a,c?i=l:s=l,o(e,t,n,i,r,s)}var a,l=-1,u=e.length;if(u&&isNaN(e[0].x)&&(e=e.map(ai)),arguments.length<5)if(3===arguments.length)r=i=n,n=t;else{t=n=1/0,i=r=-1/0;while(++l<u)a=e[l],a.x<t&&(t=a.x),a.y<n&&(n=a.y),a.x>i&&(i=a.x),a.y>r&&(r=a.y);var c=i-t,h=r-n;c>h?r=n+c:i=t+h}var d=oi();return d.add=function(e){o(d,e,t,n,i,r)},d.visit=function(e){si(e,d,t,n,i,r)},e.forEach(d.add),d},d3.time={};var go=Date,vo=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];li.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){yo.setUTCDate.apply(this._,arguments)},setDay:function(){yo.setUTCDay.apply(this._,arguments)},setFullYear:function(){yo.setUTCFullYear.apply(this._,arguments)},setHours:function(){yo.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){yo.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){yo.setUTCMinutes.apply(this._,arguments)},setMonth:function(){yo.setUTCMonth.apply(this._,arguments)},setSeconds:function(){yo.setUTCSeconds.apply(this._,arguments)},setTime:function(){yo.setTime.apply(this._,arguments)}};var yo=Date.prototype,xo="%a %b %e %H:%M:%S %Y",bo="%m/%d/%y",wo="%H:%M:%S",_o=vo,Ao=_o.map(ui),So=["January","February","March","April","May","June","July","August","September","October","November","December"],Eo=So.map(ui);d3.time.format=function(e){function t(t){var i,r,o=[],s=-1,a=0;while(++s<n)37==e.charCodeAt(s)&&(o.push(e.substring(a,s),(r=ko[i=e.charAt(++s)])?r(t):i),a=s+1);return o.push(e.substring(a,s)),o.join("")}var n=e.length;return t.parse=function(t){var n={y:1900,m:0,d:1,H:0,M:0,S:0,L:0},i=ci(n,e,t,0);if(i!=t.length)return null;"p"in n&&(n.H=n.H%12+12*n.p);var r=new go;return r.setFullYear(n.y,n.m,n.d),r.setHours(n.H,n.M,n.S,n.L),r},t.toString=function(){return e},t};var Mo=d3.format("02d"),To=d3.format("03d"),Co=d3.format("04d"),Po=d3.format("2d"),Ro=hi(_o),Lo=hi(Ao),Oo=hi(So),Do=di(So),Io=hi(Eo),No=di(Eo),ko={a:function(e){return Ao[e.getDay()]},A:function(e){return _o[e.getDay()]},b:function(e){return Eo[e.getMonth()]},B:function(e){return So[e.getMonth()]},c:d3.time.format(xo),d:function(e){return Mo(e.getDate())},e:function(e){return Po(e.getDate())},H:function(e){return Mo(e.getHours())},I:function(e){return Mo(e.getHours()%12||12)},j:function(e){return To(1+d3.time.dayOfYear(e))},L:function(e){return To(e.getMilliseconds())},m:function(e){return Mo(e.getMonth()+1)},M:function(e){return Mo(e.getMinutes())},p:function(e){return e.getHours()>=12?"PM":"AM"},S:function(e){return Mo(e.getSeconds())},U:function(e){return Mo(d3.time.sundayOfYear(e))},w:function(e){return e.getDay()},W:function(e){return Mo(d3.time.mondayOfYear(e))},x:d3.time.format(bo),X:d3.time.format(wo),y:function(e){return Mo(e.getFullYear()%100)},Y:function(e){return Co(e.getFullYear()%1e4)},Z:Ri,"%":function(e){return"%"}},Vo={a:pi,A:fi,b:mi,B:gi,c:vi,d:Si,e:Si,H:Ei,I:Ei,L:Ci,m:Ai,M:Mi,p:Pi,S:Ti,x:yi,X:xi,y:wi,Y:bi},Uo=/^\s*\d+/,Fo=d3.map({am:0,pm:1});d3.time.format.utc=function(e){function t(e){try{go=li;var t=new go;return t._=e,n(t)}finally{go=Date}}var n=d3.time.format(e);return t.parse=function(e){try{go=li;var t=n.parse(e);return t&&t._}finally{go=Date}},t.toString=n.toString,t};var zo=d3.time.format.utc("%Y-%m-%dT%H:%M:%S.%LZ");d3.time.format.iso=Date.prototype.toISOString?Li:zo,Li.parse=function(e){var t=new Date(e);return isNaN(t)?null:t},Li.toString=zo.toString,d3.time.second=Oi((function(e){return new go(1e3*Math.floor(e/1e3))}),(function(e,t){e.setTime(e.getTime()+1e3*Math.floor(t))}),(function(e){return e.getSeconds()})),d3.time.seconds=d3.time.second.range,d3.time.seconds.utc=d3.time.second.utc.range,d3.time.minute=Oi((function(e){return new go(6e4*Math.floor(e/6e4))}),(function(e,t){e.setTime(e.getTime()+6e4*Math.floor(t))}),(function(e){return e.getMinutes()})),d3.time.minutes=d3.time.minute.range,d3.time.minutes.utc=d3.time.minute.utc.range,d3.time.hour=Oi((function(e){var t=e.getTimezoneOffset()/60;return new go(36e5*(Math.floor(e/36e5-t)+t))}),(function(e,t){e.setTime(e.getTime()+36e5*Math.floor(t))}),(function(e){return e.getHours()})),d3.time.hours=d3.time.hour.range,d3.time.hours.utc=d3.time.hour.utc.range,d3.time.day=Oi((function(e){var t=new go(1970,0);return t.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),t}),(function(e,t){e.setDate(e.getDate()+t)}),(function(e){return e.getDate()-1})),d3.time.days=d3.time.day.range,d3.time.days.utc=d3.time.day.utc.range,d3.time.dayOfYear=function(e){var t=d3.time.year(e);return Math.floor((e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/864e5)},vo.forEach((function(e,t){e=e.toLowerCase(),t=7-t;var n=d3.time[e]=Oi((function(e){return(e=d3.time.day(e)).setDate(e.getDate()-(e.getDay()+t)%7),e}),(function(e,t){e.setDate(e.getDate()+7*Math.floor(t))}),(function(e){var n=d3.time.year(e).getDay();return Math.floor((d3.time.dayOfYear(e)+(n+t)%7)/7)-(n!==t)}));d3.time[e+"s"]=n.range,d3.time[e+"s"].utc=n.utc.range,d3.time[e+"OfYear"]=function(e){var n=d3.time.year(e).getDay();return Math.floor((d3.time.dayOfYear(e)+(n+t)%7)/7)}})),d3.time.week=d3.time.sunday,d3.time.weeks=d3.time.sunday.range,d3.time.weeks.utc=d3.time.sunday.utc.range,d3.time.weekOfYear=d3.time.sundayOfYear,d3.time.month=Oi((function(e){return e=d3.time.day(e),e.setDate(1),e}),(function(e,t){e.setMonth(e.getMonth()+t)}),(function(e){return e.getMonth()})),d3.time.months=d3.time.month.range,d3.time.months.utc=d3.time.month.utc.range,d3.time.year=Oi((function(e){return e=d3.time.day(e),e.setMonth(0,1),e}),(function(e,t){e.setFullYear(e.getFullYear()+t)}),(function(e){return e.getFullYear()})),d3.time.years=d3.time.year.range,d3.time.years.utc=d3.time.year.utc.range;var jo=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Bo=[[d3.time.second,1],[d3.time.second,5],[d3.time.second,15],[d3.time.second,30],[d3.time.minute,1],[d3.time.minute,5],[d3.time.minute,15],[d3.time.minute,30],[d3.time.hour,1],[d3.time.hour,3],[d3.time.hour,6],[d3.time.hour,12],[d3.time.day,1],[d3.time.day,2],[d3.time.week,1],[d3.time.month,1],[d3.time.month,3],[d3.time.year,1]],$o=[[d3.time.format("%Y"),function(e){return!0}],[d3.time.format("%B"),function(e){return e.getMonth()}],[d3.time.format("%b %d"),function(e){return 1!=e.getDate()}],[d3.time.format("%a %d"),function(e){return e.getDay()&&1!=e.getDate()}],[d3.time.format("%I %p"),function(e){return e.getHours()}],[d3.time.format("%I:%M"),function(e){return e.getMinutes()}],[d3.time.format(":%S"),function(e){return e.getSeconds()}],[d3.time.format(".%L"),function(e){return e.getMilliseconds()}]],Ho=d3.scale.linear(),Go=Vi($o);Bo.year=function(e,t){return Ho.domain(e.map(Fi)).ticks(t).map(Ui)},d3.time.scale=function(){return Ii(d3.scale.linear(),Bo,Go)};var Wo=Bo.map((function(e){return[e[0].utc,e[1]]})),qo=[[d3.time.format.utc("%Y"),function(e){return!0}],[d3.time.format.utc("%B"),function(e){return e.getUTCMonth()}],[d3.time.format.utc("%b %d"),function(e){return 1!=e.getUTCDate()}],[d3.time.format.utc("%a %d"),function(e){return e.getUTCDay()&&1!=e.getUTCDate()}],[d3.time.format.utc("%I %p"),function(e){return e.getUTCHours()}],[d3.time.format.utc("%I:%M"),function(e){return e.getUTCMinutes()}],[d3.time.format.utc(":%S"),function(e){return e.getUTCSeconds()}],[d3.time.format.utc(".%L"),function(e){return e.getUTCMilliseconds()}]],Yo=Vi(qo);Wo.year=function(e,t){return Ho.domain(e.map(ji)).ticks(t).map(zi)},d3.time.scale.utc=function(){return Ii(d3.scale.linear(),Wo,Yo)}})()},e91f:function(e,t,n){"use strict";var i=n("ebb5"),r=n("4d64").indexOf,o=i.aTypedArray,s=i.exportTypedArrayMethod;s("indexOf",(function(e){return r(o(this),e,arguments.length>1?arguments[1]:void 0)}))},e978:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("96ab"),r=n("417a"),o=n("ea01"),s={message:"must be equal to one of the allowed values",params:({schemaCode:e})=>i._`{allowedValues: ${e}}`},a={keyword:"enum",schemaType:"array",$data:!0,error:s,code(e){const{gen:t,data:n,$data:s,schema:a,schemaCode:l,it:u}=e;if(!s&&0===a.length)throw new Error("enum must have non-empty array");const c=a.length>=u.opts.loopEnum,h=r.useFunc(t,o.default);let d;if(c||s)d=t.let("valid"),e.block$data(d,p);else{if(!Array.isArray(a))throw new Error("ajv implementation error");const e=t.const("vSchema",l);d=i.or(...a.map((t,n)=>f(e,n)))}function p(){t.assign(d,!1),t.forOf("v",l,e=>t.if(i._`${h}(${n}, ${e})`,()=>t.assign(d,!0).break()))}function f(e,t){const r=a[t];return"object"===typeof r&&null!==r?i._`${h}(${n}, ${e}[${t}])`:i._`${n} === ${r}`}e.pass(d)}};t.default=a},ea01:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("694b");i.code='require("ajv/dist/runtime/equal").default',t.default=i},eadc:function(e,t,n){"use strict";const i=Math.PI,r=2*i,o=1e-6,s=r-o;function a(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function l(){return new a}a.prototype=l.prototype={constructor:a,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,i){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(e,t,n,i,r,o){this._+="C"+ +e+","+ +t+","+ +n+","+ +i+","+(this._x1=+r)+","+(this._y1=+o)},arcTo:function(e,t,n,r,s){e=+e,t=+t,n=+n,r=+r,s=+s;var a=this._x1,l=this._y1,u=n-e,c=r-t,h=a-e,d=l-t,p=h*h+d*d;if(s<0)throw new Error("negative radius: "+s);if(null===this._x1)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(p>o)if(Math.abs(d*u-c*h)>o&&s){var f=n-a,m=r-l,g=u*u+c*c,v=f*f+m*m,y=Math.sqrt(g),x=Math.sqrt(p),b=s*Math.tan((i-Math.acos((g+p-v)/(2*y*x)))/2),w=b/x,_=b/y;Math.abs(w-1)>o&&(this._+="L"+(e+w*h)+","+(t+w*d)),this._+="A"+s+","+s+",0,0,"+ +(d*f>h*m)+","+(this._x1=e+_*u)+","+(this._y1=t+_*c)}else this._+="L"+(this._x1=e)+","+(this._y1=t);else;},arc:function(e,t,n,a,l,u){e=+e,t=+t,n=+n,u=!!u;var c=n*Math.cos(a),h=n*Math.sin(a),d=e+c,p=t+h,f=1^u,m=u?a-l:l-a;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+d+","+p:(Math.abs(this._x1-d)>o||Math.abs(this._y1-p)>o)&&(this._+="L"+d+","+p),n&&(m<0&&(m=m%r+r),m>s?this._+="A"+n+","+n+",0,1,"+f+","+(e-c)+","+(t-h)+"A"+n+","+n+",0,1,"+f+","+(this._x1=d)+","+(this._y1=p):m>o&&(this._+="A"+n+","+n+",0,"+ +(m>=i)+","+f+","+(this._x1=e+n*Math.cos(l))+","+(this._y1=t+n*Math.sin(l))))},rect:function(e,t,n,i){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}},t["a"]=l},ebb5:function(e,t,n){"use strict";var i,r,o,s=n("a981"),a=n("83ab"),l=n("da84"),u=n("861d"),c=n("5135"),h=n("f5df"),d=n("9112"),p=n("6eeb"),f=n("9bf2").f,m=n("e163"),g=n("d2bb"),v=n("b622"),y=n("90e3"),x=l.Int8Array,b=x&&x.prototype,w=l.Uint8ClampedArray,_=w&&w.prototype,A=x&&m(x),S=b&&m(b),E=Object.prototype,M=E.isPrototypeOf,T=v("toStringTag"),C=y("TYPED_ARRAY_TAG"),P=y("TYPED_ARRAY_CONSTRUCTOR"),R=s&&!!g&&"Opera"!==h(l.opera),L=!1,O={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},D={BigInt64Array:8,BigUint64Array:8},I=function(e){if(!u(e))return!1;var t=h(e);return"DataView"===t||c(O,t)||c(D,t)},N=function(e){if(!u(e))return!1;var t=h(e);return c(O,t)||c(D,t)},k=function(e){if(N(e))return e;throw TypeError("Target is not a typed array")},V=function(e){if(g&&!M.call(A,e))throw TypeError("Target is not a typed array constructor");return e},U=function(e,t,n){if(a){if(n)for(var i in O){var r=l[i];if(r&&c(r.prototype,e))try{delete r.prototype[e]}catch(o){}}S[e]&&!n||p(S,e,n?t:R&&b[e]||t)}},F=function(e,t,n){var i,r;if(a){if(g){if(n)for(i in O)if(r=l[i],r&&c(r,e))try{delete r[e]}catch(o){}if(A[e]&&!n)return;try{return p(A,e,n?t:R&&A[e]||t)}catch(o){}}for(i in O)r=l[i],!r||r[e]&&!n||p(r,e,t)}};for(i in O)r=l[i],o=r&&r.prototype,o?d(o,P,r):R=!1;for(i in D)r=l[i],o=r&&r.prototype,o&&d(o,P,r);if((!R||"function"!=typeof A||A===Function.prototype)&&(A=function(){throw TypeError("Incorrect invocation")},R))for(i in O)l[i]&&g(l[i],A);if((!R||!S||S===E)&&(S=A.prototype,R))for(i in O)l[i]&&g(l[i].prototype,S);if(R&&m(_)!==S&&g(_,S),a&&!c(S,T))for(i in L=!0,f(S,T,{get:function(){return u(this)?this[C]:void 0}}),O)l[i]&&d(l[i],C,i);e.exports={NATIVE_ARRAY_BUFFER_VIEWS:R,TYPED_ARRAY_CONSTRUCTOR:P,TYPED_ARRAY_TAG:L&&C,aTypedArray:k,aTypedArrayConstructor:V,exportTypedArrayMethod:U,exportTypedArrayStaticMethod:F,isView:I,isTypedArray:N,TypedArray:A,TypedArrayPrototype:S}},ebd9:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=void 0;const i=n("cf9b"),r=n("99df"),o=n("9328"),s=n("1dec"),a=["/properties"],l="http://json-schema.org/draft-07/schema";class u extends i.default{_addVocabularies(){super._addVocabularies(),r.default.forEach(e=>this.addVocabulary(e)),this.opts.discriminator&&this.addKeyword(o.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const e=this.opts.$data?this.$dataMetaSchema(s,a):s;this.addMetaSchema(e,l,!1),this.refs["http://json-schema.org/schema"]=l}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(l)?l:void 0)}}e.exports=t=u,Object.defineProperty(t,"__esModule",{value:!0}),t.default=u;var c=n("2b0b");Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return c.KeywordCxt}});var h=n("96ab");Object.defineProperty(t,"_",{enumerable:!0,get:function(){return h._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return h.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return h.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return h.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return h.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return h.CodeGen}})},ec32:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("4c26"),r=n("96ab"),o=n("417a"),s=n("417a"),a={keyword:"patternProperties",type:"object",schemaType:"object",code(e){const{gen:t,schema:n,data:a,parentSchema:l,it:u}=e,{opts:c}=u,h=i.allSchemaProperties(n),d=h.filter(e=>o.alwaysValidSchema(u,n[e]));if(0===h.length||d.length===h.length&&(!u.opts.unevaluated||!0===u.props))return;const p=c.strictSchema&&!c.allowMatchingProperties&&l.properties,f=t.name("valid");!0===u.props||u.props instanceof r.Name||(u.props=s.evaluatedPropsToName(t,u.props));const{props:m}=u;function g(){for(const e of h)p&&v(e),u.allErrors?y(e):(t.var(f,!0),y(e),t.if(f))}function v(e){for(const t in p)new RegExp(e).test(t)&&o.checkStrictMode(u,`property ${t} matches pattern ${e} (use allowMatchingProperties)`)}function y(n){t.forIn("key",a,o=>{t.if(r._`${i.usePattern(e,n)}.test(${o})`,()=>{const i=d.includes(n);i||e.subschema({keyword:"patternProperties",schemaProp:n,dataProp:o,dataPropType:s.Type.Str},f),u.opts.unevaluated&&!0!==m?t.assign(r._`${m}[${o}]`,!0):i||u.allErrors||t.if(r.not(f),()=>t.break())})})}g()}};t.default=a},ed2c:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("a98d");class r extends Error{constructor(e,t,n){super(n||`can't resolve reference ${t} from id ${e}`),this.missingRef=i.resolveUrl(e,t),this.missingSchema=i.normalizeId(i.getFullPath(this.missingRef))}}t.default=r},ef23:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateKeywordUsage=t.validSchemaType=t.funcKeywordCode=t.macroKeywordCode=void 0;const i=n("96ab"),r=n("a3a3"),o=n("4c26"),s=n("38d7");function a(e,t){const{gen:n,keyword:r,schema:o,parentSchema:s,it:a}=e,l=t.macro.call(a.self,o,s,a),u=d(n,r,l);!1!==a.opts.validateSchema&&a.self.validateSchema(l,!0);const c=n.name("valid");e.subschema({schema:l,schemaPath:i.nil,errSchemaPath:`${a.errSchemaPath}/${r}`,topSchemaRef:u,compositeRule:!0},c),e.pass(c,()=>e.error(!0))}function l(e,t){var n;const{gen:s,keyword:a,schema:l,parentSchema:p,$data:f,it:m}=e;h(m,t);const g=!f&&t.compile?t.compile.call(m.self,l,p,m):t.validate,v=d(s,a,g),y=s.let("valid");function x(){if(!1===t.errors)_(),t.modifying&&u(e),A(()=>e.error());else{const n=t.async?b():w();t.modifying&&u(e),A(()=>c(e,n))}}function b(){const e=s.let("ruleErrs",null);return s.try(()=>_(i._`await `),t=>s.assign(y,!1).if(i._`${t} instanceof ${m.ValidationError}`,()=>s.assign(e,i._`${t}.errors`),()=>s.throw(t))),e}function w(){const e=i._`${v}.errors`;return s.assign(e,null),_(i.nil),e}function _(n=(t.async?i._`await `:i.nil)){const a=m.opts.passContext?r.default.this:r.default.self,l=!("compile"in t&&!f||!1===t.schema);s.assign(y,i._`${n}${o.callValidateCode(e,v,a,l)}`,t.modifying)}function A(e){var n;s.if(i.not(null!==(n=t.valid)&&void 0!==n?n:y),e)}e.block$data(y,x),e.ok(null!==(n=t.valid)&&void 0!==n?n:y)}function u(e){const{gen:t,data:n,it:r}=e;t.if(r.parentData,()=>t.assign(n,i._`${r.parentData}[${r.parentDataProperty}]`))}function c(e,t){const{gen:n}=e;n.if(i._`Array.isArray(${t})`,()=>{n.assign(r.default.vErrors,i._`${r.default.vErrors} === null ? ${t} : ${r.default.vErrors}.concat(${t})`).assign(r.default.errors,i._`${r.default.vErrors}.length`),s.extendErrors(e)},()=>e.error())}function h({schemaEnv:e},t){if(t.async&&!e.$async)throw new Error("async keyword in sync schema")}function d(e,t,n){if(void 0===n)throw new Error(`keyword "${t}" failed to compile`);return e.scopeValue("keyword","function"==typeof n?{ref:n}:{ref:n,code:i.stringify(n)})}function p(e,t,n=!1){return!t.length||t.some(t=>"array"===t?Array.isArray(e):"object"===t?e&&"object"==typeof e&&!Array.isArray(e):typeof e==t||n&&"undefined"==typeof e)}function f({schema:e,opts:t,self:n,errSchemaPath:i},r,o){if(Array.isArray(r.keyword)?!r.keyword.includes(o):r.keyword!==o)throw new Error("ajv implementation error");const s=r.dependencies;if(null===s||void 0===s?void 0:s.some(t=>!Object.prototype.hasOwnProperty.call(e,t)))throw new Error(`parent schema must have dependencies of ${o}: ${s.join(",")}`);if(r.validateSchema){const s=r.validateSchema(e[o]);if(!s){const e=`keyword "${o}" value is invalid at path "${i}": `+n.errorsText(r.validateSchema.errors);if("log"!==t.validateSchema)throw new Error(e);n.logger.error(e)}}}t.macroKeywordCode=a,t.funcKeywordCode=l,t.validSchemaType=p,t.validateKeywordUsage=f},ef68:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("2b0b"),r=n("4c26"),o=n("417a"),s=n("2e32"),a={keyword:"properties",type:"object",schemaType:"object",code(e){const{gen:t,schema:n,parentSchema:a,data:l,it:u}=e;"all"===u.opts.removeAdditional&&void 0===a.additionalProperties&&s.default.code(new i.KeywordCxt(u,s.default,"additionalProperties"));const c=r.allSchemaProperties(n);for(const i of c)u.definedProperties.add(i);u.opts.unevaluated&&c.length&&!0!==u.props&&(u.props=o.mergeEvaluated.props(t,o.toHash(c),u.props));const h=c.filter(e=>!o.alwaysValidSchema(u,n[e]));if(0===h.length)return;const d=t.name("valid");for(const i of h)p(i)?f(i):(t.if(r.propertyInData(t,l,i,u.opts.ownProperties)),f(i),u.allErrors||t.else().var(d,!0),t.endIf()),e.it.definedProperties.add(i),e.ok(d);function p(e){return u.opts.useDefaults&&!u.compositeRule&&void 0!==n[e].default}function f(t){e.subschema({keyword:"properties",schemaProp:t,dataProp:t},d)}}};t.default=a},f06c:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("9082"),r=n("cddc"),o=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",i.default,r.default];t.default=o},f21a:function(e,t,n){},f35f:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("73dd"),r=[i.default];t.default=r},f640:function(e){e.exports=JSON.parse('{"$id":"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#","description":"Meta-schema for $data reference (JSON AnySchema extension proposal)","type":"object","required":["$data"],"properties":{"$data":{"type":"string","anyOf":[{"format":"relative-json-pointer"},{"format":"json-pointer"}]}},"additionalProperties":false}')},f8cd:function(e,t,n){var i=n("a691");e.exports=function(e){var t=i(e);if(t<0)throw RangeError("The argument can't be less than 0");return t}},fae8:function(e,t,n){"use strict";var i=n("eadc"),r=n("82ac"),o=n("d8ad");function s(e){this._context=e}s.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};var a=function(e){return new s(e)},l=n("fda4");t["a"]=function(e,t){var n=Object(o["a"])(!0),s=null,u=a,c=null;function h(o){var a,l,h,d=(o=Object(r["a"])(o)).length,p=!1;for(null==s&&(c=u(h=Object(i["a"])())),a=0;a<=d;++a)!(a<d&&n(l=o[a],a,o))===p&&((p=!p)?c.lineStart():c.lineEnd()),p&&c.point(+e(l,a,o),+t(l,a,o));if(h)return c=null,h+""||null}return e="function"===typeof e?e:void 0===e?l["a"]:Object(o["a"])(e),t="function"===typeof t?t:void 0===t?l["b"]:Object(o["a"])(t),h.x=function(t){return arguments.length?(e="function"===typeof t?t:Object(o["a"])(+t),h):e},h.y=function(e){return arguments.length?(t="function"===typeof e?e:Object(o["a"])(+e),h):t},h.defined=function(e){return arguments.length?(n="function"===typeof e?e:Object(o["a"])(!!e),h):n},h.curve=function(e){return arguments.length?(u=e,null!=s&&(c=u(s)),h):u},h.context=function(e){return arguments.length?(null==e?s=c=null:c=u(s=e),h):s},h}},fb27:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n("96ab"),r=n("417a"),o=n("527c"),s={message({keyword:e,schemaCode:t}){const n="maxLength"===e?"more":"fewer";return i.str`must NOT have ${n} than ${t} characters`},params:({schemaCode:e})=>i._`{limit: ${e}}`},a={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:s,code(e){const{keyword:t,data:n,schemaCode:s,it:a}=e,l="maxLength"===t?i.operators.GT:i.operators.LT,u=!1===a.opts.unicode?i._`${n}.length`:i._`${r.useFunc(e.gen,o.default)}(${n})`;e.fail$data(i._`${u} ${l} ${s}`)}};t.default=a},fb2c:function(e,t,n){var i=n("74e8");i("Uint32",(function(e){return function(t,n,i){return e(this,t,n,i)}}))},fda4:function(e,t,n){"use strict";function i(e){return e[0]}function r(e){return e[1]}n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}))}}]);
//# sourceMappingURL=vendor~wrapper.02b41ce9.js.map